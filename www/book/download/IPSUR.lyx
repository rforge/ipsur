#LyX 1.6.7 created this file. For more info see http://www.lyx.org/
\lyxformat 345
\begin_document
\begin_header
\textclass literate-book
\begin_preamble
% Meta information - fill between {} and do not remove %
% \VignetteIndexEntry{An Introduction to Probability and Statistics Using R}
% \VignetteDepends{}
% \VignetteKeywords{}
% \VignettePackage{IPSUR}
% Package

% user-loaded packages
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{latexsym}
%\usepackage{theorem}
\usepackage{subfig}
\usepackage{graphics}
\usepackage{epsfig}
\usepackage{makeidx}
%\usepackage{showidx}
\usepackage{multicol}
%\usepackage{floatflt}
\usepackage{url}
\usepackage{srcltx}
\usepackage{txfonts}
\usepackage{stmaryrd}
\usepackage{textcomp}
%\usepackage{pslatex}
\usepackage{upgreek}
\usepackage[subfigure]{tocloft}
\setlength{\cftfignumwidth}{1.5cm}


%  user defined commands
% special operators
\renewcommand{\P}{%
  \mathop{\operator@font I\hspace{-1.5pt}P\hspace{.13pt}}}
\newcommand{\E}{%
  \mathop{\operator@font I\hspace{-1.5pt}E\hspace{.13pt}}}
\newcommand{\VAR}{\operatorname{var}}
\newcommand{\COV}{\operatorname{cov}}
\newcommand{\COR}{\operatorname{cor}}
\renewcommand{\vec}[1]{\mbox{\boldmath$#1$}}

% special symbols
\newcommand{\me}{\mathrm{e}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\diff}{\mathrm{d}}
\newcommand{\ybar}{\overline{y}}
\newcommand{\xbar}{\overline{x}}
\newcommand{\Xbar}{\overline{X}}
\newcommand{\Ybar}{\overline{Y}}

% special logos
\providecommand{\IPSUR}
{\textsc{I\kern 0ex\lower-.3ex\hbox{\small P}\kern -.5ex\lower.4ex\hbox{\footnotesize S}\kern -.25exU}\kern -.1ex\lower .15ex\hbox{\textsf{\large R}}\@}

\providecommand{\IPSURtitle}
{\fontsize{30}{35}\selectfont \textsc{I\kern -.16ex\lower-.5ex\hbox{\Large P}\kern -.5ex\lower.4ex\hbox{\Large S}\kern -.25exU}\kern -.1ex\lower .15ex\hbox{\textsf{\Huge R}}\@}


%%  Sweave specific commands
% make the input blue, output red
\DefineVerbatimEnvironment{Soutput}{Verbatim}{formatcom=\color{blue}}
\DefineVerbatimEnvironment{Sinput}{Verbatim}{fontshape=sl, formatcom=\color{red}}
% make the input/output black
%\DefineVerbatimEnvironment{Soutput}{Verbatim}{formatcom=\color{black}}
%\DefineVerbatimEnvironment{Sinput}{Verbatim}{fontshape=sl, formatcom=\color{black}}


% get rid of extra Sweave space
\fvset{listparameters={\setlength{\topsep}{0pt}}}
\renewenvironment{Schunk}{\vspace{\topsep}}{\vspace{\topsep}}  

% settings for program listings
\lstset{
language=R,
breaklines=true,
breakatwhitespace=true,
keywordstyle={\ttfamily},
numberstyle = {\ttfamily},
morestring=[b]"
}

% Turn on questions and answers
\newcommand{\question}[1]{#1}
\newcommand{\answer}[1]{#1}
% Turn off questions and answers
%\newcommand{\question}[1]{}
%\newcommand{\answer}[1]{}
\end_preamble
\options nogin
\use_default_options false
\begin_modules
theorems-ams
eqs-within-sections
figs-within-sections
theorems-ams-extended
theorems-chap
\end_modules
\language english
\inputencoding utf8
\font_roman lmodern
\font_sans lmss
\font_typewriter lmtt
\font_default_family default
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100

\graphics default
\paperfontsize 12
\spacing single
\use_hyperref true
\pdf_title "Introduction to Probability and Statistics Using R"
\pdf_author "G. Jay Kerns"
\pdf_bookmarks true
\pdf_bookmarksnumbered true
\pdf_bookmarksopen true
\pdf_bookmarksopenlevel 0
\pdf_breaklinks true
\pdf_pdfborder true
\pdf_colorlinks true
\pdf_backref page
\pdf_pdfusetitle true
\pdf_quoted_options "linkcolor=blue,  citecolor=black, urlcolor=blue"
\papersize a4paper
\use_geometry true
\use_amsmath 1
\use_esint 0
\cite_engine basic
\use_bibtopic false
\paperorientation portrait
\branch examples
\selected 1
\color #faf0e6
\end_branch
\branch howtowithR
\selected 1
\color #faf0e6
\end_branch
\branch proofs
\selected 1
\color #faf0e6
\end_branch
\branch answers
\selected 1
\color #faf0e6
\end_branch
\branch solutions
\selected 1
\color #faf0e6
\end_branch
\branch main
\selected 1
\color #faf0e6
\end_branch
\leftmargin 1in
\topmargin 1in
\rightmargin 1in
\bottommargin 1in
\secnumdepth 2
\tocdepth 1
\paragraph_separation indent
\defskip medskip
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle headings
\listings_params "basicstyle={\ttfamily},breaklines=true,language=R"
\bullet 1 0 9 -1
\tracking_changes false
\output_changes false
\author "" 
\author "" 
\end_header

\begin_body

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout

\family typewriter
\size largest
IPSUR.lyx
\family default
 - Introduction to Probability and Statistics Using 
\family sans
R
\end_layout

\begin_layout Plain Layout

\family typewriter
\size small
Copyright (C) 2010 G.
 Jay Kerns, <gkerns@ysu.edu>
\end_layout

\begin_layout Plain Layout

\family typewriter
\size small
This program is free software: you can redistribute it and/or modify it
 under the terms of the GNU General Public License as  published by the
 Free Software Foundation, either version 3 of the License, or (at your
 option) any later version.
  This program is distributed in the hope that it will be useful, but WITHOUT
 ANY WARRANTY; without even the implied warranty  of MERCHANTABILITY or
 FITNESS FOR A PARTICULAR PURPOSE.
 See the GNU General Public License for more details.
  You  should have received a copy of the GNU General Public License along
 with this program.
  If not, see <http://www.gnu.org/licenses/>
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Plain Layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Plain Layout

%%%                                                                  %%%
\end_layout

\begin_layout Plain Layout

%%%  IPSUR.Rnw - Introduction to Probability and Statistics Using R  %%%
\end_layout

\begin_layout Plain Layout

%%%  Copyright (C) 2010  G.
 Jay Kerns, <gkerns@ysu.edu>              %%%
\end_layout

\begin_layout Plain Layout

%%%  This program is free software: you can redistribute it and/or   %%%
\end_layout

\begin_layout Plain Layout

%%%  modify it under the terms of the GNU General Public License as  %%%
\end_layout

\begin_layout Plain Layout

%%%  published by the Free Software Foundation, either version 3     %%%
\end_layout

\begin_layout Plain Layout

%%%  of the License, or (at your option) any later version.
  This    %%%
\end_layout

\begin_layout Plain Layout

%%%  program is distributed in the hope that it will be useful,      %%%
\end_layout

\begin_layout Plain Layout

%%%  but WITHOUT ANY WARRANTY; without even the implied warranty     %%%
\end_layout

\begin_layout Plain Layout

%%%  of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
         %%%
\end_layout

\begin_layout Plain Layout

%%%  See the GNU General Public License for more details.
  You       %%%
\end_layout

\begin_layout Plain Layout

%%%  should have received a copy of the GNU General Public License   %%%
\end_layout

\begin_layout Plain Layout

%%%  along with this program.
  If not, see                           %%%
\end_layout

\begin_layout Plain Layout

%%%  <http://www.gnu.org/licenses/>                                  %%%
\end_layout

\begin_layout Plain Layout

%%%                                                                  %%%
\end_layout

\begin_layout Plain Layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\begin_layout Plain Layout

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end_layout

\end_inset


\end_layout

\begin_layout Scrap
<<echo = FALSE>>=
\begin_inset Newline newline
\end_inset

###  IPSUR.R - Introduction to Probability and Statistics Using R
\begin_inset Newline newline
\end_inset

###  Copyright (C) 2010  G.
 Jay Kerns, <gkerns@ysu.edu>
\begin_inset Newline newline
\end_inset

###  This program is free software: you can redistribute it and/or modify
\begin_inset Newline newline
\end_inset

###  it under the terms of the GNU General Public License as published by
\begin_inset Newline newline
\end_inset

###  the Free Software Foundation, either version 3 of the License, or
\begin_inset Newline newline
\end_inset

###  (at your option) any later version.
\begin_inset Newline newline
\end_inset

###  This program is distributed in the hope that it will be useful,
\begin_inset Newline newline
\end_inset

###  but WITHOUT ANY WARRANTY; without even the implied warranty of
\begin_inset Newline newline
\end_inset

###  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
  See the
\begin_inset Newline newline
\end_inset

###  GNU General Public License for more details.
\begin_inset Newline newline
\end_inset

###  You should have received a copy of the GNU General Public License
\begin_inset Newline newline
\end_inset

###  along with this program.
  If not, see <http://www.gnu.org/licenses/>
\begin_inset Newline newline
\end_inset

###################################################
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<echo = FALSE>>=
\begin_inset Newline newline
\end_inset

seed <- 42
\begin_inset Newline newline
\end_inset

set.seed(seed)
\begin_inset Newline newline
\end_inset

options(width = 75)
\begin_inset Newline newline
\end_inset

#library(random)
\begin_inset Newline newline
\end_inset

#i_seed <- randomNumbers(n = 624, col = 1, min = -1e+09, max = 1e+09)
\begin_inset Newline newline
\end_inset

#.Random.seed[2:626] <- as.integer(c(1, i_seed))
\begin_inset Newline newline
\end_inset

#save.image(file = "seed.RData")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<echo = FALSE>>=
\begin_inset Newline newline
\end_inset

options(useFancyQuotes = FALSE)
\begin_inset Newline newline
\end_inset

#library(prob)
\begin_inset Newline newline
\end_inset

library(RcmdrPlugin.IPSUR)
\begin_inset Newline newline
\end_inset

# Generate RcmdrTestDrive
\begin_inset Newline newline
\end_inset

n <- 168
\begin_inset Newline newline
\end_inset

# generate order 
\begin_inset Newline newline
\end_inset

order <- 1:n
\begin_inset Newline newline
\end_inset

# generate race 
\begin_inset Newline newline
\end_inset

race <- sample(c("White","AfAmer","Asian","Other"), size=n, prob=c(76,13,5,6),
 replace = TRUE)
\begin_inset Newline newline
\end_inset

race <- factor(race)
\begin_inset Newline newline
\end_inset

# generate gender and smoke 
\begin_inset Newline newline
\end_inset

tmp <- sample(4, size=n, prob=c(12,38,9,41), replace = TRUE) 
\begin_inset Newline newline
\end_inset

gender <- factor(ifelse(tmp < 3,"Male", "Female")) 
\begin_inset Newline newline
\end_inset

smoke <- factor(ifelse(tmp %in% c(1,3), "Yes", "No"))
\begin_inset Newline newline
\end_inset

# generate parking
\begin_inset Newline newline
\end_inset

parking <- rgeom(n, prob = 0.4) + 1
\begin_inset Newline newline
\end_inset

# generate salary 
\begin_inset Newline newline
\end_inset

m <- 17 + (as.numeric(gender)-1) 
\begin_inset Newline newline
\end_inset

s <- 1 + (2 - as.numeric(gender)) 
\begin_inset Newline newline
\end_inset

salary <- rnorm(n, mean = m, sd = s)
\begin_inset Newline newline
\end_inset

# simulate reduction 
\begin_inset Newline newline
\end_inset

x <- arima.sim(list(order=c(1,0,0), ar=.9), n=n) 
\begin_inset Newline newline
\end_inset

reduction <- as.numeric((20*x + order)/n + 5)
\begin_inset Newline newline
\end_inset

# simulate before and after
\begin_inset Newline newline
\end_inset

before <- rlogis(n, location = 68, scale = 3) 
\begin_inset Newline newline
\end_inset

m <- (as.numeric(smoke)-1)*2.5 
\begin_inset Newline newline
\end_inset

after <- before - rnorm(n, mean = m, sd=0.1)
\begin_inset Newline newline
\end_inset

RcmdrTestDrive <- data.frame(order = order, race = race, smoke = smoke, gender
 = gender, salary = salary, reduction = reduction, before = before, after
 = after, parking = parking)
\begin_inset Newline newline
\end_inset

# clean up
\begin_inset Newline newline
\end_inset

remove(list = names(RcmdrTestDrive))
\begin_inset Newline newline
\end_inset

remove(x, n, m, s, tmp)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<echo = FALSE>>=
\begin_inset Newline newline
\end_inset

plot.htest <- function (x, hypoth.or.conf = 'Hypoth',...) { 
\begin_inset Newline newline
\end_inset

require(HH) 
\begin_inset Newline newline
\end_inset

if (x$method == "1-sample proportions test with continuity correction" ||
 x$method == "1-sample proportions test without continuity correction"){
\begin_inset Newline newline
\end_inset

mu <- x$null.value
\begin_inset Newline newline
\end_inset

obs.mean <- x$estimate
\begin_inset Newline newline
\end_inset

n <- NA
\begin_inset Newline newline
\end_inset

std.dev <- abs(obs.mean - mu)/sqrt(x$statistic)
\begin_inset Newline newline
\end_inset

deg.freedom <- NA
\begin_inset Newline newline
\end_inset

if(x$alternative == "two.sided"){
\begin_inset Newline newline
\end_inset

alpha.right <- (1 - attr(x$conf.int, "conf.level"))/2
\begin_inset Newline newline
\end_inset

Use.alpha.left <- TRUE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- TRUE
\begin_inset Newline newline
\end_inset

} else if (x$alternative == "less") {
\begin_inset Newline newline
\end_inset

alpha.right <- 1 - attr(x$conf.int, "conf.level")
\begin_inset Newline newline
\end_inset

Use.alpha.left <- TRUE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- FALSE
\begin_inset Newline newline
\end_inset

} else {
\begin_inset Newline newline
\end_inset

alpha.right <- 1 - attr(x$conf.int, "conf.level")
\begin_inset Newline newline
\end_inset

Use.alpha.left <- FALSE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- TRUE
\begin_inset Newline newline
\end_inset

}
\begin_inset Newline newline
\end_inset

} else if (x$method == "One Sample z-test"){
\begin_inset Newline newline
\end_inset

mu <- x$null.value
\begin_inset Newline newline
\end_inset

obs.mean <- x$estimate
\begin_inset Newline newline
\end_inset

n <- x$parameter[1]
\begin_inset Newline newline
\end_inset

std.dev <- x$parameter[2]
\begin_inset Newline newline
\end_inset

deg.freedom <- NA
\begin_inset Newline newline
\end_inset

if(x$alternative == "two.sided"){
\begin_inset Newline newline
\end_inset

alpha.right <- (1 - attr(x$conf.int, "conf.level"))/2
\begin_inset Newline newline
\end_inset

Use.alpha.left <- TRUE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- TRUE
\begin_inset Newline newline
\end_inset

} else if (x$alternative == "less") {
\begin_inset Newline newline
\end_inset

alpha.right <- 1 - attr(x$conf.int, "conf.level")
\begin_inset Newline newline
\end_inset

Use.alpha.left <- TRUE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- FALSE
\begin_inset Newline newline
\end_inset

} else {
\begin_inset Newline newline
\end_inset

alpha.right <- 1 - attr(x$conf.int, "conf.level")
\begin_inset Newline newline
\end_inset

Use.alpha.left <- FALSE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- TRUE
\begin_inset Newline newline
\end_inset

} 
\begin_inset Newline newline
\end_inset

} else if (x$method == "One Sample t-test" || x$method == "Paired t-test"){
\begin_inset Newline newline
\end_inset

mu <- x$null.value
\begin_inset Newline newline
\end_inset

obs.mean <- x$estimate
\begin_inset Newline newline
\end_inset

n <- x$parameter + 1
\begin_inset Newline newline
\end_inset

std.dev <- x$estimate/x$statistic*sqrt(n)
\begin_inset Newline newline
\end_inset

deg.freedom <- x$parameter
\begin_inset Newline newline
\end_inset

if(x$alternative == "two.sided"){
\begin_inset Newline newline
\end_inset

alpha.right <- (1 - attr(x$conf.int, "conf.level"))/2
\begin_inset Newline newline
\end_inset

Use.alpha.left <- TRUE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- TRUE
\begin_inset Newline newline
\end_inset

} else if (x$alternative == "less") {
\begin_inset Newline newline
\end_inset

alpha.right <- 1 - attr(x$conf.int, "conf.level")
\begin_inset Newline newline
\end_inset

Use.alpha.left <- TRUE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- FALSE
\begin_inset Newline newline
\end_inset

} else {
\begin_inset Newline newline
\end_inset

alpha.right <- 1 - attr(x$conf.int, "conf.level")
\begin_inset Newline newline
\end_inset

Use.alpha.left <- FALSE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- TRUE
\begin_inset Newline newline
\end_inset

}
\begin_inset Newline newline
\end_inset

} else if (x$method == "Welch Two Sample t-test"){
\begin_inset Newline newline
\end_inset

mu <- x$null.value
\begin_inset Newline newline
\end_inset

obs.mean <- -diff(x$estimate)
\begin_inset Newline newline
\end_inset

n <- x$parameter + 2
\begin_inset Newline newline
\end_inset

std.dev <- obs.mean/x$statistic*sqrt(n)
\begin_inset Newline newline
\end_inset

deg.freedom <- x$parameter
\begin_inset Newline newline
\end_inset

if(x$alternative == "two.sided"){
\begin_inset Newline newline
\end_inset

alpha.right <- (1 - attr(x$conf.int, "conf.level"))/2
\begin_inset Newline newline
\end_inset

Use.alpha.left <- TRUE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- TRUE
\begin_inset Newline newline
\end_inset

} else if (x$alternative == "less") {
\begin_inset Newline newline
\end_inset

alpha.right <- 1 - attr(x$conf.int, "conf.level")
\begin_inset Newline newline
\end_inset

Use.alpha.left <- TRUE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- FALSE
\begin_inset Newline newline
\end_inset

} else {
\begin_inset Newline newline
\end_inset

alpha.right <- 1 - attr(x$conf.int, "conf.level")
\begin_inset Newline newline
\end_inset

Use.alpha.left <- FALSE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- TRUE
\begin_inset Newline newline
\end_inset

} 
\begin_inset Newline newline
\end_inset

} else if (x$method == " Two Sample t-test"){
\begin_inset Newline newline
\end_inset

mu <- x$null.value
\begin_inset Newline newline
\end_inset

obs.mean <- -diff(x$estimate)
\begin_inset Newline newline
\end_inset

n <- x$parameter + 2
\begin_inset Newline newline
\end_inset

std.dev <- obs.mean/x$statistic*sqrt(n)
\begin_inset Newline newline
\end_inset

deg.freedom <- x$parameter
\begin_inset Newline newline
\end_inset

if(x$alternative == "two.sided"){
\begin_inset Newline newline
\end_inset

alpha.right <- (1 - attr(x$conf.int, "conf.level"))/2
\begin_inset Newline newline
\end_inset

Use.alpha.left <- TRUE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- TRUE
\begin_inset Newline newline
\end_inset

} else if (x$alternative == "less") {
\begin_inset Newline newline
\end_inset

alpha.right <- 1 - attr(x$conf.int, "conf.level")
\begin_inset Newline newline
\end_inset

Use.alpha.left <- TRUE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- FALSE
\begin_inset Newline newline
\end_inset

} else {
\begin_inset Newline newline
\end_inset

alpha.right <- 1 - attr(x$conf.int, "conf.level")
\begin_inset Newline newline
\end_inset

Use.alpha.left <- FALSE
\begin_inset Newline newline
\end_inset

Use.alpha.right <- TRUE
\begin_inset Newline newline
\end_inset

}
\begin_inset Newline newline
\end_inset

}
\begin_inset Newline newline
\end_inset

return(normal.and.t.dist(mu.H0 = mu, obs.mean = obs.mean, std.dev = std.dev, n =
 n, deg.freedom = deg.freedom, alpha.right = alpha.right, Use.obs.mean = TRUE,
 Use.alpha.left = Use.alpha.left, Use.alpha.right = Use.alpha.right, hypoth.or.conf
 = hypoth.or.conf))
\begin_inset Newline newline
\end_inset

}
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Title
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
fontsize{30}{35}
\backslash
selectfont 
\end_layout

\end_inset

Introduction to Probability
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash
 
\end_layout

\end_inset

and Statistics Using 
\family sans
R
\end_layout

\begin_layout Date
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
fontsize{24}{28}
\backslash
selectfont 
\end_layout

\end_inset


\noun on
First Edition
\end_layout

\begin_layout Author
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
fontsize{24}{28}
\backslash
selectfont 
\end_layout

\end_inset

G.
\begin_inset space ~
\end_inset

Jay Kerns
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
pagenumbering{roman}
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{page}{2}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
IPSUR
\end_layout

\end_inset

: Introduction to Probability and Statistics Using 
\family sans
R
\end_layout

\begin_layout Standard
\noindent
Copyright 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
textcopyright
\end_layout

\end_inset


\begin_inset space ~
\end_inset

2010 G.
\begin_inset space ~
\end_inset

Jay Kerns
\end_layout

\begin_layout Standard
\noindent
ISBN: 978-0-557-24979-4
\end_layout

\begin_layout Standard
\begin_inset VSpace defskip
\end_inset


\end_layout

\begin_layout Standard
\noindent
Permission is granted to copy, distribute and/or modify this document under
 the terms of the GNU Free Documentation License, Version 1.3 or any later
 version published by the Free Software Foundation; with no Invariant Sections,
 no Front-Cover Texts, and no Back-Cover Texts.
 A copy of the license is included in the section entitled ``GNU Free Documentat
ion License''.
\end_layout

\begin_layout Standard
\noindent
\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Standard
\noindent
Date: 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
today
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
\begin_inset VSpace vfill
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cleardoublepage
\end_layout

\begin_layout Plain Layout


\backslash
phantomsection
\end_layout

\begin_layout Plain Layout


\backslash
pdfbookmark[1]{Contents}{table}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset toc
LatexCommand tableofcontents

\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cleardoublepage
\end_layout

\begin_layout Plain Layout


\backslash
phantomsection
\end_layout

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{chapter}{Preface}
\end_layout

\end_inset


\end_layout

\begin_layout Chapter*
Preface
\end_layout

\begin_layout Standard
This book was expanded from lecture materials I use in a one semester upper-divi
sion undergraduate course entitled 
\emph on
Probability and Statistics
\emph default
 at Youngstown State University.
 Those lecture materials, in turn, were based on notes that I transcribed
 as a graduate student at Bowling Green State University.
 The course for which the materials were written is 50-50 Probability and
 Statistics, and the attendees include mathematics, engineering, and computer
 science majors (among others).
 The catalog prerequisites for the course are a full year of calculus.
\end_layout

\begin_layout Standard
The book can be subdivided into three basic parts.
 The first part includes the introductions and elementary 
\emph on
descriptive statistics
\emph default
; I want the students to be knee-deep in data right out of the gate.
 The second part is the study of 
\emph on
probability
\emph default
, which begins at the basics of sets and the equally likely model, journeys
 past discrete/continuous random variables, and continues through to multivariat
e distributions.
 The chapter on sampling distributions paves the way to the third part,
 which is 
\emph on
inferential statistics
\emph default
.
 This last part includes point and interval estimation, hypothesis testing,
 and finishes with introductions to selected topics in applied statistics.
\end_layout

\begin_layout Standard
I usually only have time in one semester to cover a small subset of this
 book.
 I cover the material in Chapter 2 in a class period that is supplemented
 by a take-home assignment for the students.
 I spend a lot of time on Data Description, Probability, Discrete, and Continuou
s Distributions.
 I mention selected facts from Multivariate Distributions in passing, and
 discuss the meaty parts of Sampling Distributions before moving right along
 to Estimation (which is another chapter I dwell on considerably).
 Hypothesis Testing goes faster after all of the previous work, and by that
 time the end of the semester is in sight.
 I normally choose one or two final chapters (sometimes three) from the
 remaining to survey, and regret at the end that I did not have the chance
 to cover more.
\end_layout

\begin_layout Standard
In an attempt to be correct I have included material in this book which
 I would normally not mention during the course of a standard lecture.
 For instance, I normally do not highlight the intricacies of measure theory
 or integrability conditions when speaking to the class.
 Moreover, I often stray from the matrix approach to multiple linear regression
 because many of my students have not yet been formally trained in linear
 algebra.
 That being said, it is important to me for the students to hold something
 in their hands which acknowledges the world of mathematics and statistics
 beyond the classroom, and which may be useful to them for many semesters
 to come.
 It also mirrors my own experience as a student.
\end_layout

\begin_layout Standard
The vision for this document is a more or less self contained, essentially
 complete, correct, introductory textbook.
 There should be plenty of exercises for the student, with full solutions
 for some, and no solutions for others (so that the instructor may assign
 them for grading).
 By 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Scrap

Sweave
\end_layout

\end_inset

's dynamic nature it is possible to write randomly generated exercises and
 I had planned to implement this idea already throughout the book.
 Alas, there are only 24 hours in a day.
 Look for more in future editions.
\end_layout

\begin_layout Standard
Seasoned readers will be able to detect my origins: 
\emph on
Probability and Statistical Inference
\emph default
 by Hogg and Tanis 
\begin_inset CommandInset citation
LatexCommand citet
key "Hogg2006"

\end_inset

, 
\emph on
Statistical Inference
\emph default
 by Casella and Berger 
\begin_inset CommandInset citation
LatexCommand citet
key "Casella2002"

\end_inset

, and 
\emph on
Theory of Point Estimation/Testing Statistical Hypotheses
\emph default
 by Lehmann 
\begin_inset CommandInset citation
LatexCommand cite
key "Lehmann1998,Lehmann1986"

\end_inset

.
 I highly recommend each of those books to every reader of this one.
 Some 
\family sans
R
\family default
 books with 
\begin_inset Quotes eld
\end_inset

introductory
\begin_inset Quotes erd
\end_inset

 in the title that I recommend are 
\emph on
Introductory Statistics with 
\family sans
R
\family default
\emph default
 by Dalgaard 
\begin_inset CommandInset citation
LatexCommand cite
key "Dalgaard2008"

\end_inset

 and 
\emph on
Using 
\family sans
R
\family default
 for Introductory Statistics
\emph default
 by Verzani 
\begin_inset CommandInset citation
LatexCommand cite
key "Verzani2005"

\end_inset

.
 Surely there are many, many other good introductory books about 
\family sans
R
\family default
, but frankly, I have tried to steer clear of them for the past year or
 so to avoid any undue influence on my own writing.
\end_layout

\begin_layout Standard
I would like to make special mention of two other books: 
\emph on
Introduction to Statistical Thought
\emph default
 by Michael Lavine 
\begin_inset CommandInset citation
LatexCommand cite
key "Lavine2009"

\end_inset

 and 
\emph on
Introduction to Probability
\emph default
 by Grinstead and Snell 
\begin_inset CommandInset citation
LatexCommand cite
key "Grinstead1997"

\end_inset

.
 Both of these books are 
\emph on
free
\emph default
 and are what ultimately convinced me to release 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
IPSUR
\backslash

\end_layout

\end_inset

 under a free license, too.
\end_layout

\begin_layout Standard
Please bear in mind that the title of this book is 
\begin_inset Quotes eld
\end_inset

Introduction to Probability and Statistics Using 
\family sans
R
\family default

\begin_inset Quotes erd
\end_inset

, and not 
\begin_inset Quotes eld
\end_inset

Introduction to 
\family sans
R
\family default
 Using Probability and Statistics
\begin_inset Quotes erd
\end_inset

, nor even 
\begin_inset Quotes eld
\end_inset

Introduction to Probability and Statistics and 
\family sans
R
\family default
 Using Words
\begin_inset Quotes erd
\end_inset

.
 The people at the party are Probability and Statistics; the handshake is
 
\family sans
R
\family default
.
 There are several important topics about 
\family sans
R
\family default
 which some individuals will feel are underdeveloped, glossed over, or wantonly
 omitted.
 Some will feel the same way about the probabilistic and/or statistical
 content.
 Still others will just want to learn 
\family sans
R
\family default
 and skip all of the mathematics.
\end_layout

\begin_layout Standard
Despite any misgivings: here it is, warts and all.
 I humbly invite said individuals to take this book, with the GNU Free Documenta
tion License (GNU-FDL) in hand, and make it better.
 In that spirit there are at least a few ways in my view in which this book
 could be improved.
\end_layout

\begin_layout Description
Better
\begin_inset space ~
\end_inset

data.
 The data analyzed in this book are almost entirely from the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Scrap

datasets
\end_layout

\end_inset

 package in base 
\family sans
R
\family default
, and here is why:
\end_layout

\begin_deeper
\begin_layout Enumerate
I made a conscious effort to minimize dependence on contributed packages,
\end_layout

\begin_layout Enumerate
The data are instantly available, already in the correct format, so we need
 not take time to manage them, and
\end_layout

\begin_layout Enumerate
The data are 
\emph on
real
\emph default
.
\end_layout

\begin_layout Standard
I made no attempt to choose data sets that would be interesting to the students;
 rather, data were chosen for their potential to convey a statistical point.
 Many of the data sets are decades old or more (for instance, the data used
 to introduce simple linear regression are the speeds and stopping distances
 of cars in the 1920's).
\end_layout

\begin_layout Standard
In a perfect world with infinite time I would research and contribute recent,
 
\emph on
real
\emph default
 data in a context crafted to engage the students in 
\emph on
every
\emph default
 example.
 One day I hope to stumble over said time.
 In the meantime, I will add new data sets incrementally as time permits.
\end_layout

\end_deeper
\begin_layout Description
More
\begin_inset space ~
\end_inset

proofs.
 I would like to include more proofs for the sake of completeness (I understand
 that some people would not consider more proofs to be improvement).
 Many proofs have been skipped entirely, and I am not aware of any rhyme
 or reason to the current omissions.
 I will add more when I get a chance.
 
\end_layout

\begin_layout Description
More
\begin_inset space ~
\end_inset

and
\begin_inset space ~
\end_inset

better
\begin_inset space ~
\end_inset

graphics: I have not used the 
\begin_inset listings
lstparams "basicstyle={\ttfamily},breaklines=true,language=R"
inline true
status open

\begin_layout Scrap

ggplot2
\end_layout

\end_inset

 package 
\begin_inset CommandInset citation
LatexCommand citet
key "Wickam2009"

\end_inset

 because I do not know how to use it yet.
 It is on my to-do list.
\end_layout

\begin_layout Description
More
\begin_inset space ~
\end_inset

and
\begin_inset space ~
\end_inset

better
\begin_inset space ~
\end_inset

exercises: There are only a few exercises in the first edition simply because
 I have not had time to write more.
 I have toyed with the 
\begin_inset listings
lstparams "basicstyle={\ttfamily},breaklines=true,language=R"
inline true
status open

\begin_layout Scrap

exams
\end_layout

\end_inset

 package 
\begin_inset CommandInset citation
LatexCommand citet
key "exams"

\end_inset

 and I believe that it is a right way to move forward.
 As I learn more about what the package can do I would like to incorporate
 it into later editions of this book.
\end_layout

\begin_layout Section*
About This Document
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
IPSUR
\backslash

\end_layout

\end_inset

 contains many interrelated parts: the 
\series bold
\emph on
Document
\series default
\emph default
, the 
\series bold
\emph on
Program
\series default
\emph default
, the 
\series bold
\emph on
Package
\series default
\emph default
, and the 
\series bold
\emph on
Ancillaries
\series default
\emph default
.
 In short, the 
\emph on
Document
\emph default
 is what you are reading right now.
 The 
\emph on
Program
\emph default
 provides an efficient means to modify the Document.
 The 
\emph on
Package
\emph default
 is an 
\family sans
R
\family default
 package that houses the Program and the Document.
 Finally, the 
\emph on
Ancillaries
\emph default
 are extra materials that reside in the Package and were produced by the
 Program to supplement use of the Document.
 We briefly describe each of them in turn.
\end_layout

\begin_layout Subsection*
The Document
\end_layout

\begin_layout Standard
The 
\emph on
Document
\emph default
 is that which you are reading right now -- 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
IPSUR's
\end_layout

\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
emph{raison d'
\backslash
^etre}
\end_layout

\end_inset

.
 There are transparent copies (nonproprietary text files) and opaque copies
 (everything else).
 See the GNU-FDL in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:GNU-Free-Documentation"

\end_inset

 for more precise language and details.
\end_layout

\begin_layout Description

\family typewriter
IPSUR.tex
\family default
 is a transparent copy of the Document to be typeset with a LaTeX distribution
 such as MikTeX or TeX Live.
 Any reader is free to modify the Document and release the modified version
 in accordance with the provisions of the GNU-FDL.
 Note that this file cannot be used to generate a randomized copy of the
 Document.
 Indeed, in its released form it is only capable of typesetting the exact
 version of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
IPSUR
\backslash

\end_layout

\end_inset

 which you are currently reading.
 Furthermore, the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

.tex
\end_layout

\end_inset


\color inherit
 file is unable to generate any of the ancillary materials.
 
\end_layout

\begin_layout Description

\family typewriter
IPSUR-xxx.eps
\family default
,
\begin_inset space ~
\end_inset


\family typewriter
IPSUR-xxx.pdf
\family default
 are the image files for every graph in the Document.
 These are needed when typesetting with LaTeX.
\end_layout

\begin_layout Description

\family typewriter
IPSUR.pdf
\family default
 is an opaque copy of the Document.
 This is the file that instructors would likely want to distribute to students.
\end_layout

\begin_layout Description

\family typewriter
IPSUR.dvi
\family default
 is another opaque copy of the Document in a different file format.
\end_layout

\begin_layout Subsection*
The Program
\end_layout

\begin_layout Standard
The 
\emph on
Program
\emph default
 includes 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.lyx
\end_layout

\end_inset


\color inherit
 and its nephew 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.Rnw
\end_layout

\end_inset


\color inherit
; the purpose of each is to give individuals a way to quickly customize
 the Document for their particular purpose(s).
\end_layout

\begin_layout Description

\family typewriter
IPSUR.lyx
\family default
 is the source LyX file for the Program, released under the GNU General
 Public License (GNU GPL) Version 3.
 This file is opened, modified, and compiled with LyX, a sophisticated open-sour
ce document processor, and may be used (together with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Sweave
\end_layout

\end_inset


\color inherit
) to generate a randomized, modified copy of the Document with brand new
 data sets for some of the exercises and the solution manuals (in the Second
 Edition).
 Additionally, LyX can easily activate/deactivate entire blocks of the document,
 
\emph on
e.g.
\begin_inset space ~
\end_inset


\emph default
the 
\family sans
proofs
\family default
 of the theorems, the student 
\family sans
solutions
\family default
 to the exercises, or the instructor 
\family sans
answers
\family default
 to the problems, so that the new author may choose which sections (s)he
 would like to include in the final Document (again, Second Edition).
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.lyx
\end_layout

\end_inset


\color inherit
 file is all that a person needs (in addition to a properly configured system
 -- see Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Instructions-for-Instructors"

\end_inset

) to generate/compile/export to all of the other formats described above
 and below, which includes the ancillary materials 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.Rdata
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.R
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Description

\family typewriter
IPSUR.Rnw
\family default
 is another form of the source code for the Program, also released under
 the GNU GPL Version 3.
 It was produced by exporting 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.lyx
\end_layout

\end_inset


\color inherit
 into
\family sans
 R
\family default
/Sweave format (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.Rnw
\end_layout

\end_inset


\color inherit
).
 This file may be processed with Sweave to generate a randomized copy of
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.tex
\end_layout

\end_inset


\color inherit
 -- a transparent copy of the Document -- together with the ancillary materials
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.Rdata
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.R
\end_layout

\end_inset


\color inherit
.
 Please note, however, that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.Rnw
\end_layout

\end_inset


\color inherit
 is just a simple text file which does not support many of the extra features
 that LyX offers such as WYSIWYM editing, instantly (de)activating branches
 of the manuscript, and more.
 
\end_layout

\begin_layout Subsection*
The Package
\end_layout

\begin_layout Standard
There is a contributed package on 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

CRAN
\end_layout

\end_inset


\color inherit
, called 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR
\end_layout

\end_inset


\color inherit
.
 The package affords many advantages, one being that it houses the Document
 in an easy-to-access medium.
 Indeed, a student can have the Document at his/her fingertips with only
 three commands:
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

install.packages("IPSUR")
\begin_inset Newline newline
\end_inset

library(IPSUR)
\begin_inset Newline newline
\end_inset

read(IPSUR)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Another advantage goes hand in hand with the Program's license; since 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
IPSUR
\backslash

\end_layout

\end_inset

 is free, the source code must be freely available to anyone that wants
 it.
 A package hosted on 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

CRAN
\end_layout

\end_inset


\color inherit
 allows the author to obey the license by default.
\end_layout

\begin_layout Standard
A much more important advantage is that the excellent facilities at 
\family sans
R
\family default
-Forge are building and checking the package daily against patched and developme
nt versions of the absolute latest pre-release of 
\family sans
R
\family default
.
 If any problems surface then I will know about it within 24 hours.
\end_layout

\begin_layout Standard
And finally, suppose there is some sort of problem.
 The package structure makes it 
\emph on
incredibly
\emph default
 easy for me to distribute bug-fixes and corrected typographical errors.
 As an author I can make my corrections, upload them to the repository at
 
\family sans
R
\family default
-Forge, and they will be reflected 
\emph on
worldwide
\emph default
 within hours.
 We aren't in Kansas anymore, Toto.
\end_layout

\begin_layout Subsection*
Ancillary Materials
\end_layout

\begin_layout Standard
These are extra materials that accompany 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
IPSUR
\end_layout

\end_inset

.
 They reside in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

/etc
\end_layout

\end_inset

 subdirectory of the package source.
\end_layout

\begin_layout Description

\family typewriter
IPSUR.RData
\family default
 is a saved image of the 
\family sans
R
\family default
 workspace at the completion of the Sweave processing of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
IPSUR
\end_layout

\end_inset

.
 It can be loaded into memory with 
\family sans
File
\family default
 
\begin_inset Formula $\triangleright$
\end_inset

 
\family sans
Load Workspace
\family default
 or with the command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

load("/path/to/IPSUR.Rdata")
\end_layout

\end_inset


\color inherit
.
 Either method will make every single object in the file immediately available
 and in memory.
 In particular, the data BLANK from Exercise BLANK in Chapter BLANK on page
 BLANK will be loaded.
 Type BLANK at the command line (after loading 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.RData
\end_layout

\end_inset


\color inherit
) to see for yourself.
 
\end_layout

\begin_layout Description

\family typewriter
IPSUR.R
\family default
 is the exported 
\family sans
R
\family default
 code from 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.Rnw
\end_layout

\end_inset


\color inherit
.
 With this script, literally every 
\family sans
R
\family default
 command from the entirety of 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
IPSUR
\backslash

\end_layout

\end_inset

 can be resubmitted at the command line.
\end_layout

\begin_layout Section*
Notation
\end_layout

\begin_layout Standard
We use the notation 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset

 or 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stem.leaf
\end_layout

\end_inset

 notation to denote objects, functions, 
\emph on
\color inherit
etc
\emph default
\color none
..
 The sequence 
\begin_inset Quotes eld
\end_inset


\family sans
\color inherit
Statistics
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset


\family default
 
\family sans
Summaries
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset


\family default
 
\family sans
Active Dataset
\family default
\color none

\begin_inset Quotes erd
\end_inset

 means to click the 
\family sans
\color inherit
Statistics
\family default
\color none
 menu item, next click the 
\family sans
\color inherit
Summaries
\family default
\color none
 submenu item, and finally click 
\family sans
\color inherit
Active Dataset
\family default
\color none
.
\end_layout

\begin_layout Section*
Acknowledgements
\end_layout

\begin_layout Standard
This book would not have been possible without the firm mathematical and
 statistical foundation provided by the professors at Bowling Green State
 University, including Drs.
\begin_inset space ~
\end_inset

G
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'{a}
\end_layout

\end_inset

bor Sz
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
'{e}
\end_layout

\end_inset

kely, Craig Zirbel, Arjun K.
\begin_inset space ~
\end_inset

Gupta, Hanfeng Chen, Truc Nguyen, and James Albert.
 I would also like to thank Drs.
\begin_inset space ~
\end_inset

Neal Carothers and Kit Chan.
\end_layout

\begin_layout Standard
I would also like to thank my colleagues at Youngstown State University
 for their support.
 In particular, I would like to thank Dr.
\begin_inset space ~
\end_inset

G.
\begin_inset space ~
\end_inset

Andy Chang for showing me what it means to be a statistician.
\end_layout

\begin_layout Standard
I would like to thank Richard Heiberger for his insightful comments and
 improvements to several points and displays in the manuscript.
 
\end_layout

\begin_layout Standard
Finally, and most importantly, I would like to thank my wife for her patience
 and understanding while I worked hours, days, months, and years on a 
\emph on
free book
\emph default
.
 In retrospect, I can't believe I ever got away with it.
\end_layout

\begin_layout Standard
\begin_inset VSpace vfill
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cleardoublepage
\end_layout

\begin_layout Plain Layout


\backslash
phantomsection
\end_layout

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{chapter}{List of Figures}
\end_layout

\begin_layout Plain Layout


\backslash
listoffigures
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace vfill
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cleardoublepage
\end_layout

\begin_layout Plain Layout


\backslash
phantomsection
\end_layout

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{chapter}{List of Tables}
\end_layout

\begin_layout Plain Layout


\backslash
listoftables
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
An Introduction to Probability and Statistics
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
pagenumbering{arabic} 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
This chapter has proved to be the hardest to write, by far.
 The trouble is that there is so much to say -- and so many people have
 already said it so much better than I could.
 When I get something I like I will release it here.
\end_layout

\begin_layout Standard
In the meantime, there is a lot of information already available to a person
 with an Internet connection.
 I recommend to start at Wikipedia, which is not a flawless resource but
 it has the main ideas with links to reputable sources.
\end_layout

\begin_layout Standard
In my lectures I usually tell stories about Fisher, Galton, Gauss, Laplace,
 Quetelet, and the Chevalier de Mere.
\end_layout

\begin_layout Section
Probability
\end_layout

\begin_layout Standard
The common folklore is that probability has been around for millennia but
 did not gain the attention of mathematicians until approximately 1654 when
 the Chevalier de Mere had a question regarding the fair division of a game's
 payoff to the two players, if the game had to end prematurely.
\end_layout

\begin_layout Section
Statistics
\end_layout

\begin_layout Standard
Statistics concerns data; their collection, analysis, and interpretation.
 In this book we distinguish between two types of statistics: descriptive
 and inferential.
 
\end_layout

\begin_layout Standard
Descriptive statistics concerns the summarization of data.
 We have a data set and we would like to describe the data set in multiple
 ways.
 Usually this entails calculating numbers from the data, called descriptive
 measures, such as percentages, sums, averages, and so forth.
\end_layout

\begin_layout Standard
Inferential statistics does more.
 There is an inference associated with the data set, a conclusion drawn
 about the population from which the data originated.
\end_layout

\begin_layout Standard
I would like to mention that there are two schools of thought of statistics:
 frequentist and bayesian.
 The difference between the schools is related to how the two groups interpret
 the underlying probability (see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Interpreting-Probabilities"

\end_inset

).
 The frequentist school gained a lot of ground among statisticians due in
 large part to the work of Fisher, Neyman, and Pearson in the early twentieth
 century.
 That dominance lasted until inexpensive computing power became widely available
; nowadays the bayesian school is garnering more attention and at an increasing
 rate.
\end_layout

\begin_layout Standard
This book is devoted mostly to the frequentist viewpoint because that is
 how I was trained, with the conspicuous exception of Sections 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Bayes'-Rule"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Conditional-Distributions"

\end_inset

.
 I plan to add more bayesian material in later editions of this book.
\end_layout

\begin_layout Section*
Chapter Exercises
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{section}{Chapter Exercises}
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{thm}{0}
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
An Introduction to 
\family sans
R
\begin_inset CommandInset label
LatexCommand label
name "cha:introduction-to-R"

\end_inset


\end_layout

\begin_layout Section
Downloading and Installing 
\family sans
R
\begin_inset CommandInset label
LatexCommand label
name "sec:download-install-R"

\end_inset


\end_layout

\begin_layout Standard
The instructions for obtaining 
\family sans
R
\family default
 largely depend on the user's hardware and operating system.
 The 
\family sans
R
\family default
 Project has written an 
\family sans
R
\family default
 Installation and Administration manual with complete, precise instructions
 about what to do, together with all sorts of additional information.
 The following is just a primer to get a person started.
\end_layout

\begin_layout Subsection
Installing 
\family sans
R
\end_layout

\begin_layout Standard
Visit one of the links below to download the latest version of 
\family sans
R
\family default
 for your operating system:
\end_layout

\begin_layout Description
Microsoft
\begin_inset space ~
\end_inset

Windows: 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://cran.r-project.org/bin/windows/base/
\end_layout

\end_inset

 
\end_layout

\begin_layout Description
MacOS: 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://cran.r-project.org/bin/macosx/
\end_layout

\end_inset


\end_layout

\begin_layout Description
Linux: 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://cran.r-project.org/bin/linux/
\end_layout

\end_inset


\end_layout

\begin_layout Standard
On Microsoft Windows, click the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

R-x.y.z.exe
\end_layout

\end_inset


\color inherit
 installer to start installation.
 When it asks for "Customized startup options", specify 
\family sans
Yes
\family default
.
 In the next window, be sure to select the SDI (single document interface)
 option; this is useful later when we discuss three dimensional plots with
 the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rgl
\end_layout

\end_inset


\color inherit
 package 
\begin_inset CommandInset citation
LatexCommand cite
key "rgl"

\end_inset

.
\end_layout

\begin_layout Paragraph*
Installing 
\family sans
R
\family default
 on a USB drive (Windows)
\end_layout

\begin_layout Standard
With this option you can use 
\family sans
R
\family default
 portably and without administrative privileges.
 There is an entry in the 
\family sans
R
\family default
 for Windows FAQ about this.
 Here is the procedure I use: 
\end_layout

\begin_layout Enumerate
Download the Windows installer above and start installation as usual.
 When it asks 
\emph on
where
\emph default
 to install, navigate to the top-level directory of the USB drive instead
 of the default 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

C
\end_layout

\end_inset


\color inherit
 drive.
\end_layout

\begin_layout Enumerate
When it asks whether to modify the Windows registry, uncheck the box; we
 do NOT want to tamper with the registry.
 
\end_layout

\begin_layout Enumerate
After installation, change the name of the folder from 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

R-x.y.z
\end_layout

\end_inset


\color inherit
 to just plain 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

R
\end_layout

\end_inset


\color inherit
.
 (Even quicker: do this in step 1.) 
\end_layout

\begin_layout Enumerate
Download the following shortcut to the top-level directory of the USB drive,
 right beside the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

R
\end_layout

\end_inset


\color inherit
 folder, not inside the folder.
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://ipsur.r-forge.r-project.org/book/download/R.exe
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Use the downloaded shortcut to run 
\family sans
R
\family default
.
\end_layout

\end_deeper
\begin_layout Standard
Steps 3 and 4 are not required but save you the trouble of navigating to
 the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

R-x.y.z/bin
\end_layout

\end_inset


\color inherit
 directory to double-click 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Rgui.exe
\end_layout

\end_inset


\color inherit
 every time you want to run the program.
 It is useless to create your own shortcut to 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Rgui.exe
\end_layout

\end_inset


\color inherit
.
 Windows does not allow shortcuts to have relative paths; they always have
 a drive letter associated with them.
 So if you make your own shortcut and plug your USB drive into some 
\emph on
other
\emph default
 machine that happens to assign your drive a different letter, then your
 shortcut will no longer be pointing to the right place.
 
\end_layout

\begin_layout Subsection
Installing and Loading Add-on Packages
\begin_inset CommandInset label
LatexCommand label
name "sub:installing-loading-packages"

\end_inset


\end_layout

\begin_layout Standard
There are 
\emph on
base
\emph default
 packages (which come with 
\family sans
R
\family default
 automatically), and 
\emph on
contributed
\emph default
 packages (which must be downloaded for installation).
 For example, on the version of 
\family sans
R
\family default
 being used for this document the default base packages loaded at startup
 are 
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

getOption("defaultPackages")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The base packages are maintained by a select group of volunteers, called
 
\begin_inset Quotes eld
\end_inset


\family sans
R
\family default
 Core
\begin_inset Quotes erd
\end_inset

.
 In addition to the base packages, there are literally thousands of additional
 contributed packages written by individuals all over the world.
 These are stored worldwide on mirrors of the Comprehensive 
\family sans
R
\family default
 Archive Network, or 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

CRAN
\end_layout

\end_inset

 for short.

\color inherit
 Given an active Internet connection, anybody is free to download and install
 these packages and even inspect the source code.
\end_layout

\begin_layout Standard
To install a package named 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

foo
\end_layout

\end_inset

, open up 
\family sans
\color inherit
R
\family default
\color none
 and type 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

install.packages("foo")
\end_layout

\end_inset


\color inherit

\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
install.packages
\end_layout

\end_inset

.
 To install 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

foo
\end_layout

\end_inset


\color inherit
 and additionally install all of the other packages on which 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

foo
\end_layout

\end_inset


\color inherit
 depends, instead type 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

install.packages("foo", depends = TRUE)
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
The general command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

install.packages()
\end_layout

\end_inset


\color inherit
 will (on most operating systems) open a window containing a huge list of
 available packages; simply choose one or more to install.
\end_layout

\begin_layout Standard
No matter how many packages are installed onto the system, each one must
 first be loaded for use with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

library
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
library
\end_layout

\end_inset

 function.
 For instance, the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

foreign
\end_layout

\end_inset

 package 
\begin_inset CommandInset citation
LatexCommand cite
key "foreign"

\end_inset

 contains all sorts of functions needed to import data sets into 
\family sans
\color inherit
R
\family default
\color none
 from other software such as SPSS, SAS, 
\emph on
\color inherit
etc
\emph default
\color none
..
 But none of those functions will be available until the 
\color inherit
command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

library(foreign)
\end_layout

\end_inset

 is issued.
 
\end_layout

\begin_layout Standard
Type 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

library()
\end_layout

\end_inset

 at the command prompt (described below) to see a list of all available
 packages in your library.
\end_layout

\begin_layout Standard
For complete, precise information regarding installation of 
\family sans
R
\family default
 and add-on packages, see the 
\family sans
R
\family default
 Installation and Administration manual, 
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://cran.r-project.org/manuals.html
\end_layout

\end_inset

.
\end_layout

\begin_layout Section
Communicating with 
\family sans
R
\begin_inset CommandInset label
LatexCommand label
name "sec:Communicating-with-R"

\end_inset


\end_layout

\begin_layout Paragraph*
One line at a time
\end_layout

\begin_layout Standard
This is the most basic method and is the first one that beginners will use.
\end_layout

\begin_layout Description

\family sans
RGui
\family default

\begin_inset space ~
\end_inset

(Microsoft
\begin_inset Formula $\circledR$
\end_inset


\begin_inset space ~
\end_inset

Windows)
\end_layout

\begin_layout Description
Terminal
\end_layout

\begin_layout Description
Emacs/ESS,
\begin_inset space ~
\end_inset

XEmacs
\end_layout

\begin_layout Description
JGR
\end_layout

\begin_layout Paragraph*
Multiple lines at a time
\end_layout

\begin_layout Standard
For longer programs (called 
\emph on
scripts
\emph default
) there is too much code to write all at once at the command prompt.
 Furthermore, for longer scripts it is convenient to be able to only modify
 a certain piece of the script and run it again in 
\family sans
R
\family default
.
 Programs called 
\emph on
script editors
\emph default
 are specially designed to aid the communication and code writing process.
 They have all sorts of helpful features including 
\family sans
R
\family default
 syntax highlighting, automatic code completion, delimiter matching, and
 dynamic help on the 
\family sans
R
\family default
 functions as they are being written.
 Even more, they often have all of the text editing features of programs
 like Microsoft
\begin_inset Formula $\circledR$
\end_inset

 Word.
 Lastly, most script editors are fully customizable in the sense that the
 user can customize the appearance of the interface to choose what colors
 to display, when to display them, and how to display them.
\end_layout

\begin_layout Description

\family sans
R
\begin_inset space ~
\end_inset


\family default
Editor
\begin_inset space ~
\end_inset

(Windows):
\begin_inset Index
status open

\begin_layout Plain Layout

\family sans
R
\family default
 Editor
\end_layout

\end_inset

 In Microsoft
\begin_inset Formula $\circledR$
\end_inset

 Windows, 
\family sans
R
\family default
Gui has its own built-in script editor, called 
\family sans
R
\family default
 Editor.
 From the console window, select 
\family sans
File
\family default
\emph on
 
\family sans
\emph default

\begin_inset Formula $\triangleright$
\end_inset


\family default
\emph on
 
\family sans
\emph default
New
\emph on
 
\emph default
Script
\family default
\emph on
.

\emph default
\color none
 A script window opens, and the lines of code can be written in the window.
 When satisfied with the code, the user highlights all of the commands and
 presses 
\family sans
\color inherit
Ctrl+R
\family default
\color none
.
 The commands are automatically run at once in 
\family sans
R
\family default
 and the output is shown.
 To save the script for later, click 
\family sans
\color inherit
File
\family default
\emph on
\color none
 
\family sans
\emph default
\color inherit

\begin_inset Formula $\triangleright$
\end_inset


\family default
\emph on
\color none
 
\family sans
\emph default
\color inherit
Save as...

\family default
\color none
 in 
\family sans
R
\family default
 Editor.
 The script can be reopened later with 
\family sans
\color inherit
File
\family default
\emph on
\color none
 
\family sans
\emph default
\color inherit

\begin_inset Formula $\triangleright$
\end_inset


\family default
\emph on
\color none
 
\family sans
\emph default
\color inherit
Open Script...

\family default
\color none
 in 
\family sans
\color inherit
RGui
\family default
\color none
.
 Note that 
\family sans
\color inherit
R
\family default
 Editor does not have the fancy syntax highlighting that the others do.
\end_layout

\begin_layout Description

\family sans
\series bold
R
\family default
WinEdt
\series default
:
\begin_inset Index
status open

\begin_layout Plain Layout

\family sans
R
\family default
WinEdt
\end_layout

\end_inset

 This option is coordinated with WinEdt for LaTeX and has additional features
 such as code highlighting, remote sourcing, and a ton of other things.
 However, one first needs to download and install a shareware version of
 another program, WinEdt, which is only free for a while -- pop-up windows
 will eventually appear that ask for a registration code.
 
\family sans
R
\family default
WinEdt is nevertheless a very fine choice if you already own WinEdt or are
 planning to purchase it in the near future.
\end_layout

\begin_layout Description
Tinn-
\family sans
R
\family default
/Sciviews-K:
\begin_inset Index
status open

\begin_layout Plain Layout
Tinn-
\family sans
R
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout
Sciviews-K
\end_layout

\end_inset

 This one is completely free and has all of the above mentioned options
 and more.
 It is simple enough to use that the user can virtually begin working with
 it immediately after installation.
 But Tinn-
\family sans
R
\family default
 proper is only available for Microsoft
\begin_inset Formula $\circledR$
\end_inset

 Windows operating systems.
 If you are on MacOS or Linux, a comparable alternative is Sci-Views - Komodo
 Edit.
\end_layout

\begin_layout Description
Emacs/ESS:
\begin_inset Index
status open

\begin_layout Plain Layout
Emacs
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout
ESS
\end_layout

\end_inset

 Emacs is an all purpose text editor.
 It can do absolutely anything with respect to modifying, searching, editing,
 and manipulating, text.
 And if Emacs can't do it, then you can write a program that extends Emacs
 to do it.
 Once such extension is called 
\emph on
ESS
\emph default
, which stands for 
\emph on
E
\emph default
macs 
\emph on
S
\emph default
peaks 
\emph on
S
\emph default
tatistics.
 With ESS a person can speak to 
\family sans
R,
\family default
 do all of the tricks that the other script editors offer, and much, much,
 more.
 Please see the following for installation details, documentation, reference
 cards, and a whole lot more:
\end_layout

\begin_layout Standard
\align center
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://ess.r-project.org
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\emph on
Fair warning
\emph default
: if you want to try Emacs and if you grew up with Microsoft
\begin_inset Formula $\circledR$
\end_inset

 Windows or Macintosh, then you are going to need to relearn everything
 you thought you knew about computers your whole life.
 (Or, since Emacs is completely customizable, you can reconfigure Emacs
 to behave the way you want.) I have personally experienced this transformation
 and I will never go back.
\end_layout

\begin_layout Description
JGR
\begin_inset space ~
\end_inset

(read
\begin_inset space ~
\end_inset


\begin_inset Quotes eld
\end_inset

Jaguar
\begin_inset Quotes erd
\end_inset

):
\begin_inset Index
status open

\begin_layout Plain Layout
JGR
\end_layout

\end_inset

 This one has the bells and whistles of 
\family sans
RGui
\family default
 plus it is based on Java, so it works on multiple operating systems.
 It has its own script editor like 
\family sans
R
\family default
 Editor but with additional features such as syntax highlighting and code-comple
tion.
 If you do not use Microsoft
\begin_inset Formula $\circledR$
\end_inset

 Windows (or even if you do) you definitely want to check out this one.
\end_layout

\begin_layout Description
Kate,
\begin_inset space ~
\end_inset

Bluefish,
\begin_inset space ~
\end_inset


\emph on
etc
\emph default
.
 There are literally dozens of other text editors available, many of them
 free, and each has its own (dis)advantages.
 I only have mentioned the ones with which I have had substantial personal
 experience and have enjoyed at some point.
 Play around, and let me know what you find.
\end_layout

\begin_layout Paragraph*
Graphical User Interfaces (GUIs)
\end_layout

\begin_layout Standard
By the word 
\begin_inset Quotes eld
\end_inset

GUI
\begin_inset Quotes erd
\end_inset

 I mean an interface in which the user communicates with 
\family sans
R
\family default
 by way of points-and-clicks in a menu of some sort.
 Again, there are many, many options and I only mention ones that I have
 used and enjoyed.
 Some of the other more popular script editors can be downloaded from the
\family sans
 R
\family default
-Project website at 
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://www.sciviews.org/_rgui/
\end_layout

\end_inset

.

\color none
 On the left side of the screen (under 
\series bold
Projects
\series default
) there are several choices available.
\end_layout

\begin_layout Description

\family sans
R
\begin_inset space ~
\end_inset


\family default
Commander provides
\begin_inset Index
status open

\begin_layout Plain Layout

\family sans
R
\family default
 Commander
\end_layout

\end_inset

 a point-and-click interface to many basic statistical tasks.
 It is called the 
\begin_inset Quotes eld
\end_inset

Commander
\begin_inset Quotes erd
\end_inset

 because every time one makes a selection from the menus, the code corresponding
 to the task is listed in the output window.
 One can take this code, copy-and-paste it to a text file, then re-run it
 again at a later time without the 
\family sans
R
\family default
 Commander's assistance.
 It is well suited for the introductory level.
 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

Rcmdr
\end_layout

\end_inset


\color inherit
 also allows for user-contributed 
\begin_inset Quotes eld
\end_inset

Plugins
\begin_inset Quotes erd
\end_inset

 which are separate packages on 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

CRAN
\end_layout

\end_inset


\color inherit
 that add extra functionality to the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

Rcmdr
\end_layout

\end_inset


\color inherit
 package.
 The plugins are typically named with the prefix 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

RcmdrPlugin
\end_layout

\end_inset


\color inherit
 to make them easy to identify in the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

CRAN
\end_layout

\end_inset


\color inherit
 package list.
 One such plugin is the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash

\backslash
 
\end_layout

\end_inset

 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

RcmdrPlugin.IPSUR
\end_layout

\end_inset

 package which accompanies this text.
\end_layout

\begin_layout Description
Poor
\begin_inset space ~
\end_inset

Man's
\begin_inset space ~
\end_inset

GUI 
\begin_inset Index
status open

\begin_layout Plain Layout
Poor Man's GUI
\end_layout

\end_inset

 is an alternative to the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

Rcmdr
\end_layout

\end_inset


\color inherit
 which is based on GTk instead of Tcl/Tk.
 It has been a while since I used it but I remember liking it very much
 when I did.
 One thing that stood out was that the user could drag-and-drop data sets
 for plots.
 See here for more information: 
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://wiener.math.csi.cuny.edu/pmg/
\end_layout

\end_inset

.
\end_layout

\begin_layout Description
Rattle
\begin_inset Index
status open

\begin_layout Plain Layout
Rattle
\end_layout

\end_inset

 is a data mining toolkit which was designed to manage/analyze very large
 data sets, but it provides enough other general functionality to merit
 mention here.
 See 
\begin_inset CommandInset citation
LatexCommand cite
key "rattle"

\end_inset

 for more information.
\end_layout

\begin_layout Description
Deducer
\begin_inset Index
status open

\begin_layout Plain Layout
Deducer
\end_layout

\end_inset

 is relatively new and shows promise from what I have seen, but I have not
 actually used it in the classroom yet.
\end_layout

\begin_layout Section
Basic 
\family sans
R
\family default
 Operations and Concepts
\begin_inset CommandInset label
LatexCommand label
name "sec:Basic-R-Operations"

\end_inset


\end_layout

\begin_layout Standard
The 
\family sans
R
\family default
 developers have written an introductory document entitled 
\begin_inset Quotes eld
\end_inset

An Introduction to 
\family sans
R
\family default

\begin_inset Quotes erd
\end_inset

.
 There is a sample session included which shows what basic interaction with
 
\family sans
R
\family default
 looks like.
 I recommend that all new users of 
\family sans
R
\family default
 read that document, but bear in mind that there are concepts mentioned
 which will be unfamiliar to the beginner.
\end_layout

\begin_layout Standard
Below are some of the most basic operations that can be done with 
\family sans
R
\family default
.
 Almost every book about 
\family sans
R
\family default
 begins with a section like the one below; look around to see all sorts
 of things that can be done at this most basic level.
\end_layout

\begin_layout Subsection
Arithmetic
\begin_inset CommandInset label
LatexCommand label
name "sub:Arithmetic"

\end_inset


\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

2 + 3       # add
\begin_inset Newline newline
\end_inset

4 * 5 / 6   # multiply and divide
\begin_inset Newline newline
\end_inset

7^8         # 7 to the 8th power
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Notice the comment character 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

#
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
#
\end_layout

\end_inset

.
 Anything typed after a 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

#
\end_layout

\end_inset

 symbol is ignored by 
\family sans
\color inherit
R
\family default
\color none
.
 We know that 
\begin_inset Formula $20/6$
\end_inset

 is a repeating decimal, but the above example shows only 7 digits.
 We can change the number of digits displayed with 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

options
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
options
\end_layout

\end_inset

:
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

options(digits = 16)
\begin_inset Newline newline
\end_inset

10/3                 # see more digits
\begin_inset Newline newline
\end_inset

sqrt(2)              # square root
\begin_inset Newline newline
\end_inset

exp(1)               # Euler's constant, e
\begin_inset Newline newline
\end_inset

pi       
\begin_inset Newline newline
\end_inset

options(digits = 7)  # back to default
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Note that it is possible to set 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

digits
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
digits
\end_layout

\end_inset

 up to 22, but setting them over 16 is not recommended (the extra significant
 digits are not necessarily reliable).
 Above notice the 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

sqrt
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
sqrt
\end_layout

\end_inset

 function for square roots and the 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

exp
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
exp
\end_layout

\end_inset

 function for powers of 
\begin_inset Formula $\me$
\end_inset

, Euler's number.
\end_layout

\begin_layout Subsection
Assignment, Object names, and Data types
\begin_inset CommandInset label
LatexCommand label
name "sub:Assignment-Object-names"

\end_inset


\end_layout

\begin_layout Standard
It is often convenient to assign numbers and values to variables (objects)
 to be used later.
 The proper way to assign values to a variable is with the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

<-
\end_layout

\end_inset

 operator (with a space on either side).
 The 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

=
\end_layout

\end_inset

 symbol works too, but it is recommended by the 
\family sans
\color inherit
R
\family default
\color none
 masters to reserve 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

=
\end_layout

\end_inset

 for specifying arguments to functions (discussed later).
 In this book we will follow their advice and use 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

<-
\end_layout

\end_inset

 for assignment.
 Once a variable is assigned, its value can be printed by simply entering
 the variable name by itself.
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

x <- 7*41/pi   # don't see the calculated value
\begin_inset Newline newline
\end_inset

x              # take a look
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
When choosing a variable name you can use letters, numbers, dots 
\begin_inset Quotes eld
\end_inset


\family typewriter
.
\family default

\begin_inset Quotes erd
\end_inset

, or underscore 
\begin_inset Quotes eld
\end_inset


\family typewriter
_
\family default

\begin_inset Quotes erd
\end_inset

 characters.
 You cannot use mathematical operators, and a leading dot may not be followed
 by a number.
 Examples of valid names are: 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

x1
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

y.value
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "basicstyle={\ttfamily},language=Caml"
inline true
status open

\begin_layout Plain Layout

y_hat
\end_layout

\end_inset


\color inherit
.
 (More precisely, the set of allowable characters in object names depends
 on one's particular system and locale; see An Introduction to 
\family sans
R
\family default
 for more discussion on this.)
\end_layout

\begin_layout Standard
Objects can be of many 
\emph on
types
\emph default
, 
\emph on
modes
\emph default
, and 
\emph on
classes
\emph default
.
 At this level, it is not necessary to investigate all of the intricacies
 of the respective types, but there are some with which you need to become
 familiar:
\end_layout

\begin_layout Description
integer: the values 
\begin_inset Formula $0$
\end_inset

, 
\begin_inset Formula $\pm1$
\end_inset

, 
\begin_inset Formula $\pm2$
\end_inset

, \SpecialChar \ldots{}
; these are represented exactly by 
\family sans
R
\family default
.
\end_layout

\begin_layout Description
double: real numbers (rational and irrational); these numbers are not represente
d exactly (save integers or fractions with a denominator that is a multiple
 of 2, see 
\begin_inset CommandInset citation
LatexCommand cite
key "Venables2010"

\end_inset

).
\end_layout

\begin_layout Description
character: elements that are wrapped with pairs of 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

"
\end_layout

\end_inset


\color inherit
 or 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

'
\end_layout

\end_inset


\color inherit
;
\end_layout

\begin_layout Description
logical: includes 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

TRUE
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

FALSE
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

NA
\end_layout

\end_inset

 (which are reserved words); the 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

NA
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
NA
\end_layout

\end_inset

 stands for 
\color inherit

\begin_inset Quotes eld
\end_inset

not available
\color none

\begin_inset Quotes erd
\end_inset

, 
\emph on
\color inherit
i.e.
\emph default
\color none
, a missing value.
\end_layout

\begin_layout Standard
You can determine an object's type with the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

typeof
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
typeof
\end_layout

\end_inset


\color inherit
 function.
 In addition to the above, there is the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

complex
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
complex
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
as.complex
\end_layout

\end_inset


\color inherit
 data type:
\end_layout

\begin_layout Scrap
<<five, keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

sqrt(-1)              # isn't defined
\begin_inset Newline newline
\end_inset

sqrt(-1+0i)           # is defined
\begin_inset Newline newline
\end_inset

sqrt(as.complex(-1))  # same thing
\begin_inset Newline newline
\end_inset

(0 + 1i)^2            # should be -1
\begin_inset Newline newline
\end_inset

typeof((0 + 1i)^2)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Note that you can just type 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

(1i)^2
\end_layout

\end_inset

 to get the same answer.

\color inherit
 The 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

NaN
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
NaN
\end_layout

\end_inset


\color inherit
 stands for 
\begin_inset Quotes eld
\end_inset

not a number
\begin_inset Quotes erd
\end_inset

; it is represented internally as 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

double
\end_layout

\end_inset


\color inherit

\begin_inset Index
status open

\begin_layout Plain Layout
double
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Subsection
Vectors
\begin_inset CommandInset label
LatexCommand label
name "sub:Vectors"

\end_inset


\end_layout

\begin_layout Standard
All of this time we have been manipulating vectors of length 1.
 Now let us move to vectors with multiple entries.
\end_layout

\begin_layout Paragraph*
Entering data vectors
\end_layout

\begin_layout Enumerate

\color none
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

c
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
c
\end_layout

\end_inset

:
\color inherit
 If you would like to enter the data 
\family typewriter
74,31,95,61,76,34,23,54,96
\family default
 into 
\family sans
R
\family default
, you may create a data vector with the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

c
\end_layout

\end_inset


\color inherit
 function (which is short for 
\emph on
concatenate
\emph default
).
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x <- c(74, 31, 95, 61, 76, 34, 23, 54, 96)
\begin_inset Newline newline
\end_inset

x
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The elements of a vector are usually coerced by 
\family sans
R
\family default
 to the the most general type of any of the elements, so if you do 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

c(1, "2")
\end_layout

\end_inset


\color inherit
 then the result will be 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

c("1", "2")
\end_layout

\end_inset


\color inherit
.
\end_layout

\end_deeper
\begin_layout Enumerate

\color none
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

scan
\end_layout

\end_inset


\color inherit

\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
scan
\end_layout

\end_inset

: This method is useful when the data are stored somewhere else.
 For instance, you may type 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

x <- scan()
\end_layout

\end_inset


\color inherit
 at the command prompt and 
\family sans
R
\family default
 will display 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

1:
\end_layout

\end_inset


\color inherit
 to indicate that it is waiting for the first data value.
 Type a value and press 
\family sans
Enter
\family default
, at which point 
\family sans
R
\family default
 will display 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

2:
\end_layout

\end_inset


\color inherit
, and so forth.
 Note that entering an empty line stops the scan.
 This method is especially handy when you have a column of values, say,
 stored in a text file or spreadsheet.
 You may copy and paste them all at the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

1:
\end_layout

\end_inset

 prompt, and 
\family sans
\color inherit
R
\family default
\color none
 will store all of the values instantly in the vector 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset

.
\end_layout

\begin_layout Enumerate
repeated data; regular patterns: 
\color none
the 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

seq
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
seq
\end_layout

\end_inset

 function will generate all sorts of sequences of numbers.
 It has the arguments 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

from
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

to
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

by
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

length.out
\end_layout

\end_inset

 which can be set in concert with one another.
 We will do a couple of examples to show you how it works.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

seq(from = 1, to = 5)
\begin_inset Newline newline
\end_inset

seq(from = 2, by = -0.1, length.out = 4)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard

\color none
Note that we can get the first line much quicker with the colon operator
 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

:
\end_layout

\end_inset


\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

1:5
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard

\color none
The vector 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

LETTERS
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
LETTERS
\end_layout

\end_inset


\color inherit
 has the 26 letters of the English alphabet in uppercase and 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

letters
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
letters
\end_layout

\end_inset

 has all of them in lowercase.
\end_layout

\end_deeper
\begin_layout Paragraph*
Indexing data vectors
\end_layout

\begin_layout Standard
Sometimes we do not want the whole vector, but just a piece of it.
 We can access the intermediate parts with the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

[]
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
[]
\end_layout

\end_inset

 operator.
 Observe (with 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset

 defined above)
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x[1]
\begin_inset Newline newline
\end_inset

x[2:4]
\begin_inset Newline newline
\end_inset

x[c(1,3,4,8)]
\begin_inset Newline newline
\end_inset

x[-c(1,3,4,8)]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Notice that we used the minus sign to specify those elements that we do
 
\emph on
not
\emph default
 want.
 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

LETTERS[1:5]
\begin_inset Newline newline
\end_inset

letters[-(6:24)]
\end_layout

\begin_layout Scrap
@
\end_layout

\begin_layout Subsection
Functions and Expressions
\begin_inset CommandInset label
LatexCommand label
name "sub:Functions-and-Expressions"

\end_inset


\end_layout

\begin_layout Standard
A function takes arguments as input and returns an object as output.
 There are functions to do all sorts of things.
 We show some examples below.
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

x <- 1:5
\begin_inset Newline newline
\end_inset

sum(x)
\begin_inset Newline newline
\end_inset

length(x)
\begin_inset Newline newline
\end_inset

min(x)
\begin_inset Newline newline
\end_inset

mean(x)      # sample mean
\begin_inset Newline newline
\end_inset

sd(x)        # sample standard deviation
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
It will not be long before the user starts to wonder how a particular function
 is doing its job, and since 
\family sans
R
\family default
 is open-source, anybody is free to look under the hood of a function to
 see how things are calculated.
 For detailed instructions see the article 
\begin_inset Quotes eld
\end_inset

Accessing the Sources
\begin_inset Quotes erd
\end_inset

 by Uwe Ligges 
\begin_inset CommandInset citation
LatexCommand citet
key "Ligges2006"

\end_inset

.
 In short:
\end_layout

\begin_layout Enumerate
Type the name of the function without any parentheses or arguments.
 If you are lucky then the code for the entire function will be printed,
 right there looking at you.
 For instance, suppose that we would like to see how the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

intersect
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
intersect
\end_layout

\end_inset


\color inherit
 function works:
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

intersect
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
If instead it shows 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

UseMethod("
\end_layout

\end_inset


\emph on
\color inherit
something
\emph default
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

")
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
UseMethod
\end_layout

\end_inset


\color inherit
 then you will need to choose the 
\emph on
class
\emph default
 of the object to be inputted and next look at the 
\emph on
method
\emph default
 that will be 
\emph on
dispatched
\emph default
 to the object.
 For instance, typing 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rev
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
rev
\end_layout

\end_inset


\color inherit
 says 
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

rev
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The output is telling us that there are multiple methods associated with
 the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rev
\end_layout

\end_inset


\color inherit
 function.
 To see what these are, type
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

methods(rev)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Now we learn that there are two different 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rev(x)
\end_layout

\end_inset


\color inherit
 functions, only one of which being chosen at each call depending on what
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 is.
 There is one for 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dendrogram
\end_layout

\end_inset


\color inherit
 objects and a 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

default
\end_layout

\end_inset


\color inherit
 method for everything else.
 Simply type the name to see what each method does.
 For example, the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

default
\end_layout

\end_inset


\color inherit
 method can be viewed with
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

rev.default
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
Some functions are hidden by a 
\emph on
namespace
\emph default
 (see An Introduction to 
\family sans
R
\family default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Venables2010"

\end_inset

), and are not visible on the first try.
 For example, if we try to look at the code for 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

wilcox.test
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
wilcox.test
\end_layout

\end_inset

 (see Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Nonparametric-Statistics"

\end_inset

) we get the following:
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

wilcox.test
\begin_inset Newline newline
\end_inset

methods(wilcox.test)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
If we were to try 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

wilcox.test.default
\end_layout

\end_inset


\color inherit
 we would get a 
\begin_inset Quotes eld
\end_inset

not found
\begin_inset Quotes erd
\end_inset

 error, because it is hidden behind the namespace for the package 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stats
\end_layout

\end_inset

 (shown in the last line when we tried 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

wilcox.test
\end_layout

\end_inset

).
 
\color inherit
In cases like these we prefix the package name to the front of the function
 name with three colons; the command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stats:::wilcox.test.default
\end_layout

\end_inset

 will show the source code, omitted here for brevity.
\end_layout

\end_deeper
\begin_layout Enumerate
If it shows 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.Internal(
\end_layout

\end_inset


\emph on
\color inherit
something
\emph default
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

)
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
.Internal
\end_layout

\end_inset


\color inherit
 or 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.Primitive("
\end_layout

\end_inset


\emph on
\color inherit
something
\emph default
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

")
\end_layout

\end_inset


\color inherit

\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
.Primitive
\end_layout

\end_inset

, then it will be necessary to download the source code of 
\family sans
R
\family default
 (which is 
\emph on
not
\emph default
 a binary version with an 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.exe
\end_layout

\end_inset


\color inherit
 extension) and search inside the code there.
 See Ligges 
\begin_inset CommandInset citation
LatexCommand cite
key "Ligges2006"

\end_inset

 for more discussion on this.
 
\color none
An example is 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

exp
\end_layout

\end_inset

:
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

exp
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Be warned that most of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.Internal
\end_layout

\end_inset


\color inherit
 functions are written in other computer languages which the beginner may
 not understand, at least initially.
\end_layout

\end_deeper
\begin_layout Section
Getting Help
\begin_inset CommandInset label
LatexCommand label
name "sec:Getting-Help"

\end_inset


\end_layout

\begin_layout Standard
When you are using 
\family sans
R
\family default
, it will not take long before you find yourself needing help.
 Fortunately, 
\family sans
R
\family default
 has extensive help resources and you should immediately become familiar
 with them.
 Begin by clicking 
\family sans
Help
\family default
 on 
\family sans
Rgui
\family default
.
 The following options are available.
\end_layout

\begin_layout Itemize

\series bold
Console
\series default
: gives useful shortcuts, for instance, 
\family sans
Ctrl+L
\family default
, to clear the 
\family sans
R
\family default
 console screen.
\end_layout

\begin_layout Itemize

\series bold
FAQ on 
\family sans
R
\family default
\series default
: frequently asked questions concerning general 
\family sans
R
\family default
 operation.
\end_layout

\begin_layout Itemize

\series bold
FAQ on 
\family sans
R
\family default
 for Windows
\series default
: frequently asked questions about 
\family sans
R
\family default
, tailored to the Microsoft Windows operating system.
\end_layout

\begin_layout Itemize

\series bold
Manuals
\series default
: technical manuals about all features of the 
\family sans
R
\family default
 system including installation, the complete language definition, and add-on
 packages.
\end_layout

\begin_layout Itemize

\family sans
\series bold
R
\family default
 functions (text)\SpecialChar \ldots{}

\series default
: use this if you know the 
\emph on
exact
\emph default
 name of the function you want to know more about, for example, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mean
\end_layout

\end_inset


\color inherit
 or 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

plot
\end_layout

\end_inset


\color inherit
.
 Typing 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mean
\end_layout

\end_inset


\color inherit
 in the window is equivalent to typing 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

help("mean")
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
help
\end_layout

\end_inset


\color inherit
 at the command line, or more simply, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?mean
\end_layout

\end_inset


\color inherit

\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
?
\end_layout

\end_inset

.
 Note that this method only works if the function of interest is contained
 in a package that is already loaded into the search path with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

library
\end_layout

\end_inset

.
\end_layout

\begin_layout Itemize

\series bold
HTML Help
\series default
: use this to browse the manuals with point-and-click links.
 It also has a Search Engine & Keywords for searching the help page titles,
 with point-and-click links for the search results.
 This is possibly the best help method for beginners.
 It can be started from the command line with the command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

help.start()
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
help.start
\end_layout

\end_inset

.
\end_layout

\begin_layout Itemize

\series bold
Search help\SpecialChar \ldots{}

\series default
: use this if you do not know the exact name of the function of interest,
 or if the function is in a package that has not been loaded yet.
 For example, you may enter 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

plo
\end_layout

\end_inset


\color inherit
 and a text window will return listing all the help files with an alias,
 concept, or title matching `
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

plo
\end_layout

\end_inset


\color inherit
' using regular expression matching; it is equivalent to typing 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

help.search("plo")
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
help.search
\end_layout

\end_inset


\color inherit
 at the command line.
 The advantage is that you do not need to know the exact name of the function;
 the disadvantage is that you cannot point-and-click the results.
 Therefore, one may wish to use the HTML Help search engine instead.
 An equivalent way is 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

??plo
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
??
\end_layout

\end_inset

 at the command line.
\end_layout

\begin_layout Itemize

\series bold
search.r-project.org\SpecialChar \ldots{}

\series default
: this will search for words in help lists and email archives of the 
\family sans
R
\family default
 Project.
 It can be very useful for finding other questions that other users have
 asked.
\end_layout

\begin_layout Itemize

\series bold
Apropos\SpecialChar \ldots{}

\series default
: use this for more sophisticated partial name matching of functions.
 See 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?apropos
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
apropos
\end_layout

\end_inset


\color inherit
 for details.
\end_layout

\begin_layout Standard
On the help pages for a function there are sometimes 
\begin_inset Quotes eld
\end_inset

Examples
\begin_inset Quotes erd
\end_inset

 listed at the bottom of the page, which will work if copy-pasted at the
 command line (unless marked otherwise).
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

example
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
example
\end_layout

\end_inset


\color inherit
 function will run the code automatically, skipping the intermediate step.
 For instance, we may try 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

example(mean)
\end_layout

\end_inset

 to see a few examples of how the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mean
\end_layout

\end_inset

 function works.
\end_layout

\begin_layout Subsection

\family sans
R
\family default
 Help Mailing Lists
\end_layout

\begin_layout Standard
There are several mailing lists associated with 
\family sans
R
\family default
, and there is a huge community of people that read and answer questions
 related to 
\family sans
R
\family default
.
 See here 
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://www.r-project.org/mail.html
\end_layout

\end_inset

 for an idea of what is available.
 Particularly pay attention to the bottom of the page which lists several
 special interest groups (SIGs) related to 
\family sans
R
\family default
.
\end_layout

\begin_layout Standard
Bear in mind that 
\family sans
R
\family default
 is free software, which means that it was written by volunteers, and the
 people that frequent the mailing lists are also volunteers who are not
 paid by customer support fees.
 Consequently, if you want to use the mailing lists for free advice then
 you must adhere to some basic etiquette, or else you may not get a reply,
 or even worse, you may receive a reply which is a bit less cordial than
 you are used to.
 Below are a few considerations:
\end_layout

\begin_layout Enumerate
Read the FAQ (
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://cran.r-project.org/faqs.html
\end_layout

\end_inset

).
 Note that there are different FAQs for different operating systems.
 You should read these now, even without a question at the moment, to learn
 a lot about the idiosyncrasies of 
\family sans
R
\family default
.
\end_layout

\begin_layout Enumerate
Search the archives.
 Even if your question is not a FAQ, there is a very high likelihood that
 your question has been asked before on the mailing list.
 If you want to know about topic 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

foo
\end_layout

\end_inset

, then you can do 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

RSiteSearch("foo")
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
RSiteSearch
\end_layout

\end_inset

 to search the mailing list archives (and the online help) for it.
 
\end_layout

\begin_layout Enumerate
Do a Google search and an 
\family typewriter
RSeek.org
\family default
 search.
\end_layout

\begin_layout Standard
If your question is not a FAQ, has not been asked on 
\family sans
R
\family default
-help before, and does not yield to a Google (or alternative) search, then,
 and only then, should you even consider writing to 
\family sans
R
\family default
-help.
 Below are a few additional considerations.
 
\end_layout

\begin_layout Enumerate

\series bold
Read the posting guide (
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://www.r-project.org/posting-guide.html
\end_layout

\end_inset

) before posting.

\series default
 This will save you a lot of trouble and pain.
\end_layout

\begin_layout Enumerate
Get rid of the command prompts (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

>
\end_layout

\end_inset


\color inherit
) from output.
 Readers of your message will take the text from your mail and copy-paste
 into an 
\family sans
R
\family default
 session.
 If you make the readers' job easier then it will increase the likelihood
 of a response.
\end_layout

\begin_layout Enumerate
Questions are often related to a specific data set, and the best way to
 communicate the data is with a 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dump
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
dump
\end_layout

\end_inset

 command.
 For instance, if your question involves data stored in a vector 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset

, you can type 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dump("x","")
\end_layout

\end_inset

 at the command prompt and copy-paste the output into the body of your email
 message.
 Then the reader may easily copy-paste the message from your email into
 
\family sans
\color inherit
R
\family default
\color none
 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset

 will be available to him/her.
\end_layout

\begin_layout Enumerate
Sometimes the answer the question is related to the operating system used,
 the attached packages, or the exact version of 
\family sans
R
\family default
 being used.
 
\color none
The 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

sessionInfo()
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
sessionInfo
\end_layout

\end_inset

 command collects all of this information to be copy-pasted into an email
 (and the Posting Guide requests this information).
 See Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:R-Session-Information"

\end_inset

 for an example.
\end_layout

\begin_layout Section
External Resources
\end_layout

\begin_layout Standard
There is a mountain of information on the Internet about 
\family sans
R
\family default
.
 Below are a few of the important ones.
\end_layout

\begin_layout Description
The
\begin_inset space ~
\end_inset


\family sans
R
\begin_inset space ~
\end_inset


\family default
Project
\begin_inset space ~
\end_inset

for
\begin_inset space ~
\end_inset

Statistical
\begin_inset space ~
\end_inset

Computing:
\begin_inset Index
status open

\begin_layout Plain Layout
The 
\family sans
R
\family default
-Project
\end_layout

\end_inset

 (
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://www.r-project.org/
\end_layout

\end_inset

) Go here first.
\end_layout

\begin_layout Description
The
\begin_inset space ~
\end_inset

Comprehensive
\begin_inset space ~
\end_inset


\family sans
R
\begin_inset space ~
\end_inset


\family default
Archive
\begin_inset space ~
\end_inset

Network:
\begin_inset Index
status open

\begin_layout Plain Layout
CRAN
\end_layout

\end_inset

 (
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://cran.r-project.org/
\end_layout

\end_inset

) This is where 
\family sans
R
\family default
 is stored along with thousands of contributed packages.
 There are also loads of contributed information (books, tutorials, 
\emph on
etc
\emph default
.).
 There are mirrors all over the world with duplicate information.
\end_layout

\begin_layout Description

\family sans
R
\family default
-Forge:
\begin_inset Index
status open

\begin_layout Plain Layout

\family sans
R
\family default
-Forge
\end_layout

\end_inset

 (
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://r-forge.r-project.org/
\end_layout

\end_inset

) This is another location where 
\family sans
R
\family default
 packages are stored.
 Here you can find development code which has not yet been released to 
\family sans
CRAN
\family default
.
\end_layout

\begin_layout Description

\family sans
R
\begin_inset space ~
\end_inset


\family default
Wiki:
\begin_inset Index
status open

\begin_layout Plain Layout

\family sans
R
\family default
-Wiki
\end_layout

\end_inset

 (
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://wiki.r-project.org/rwiki/doku.php
\end_layout

\end_inset

) There are many tips and tricks listed here.
 If you find a trick of your own, login and share it with the world.
\end_layout

\begin_layout Description
Other: the 
\family sans
R
\family default
 Graph Gallery
\begin_inset Index
status open

\begin_layout Plain Layout

\family sans
R
\family default
 Graph Gallery
\end_layout

\end_inset

 (
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://addictedtor.free.fr/graphiques/
\end_layout

\end_inset

) and 
\family sans
R
\family default
 Graphical Manual
\begin_inset Index
status open

\begin_layout Plain Layout

\family sans
R
\family default
 Graphical Manual
\end_layout

\end_inset

 (
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://bm2.genes.nig.ac.jp/RGM2/index.php
\end_layout

\end_inset

) have literally thousands of graphs to peruse.
 
\family sans
R
\family default
Seek (
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://www.rseek.org
\end_layout

\end_inset

) is a search engine based on Google specifically tailored for 
\family sans
R
\family default
 queries.
 
\end_layout

\begin_layout Section
Other Tips
\end_layout

\begin_layout Standard
It is unnecessary to retype commands repeatedly, since 
\family sans
R
\family default
 remembers what you have recently entered on the command line.
 
\color none
On the Microsoft
\begin_inset Formula $\circledR$
\end_inset

 Windows 
\family sans
\color inherit
R
\family default
\color none
Gui,
\color inherit
 to cycle through the previous commands just push the 
\begin_inset Formula $\uparrow$
\end_inset

 (up arrow) key.
 
\color none
On Emacs/ESS the command is 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

M-p
\end_layout

\end_inset

 (which means hold down the 
\family sans
\color inherit
Alt
\family default
\color none
 button and press 
\begin_inset Quotes eld
\end_inset


\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

p
\end_layout

\end_inset


\begin_inset Quotes erd
\end_inset

)
\color inherit
.
 More generally, 
\color none
the command 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

history()
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
history
\end_layout

\end_inset

 will show a whole list of recently entered commands.
\end_layout

\begin_layout Itemize
To find out what all variables are in the current work environment, use
 the commands 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

objects()
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
objects
\end_layout

\end_inset


\color inherit
 or 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ls()
\end_layout

\end_inset


\color inherit

\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
ls
\end_layout

\end_inset

.
 These list all available objects in the workspace.
 If you wish to remove one or more variables, use 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

remove(var1, var2, var3)
\end_layout

\end_inset


\color inherit

\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
remove
\end_layout

\end_inset

, or more simply 
\color none
use 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rm(var1, var2, var3)
\end_layout

\end_inset


\color inherit
, and to remove all objects use 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rm(list = ls())
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Itemize
Another use of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

scan
\end_layout

\end_inset


\color inherit
 is when you have a long list of numbers (separated by spaces or on different
 lines) already typed somewhere else, say in a text file.
 To enter all the data in one fell swoop, first highlight and copy the list
 of numbers to the Clipboard with 
\family sans
Edit
\family default
\emph on
\color none
 
\family sans
\emph default
\color inherit

\begin_inset Formula $\triangleright$
\end_inset


\family default
\emph on
\color none
 
\family sans
\emph default
\color inherit
Copy
\family default
 (or by right-clicking and selecting 
\family sans
Copy
\family default
).
 Next type the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x <- scan()
\end_layout

\end_inset

 command in the 
\family sans
R
\family default
 console, and paste the numbers at the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

1:
\end_layout

\end_inset

 prompt with 
\family sans
\color inherit
Edit
\family default
\emph on
\color none
 
\family sans
\emph default
\color inherit

\begin_inset Formula $\triangleright$
\end_inset


\family default
\emph on
\color none
 
\family sans
\emph default
\color inherit
Paste
\family default
\color none
.
 All of the numbers will automatically be entered into the vector 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset

.
\end_layout

\begin_layout Itemize
The command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Ctrl+l
\end_layout

\end_inset

 clears the screen in the Microsoft
\begin_inset Formula $\circledR$
\end_inset

 Windows 
\family sans
\color inherit
R
\family default
\color none
Gui.
 The comparable command for Emacs/ESS is 
\end_layout

\begin_layout Itemize
Once you use 
\family sans
R
\family default
 for awhile there may be some commands that you wish to run automatically
 whenever 
\family sans
R
\family default
 starts.
 These commands may be saved in a file called 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Rprofile.site
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
Rprofile.site
\end_layout

\end_inset

 which is usually in the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

etc
\end_layout

\end_inset

 folder, which lives in the 
\family sans
\color inherit
R
\family default
\color none
 home directory (which on Microsoft
\begin_inset Formula $\circledR$
\end_inset

 Windows usually is 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

C:
\backslash
Program Files
\backslash
R
\end_layout

\end_inset

).
 Alternatively, you can make a file 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.Rprofile
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
.Rprofile
\end_layout

\end_inset

 to be stored in the user's home directory, or anywhere 
\family sans
\color inherit
R
\family default
\color none
 is invoked.
 This allows for multiple configurations for different projects or users.
 See 
\begin_inset Quotes eld
\end_inset

Customizing the Environment
\begin_inset Quotes erd
\end_inset

 of 
\emph on
\color inherit
An Introduction to 
\family sans
R
\family default
\emph default
\color none
 for more details.
\end_layout

\begin_layout Itemize
When exiting 
\family sans
R
\family default
 the user is given the option to 
\begin_inset Quotes eld
\end_inset

save the workspace
\begin_inset Quotes erd
\end_inset

.
 I recommend that beginners DO NOT save the workspace when quitting.
 If 
\family sans
Yes
\family default
 is selected, then all of the objects and data currently in 
\family sans
R
\family default
's memory is saved in a file located in the working directory called 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.RData
\end_layout

\end_inset


\color inherit

\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
.RData
\end_layout

\end_inset

.
 This file is then automatically loaded the next time 
\family sans
R
\family default
 starts (in which case 
\family sans
R
\family default
 will say 
\color none

\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

[previously saved workspace restored]
\end_layout

\end_inset


\color inherit
).
 This is a valuable feature for experienced users of 
\family sans
R
\family default
, but I find that it causes more trouble than it saves with beginners.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Chapter Exercises
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{section}{Chapter Exercises}
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{thm}{0}
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Data Description 
\begin_inset CommandInset label
LatexCommand label
name "cha:Describing-Data-Distributions"

\end_inset


\end_layout

\begin_layout Standard
\noindent
In this chapter we introduce the different types of data that a statistician
 is likely to encounter, and in each subsection we give some examples of
 how to display the data of that particular type.
 Once we see how to display data distributions, we next introduce the basic
 properties of data distributions.
 We qualitatively explore several data sets.
 Once that we have intuitive properties of data sets, we next discuss how
 we may numerically measure and describe those properties with descriptive
 statistics.
\end_layout

\begin_layout Paragraph*
What do I want them to know?
\end_layout

\begin_layout Itemize
different data types, such as quantitative versus qualitative, nominal versus
 ordinal, and discrete versus continuous
\end_layout

\begin_layout Itemize
basic graphical displays for assorted data types, and some of their (dis)advanta
ges 
\end_layout

\begin_layout Itemize
fundamental properties of data distributions, including center, spread,
 shape, and crazy observations
\end_layout

\begin_layout Itemize
methods to describe data (visually/numerically) with respect to the properties,
 and how the methods differ depending on the data type
\end_layout

\begin_layout Itemize
all of the above in the context of grouped data, and in particular, the
 concept of a factor
\end_layout

\begin_layout Section
Types of Data
\begin_inset CommandInset label
LatexCommand label
name "sec:Types-of-Data"

\end_inset


\end_layout

\begin_layout Standard
Loosely speaking, a datum is any piece of collected information, and a data
 set is a collection of data related to each other in some way.
 We will categorize data into five types and describe each in turn:
\end_layout

\begin_layout Description
Quantitative data associated with a measurement of some quantity on an observati
onal unit,
\end_layout

\begin_layout Description
Qualitative data associated with some quality or property of the observational
 unit,
\end_layout

\begin_layout Description
Logical data to represent true or false and which play an important role
 later,
\end_layout

\begin_layout Description
Missing data that should be there but are not, and
\end_layout

\begin_layout Description
Other
\begin_inset space ~
\end_inset

types everything else under the sun.
\end_layout

\begin_layout Standard
In each subsection we look at some examples of the type in question and
 introduce methods to display them.
\end_layout

\begin_layout Subsection
Quantitative data
\begin_inset CommandInset label
LatexCommand label
name "sub:Quantitative-Data"

\end_inset


\end_layout

\begin_layout Standard
Quantitative data are any data that measure or are associated with a measurement
 of the quantity of something.
 They invariably assume numerical values.
 Quantitative data can be further subdivided into two categories.
 
\end_layout

\begin_layout Itemize

\emph on
Discrete data
\emph default
 take values in a finite or countably infinite set of numbers, that is,
 all possible values could (at least in principle) be written down in an
 ordered list.
 Examples include: counts, number of arrivals, or number of successes.
 They are often represented by integers, say, 0, 1, 2, 
\emph on
etc
\emph default
..
\end_layout

\begin_layout Itemize

\emph on
Continuous data
\emph default
 take values in an interval of numbers.
 These are also known as scale data, interval data, or measurement data.
 Examples include: height, weight, length, time, 
\emph on
etc
\emph default
.
 Continuous data are often characterized by fractions or decimals: 3.82,
 7.0001, 4
\begin_inset space ~
\end_inset


\begin_inset Formula $\frac{5}{8}$
\end_inset

, 
\emph on
etc
\emph default
..
\end_layout

\begin_layout Standard
Note that the distinction between discrete and continuous data is not always
 clear-cut.
 Sometimes it is convenient to treat data as if they were continuous, even
 though strictly speaking they are not continuous.
 See the examples.
\end_layout

\begin_layout Example

\series bold
Annual Precipitation in US Cities.

\series default
 The vector 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

precip
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\color none
Data sets ! 
\family typewriter
\color inherit
precip
\end_layout

\end_inset

 contains average amount of rainfall (in inches) for each of 70 cities in
 the United States and Puerto Rico.

\color inherit
 Let us take a look at the data:
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

str(precip)
\begin_inset Newline newline
\end_inset

precip[1:4]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The output shows that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

precip
\end_layout

\end_inset


\color inherit
 is a numeric vector which has been 
\emph on
named
\emph default
, that is, each value has a name associated with it (which can be set with
 the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

names
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
names
\end_layout

\end_inset


\color inherit
 function).
 These are quantitative continuous data.
\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Example

\series bold
Lengths of Major North American Rivers.

\series default
 The U.S.
\begin_inset space ~
\end_inset

Geological Survey recorded the lengths (in miles) of several rivers in North
 America.
 They are stored in the vector 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rivers
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\color none
Data sets ! 
\family typewriter
\color inherit
rivers
\end_layout

\end_inset


\color inherit
 in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

datasets
\end_layout

\end_inset


\color inherit
 package (which ships with base 
\family sans
R
\family default
).
 See 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?rivers
\end_layout

\end_inset


\color inherit
.
 Let us take a look at the data with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

str
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
str
\end_layout

\end_inset


\color inherit
 function.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

str(rivers)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Example
The output says that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rivers
\end_layout

\end_inset


\color inherit
 is a numeric vector of length 141, and the first few values are 735, 320,
 325, 
\emph on
etc
\emph default
.
 These data are definitely quantitative and it appears that the measurements
 have been rounded to the nearest mile.
 Thus, strictly speaking, these are discrete data.
 But we will find it convenient later to take data like these to be continuous
 for some of our statistical procedures.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example

\series bold
Yearly Numbers of Important Discoveries.

\series default
 The vector 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

discoveries
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\color none
Data sets ! 
\family typewriter
\color inherit
discoveries
\end_layout

\end_inset

 contains numbers of “great” inventions/discoveries in each year from 1860
 to 1959, as reported by the 1975 World Almanac.
 
\color inherit
Let us take a look at the data:
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

str(discoveries)
\begin_inset Newline newline
\end_inset

discoveries[1:4]
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Standard
The output is telling us that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

discoveries
\end_layout

\end_inset


\color inherit
 is a 
\emph on
time series
\emph default
 (see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:other-data-types"

\end_inset

 for more) of length 100.
 The entries are integers, and since they represent counts this is a good
 example of discrete quantitative data.
 We will take a closer look in the following sections.
\end_layout

\begin_layout Subsection*
Displaying Quantitative Data
\begin_inset CommandInset label
LatexCommand label
name "sub:Displaying-Quantitative-Data"

\end_inset


\end_layout

\begin_layout Standard
One of the first things to do when confronted by quantitative data (or any
 data, for that matter) is to make some sort of visual display to gain some
 insight into the data's structure.
 There are almost as many display types from which to choose as there are
 data sets to plot.
 We describe some of the more popular alternatives.
 
\end_layout

\begin_layout Paragraph*
Strip
\begin_inset space ~
\end_inset

charts
\begin_inset Index
status open

\begin_layout Plain Layout
strip chart
\end_layout

\end_inset

 (also known as Dot plots)
\begin_inset Index
status open

\begin_layout Plain Layout
dot plot | see{strip chart}
\end_layout

\end_inset


\begin_inset CommandInset label
LatexCommand label
name "par:Strip-charts"

\end_inset


\end_layout

\begin_layout Standard
These can be used for discrete or continuous data, and usually look best
 when the data set is not too large.
 Along the horizontal axis is a numerical scale above which the data values
 are plotted.
 We can do it in 
\family sans
R
\family default
 with a call to the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stripchart
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
stripchart
\end_layout

\end_inset


\color inherit
 function.
 There are three available methods.
\end_layout

\begin_layout Description
overplot plots ties covering each other.
 This method is good to display only the distinct values assumed by the
 data set.
\end_layout

\begin_layout Description
jitter adds some noise to the data in the 
\begin_inset Formula $y$
\end_inset

 direction in which case the data values are not covered up by ties.
\end_layout

\begin_layout Description
stack plots repeated values stacked on top of one another.
 This method is best used for discrete data with a lot of ties; if there
 are no repeats then this method is identical to overplot.
\end_layout

\begin_layout Standard
See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Various-stripchart-methods,"

\end_inset

, which is produced by the following code.
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

stripchart(precip, xlab="rainfall")
\begin_inset Newline newline
\end_inset

stripchart(rivers, method="jitter", xlab="length")
\begin_inset Newline newline
\end_inset

stripchart(discoveries, method="stack", xlab="number")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The leftmost graph is a strip chart of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

precip
\end_layout

\end_inset

 data.
 The graph shows tightly clustered values in the middle with some others
 falling balanced on either side, with perhaps slightly more falling to
 the left.
 Later we will call this a symmetric distribution, see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Shape"

\end_inset

.
 The middle graph is of the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rivers
\end_layout

\end_inset

 data, a vector of length 141.
 There are several repeated values in the rivers data, and if we were to
 use the overplot method we would lose some of them in the display.
 This plot shows a what we will later call a right-skewed shape with perhaps
 some extreme values on the far right of the display.
 The third graph strip charts 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

discoveries
\end_layout

\end_inset

 data which are literally a textbook example of a right skewed distribution.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

par(mfrow = c(1,3)) # 3 plots: 1 row, 3 columns
\begin_inset Newline newline
\end_inset

stripchart(precip, xlab="rainfall")
\begin_inset Newline newline
\end_inset

stripchart(rivers, method="jitter", xlab="length")
\begin_inset Newline newline
\end_inset

stripchart(discoveries, method="stack", xlab="number")
\begin_inset Newline newline
\end_inset

par(mfrow = c(1,1)) # back to normal
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Strip charts of the 
\family typewriter
precip
\family default
, 
\family typewriter
rivers
\family default
, and 
\family typewriter
discoveries
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:Various-stripchart-methods,"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Plain Layout

\size small
The first graph uses the 
\family typewriter
overplot
\family default
 method, the second the 
\family typewriter
jitter
\family default
 method, and the third the 
\family typewriter
stack
\family default
 method.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

DOTplot
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
DOTplot
\end_layout

\end_inset

 function in the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

UsingR
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\color none
R packages ! 
\family typewriter
\color inherit
UsingR
\end_layout

\end_inset

 package 
\begin_inset CommandInset citation
LatexCommand citet
key "usingr"

\end_inset

 is another alternative.
\end_layout

\begin_layout Paragraph*
Histogram
\begin_inset Index
status open

\begin_layout Plain Layout
Histogram
\end_layout

\end_inset


\end_layout

\begin_layout Standard
These are typically used for continuous data.
 A histogram is constructed by first deciding on a set of classes, or bins,
 which partition the real line into a set of boxes into which the data values
 fall.
 Then vertical bars are drawn over the bins with height proportional to
 the number of observations that fell into the bin.
 
\end_layout

\begin_layout Standard
These are one of the most common summary displays, and they are often misidentif
ied as 
\begin_inset Quotes eld
\end_inset

Bar Graphs
\begin_inset Quotes erd
\end_inset

 (see below.) The scale on the 
\begin_inset Formula $y$
\end_inset

 axis can be frequency, percentage, or density (relative frequency).
 The term histogram was coined by Karl Pearson in 1891, see 
\begin_inset CommandInset citation
LatexCommand citet
key "Miller"

\end_inset

.
\end_layout

\begin_layout Example

\series bold
Annual Precipitation in US Cities.

\series default
 We are going to take another look at the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

precip
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\color none
Data sets ! 
\family typewriter
\color inherit
precip
\end_layout

\end_inset

 data that we investigated earlier.
 The strip chart in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Various-stripchart-methods,"

\end_inset

 suggested
\color inherit
 a loosely balanced distribution; let us now look to see what a histogram
 says.
 
\end_layout

\begin_layout Example
There are many ways to plot histograms in 
\family sans
R
\family default
, and one of the easiest is with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

hist
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
hist
\end_layout

\end_inset


\color inherit
 function.
 The following code produces the plots in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:histograms"

\end_inset

.
\end_layout

\begin_deeper
\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

hist(precip, main = "")
\begin_inset Newline newline
\end_inset

hist(precip, freq = FALSE, main = "")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Notice the argument 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

main = ""
\end_layout

\end_inset

, which suppresses the main title from being displayed -- it would have
 said 
\begin_inset Quotes eld
\end_inset

Histogram of 
\family typewriter
\color inherit
precip
\family default
\color none

\begin_inset Quotes erd
\end_inset

 otherwise.
 The plot on the left is a frequency histogram (the default), and the plot
 on the right is a relative frequency histogram (
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

freq = FALSE
\end_layout

\end_inset

).
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

par(mfrow = c(1,2)) # 2 plots: 1 row, 2 columns
\begin_inset Newline newline
\end_inset

hist(precip, main = "")
\begin_inset Newline newline
\end_inset

hist(precip, freq = FALSE, main = "")
\begin_inset Newline newline
\end_inset

par(mfrow = c(1,1)) # back to normal
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
(Relative) frequency histograms of the 
\family typewriter
precip
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:histograms"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
Please be careful regarding the biggest weakness of histograms: the graph
 obtained strongly depends on the bins chosen.
 Choose another set of bins, and you will get a different histogram.
 Moreover, there are not any definitive criteria by which bins should be
 defined; the best choice for a given data set is the one which illuminates
 the data set's underlying structure (if any).
 Luckily for us there are algorithms to automatically choose bins that are
 likely to display well, and more often than not the default bins do a good
 job.
 This is not always the case, however, and a responsible statistician will
 investigate many bin choices to test the stability of the display.
\end_layout

\begin_layout Example
Recall that the strip chart in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Various-stripchart-methods,"

\end_inset

 suggested a relatively balanced shape to the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

precip
\end_layout

\end_inset

 
\color inherit
data distribution.
 Watch what happens when we change the bins slightly (with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

breaks
\end_layout

\end_inset


\color inherit
 argument to 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

hist
\end_layout

\end_inset


\color inherit
).
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:histograms-bins"

\end_inset

 which was produced by the following code.
\end_layout

\begin_deeper
\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

hist(precip, breaks = 10, main = "")
\begin_inset Newline newline
\end_inset

hist(precip, breaks = 200, main = "")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

par(mfrow = c(1,2)) # 2 plots: 1 row, 2 columns
\begin_inset Newline newline
\end_inset

hist(precip, breaks = 10, main = "")
\begin_inset Newline newline
\end_inset

hist(precip, breaks = 200, main = "")
\begin_inset Newline newline
\end_inset

par(mfrow = c(1,1)) # back to normal
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
More histograms of the 
\family typewriter
precip
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:histograms-bins"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset

The leftmost graph (with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

breaks = 10
\end_layout

\end_inset

)
\color inherit
 shows that the distribution is not balanced at all.
 There are two humps: a big one in the middle and a smaller one to the left.
 Graphs like this often indicate some underlying group structure to the
 data; we could now investigate whether the cities for which rainfall was
 measured were similar in some way, with respect to geographic region, for
 example.
\end_layout

\begin_layout Standard
The rightmost graph in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:histograms-bins"

\end_inset

 shows what happens when the number of bins is too large: the histogram
 is too grainy and hides the rounded appearance of the earlier histograms.
 If we were to continue increasing the number of bins we would eventually
 get all observed bins to have exactly one element, which is nothing more
 than a glorified strip chart.
\end_layout

\end_deeper
\begin_layout Paragraph*
Stemplots (more to be said in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Exploratory-Data-Analysis"

\end_inset

)
\end_layout

\begin_layout Standard
Stemplots have two basic parts: 
\emph on
stems
\emph default
 and 
\emph on
leaves
\emph default
.
 The final digit of the data values is taken to be a 
\emph on
leaf
\emph default
, and the leading digit(s) is (are) taken to be 
\emph on
stems
\emph default
.
 We draw a vertical line, and to the left of the line we list the stems.
 To the right of the line, we list the leaves beside their corresponding
 stem.
 There will typically be several leaves for each stem, in which case the
 leaves accumulate to the right.
 It is sometimes necessary to round the data values, especially for larger
 data sets.
\end_layout

\begin_layout Example

\color none
\begin_inset CommandInset label
LatexCommand label
name "exa:-ukdriverdeaths-first"

\end_inset


\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

UKDriverDeaths
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\color none
Data sets ! 
\family typewriter
\color inherit
UKDriverDeaths
\end_layout

\end_inset

 is a time series that contains the total car drivers killed or seriously
 injured in Great Britain monthly from Jan 1969 to Dec 1984.
 See 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?UKDriverDeaths
\end_layout

\end_inset

.
 Compulsory seat belt use was introduced on January 31, 1983.
 We
\color inherit
 construct a stem and leaf diagram in 
\family sans
R
\family default
 with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stem.leaf
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
stem.leaf
\end_layout

\end_inset


\color inherit
 function from the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

aplpack
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family sans
R
\family default
\color none
 packages ! 
\family typewriter
\color inherit
aplpack
\end_layout

\end_inset


\color inherit
 package 
\begin_inset CommandInset citation
LatexCommand citet
key "aplpack"

\end_inset

.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(aplpack)
\begin_inset Newline newline
\end_inset

stem.leaf(UKDriverDeaths, depth = FALSE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The display shows a more or less balanced mound-shaped distribution, with
 one or maybe two humps, a big one and a smaller one just to its right.
 Note that the data have been rounded to the tens place so that each datum
 gets only one leaf to the right of the dividing line.
\end_layout

\begin_layout Standard
Notice that the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

depth
\end_layout

\end_inset


\color inherit
s
\begin_inset Index
status open

\begin_layout Plain Layout
depths
\end_layout

\end_inset

 have been suppressed.
 To learn more about this option and many others, see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Exploratory-Data-Analysis"

\end_inset

.
 Unlike a histogram, the original data values may be recovered from the
 stemplot display -- modulo the rounding -- that is, starting from the top
 and working down we can read off the data values 1050, 1070, 1110, 1130,
 
\emph on
etc
\emph default
.
 
\end_layout

\begin_layout Paragraph*
Index plot
\end_layout

\begin_layout Standard
Done with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

plot
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
plot
\end_layout

\end_inset


\color inherit
 function.
 These are good for plotting data which are ordered, for example, when the
 data are measured over time.
 That is, the first observation was measured at time 1, the second at time
 2, 
\emph on
etc
\emph default
.
 It is a two dimensional plot, in which the index (or time) is the 
\begin_inset Formula $x$
\end_inset

 variable and the measured value is the 
\begin_inset Formula $y$
\end_inset

 variable.
 There are several plotting methods for index plots, and we discuss two
 of them:
\end_layout

\begin_layout Description
spikes: draws a vertical line from the 
\begin_inset Formula $x$
\end_inset

-axis to the observation height (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

type = "h"
\end_layout

\end_inset


\color inherit
).
\end_layout

\begin_layout Description
points: plots a simple point at the observation height (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

type = "p"
\end_layout

\end_inset


\color inherit
).
\end_layout

\begin_layout Example

\series bold
Level of Lake Huron 1875-1972.

\series default
 Brockwell and Davis 
\begin_inset CommandInset citation
LatexCommand citet
key "Brockwell1991"

\end_inset

 give the annual measurements of the level (in feet) of Lake Huron from
 1875--1972.
 The data are stored in the time series 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

LakeHuron
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\color none
Data sets ! 
\family typewriter
\color inherit
LakeHuron
\end_layout

\end_inset

.
 See
\color inherit
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?LakeHuron
\end_layout

\end_inset

.

\color inherit
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:indpl-lakehuron"

\end_inset

 was produced with the following code:
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

plot(LakeHuron, type = "h")
\begin_inset Newline newline
\end_inset

plot(LakeHuron, type = "p")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The plots show an overall decreasing trend to the observations, and there
 appears to be some seasonal variation that increases over time.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 8, width = 6>>=
\begin_inset Newline newline
\end_inset

par(mfrow = c(2,1)) # 2 plots: 1 row, 2 columns
\begin_inset Newline newline
\end_inset

plot(LakeHuron, type = "h")
\begin_inset Newline newline
\end_inset

plot(LakeHuron, type = "p")
\begin_inset Newline newline
\end_inset

par(mfrow = c(1,1)) # back to normal
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Index plots of the 
\family typewriter
LakeHuron
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:indpl-lakehuron"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Paragraph*
Density estimates
\end_layout

\begin_layout Subsection
Qualitative Data, Categorical Data, and Factors
\begin_inset CommandInset label
LatexCommand label
name "sub:Qualitative-Data"

\end_inset


\end_layout

\begin_layout Standard
Qualitative data are simply any type of data that are not numerical, or
 do not represent numerical quantities.
 Examples of qualitative variables include a subject's name, gender, race/ethnic
ity, political party, socioeconomic status, class rank, driver's license
 number, and social security number (SSN).
\end_layout

\begin_layout Standard
Please bear in mind that some data 
\emph on
look
\emph default
 to be quantitative but are 
\emph on
not,
\emph default
 because they do not represent numerical quantities and do not obey mathematical
 rules.
 For example, a person's shoe size is typically written with numbers: 8,
 or 9, or 12, or 
\begin_inset Formula $12\,\frac{1}{2}$
\end_inset

.
 Shoe size is not quantitative, however, because if we take a size 8 and
 combine with a size 9 we do not get a size 17.
\end_layout

\begin_layout Standard
Some qualitative data serve merely to 
\emph on
identify
\emph default
 the observation (such a subject's name, driver's license number, or SSN).
 This type of data does not usually play much of a role in statistics.
 But other qualitative variables serve to 
\emph on
subdivide
\emph default
 the data set into categories; we call these 
\emph on
factors
\emph default
.
 In the above examples, gender, race, political party, and socioeconomic
 status would be considered factors (shoe size would be another one).
 The possible values of a factor are called its 
\emph on
levels
\emph default
.
 For instance, the factor 
\emph on
gender
\emph default
 would have two levels, namely, male and female.
 Socioeconomic status typically has three levels: high, middle, and low.
\end_layout

\begin_layout Standard
Factors may be of two types: 
\emph on
nominal
\emph default

\begin_inset Index
status open

\begin_layout Plain Layout
nominal data
\end_layout

\end_inset

 and 
\emph on
ordinal
\emph default

\begin_inset Index
status open

\begin_layout Plain Layout
ordinal data
\end_layout

\end_inset

.
 Nominal factors have levels that correspond to names of the categories,
 with no implied ordering.
 Examples of nominal factors would be hair color, gender, race, or political
 party.
 There is no natural ordering to 
\begin_inset Quotes eld
\end_inset

Democrat
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

Republican
\begin_inset Quotes erd
\end_inset

; the categories are just names associated with different groups of people.
 
\end_layout

\begin_layout Standard
In contrast, ordinal factors have some sort of ordered structure to the
 underlying factor levels.
 For instance, socioeconomic status would be an ordinal categorical variable
 because the levels correspond to ranks associated with income, education,
 and occupation.
 Another example of ordinal categorical data would be class rank.
\end_layout

\begin_layout Standard
Factors have special status in 
\family sans
R
\family default
.
 They are represented internally by numbers, but even when they are written
 numerically their values do not convey any numeric meaning or obey any
 mathematical rules (that is, Stage III cancer is not Stage I cancer + Stage
 II cancer).
\end_layout

\begin_layout Example
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

state.abb
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\color none
Data sets ! 
\family typewriter
\color inherit
state.abb
\end_layout

\end_inset

 vector gives the two letter postal abbreviations for all 50 states.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

str(state.abb)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
These would be ID data.
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

state.name
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\color none
Data sets ! 
\family typewriter
\color inherit
state.name
\end_layout

\end_inset

 vector lists all of the complete names and those data would also be ID.
\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Example

\series bold
U.S.
\begin_inset space ~
\end_inset

State Facts and Features.

\series default
\color none
 The U.S.
\begin_inset space ~
\end_inset

Department of Commerce of the U.S.
\begin_inset space ~
\end_inset

Census Bureau releases all sorts of information in the 
\emph on
\color inherit
Statistical Abstract of the United States
\emph default
\color none
, and the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

state.region
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\color none
Data sets ! 
\family typewriter
\color inherit
state.region
\end_layout

\end_inset


\color inherit
 data lists each of the 50 states and the region to which it belongs, be
 it Northeast, South, North Central, or West.
 See 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?state.region
\end_layout

\end_inset

.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

str(state.region)
\begin_inset Newline newline
\end_inset

state.region[1:5]
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Example
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

str
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
str
\end_layout

\end_inset


\color inherit
 output shows that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

state.region
\end_layout

\end_inset


\color inherit
 is already stored internally as a factor and it lists a couple of the factor
 levels.
 To see all of the levels we printed the first five entries of the vector
 in the second line.need to print a piece of the from 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Subsection*
Displaying Qualitative Data
\begin_inset CommandInset label
LatexCommand label
name "sub:Displaying-Qualitative-Data"

\end_inset


\end_layout

\begin_layout Paragraph*
Tables
\begin_inset CommandInset label
LatexCommand label
name "par:Tables"

\end_inset


\end_layout

\begin_layout Standard
One of the best ways to summarize qualitative data is with a table of the
 data values.
 We may count frequencies with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

table
\end_layout

\end_inset


\color inherit
 function or list proportions with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prop.table
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
prop.table
\end_layout

\end_inset


\color inherit
 function (whose input is a frequency table).
 In the 
\family sans
R
\family default
 Commander you can do it with 
\family sans
Statistics
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset


\family default
 
\family sans
Frequency Distribution\SpecialChar \ldots{}
.

\family default
 Alternatively, to look at tables for all factors in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Active data set
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
Active data set
\end_layout

\end_inset


\color inherit
 you can do 
\family sans
Statistics
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset


\family default
 
\family sans
Summaries
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset


\family default
 
\family sans
Active Dataset
\family default
.
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

Tbl <- table(state.division)
\begin_inset Newline newline
\end_inset

Tbl               # frequencies
\begin_inset Newline newline
\end_inset

Tbl/sum(Tbl)      # relative frequencies
\begin_inset Newline newline
\end_inset

prop.table(Tbl)   # same thing
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Paragraph*
Bar Graphs
\begin_inset CommandInset label
LatexCommand label
name "par:Bar-Graphs"

\end_inset


\end_layout

\begin_layout Standard
A bar graph is the analogue of a histogram for categorical data.
 A bar is displayed for each level of a factor, with the heights of the
 bars proportional to the frequencies of observations falling in the respective
 categories.
 A disadvantage of bar graphs is that the levels are ordered alphabetically
 (by default), which may sometimes obscure patterns in the display.
 
\end_layout

\begin_layout Example

\series bold
U.S.
\begin_inset space ~
\end_inset

State Facts and Features.

\series default
\color none
 The 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

state.region
\end_layout

\end_inset


\color inherit
 data lists each of the 50 states and the region to which it belongs, be
 it Northeast, South, North Central, or West.
 See 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?state.region
\end_layout

\end_inset

.
 It is already stored internally as a factor.
 We make a 
\color inherit
bar graph with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

barplot
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
barplot
\end_layout

\end_inset

 function:
\color inherit
 
\end_layout

\begin_deeper
\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

barplot(table(state.region), cex.names = 0.50)
\begin_inset Newline newline
\end_inset

barplot(prop.table(table(state.region)), cex.names = 0.50)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:bar-gr-stateregion"

\end_inset

.
 The display on the left is a frequency bar graph because the 
\begin_inset Formula $y$
\end_inset

 axis shows counts, while the display on the left is a relative frequency
 bar graph.
 The only difference between the two is the scale.
 Looking at the graph we see that the majority of the fifty states are in
 the South, followed by West, North Central, and finally Northeast.
 Over 30% of the states are in the South.
\end_layout

\begin_layout Standard
Notice the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cex.names
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
cex.names
\end_layout

\end_inset

 argument that we used, above.
 It shrinks the names on the 
\begin_inset Formula $x$
\end_inset

 axis by 50% which makes them easier to read.
 See 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?par
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
par
\end_layout

\end_inset

 for a detailed list of additional plot parameters.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

par(mfrow = c(1,2)) # 2 plots: 1 row, 2 columns
\begin_inset Newline newline
\end_inset

barplot(table(state.region), cex.names = 0.50)
\begin_inset Newline newline
\end_inset

barplot(prop.table(table(state.region)), cex.names = 0.50)
\begin_inset Newline newline
\end_inset

par(mfrow = c(1,1))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Bar graphs of the 
\family typewriter
state.region
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:bar-gr-stateregion"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Plain Layout

\size small
The left graph is a frequency barplot made with 
\family typewriter
table
\family default
 and the right is a relative frequency barplot made with 
\family typewriter
prop.table
\family default
.
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Paragraph*
Pareto Diagrams
\begin_inset CommandInset label
LatexCommand label
name "par:Pareto-Diagrams"

\end_inset


\end_layout

\begin_layout Standard
A pareto diagram is a lot like a bar graph except the bars are rearranged
 such that they decrease in height going from left to right.
 The rearrangement is handy because it can visually reveal structure (if
 any) in how fast the bars decrease -- this is much more difficult when
 the bars are jumbled.
 
\end_layout

\begin_layout Example

\color none
U.S.
\begin_inset space ~
\end_inset

State Facts and Features.
 The 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

state.division
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\color none
Data sets ! 
\family typewriter
\color inherit
state.division
\end_layout

\end_inset

 data record the division (New England, Middle Atlantic, South Atlantic,
 East South Central, West South Central, East North Central, West North
 Central, Mountain, and Pacific) of the fifty states.
 We can make a pareto diagram 
\color inherit
with either the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

RcmdrPlugin.IPSUR
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family sans
R
\family default
\color none
 packages ! 
\family typewriter
\color inherit
RcmdrPlugin.IPSUR
\end_layout

\end_inset

 package
\color inherit
 or with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

pareto.chart
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
pareto.chart
\end_layout

\end_inset


\color inherit
 function from the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

qcc
\end_layout

\end_inset


\begin_inset Index
status collapsed

\begin_layout Plain Layout

\family sans
R
\family default
\color none
 packages ! 
\family typewriter
\color inherit
qcc
\end_layout

\end_inset


\color inherit
 package 
\begin_inset CommandInset citation
LatexCommand citet
key "qcc"

\end_inset

.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Pareto-chart"

\end_inset

.
 The code follows.
\end_layout

\begin_deeper
\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

library(qcc)
\begin_inset Newline newline
\end_inset

pareto.chart(table(state.division), ylab="Frequency")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

library(qcc)
\begin_inset Newline newline
\end_inset

pareto.chart(table(state.division), ylab="Frequency")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Pareto chart of the 
\family typewriter
state.division
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:Pareto-chart"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Paragraph*
Dot Charts
\begin_inset CommandInset label
LatexCommand label
name "par:Dotcharts"

\end_inset


\end_layout

\begin_layout Standard
These are a lot like a bar graph that has been turned on its side with the
 bars replaced by dots on horizontal lines.
 They do not convey any more (or less) information than the associated bar
 graph, but the strength lies in the economy of the display.
 Dot charts are so compact that it is easy to graph very complicated multi-varia
ble interactions together in one graph.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Comparing-Data-Sets"

\end_inset

.
 We will give an example here using the same data as above for comparison.
 The graph was produced by the following code.
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

x <- table(state.region)
\begin_inset Newline newline
\end_inset

dotchart(as.vector(x), labels = names(x))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

x <- table(state.region)
\begin_inset Newline newline
\end_inset

dotchart(as.vector(x), labels = names(x))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Dot chart of the 
\family typewriter
state.region
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:dot-charts"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:dot-charts"

\end_inset

.
 Compare it to Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:bar-gr-stateregion"

\end_inset

.
\end_layout

\begin_layout Paragraph*
Pie Graphs
\begin_inset CommandInset label
LatexCommand label
name "par:Pie-Graphs"

\end_inset


\end_layout

\begin_layout Standard
These can be done with 
\family sans
R
\family default
 and the 
\family sans
R
\family default
 Commander, but they fallen out of favor in recent years because researchers
 have determined that while the human eye is good at judging linear measures,
 it is notoriously bad at judging relative areas (such as those displayed
 by a pie graph).
 Pie charts are consequently a very bad way of displaying information.
 A bar chart or dot chart is a preferable way of displaying qualitative
 data.
 
\color none
See 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?pie
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
pie
\end_layout

\end_inset

 for more information.
\end_layout

\begin_layout Standard
We are not going to do any examples of a pie graph and discourage their
 use elsewhere.
 
\end_layout

\begin_layout Subsection
Logical Data
\begin_inset CommandInset label
LatexCommand label
name "sub:Logical-Data"

\end_inset


\end_layout

\begin_layout Standard
There is another type of information recognized by 
\family sans
R
\family default
 which does not fall into the above categories.
 The value is either 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

TRUE
\end_layout

\end_inset


\color inherit
 or 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

FALSE
\end_layout

\end_inset

 
\color inherit
(note that equivalently you can use 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

1 = TRUE
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

0 = FALSE
\end_layout

\end_inset


\color inherit
).
 Here is an example of a logical vector:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x <- 5:9
\begin_inset Newline newline
\end_inset

y <- (x < 7.3)
\begin_inset Newline newline
\end_inset

y
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Many functions in 
\family sans
R
\family default
 have options that the user may or may not want to activate in the function
 call.
 For example, the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stem.leaf
\end_layout

\end_inset


\color inherit
 function has the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

depths
\end_layout

\end_inset


\color inherit
 argument which is 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

TRUE
\end_layout

\end_inset


\color inherit
 by default.
 We saw in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Quantitative-Data"

\end_inset

 how to turn the option off, simply enter 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stem.leaf(x, depths = FALSE)
\end_layout

\end_inset


\color inherit
 and they will not be shown on the display.
\end_layout

\begin_layout Standard
We can swap 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

TRUE
\end_layout

\end_inset

 with 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

FALSE
\end_layout

\end_inset

 with the exclamation point 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

!
\end_layout

\end_inset

.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

!y
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Subsection
Missing Data
\begin_inset CommandInset label
LatexCommand label
name "sub:Missing-Data"

\end_inset


\end_layout

\begin_layout Standard
Missing data are a persistent and prevalent problem in many statistical
 analyses, especially those associated with the social sciences.
 
\family sans
R
\family default
 reserves the special symbol 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

NA
\end_layout

\end_inset


\color inherit
 to representing missing data.
\end_layout

\begin_layout Standard
Ordinary arithmetic with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

NA
\end_layout

\end_inset

 values give 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

NA
\end_layout

\end_inset

's (addition, subtraction, 
\emph on
\color inherit
etc
\emph default
\color none
.) and applying a function to a vector that has an 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

NA
\end_layout

\end_inset

 in it will usually give an 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

NA
\end_layout

\end_inset

.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x <- c(3, 7, NA, 4, 7)
\begin_inset Newline newline
\end_inset

y <- c(5, NA, 1, 2, 2)
\begin_inset Newline newline
\end_inset

x + y
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Some functions have a 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

na.rm
\end_layout

\end_inset


\color inherit
 argument which when 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

TRUE
\end_layout

\end_inset


\color inherit
 will ignore missing data as if it were not there (such as 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mean
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

var
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

sd
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IQR
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mad
\end_layout

\end_inset


\color inherit
, \SpecialChar \ldots{}
).
 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

sum(x)
\begin_inset Newline newline
\end_inset

sum(x, na.rm = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Other functions do not have a 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

na.rm
\end_layout

\end_inset


\color inherit
 argument and will return 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

NA
\end_layout

\end_inset


\color inherit
 or an error if the argument has 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

NA
\end_layout

\end_inset


\color inherit
s.
 In those cases we can find the locations of any 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

NA
\end_layout

\end_inset

s with the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

is.na
\end_layout

\end_inset

 function and remove those cases with the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

[]
\end_layout

\end_inset

 operator.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

is.na(x)
\begin_inset Newline newline
\end_inset

z <- x[!is.na(x)]
\begin_inset Newline newline
\end_inset

sum(z)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The analogue of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

is.na
\end_layout

\end_inset


\color inherit
 for rectangular data sets (or data frames) is the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

complete.cases
\end_layout

\end_inset


\color inherit
 function.
 See Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Editing-Data-Sets"

\end_inset

.
\end_layout

\begin_layout Subsection
Other Data Types
\begin_inset CommandInset label
LatexCommand label
name "sub:other-data-types"

\end_inset


\end_layout

\begin_layout Section
Features of Data Distributions
\begin_inset CommandInset label
LatexCommand label
name "sec:features-of-data"

\end_inset


\end_layout

\begin_layout Standard
Given that the data have been appropriately displayed, the next step is
 to try to identify salient features represented in the graph.
 The acronym to remember is 
\emph on
C
\emph default
enter, 
\emph on
U
\emph default
nusual features, 
\emph on
S
\emph default
pread, and 
\emph on
S
\emph default
hape.
 (CUSS).
\end_layout

\begin_layout Subsection
Center
\begin_inset CommandInset label
LatexCommand label
name "sub:Center"

\end_inset


\end_layout

\begin_layout Standard
One of the most basic features of a data set is its center.
 Loosely speaking, the center of a data set is associated with a number
 that represents a middle or general tendency of the data.
 Of course, there are usually several values that would serve as a center,
 and our later tasks will be focused on choosing an appropriate one for
 the data at hand.
 Judging from the histogram that we saw in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:histograms-bins"

\end_inset

, a measure of center would be about 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(mean(precip))}
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Subsection
Spread
\begin_inset CommandInset label
LatexCommand label
name "sub:Spread"

\end_inset


\end_layout

\begin_layout Standard
The spread of a data set is associated with its variability; data sets with
 a large spread tend to cover a large interval of values, while data sets
 with small spread tend to cluster tightly around a central value.
 
\end_layout

\begin_layout Subsection
Shape
\begin_inset CommandInset label
LatexCommand label
name "sub:Shape"

\end_inset


\end_layout

\begin_layout Standard
When we speak of the 
\emph on
shape
\emph default
 of a data set, we are usually referring to the shape exhibited by an associated
 graphical display, such as a histogram.
 The shape can tell us a lot about any underlying structure to the data,
 and can help us decide which statistical procedure we should use to analyze
 them.
\end_layout

\begin_layout Paragraph*
Symmetry and Skewness
\end_layout

\begin_layout Standard
A distribution is said to be 
\emph on
right-skewed
\emph default
 (or 
\emph on
positively skewed
\emph default
) if the right tail seems to be stretched from the center.
 A 
\emph on
left-skewed
\emph default
 (or 
\emph on
negatively skewed
\emph default
) distribution is stretched to the left side.
 A symmetric distribution has a graph that is balanced about its center,
 in the sense that half of the graph may be reflected about a central line
 of symmetry to match the other half.
\end_layout

\begin_layout Standard
We have already encountered skewed distributions: both the discoveries data
 in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Various-stripchart-methods,"

\end_inset

 and the precip data in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:histograms-bins"

\end_inset

 appear right-skewed.
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

UKDriverDeaths
\end_layout

\end_inset


\color inherit
 data in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:-ukdriverdeaths-first"

\end_inset

 is relatively symmetric (but note the one extreme value 2654 identified
 at the bottom of the stemplot).
\end_layout

\begin_layout Paragraph*
Kurtosis
\end_layout

\begin_layout Standard
Another component to the shape of a distribution is how 
\begin_inset Quotes eld
\end_inset

peaked
\begin_inset Quotes erd
\end_inset

 it is.
 Some distributions tend to have a flat shape with thin tails.
 These are called 
\emph on
platykurtic
\emph default
, and an example of a platykurtic distribution is the uniform distribution;
 see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:The-Continuous-Uniform"

\end_inset

.
 On the other end of the spectrum are distributions with a steep peak, or
 spike, accompanied by heavy tails; these are called 
\emph on
leptokurtic
\emph default
.
 Examples of leptokurtic distributions are the Laplace distribution and
 the logistic distribution.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Other-Continuous-Distributions"

\end_inset

.
 In between are distributions (called 
\emph on
mesokurtic
\emph default
) with a rounded peak and moderately sized tails.
 The standard example of a mesokurtic distribution is the famous bell-shaped
 curve, also known as the Gaussian, or normal, distribution, and the binomial
 distribution can be mesokurtic for specific choices of 
\begin_inset Formula $p$
\end_inset

.
 See Sections 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:binom-dist"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:The-Normal-Distribution"

\end_inset

.
\end_layout

\begin_layout Subsection
Clusters and Gaps
\begin_inset CommandInset label
LatexCommand label
name "sub:clusters-and-gaps"

\end_inset


\end_layout

\begin_layout Standard
Clusters or gaps are sometimes observed in quantitative data distributions.
 They indicate clumping of the data about distinct values, and gaps may
 exist between clusters.
 Clusters often suggest an underlying grouping to the data.
 For example, take a look at the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

faithful
\end_layout

\end_inset


\color inherit
 data which contains the duration of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

eruptions
\end_layout

\end_inset


\color inherit
 and the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

waiting
\end_layout

\end_inset

 time between eruptions of the Old Faithful geyser in Yellowstone National
 Park.
 (Do not be frightened by the complicated information at the left of the
 display for now; we will learn how to interpret it in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Exploratory-Data-Analysis"

\end_inset

).
\begin_inset CommandInset label
LatexCommand label
name "exa:stemleaf-multiple-lines-stem"

\end_inset


\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(aplpack)
\begin_inset Newline newline
\end_inset

stem.leaf(faithful$eruptions)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
There are definitely two clusters of data here; an upper cluster and a lower
 cluster.
 
\end_layout

\begin_layout Subsection
Extreme Observations and other Unusual Features
\begin_inset CommandInset label
LatexCommand label
name "sub:Extreme-Observations-and"

\end_inset


\end_layout

\begin_layout Standard
Extreme observations fall far from the rest of the data.
 Such observations are troublesome to many statistical procedures; they
 cause exaggerated estimates and instability.
 It is important to identify extreme observations and examine the source
 of the data more closely.
 There are many possible reasons underlying an extreme observation:
\end_layout

\begin_layout Itemize

\series bold
Maybe the value is a typographical error.

\series default
 Especially with large data sets becoming more prevalent, many of which
 being recorded by hand, mistakes are a common problem.
 After closer scrutiny, these can often be fixed.
\end_layout

\begin_layout Itemize

\series bold
Maybe the observation was not meant for the study
\series default
, because it does not belong to the population of interest.
 For example, in medical research some subjects may have relevant complications
 in their genealogical history that would rule out their participation in
 the experiment.
 Or when a manufacturing company investigates the properties of one of its
 devices, perhaps a particular product is malfunctioning and is not representati
ve of the majority of the items.
\end_layout

\begin_layout Itemize

\series bold
Maybe it indicates a deeper trend or phenomenon
\series default
.
 Many of the most influential scientific discoveries were made when the
 investigator noticed an unexpected result, a value that was not predicted
 by the classical theory.
 Albert Einstein, Louis Pasteur, and others built their careers on exactly
 this circumstance.
\end_layout

\begin_layout Section
Descriptive Statistics
\begin_inset CommandInset label
LatexCommand label
name "sec:Descriptive-Statistics"

\end_inset


\end_layout

\begin_layout Subsection
Frequencies and Relative Frequencies
\begin_inset CommandInset label
LatexCommand label
name "sub:Frequencies-and-Relative"

\end_inset


\end_layout

\begin_layout Standard
These are used for categorical data.
 The idea is that there are a number of different categories, and we would
 like to get some idea about how the categories are represented in the populatio
n.
 For example, we may want to see how the 
\end_layout

\begin_layout Subsection
Measures of Center
\begin_inset CommandInset label
LatexCommand label
name "sub:Measures-of-Center"

\end_inset


\end_layout

\begin_layout Standard
The 
\emph on
sample mean
\emph default
 is denoted 
\begin_inset Formula $\xbar$
\end_inset

 (read 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $x$
\end_inset

-bar
\begin_inset Quotes erd
\end_inset

) and is simply the arithmetic average of the observations:
\begin_inset Formula \begin{equation}
\xbar=\frac{x_{1}+x_{2}+\cdots+x_{n}}{n}=\frac{1}{n}\sum_{i=1}^{n}x_{i}.\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
Good: natural, easy to compute, has nice mathematical properties
\end_layout

\begin_layout Itemize
Bad: sensitive to extreme values
\end_layout

\begin_layout Standard
It is appropriate for use with data sets that are not highly skewed without
 extreme observations.
\end_layout

\begin_layout Standard
The 
\emph on
sample median
\emph default
 is another popular measure of center and is denoted 
\begin_inset Formula $\tilde{x}$
\end_inset

.
 To calculate its value, first sort the data into an increasing sequence
 of numbers.
 If the data set has an odd number of observations then 
\begin_inset Formula $\tilde{x}$
\end_inset

 is the value of the middle observation, which lies in position 
\begin_inset Formula $(n+1)/2$
\end_inset

; otherwise, there are two middle observations and 
\begin_inset Formula $\tilde{x}$
\end_inset

 is the average of those middle values.
\end_layout

\begin_layout Itemize
Good: resistant to extreme values, easy to describe
\end_layout

\begin_layout Itemize
Bad: not as mathematically tractable, need to sort the data to calculate
\end_layout

\begin_layout Standard
One desirable property of the sample median is that it is resistant to extreme
 observations, in the sense that the value of 
\begin_inset Formula $\tilde{x}$
\end_inset

 depends only the values of the middle observations, and is quite unaffected
 by the actual values of the outer observations in the ordered list.
 The same cannot be said for the sample mean.
 Any significant changes in the magnitude of an observation 
\begin_inset Formula $x_{k}$
\end_inset

 results in a corresponding change in the value of the mean.
 Hence, the sample mean is said to be sensitive to extreme observations.
\end_layout

\begin_layout Standard
The 
\emph on
trimmed mean
\emph default
 is a measure designed to address the sensitivity of the sample mean to
 extreme observations.
 The idea is to 
\begin_inset Quotes eld
\end_inset

trim
\begin_inset Quotes erd
\end_inset

 a fraction (less than 1/2) of the observations off each end of the ordered
 list, and then calculate the sample mean of what remains.
 We will denote it by 
\begin_inset Formula $\xbar_{t=0.05}$
\end_inset

.
\end_layout

\begin_layout Itemize
Good: resistant to extreme values, shares nice statistical properties
\end_layout

\begin_layout Itemize
Bad: need to sort the data
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Itemize
You can calculate frequencies or relative frequencies with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

table
\end_layout

\end_inset


\color inherit
 function, and relative frequencies with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prop.table(table())
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Itemize
You can calculate the sample mean of a data vector 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 with the command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mean(x)
\end_layout

\end_inset


\color inherit
.
 
\end_layout

\begin_layout Itemize
You can calculate the sample median of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 with the command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

median(x)
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Itemize
You can calculate the trimmed mean with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trim
\end_layout

\end_inset


\color inherit
 argument; 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mean(x, trim = 0.05)
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Subsection
Order Statistics and the Sample Quantiles
\begin_inset CommandInset label
LatexCommand label
name "sub:Order-Statistics-and"

\end_inset


\end_layout

\begin_layout Standard
A common first step in an analysis of a data set is to sort the values.
 Given a data set 
\begin_inset Formula $x_{1}$
\end_inset

, 
\begin_inset Formula $x_{2}$
\end_inset

, \SpecialChar \ldots{}
,
\begin_inset Formula $x_{n}$
\end_inset

, we may sort the values to obtain an increasing sequence
\begin_inset Formula \begin{equation}
x_{(1)}\leq x_{(2)}\leq x_{(3)}\leq\cdots\leq x_{(n)}\end{equation}

\end_inset

and the resulting values are called the 
\emph on
order statistics
\emph default
.
 The 
\begin_inset Formula $k$
\end_inset


\begin_inset Formula $^{\text{th}}$
\end_inset

 entry in the list, 
\begin_inset Formula $x_{(k)}$
\end_inset

, is the 
\begin_inset Formula $k$
\end_inset


\begin_inset Formula $^{\text{th}}$
\end_inset

 order statistic, and approximately 
\begin_inset Formula $100(k/n)$
\end_inset

% of the observations fall below 
\begin_inset Formula $x_{(k)}$
\end_inset

.
 The order statistics give an indication of the shape of the data distribution,
 in the sense that a person can look at the order statistics and have an
 idea about where the data are concentrated, and where they are sparse.
\end_layout

\begin_layout Standard
The 
\emph on
sample quantiles
\emph default
 are related to the order statistics.
 Unfortunately, there is not a universally accepted definition of them.
 Indeed, 
\family sans
R
\family default
 is equipped to calculate quantiles using nine distinct definitions! We
 will describe the default method (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

type = 7
\end_layout

\end_inset


\color inherit
), but the interested reader can see the details for the other methods with
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?quantile
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Standard
Suppose the data set has 
\begin_inset Formula $n$
\end_inset

 observations.
 Find the sample quantile of order 
\begin_inset Formula $p$
\end_inset

 (
\begin_inset Formula $0<p<1$
\end_inset

), denoted 
\begin_inset Formula $\tilde{q}_{p}$
\end_inset

 , as follows:
\end_layout

\begin_layout Description
First
\begin_inset space ~
\end_inset

step: sort the data to obtain the order statistics 
\begin_inset Formula $x_{(1)}$
\end_inset

, 
\begin_inset Formula $x_{(2)}$
\end_inset

, \SpecialChar \ldots{}
,
\begin_inset Formula $x_{(n)}$
\end_inset

.
 
\end_layout

\begin_layout Description
Second
\begin_inset space ~
\end_inset

step: calculate 
\begin_inset Formula $(n-1)p+1$
\end_inset

 and write it in the form 
\begin_inset Formula $k.d$
\end_inset

, where 
\begin_inset Formula $k$
\end_inset

 is an integer and 
\begin_inset Formula $d$
\end_inset

 is a decimal.
\end_layout

\begin_layout Description
Third
\begin_inset space ~
\end_inset

step: The sample quantile 
\begin_inset Formula $\tilde{q}_{p}$
\end_inset

 is
\begin_inset Formula \begin{equation}
\tilde{q}_{p}=x_{(k)}+d(x_{(k+1)}-x_{(k)}).\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The interpretation of 
\begin_inset Formula $\tilde{q}_{p}$
\end_inset

 is that approximately 
\begin_inset Formula $100p$
\end_inset

% of the data fall below the value 
\begin_inset Formula $\tilde{q}_{p}$
\end_inset

 .
 
\end_layout

\begin_layout Standard
Keep in mind that there is not a unique definition of percentiles, quartiles,
 
\emph on
etc
\emph default
.
 Open a different book, and you'll find a different procedure.
 The difference is small and seldom plays a role except in small data sets
 with repeated values.
 In fact, most people do not even notice in common use.
\end_layout

\begin_layout Standard
Clearly, the most popular sample quantile is 
\begin_inset Formula $\tilde{q}_{0.50}$
\end_inset

, also known as the sample median, 
\begin_inset Formula $\tilde{x}$
\end_inset

.
 The closest runners-up are the 
\emph on
first quartile
\emph default
 
\begin_inset Formula $\tilde{q}_{0.25}$
\end_inset

 and the 
\emph on
third quartile
\emph default
 
\begin_inset Formula $\tilde{q}_{0.75}$
\end_inset

 (the 
\emph on
second quartile
\emph default
 is the median).
 
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Paragraph*
At the command prompt
\end_layout

\begin_layout Standard
We can find the order statistics of a data set stored in a vector 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 with the command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

sort(x)
\end_layout

\end_inset


\color inherit
.
 
\end_layout

\begin_layout Standard
You can calculate the sample quantiles of any order 
\begin_inset Formula $p$
\end_inset

 where 
\begin_inset Formula $0<p<1$
\end_inset

 for a data set stored in a data vector 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset

 
\color inherit
with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

quantile
\end_layout

\end_inset

 function, for instance,
\color inherit
 the command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

quantile(x, probs = c(0, 0.25, 0.37))
\end_layout

\end_inset


\color inherit
 will return the smallest observation, the first quartile, 
\begin_inset Formula $\tilde{q}_{0.25}$
\end_inset

, and the 37th sample quantile, 
\begin_inset Formula $\tilde{q}_{0.37}$
\end_inset

.
 For 
\begin_inset Formula $\tilde{q}_{p}$
\end_inset

 simply change the values in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 argument to the value 
\begin_inset Formula $p$
\end_inset

.
\end_layout

\begin_layout Paragraph*
With the 
\family sans
R
\family default
 Commander
\end_layout

\begin_layout Standard
In 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Rcmdr
\end_layout

\end_inset


\color inherit
 we can find the order statistics of a variable in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Active data set
\end_layout

\end_inset


\color inherit
 by doing 
\family sans
Data 
\begin_inset Formula $\triangleright$
\end_inset

 Manage variables in Active data set\SpecialChar \ldots{}
 
\begin_inset Formula $\triangleright$
\end_inset

 Compute new variable
\emph on
\SpecialChar \ldots{}

\family default
\emph default
.
 In the 
\family sans
Expression to compute
\family default
 dialog simply type 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

sort(varname)
\end_layout

\end_inset


\color inherit
, where 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

varname
\end_layout

\end_inset


\color inherit
 is the variable that it is desired to sort.
\end_layout

\begin_layout Standard
In 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Rcmdr
\end_layout

\end_inset


\color inherit
, we can calculate the sample quantiles for a particular variable with the
 sequence 
\family sans
Statistics 
\begin_inset Formula $\triangleright$
\end_inset

 Summaries 
\begin_inset Formula $\triangleright$
\end_inset

 Numerical Summaries\SpecialChar \ldots{}

\family default
.
 We can automatically calculate the quartiles for all variables in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Active data set
\end_layout

\end_inset


\color inherit
 with the sequence 
\family sans
Statistics 
\begin_inset Formula $\triangleright$
\end_inset

 Summaries 
\begin_inset Formula $\triangleright$
\end_inset

 Active Dataset
\family default
.
\end_layout

\begin_layout Subsection
Measures of Spread
\begin_inset CommandInset label
LatexCommand label
name "sub:Measures-of-Spread"

\end_inset


\end_layout

\begin_layout Paragraph*
Sample Variance and Standard Deviation
\end_layout

\begin_layout Standard
The 
\emph on
sample variance
\emph default
 is denoted 
\begin_inset Formula $s^{2}$
\end_inset

 and is calculated with the formula
\begin_inset Formula \begin{equation}
s^{2}=\frac{1}{n-1}\sum_{i=1}^{n}(x_{i}-\xbar)^{2}.\end{equation}

\end_inset

The 
\emph on
sample standard deviation
\emph default
 is 
\begin_inset Formula $s=\sqrt{s^{2}}$
\end_inset

.
 Intuitively, the sample variance is approximately the average squared distance
 of the observations from the sample mean.
 The sample standard deviation is used to scale the estimate back to the
 measurement units of the original data.
 
\end_layout

\begin_layout Itemize
Good: tractable, has nice mathematical/statistical properties
\end_layout

\begin_layout Itemize
Bad: sensitive to extreme values
\end_layout

\begin_layout Standard
We will spend a lot of time with the variance and standard deviation in
 the coming chapters.
 In the meantime, the following two rules give some meaning to the standard
 deviation, in that there are bounds on how much of the data can fall past
 a certain distance from the mean.
\end_layout

\begin_layout Fact
Chebychev's Rule: The proportion of observations within 
\begin_inset Formula $k$
\end_inset

 standard deviations of the mean is at least 
\begin_inset Formula $1-1/k^{2}$
\end_inset

, 
\emph on
i.e.
\emph default
, at least 75%, 89%, and 94% of the data are within 2, 3, and 4 standard
 deviations of the mean, respectively.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Note that Chebychev's Rule does not say anything about when 
\begin_inset Formula $k=1$
\end_inset

, because 
\begin_inset Formula $1-1/1^{2}=0$
\end_inset

, which states that at least 0% of the observations are within one standard
 deviation of the mean (which is not saying much).
\end_layout

\begin_layout Standard
Chebychev's Rule applies to any data distribution, 
\emph on
any
\emph default
 list of numbers, no matter where it came from or what the histogram looks
 like.
 The price for such generality is that the bounds are not very tight; if
 we know more about how the data are shaped then we can say more about how
 much of the data can fall a given distance from the mean.
\end_layout

\begin_layout Fact
\begin_inset CommandInset label
LatexCommand label
name "fac:Empirical-Rule"

\end_inset

Empirical Rule: If data follow a bell-shaped curve, then approximately 68%,
 95%, and 99.7% of the data are within 1, 2, and 3 standard deviations of
 the mean, respectively.
 
\end_layout

\begin_layout Paragraph*
Interquartile Range
\end_layout

\begin_layout Standard
Just as the sample mean is sensitive to extreme values, so the associated
 measure of spread is similarly sensitive to extremes.
 Further, the problem is exacerbated by the fact that the extreme distances
 are squared.
 We know that the sample quartiles are resistant to extremes, and a measure
 of spread associated with them is the 
\emph on
interquartile range
\emph default
 (
\begin_inset Formula $IQR$
\end_inset

) defined by 
\begin_inset Formula $IQR=q_{0.75}-q_{0.25}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
Good: stable, resistant to outliers, robust to nonnormality, easy to explain
\end_layout

\begin_layout Itemize
Bad: not as tractable, need to sort the data, only involves the middle 50%
 of the data.
\end_layout

\begin_layout Paragraph*
Median Absolute Deviation 
\end_layout

\begin_layout Standard
A measure even more robust than the 
\begin_inset Formula $IQR$
\end_inset

 is the 
\emph on
median absolute deviation
\emph default
 (
\begin_inset Formula $MAD$
\end_inset

).
 To calculate it we first get the median 
\begin_inset Formula $\widetilde{x}$
\end_inset

, next the 
\emph on
absolute deviations
\emph default
 
\begin_inset Formula $|x_{1}-\tilde{x}|$
\end_inset

, 
\begin_inset Formula $|x_{2}-\tilde{x}|$
\end_inset

, 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
\SpecialChar \ldots{}
, 
\begin_inset Formula $|x_{n}-\tilde{x}|$
\end_inset

, and 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
the 
\begin_inset Formula $MAD$
\end_inset

 is proportional to the median of those deviations:
\begin_inset Formula \begin{equation}
MAD\propto\mbox{median}(|x_{1}-\tilde{x}|,\ |x_{2}-\tilde{x}|,\ldots,|x_{n}-\tilde{x}|).\end{equation}

\end_inset

That is, the 
\begin_inset Formula $MAD=c\cdot\mbox{median}(|x_{1}-\tilde{x}|,\ |x_{2}-\tilde{x}|,\ldots,|x_{n}-\tilde{x}|)$
\end_inset

, where 
\begin_inset Formula $c$
\end_inset

 is a constant chosen so that the 
\begin_inset Formula $MAD$
\end_inset

 has nice properties.
 The value of 
\begin_inset Formula $c$
\end_inset

 in 
\family sans
R
\family default
 is by default 
\begin_inset Formula $c=1.4286$
\end_inset

.
 This value is chosen to ensure that the estimator of 
\begin_inset Formula $\sigma$
\end_inset

 is correct, on the average, under suitable sampling assumptions (see Section
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Point-Estimation-1"

\end_inset

).
\end_layout

\begin_layout Itemize
Good: stable, very robust, even more so than the 
\begin_inset Formula $IQR$
\end_inset

.
\end_layout

\begin_layout Itemize
Bad: not tractable, not well known and less easy to explain.
\end_layout

\begin_layout Subsubsection*
Comparing Apples to Apples
\end_layout

\begin_layout Standard
We have seen three different measures of spread which, for a given data
 set, will give three different answers.
 Which one should we use? It depends on the data set.
 If the data are well behaved, with an approximate bell-shaped distribution,
 then the sample mean and sample standard deviation are natural choices
 with nice mathematical properties.
 However, if the data have an unusual or skewed shape with several extreme
 values, perhaps the more resistant choices among the 
\begin_inset Formula $IQR$
\end_inset

 or 
\begin_inset Formula $MAD$
\end_inset

 would be more appropriate.
\end_layout

\begin_layout Standard
However, once we are looking at the three numbers it is important to understand
 that the estimators are not all measuring the same quantity, on the average.
 In particular, it can be shown that when the data follow an approximately
 bell-shaped distribution, then on the average, the sample standard deviation
 
\begin_inset Formula $s$
\end_inset

 and the 
\begin_inset Formula $MAD$
\end_inset

 will be the approximately the same value, namely, 
\begin_inset Formula $\sigma$
\end_inset

, but the 
\begin_inset Formula $IQR$
\end_inset

 will be on the average 1.349 times larger than 
\begin_inset Formula $s$
\end_inset

 and the 
\begin_inset Formula $MAD$
\end_inset

.
 See 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Sampling-Distributions"

\end_inset

 for more details.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Paragraph*
At the command prompt
\end_layout

\begin_layout Standard
From the console we may compute the sample range with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

range(x)
\end_layout

\end_inset


\color inherit
 and the sample variance with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

var(x)
\end_layout

\end_inset


\color inherit
, where 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 is a numeric vector.
 The sample standard deviation is 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

sqrt(var(x))
\end_layout

\end_inset


\color inherit
 or just 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

sd(x)
\end_layout

\end_inset


\color inherit
.
 The 
\begin_inset Formula $IQR$
\end_inset

 is 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IQR(x)
\end_layout

\end_inset


\color inherit
 and the median absolute deviation is 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mad(x)
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Paragraph*
In 
\family sans
R
\family default
 Commander
\end_layout

\begin_layout Standard
In 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Rcmdr
\end_layout

\end_inset


\color inherit
 we can calculate the sample standard deviation with the 
\family sans
Statistics 
\begin_inset Formula $\triangleright$
\end_inset

 Summaries 
\begin_inset Formula $\triangleright$
\end_inset

 Numerical Summaries
\family default
\SpecialChar \ldots{}
 combination.
 
\family sans
R
\family default
 Commander does not calculate the 
\begin_inset Formula $IQR$
\end_inset

 or 
\begin_inset Formula $MAD$
\end_inset

 in any of the menu selections, by default.
\end_layout

\begin_layout Subsection
Measures of Shape
\begin_inset CommandInset label
LatexCommand label
name "sub:Measures-of-Shape"

\end_inset


\end_layout

\begin_layout Paragraph*
Sample Skewness
\end_layout

\begin_layout Standard
The 
\emph on
sample skewness
\emph default
, denoted by 
\begin_inset Formula $g_{1}$
\end_inset

, is defined by the formula
\begin_inset Formula \begin{equation}
g_{1}=\frac{1}{n}\frac{\sum_{i=1}^{n}(x_{i}-\xbar)^{3}}{s^{3}}.\end{equation}

\end_inset

The sample skewness can be any value 
\begin_inset Formula $-\infty<g_{1}<\infty$
\end_inset

.
 The sign of 
\begin_inset Formula $g_{1}$
\end_inset

 indicates the direction of skewness of the distribution.
 Samples that have 
\begin_inset Formula $g_{1}>0$
\end_inset

 indicate right-skewed distributions (or positively skewed), and samples
 with 
\begin_inset Formula $g_{1}<0$
\end_inset

 indicate left-skewed distributions (or negatively skewed).
 Values of 
\begin_inset Formula $g_{1}$
\end_inset

 near zero indicate a symmetric distribution.
 These are not hard and fast rules, however.
 The value of 
\begin_inset Formula $g_{1}$
\end_inset

 is subject to sampling variability and thus only provides a suggestion
 to the skewness of the underlying distribution.
 
\end_layout

\begin_layout Standard
We still need to know how big is 
\begin_inset Quotes eld
\end_inset

big
\begin_inset Quotes erd
\end_inset

, that is, how do we judge whether an observed value of 
\begin_inset Formula $g_{1}$
\end_inset

 is far enough away from zero for the data set to be considered skewed to
 the right or left? A good rule of thumb is that data sets with skewness
 larger than 
\begin_inset Formula $2\sqrt{6/n}$
\end_inset

 in magnitude are substantially skewed, in the direction of the sign of
 
\begin_inset Formula $g_{1}$
\end_inset

.
 See Tabachnick & Fidell 
\begin_inset CommandInset citation
LatexCommand cite
key "Tabachnick2006"

\end_inset

 for details.
\end_layout

\begin_layout Paragraph*
Sample Excess Kurtosis
\end_layout

\begin_layout Standard
The 
\emph on
sample excess kurtosis
\emph default
, denoted by 
\begin_inset Formula $g_{2}$
\end_inset

, is given by the formula
\begin_inset Formula \begin{equation}
g_{2}=\frac{1}{n}\frac{\sum_{i=1}^{n}(x_{i}-\xbar)^{4}}{s^{4}}-3.\end{equation}

\end_inset

The sample excess kurtosis takes values 
\begin_inset Formula $-2\leq g_{2}<\infty$
\end_inset

.
 The subtraction of 3 may seem mysterious but it is done so that mound shaped
 samples have values of 
\begin_inset Formula $g_{2}$
\end_inset

 near zero.
 Samples with 
\begin_inset Formula $g_{2}>0$
\end_inset

 are called 
\emph on
leptokurtic
\emph default
, and samples with 
\begin_inset Formula $g_{2}<0$
\end_inset

 are called 
\emph on
platykurtic
\emph default
.
 Samples with 
\begin_inset Formula $g_{2}\approx0$
\end_inset

 are called 
\emph on
mesokurtic
\emph default
.
\end_layout

\begin_layout Standard
As a rule of thumb, if 
\begin_inset Formula $|g_{2}|>4\sqrt{6/n}$
\end_inset

 then the sample excess kurtosis is substantially different from zero in
 the direction of the sign of 
\begin_inset Formula $g_{2}$
\end_inset

.
 See Tabachnick & Fidell 
\begin_inset CommandInset citation
LatexCommand cite
key "Tabachnick2006"

\end_inset

 for details.
\end_layout

\begin_layout Standard
Notice that both the sample skewness and the sample kurtosis are invariant
 with respect to location and scale, that is, the values of 
\begin_inset Formula $g_{1}$
\end_inset

 and 
\begin_inset Formula $g_{2}$
\end_inset

 do not depend on the measurement units of the data.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

e1071
\end_layout

\end_inset


\color inherit
 package 
\begin_inset CommandInset citation
LatexCommand cite
key "Dimitriadoue1071"

\end_inset

 has the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

skewness
\end_layout

\end_inset


\color inherit
 function for the sample skewness and the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

kurtosis
\end_layout

\end_inset


\color inherit
 function for the sample excess kurtosis.
 Both functions have a 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

na.rm
\end_layout

\end_inset


\color inherit
 argument which is 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

FALSE
\end_layout

\end_inset


\color inherit
 by default.
\end_layout

\begin_layout Example
We said earlier that the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

discoveries
\end_layout

\end_inset


\color inherit
 data looked positively skewed; let's see what the statistics say:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(e1071)
\begin_inset Newline newline
\end_inset

skewness(discoveries)
\begin_inset Newline newline
\end_inset

2*sqrt(6/length(discoveries))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The data are definitely skewed to the right.
 Let us check the sample excess kurtosis of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

UKDriverDeaths
\end_layout

\end_inset

 data:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

kurtosis(UKDriverDeaths)
\begin_inset Newline newline
\end_inset

4*sqrt(6/length(UKDriverDeaths))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
so that the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

UKDriverDeaths
\end_layout

\end_inset


\color inherit
 data appear to be mesokurtic, or at least not substantially leptokurtic.
\end_layout

\begin_layout Section
Exploratory Data Analysis
\begin_inset CommandInset label
LatexCommand label
name "sec:Exploratory-Data-Analysis"

\end_inset


\end_layout

\begin_layout Standard
This field was founded (mostly) by John Tukey (1915-2000).
 Its tools are useful when not much is known regarding the underlying causes
 associated with the data set, and are often used for checking assumptions.
 For example, suppose we perform an experiment and collect some data\SpecialChar \ldots{}
 now
 what? We look at the data using exploratory visual tools.
\end_layout

\begin_layout Subsection
More About Stemplots
\end_layout

\begin_layout Standard
There are many bells and whistles associated with stemplots, and the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stem.leaf
\end_layout

\end_inset


\color inherit
 function can do many of them.
\end_layout

\begin_layout Description
Trim
\begin_inset space ~
\end_inset

Outliers: Some data sets have observations that fall far from the bulk of
 the other data (in a sense made more precise in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Outliers"

\end_inset

).
 These extreme observations often obscure the underlying structure to the
 data and are best left out of the data display.
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trim.outliers
\end_layout

\end_inset


\color inherit
 argument (which is 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

TRUE
\end_layout

\end_inset


\color inherit
 by default) will separate the extreme observations from the others and
 graph the stemplot without them; they are listed at the bottom (respectively,
 top) of the stemplot with the label 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

HI
\end_layout

\end_inset


\color inherit
 (respectively 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

LO
\end_layout

\end_inset


\color inherit
).
 
\end_layout

\begin_layout Description
Split
\begin_inset space ~
\end_inset

Stems: The standard stemplot has only one line per stem, which means that
 all observations with first digit 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

3
\end_layout

\end_inset

 are plotted on the same line, regardless of the value of the second digit.
 
\color inherit
But this gives some stemplots a 
\begin_inset Quotes eld
\end_inset

skyscraper
\begin_inset Quotes erd
\end_inset

 appearance, with too many observations stacked onto the same stem.
 We can often fix the display by increasing the number of lines available
 for a given stem.
 For example, we could make two lines per stem, say, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

3*
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

3.
\end_layout

\end_inset

.
 Observations with second digit 0 through 4 would go on the upper line,
 while observations with second digit 5 through 9 would go on the lower
 line.

\color inherit
 (We could do a similar thing with five lines per stem, or even ten lines
 per stem.) The end result is a more spread out stemplot which often looks
 better.
 A good example of this was shown on page 
\begin_inset CommandInset ref
LatexCommand pageref
reference "exa:stemleaf-multiple-lines-stem"

\end_inset

.
\end_layout

\begin_layout Description
Depths: these are used to give insight into the balance of the observations
 as they accumulate toward the median.
 In a column beside the standard stemplot, the frequency of the stem containing
 the sample median is shown in parentheses.
 Next, frequencies are accumulated from the outside inward, including the
 outliers.
 Distributions that are more symmetric will have better balanced depths
 on either side of the sample median.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Paragraph*
At the command prompt
\end_layout

\begin_layout Standard
The basic command is 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stem(x)
\end_layout

\end_inset


\color inherit
 or a more sophisticated version written by Peter Wolf called 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stem.leaf(x)
\end_layout

\end_inset


\color inherit
 in the 
\family sans
R
\family default
 Commander.
 We will describe 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stem.leaf
\end_layout

\end_inset


\color inherit
 since that is the one used by 
\family sans
R
\family default
 Commander.
\end_layout

\begin_layout Paragraph*
With the 
\family sans
R
\family default
 Commander
\end_layout

\begin_layout Standard
WARNING: Sometimes when making a stem plot the result will not be what you
 expected.
 There are several reasons for this:
\end_layout

\begin_layout Itemize
Stemplots by default will trim extreme observations (defined in Section
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Outliers"

\end_inset

) from the display.
 This in some cases will result in stemplots that are not as wide as expected.
\end_layout

\begin_layout Itemize
The leafs digit is chosen automatically by 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stem.leaf
\end_layout

\end_inset


\color inherit
 according to an algorithm that the computer believes will represent the
 data well.
 Depending on the choice of the digit, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stem.leaf
\end_layout

\end_inset


\color inherit
 may drop digits from the data or round the values in unexpected ways.
\end_layout

\begin_layout Standard
Let us take a look at the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rivers
\end_layout

\end_inset

 data set
\begin_inset CommandInset label
LatexCommand label
name "ite:stemplot-rivers"

\end_inset

.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

stem.leaf(rivers)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The stemplot shows a right-skewed shape to the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rivers
\end_layout

\end_inset

 data distribution.

\color inherit
 Notice that the last digit of each of the data values were dropped from
 the display.
 Notice also that there were eight extreme observations identified by the
 computer, and their exact values are listed at the bottom of the stemplot.
 Look at the scale on the left of the stemplot and try to imagine how ridiculous
 the graph would have looked had we tried to include enough stems to include
 these other eight observations; the stemplot would have stretched over
 several pages.
 Notice finally that we can use the depths to approximate the sample median
 for these data.
 The median lies in the row identified by 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

(18)
\end_layout

\end_inset

, which means that the median is the average of the ninth and tenth observation
 on that row.
 Those two values correspond to 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

43
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

43
\end_layout

\end_inset

, so a good guess for the median would be 430.
 (For the record, the sample median is 
\begin_inset Formula $\widetilde{x}=425$
\end_inset

.
 Recall that stemplots round the data to the nearest stem-leaf pair.) 
\end_layout

\begin_layout Standard
Next let us see what the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

precip
\end_layout

\end_inset

 data look like.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

stem.leaf(precip)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Here is an example of split stems, with two lines per stem.
 The final digit of each datum has been dropped for the display.
 The data appear to be left skewed with four extreme values to the left
 and one extreme value to the right.
 The sample median is approximately 37 (it turns out to be 36.6).
\end_layout

\begin_layout Subsection
Hinges and the Five Number Summary
\begin_inset CommandInset label
LatexCommand label
name "sub:hinges-and-5NS"

\end_inset

 
\end_layout

\begin_layout Standard
Given a data set 
\begin_inset Formula $x_{1}$
\end_inset

, 
\begin_inset Formula $x_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $x_{n}$
\end_inset

, the hinges are found by the following method: 
\end_layout

\begin_layout Itemize
Find the order statistics 
\begin_inset Formula $x_{(1)}$
\end_inset

, 
\begin_inset Formula $x_{(2)}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $x_{(n)}$
\end_inset

.
 
\end_layout

\begin_layout Itemize
The 
\emph on
lower hinge
\emph default
 
\begin_inset Formula $h_{L}$
\end_inset

 is in position 
\begin_inset Formula $L=\left\lfloor (n+3)/2\right\rfloor /2$
\end_inset

, where the symbol 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset Formula $\left\lfloor x\right\rfloor $
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
 denotes the largest integer less than or equal to 
\begin_inset Formula $x$
\end_inset

.
 If the position 
\begin_inset Formula $L$
\end_inset

 is not an integer, then the hinge 
\begin_inset Formula $h_{L}$
\end_inset

 is the average of the adjacent order statistics.
\end_layout

\begin_layout Itemize
The 
\emph on
upper hinge
\emph default
 
\begin_inset Formula $h_{U}$
\end_inset

 is in position 
\begin_inset Formula $n+1-L$
\end_inset

.
\end_layout

\begin_layout Standard
Given the hinges, the 
\emph on
five number summary
\emph default
 (
\begin_inset Formula $5NS$
\end_inset

) is 
\begin_inset Formula \begin{equation}
5NS=(x_{(1)},\ h_{L},\ \tilde{x},\ h_{U},\ x_{(n)}).\end{equation}

\end_inset

An advantage of the 
\begin_inset Formula $5NS$
\end_inset

 is that it reduces a potentially large data set to a shorter list of only
 five numbers, and further, these numbers give insight regarding the shape
 of the data distribution similar to the sample quantiles in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Order-Statistics-and"

\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
If the data are stored in a vector 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset

, then you can compute the 
\begin_inset Formula $5NS$
\end_inset

 with the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

fivenum
\end_layout

\end_inset

 function.
\end_layout

\begin_layout Subsection
Boxplots
\begin_inset CommandInset label
LatexCommand label
name "sub:boxplots"

\end_inset

 
\end_layout

\begin_layout Standard
A boxplot is essentially a graphical representation of the 
\begin_inset Formula $5NS$
\end_inset

.
 It can be a handy alternative to a stripchart when the sample size is large.
\end_layout

\begin_layout Standard
A boxplot is constructed by drawing a box alongside the data axis with sides
 located at the upper and lower hinges.
 A line is drawn parallel to the sides to denote the sample median.
 Lastly, whiskers are extended from the sides of the box to the maximum
 and minimum data values (more precisely, to the most extreme values that
 are not potential outliers, defined below).
\end_layout

\begin_layout Standard
Boxplots are good for quick visual summaries of data sets, and the relative
 positions of the values in the 
\begin_inset Formula $5NS$
\end_inset

 are good at indicating the underlying shape of the data distribution, although
 perhaps not as effectively as a histogram.
 Perhaps the greatest advantage of a boxplot is that it can help to objectively
 identify extreme observations in the data set as described in the next
 section.
\end_layout

\begin_layout Standard
Boxplots are also good because one can visually assess multiple features
 of the data set simultaneously:
\end_layout

\begin_layout Description
Center can be estimated by the sample median, 
\begin_inset Formula $\tilde{x}$
\end_inset

.
\end_layout

\begin_layout Description
Spread can be judged by the width of the box, 
\begin_inset Formula $h_{U}-h_{L}$
\end_inset

.
 We know that this will be close to the 
\begin_inset Formula $IQR$
\end_inset

, which can be compared to 
\begin_inset Formula $s$
\end_inset

 and the 
\begin_inset Formula $MAD$
\end_inset

, perhaps after rescaling if appropriate.
\end_layout

\begin_layout Description
Shape is indicated by the relative lengths of the whiskers, and the position
 of the median inside the box.
 Boxes with unbalanced whiskers indicate skewness in the direction of the
 long whisker.
 Skewed distributions often have the median tending in the opposite direction
 of skewness.
 Kurtosis can be assessed using the box and whiskers.
 A wide box with short whiskers will tend to be platykurtic, while a skinny
 box with wide whiskers indicates leptokurtic distributions.
\end_layout

\begin_layout Description
Extreme
\begin_inset space ~
\end_inset

observations are identified with open circles (see below).
\end_layout

\begin_layout Subsection
Outliers
\begin_inset CommandInset label
LatexCommand label
name "sub:Outliers"

\end_inset

 
\end_layout

\begin_layout Standard
A 
\emph on
potential outlier
\emph default
 is any observation that falls beyond 1.5 times the width of the box on either
 side, that is, any observation less than 
\begin_inset Formula $h_{L}-1.5(h_{U}-h_{L})$
\end_inset

 or greater than 
\begin_inset Formula $h_{U}+1.5(h_{U}-h_{L})$
\end_inset

.
 A 
\emph on
suspected outlier
\emph default
 is any observation that falls beyond 3 times the width of the box on either
 side.
 In 
\family sans
R
\family default
, both potential and suspected outliers (if present) are denoted by open
 circles; there is no distinction between the two.
 
\end_layout

\begin_layout Standard
When potential outliers are present, the whiskers of the boxplot are then
 shortened to extend to the most extreme observation that is not a potential
 outlier.
 If an outlier is displayed in a boxplot, the index of the observation may
 be identified in a subsequent plot in 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Rcmdr
\end_layout

\end_inset


\color inherit
 by clicking the 
\family sans
Identify outliers with mouse
\family default
 option in the 
\family sans
Boxplot
\family default
 dialog.
\end_layout

\begin_layout Standard
What do we do about outliers? They merit further investigation.
 The primary goal is to determine why the observation is outlying, if possible.
 If the observation is a typographical error, then it should be corrected
 before continuing.
 If the observation is from a subject that does not belong to the population
 of interest, then perhaps the datum should be removed.
 Otherwise, perhaps the value is hinting at some hidden structure to the
 data.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The quickest way to visually identify outliers is with a boxplot, described
 above.
 Another way is with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

boxplot.stats
\end_layout

\end_inset

 function.
\end_layout

\begin_layout Example
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rivers
\end_layout

\end_inset

 data.
 We will look for potential outliers in the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rivers
\end_layout

\end_inset

 data.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

boxplot.stats(rivers)$out
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We may change the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

coef
\end_layout

\end_inset


\color inherit
 argument to 3 (it is 1.5 by default) to identify suspected outliers.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

boxplot.stats(rivers, coef = 3)$out
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Subsection
Standardizing variables
\end_layout

\begin_layout Standard
It is sometimes useful to compare data sets with each other on a scale that
 is independent of the measurement units.
 Given a set of observed data 
\begin_inset Formula $x_{1}$
\end_inset

, 
\begin_inset Formula $x_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $x_{n}$
\end_inset

 we get 
\begin_inset Formula $z$
\end_inset

 scores, denoted 
\begin_inset Formula $z_{1}$
\end_inset

, 
\begin_inset Formula $z_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $z_{n}$
\end_inset

, by means of the following formula
\begin_inset Formula \[
z_{i}=\frac{x_{i}-\xbar}{s},\quad i=1,\,2,\,\ldots,\, n.\]

\end_inset


\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

scale
\end_layout

\end_inset

 
\color inherit
function will rescale a numeric vector (or data frame) by subtracting the
 sample mean from each value (column) and/or by dividing each observation
 by the sample standard deviation.
\end_layout

\begin_layout Section
Multivariate Data and Data Frames
\begin_inset CommandInset label
LatexCommand label
name "sec:multivariate-data"

\end_inset


\end_layout

\begin_layout Standard
We have had experience with vectors of data, which are long lists of numbers.
 Typically, each entry in the vector is a single measurement on a subject
 or experimental unit in the study.
 We saw in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Vectors"

\end_inset

 how to form vectors with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

c
\end_layout

\end_inset


\color inherit
 function or the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

scan
\end_layout

\end_inset


\color inherit
 function.
 
\end_layout

\begin_layout Standard
However, statistical studies often involve experiments where there are two
 (or more) measurements associated with each subject.
 We display the measured information in a rectangular array in which each
 row corresponds to a subject, and the columns contain the measurements
 for each respective variable.
 For instance, if one were to measure the height and weight and hair color
 of each of 11 persons in a research study, the information could be represented
 with a rectangular array.
 There would be 11 rows.
 Each row would have the person's height in the first column and hair color
 in the second column.
\end_layout

\begin_layout Standard
The corresponding objects in 
\family sans
R
\family default
 are called 
\emph on
data frames
\emph default
, and they can be constructed with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

data.frame
\end_layout

\end_inset


\color inherit
 function.
 Each row is an observation, and each column is a variable.
\end_layout

\begin_layout Example
Suppose we have two vectors 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

y
\end_layout

\end_inset


\color inherit
 and we want to make a data frame out of them.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x <- 5:8
\begin_inset Newline newline
\end_inset

y <- letters[3:6]
\begin_inset Newline newline
\end_inset

A <- data.frame(v1 = x, v2 = y)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Standard
Notice that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

y
\end_layout

\end_inset


\color inherit
 are the same length.
 This is 
\emph on
necessary
\emph default
.
 Also notice that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 is a numeric vector and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

y
\end_layout

\end_inset


\color inherit
 is a character vector.
 We may choose numeric and character vectors (or even factors) for the columns
 of the data frame, but each column must be of exactly one type.
 That is, we can have a column for 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

height
\end_layout

\end_inset


\color inherit
 and a column for 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

gender
\end_layout

\end_inset

, but we will get an error if we try to mix
\color inherit
 function 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

height
\end_layout

\end_inset

 (numeric)
\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

gender
\end_layout

\end_inset


\color inherit
 (character or factor) information in the same column.
\end_layout

\begin_layout Standard
Indexing of data frames is similar to indexing of vectors.
 To get the entry in row 
\begin_inset Formula $i$
\end_inset

 and column 
\begin_inset Formula $j$
\end_inset

 do 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

A[i,j]
\end_layout

\end_inset

.
 We can get entire rows and columns by omitting the other index.

\color inherit
 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

A[3,]
\begin_inset Newline newline
\end_inset

A[1, ]
\begin_inset Newline newline
\end_inset

A[ ,2]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
There are several things happening above.
 Notice that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

A[3,]
\end_layout

\end_inset

 gave a data frame (with the same entries as the third row of 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

A
\end_layout

\end_inset

) 
\color inherit
yet 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

A[1, ]
\end_layout

\end_inset

 is a numeric vector.
 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

A[ ,2]
\end_layout

\end_inset

 is a factor vector because the default setting for 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

data.frame
\end_layout

\end_inset

 is 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stringsAsFactors = TRUE
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
Data frames have a 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

names
\end_layout

\end_inset

 attribute and the names may be extracted with the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

names
\end_layout

\end_inset

 function.
 Once we have the names we may extract given columns by way of the dollar
 sign.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

names(A)
\begin_inset Newline newline
\end_inset

A$v1
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The above is identical to 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

A[ ,1]
\end_layout

\end_inset

.

\color inherit
 
\end_layout

\begin_layout Subsection
Bivariate Data
\begin_inset CommandInset label
LatexCommand label
name "sub:Bivariate-Data"

\end_inset


\end_layout

\begin_layout Itemize
Stacked bar charts
\end_layout

\begin_layout Itemize
odds ratio and relative risk
\end_layout

\begin_layout Itemize
Introduce the sample correlation coefficient.
\end_layout

\begin_layout Standard
The 
\series bold
sample Pearson product-moment 
\emph on
correlation coefficient
\series default
\emph default
:
\begin_inset Formula \[
r=\frac{\sum_{i=1}^{n}(x_{i}-\xbar)(y_{i}-\ybar)}{\sqrt{\sum_{i=1}^{n}(x_{i}-\xbar)}\sqrt{\sum_{i=1}^{n}(y_{i}-\ybar)}}\]

\end_inset


\end_layout

\begin_layout Itemize
independent of scale
\end_layout

\begin_layout Itemize
\begin_inset Formula $-1<r<1$
\end_inset


\end_layout

\begin_layout Itemize
measures 
\emph on
strength
\emph default
 and 
\emph on
direction
\emph default
 of linear association
\end_layout

\begin_layout Itemize
Two-Way Tables.
 Done with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

table
\end_layout

\end_inset


\color inherit
, or in the 
\family sans
R
\family default
 Commander by following 
\family sans
Statistics 
\begin_inset Formula $\triangleright$
\end_inset

 Contingency Tables 
\begin_inset Formula $\triangleright$
\end_inset


\family default
 
\family sans
Two-way Tables
\family default
.
 You can also enter and analyze a two-way table.
\end_layout

\begin_deeper
\begin_layout Itemize
table
\end_layout

\begin_layout Itemize
prop.table
\end_layout

\begin_layout Itemize
addmargins
\end_layout

\begin_layout Itemize
rowPercents (Rcmdr)
\end_layout

\begin_layout Itemize
colPercents (Rcmdr)
\end_layout

\begin_layout Itemize
totPercents(Rcmdr)
\end_layout

\begin_layout Itemize
A <- xtabs(~ gender + race, data = RcmdrTestDrive)
\end_layout

\begin_layout Itemize
xtabs( Freq ~ Class + Sex, data = Titanic) # from built in table
\end_layout

\begin_layout Itemize
barplot(A, legend.text=TRUE) 
\end_layout

\begin_layout Itemize
barplot(t(A), legend.text=TRUE) 
\end_layout

\begin_layout Itemize
barplot(A, legend.text=TRUE, beside = TRUE)
\end_layout

\begin_layout Itemize
spineplot(gender ~ race, data = RcmdrTestDrive)
\end_layout

\begin_layout Itemize
Spine plot: plots categorical versus categorical
\end_layout

\end_deeper
\begin_layout Itemize
Scatterplot: look for linear association and correlation.
 
\end_layout

\begin_deeper
\begin_layout Itemize
carb ~ optden, data = Formaldehyde (boring)
\end_layout

\begin_layout Itemize
conc ~ rate, data = Puromycin
\end_layout

\begin_layout Itemize
xyplot(accel ~ dist, data = attenu) nonlinear association
\end_layout

\begin_layout Itemize
xyplot(eruptions ~ waiting, data = faithful) (linear, two groups)
\end_layout

\begin_layout Itemize
xyplot(Petal.Width ~ Petal.Length, data = iris)
\end_layout

\begin_layout Itemize
xyplot(pressure ~ temperature, data = pressure) (exponential growth)
\end_layout

\begin_layout Itemize
xyplot(weight ~ height, data = women) (strong positive linear)
\end_layout

\end_deeper
\begin_layout Subsection
Multivariate Data
\begin_inset CommandInset label
LatexCommand label
name "sub:Multivariate-Data"

\end_inset


\end_layout

\begin_layout Standard
Multivariate Data Display
\end_layout

\begin_layout Itemize
Multi-Way Tables.
 You can do this with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

table
\end_layout

\end_inset


\color inherit
, or in 
\family sans
R
\family default
 Commander by following 
\family sans
Statistics
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset


\family default
 
\family sans
Contingency Tables
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset


\family default
 
\family sans
Multi-way Tables
\family default
.
\end_layout

\begin_layout Itemize
Scatterplot matrix.
 used for displaying pairwise scatterplots simultaneously.
 Again, look for linear association and correlation.
\end_layout

\begin_layout Itemize
3D Scatterplot.
 See Figure 
\begin_inset CommandInset ref
LatexCommand pageref
reference "fig:3D-scatterplot-trees"

\end_inset


\end_layout

\begin_layout Itemize

\color none
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

plot(state.region, state.division)
\end_layout

\end_inset


\color inherit
 
\end_layout

\begin_layout Itemize

\color none
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

barplot(table(state.division,state.region), legend.text=TRUE)
\end_layout

\end_inset


\end_layout

\begin_layout Section
Comparing Populations
\begin_inset CommandInset label
LatexCommand label
name "sec:Comparing-Data-Sets"

\end_inset


\end_layout

\begin_layout Standard
Sometimes we have data from two or more groups (or populations) and we would
 like to compare them and draw conclusions.
 Some issues that we would like to address:
\end_layout

\begin_layout Itemize
Comparing centers and spreads: variation within versus between groups
\end_layout

\begin_layout Itemize
Comparing clusters and gaps
\end_layout

\begin_layout Itemize
Comparing outliers and unusual features
\end_layout

\begin_layout Itemize
Comparing shapes.
\end_layout

\begin_layout Subsection
Numerically
\end_layout

\begin_layout Standard
I am thinking here about the 
\family sans
Statistics
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset


\family default
 
\family sans
Numerical Summaries
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset

 Summarize by groups
\family default
 option or the 
\family sans
Statistics
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset


\family default
 
\family sans
Summaries
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset

Table of Statistics
\family default
 option.
 
\end_layout

\begin_layout Subsection
Graphically
\end_layout

\begin_layout Itemize
Boxplots
\end_layout

\begin_deeper
\begin_layout Itemize
Variable width: the width of the drawn boxplots are proportional to 
\begin_inset Formula $\sqrt{n_{i}}$
\end_inset

, where 
\begin_inset Formula $n_{i}$
\end_inset

 is the size of the 
\begin_inset Formula $i^{\text{th}}$
\end_inset

 group.
 Why? Because many statistics have variability proportional to the reciprocal
 of the square root of the sample size.
\end_layout

\begin_layout Itemize
Notches: extend to 
\begin_inset Formula $1.58\cdot(h_{U}-h_{L})/\sqrt{n}$
\end_inset

.
 The idea is to give roughly a 95% confidence interval for the difference
 in two medians.
 See Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Hypothesis-Testing"

\end_inset

.
\end_layout

\end_deeper
\begin_layout Itemize
Stripcharts
\end_layout

\begin_deeper
\begin_layout Itemize
stripchart(weight ~ feed, method="stack", data=chickwts)
\end_layout

\end_deeper
\begin_layout Itemize
Bar Graphs
\end_layout

\begin_deeper
\begin_layout Itemize
barplot(xtabs(Freq ~ Admit + Gender, data = UCBAdmissions)) # stacked bar
 chart
\end_layout

\begin_layout Itemize
barplot(xtabs(Freq ~ Admit, data = UCBAdmissions))
\end_layout

\begin_layout Itemize
barplot(xtabs(Freq ~ Gender + Admit, data = UCBAdmissions), legend = TRUE,
 beside = TRUE) # oops, discrimination.
\end_layout

\begin_layout Itemize
barplot(xtabs(Freq ~ Admit+Dept, data = UCBAdmissions), legend = TRUE, beside
 = TRUE) # different departments have different standards
\end_layout

\begin_layout Itemize
barplot(xtabs(Freq ~ Gender+Dept, data = UCBAdmissions), legend = TRUE,
 beside = TRUE) # men mostly applied to easy departments, women mostly applied
 to difficult departments
\end_layout

\begin_layout Itemize
barplot(xtabs(Freq ~ Gender+Dept, data = UCBAdmissions), legend = TRUE,
 beside = TRUE)
\end_layout

\begin_layout Itemize
barchart(Admit ~ Freq, data = C)
\end_layout

\begin_layout Itemize
barchart(Admit ~ Freq|Gender, data = C)
\end_layout

\begin_layout Itemize
barchart(Admit ~ Freq | Dept, groups = Gender, data = C)
\end_layout

\begin_layout Itemize
barchart(Admit ~ Freq | Dept, groups = Gender, data = C, auto.key = TRUE)
\end_layout

\end_deeper
\begin_layout Itemize
Histograms
\end_layout

\begin_deeper
\begin_layout Itemize
~ breaks | wool*tension, data = warpbreaks
\end_layout

\begin_layout Itemize
~ weight | feed, data = chickwts
\end_layout

\begin_layout Itemize
~ weight | group, data = PlantGrowth 
\end_layout

\begin_layout Itemize
~ count | spray, data = InsectSprays
\end_layout

\begin_layout Itemize
~ len | dose, data = ToothGrowth
\end_layout

\begin_layout Itemize
~ decrease | treatment, data = OrchardSprays (or rowpos or colpos)
\end_layout

\end_deeper
\begin_layout Itemize
Scatterplots
\end_layout

\begin_deeper
\begin_layout Itemize
xyplot(Petal.Width ~ Petal.Length, data = iris, group = Species)
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

library(lattice)
\begin_inset Newline newline
\end_inset

xyplot()
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Itemize
Scatterplot matrices
\end_layout

\begin_deeper
\begin_layout Itemize
splom(~ cbind(GNP.deflator,GNP,Unemployed,Armed.Forces,Population,Year,Employed),
 data = longley)
\end_layout

\begin_layout Itemize
splom(~ cbind(pop15,pop75,dpi), data = LifeCycleSavings)
\end_layout

\begin_layout Itemize
splom(~ cbind(Murder, Assault, Rape), data = USArrests)
\end_layout

\begin_layout Itemize
splom(~ cbind(CONT, INTG, DMNR), data = USJudgeRatings)
\end_layout

\begin_layout Itemize
splom(~ cbind(area,peri,shape,perm), data = rock)
\end_layout

\begin_layout Itemize
splom(~ cbind(Air.Flow, Water.Temp, Acid.Conc., stack.loss), data = stackloss)
\end_layout

\begin_layout Itemize
splom(~ cbind(Fertility,Agriculture,Examination,Education,Catholic,Infant.Mortali
ty), data = swiss)
\end_layout

\begin_layout Itemize
splom(~ cbind(Fertility,Agriculture,Examination), data = swiss) (positive
 and negative)
\end_layout

\end_deeper
\begin_layout Itemize
Dot charts
\end_layout

\begin_deeper
\begin_layout Itemize
dotchart(USPersonalExpenditure)
\end_layout

\begin_layout Itemize
dotchart(t(USPersonalExpenditure))
\end_layout

\begin_layout Itemize
dotchart(WorldPhones) (transpose is no good)
\end_layout

\begin_layout Itemize
freeny.x is no good, neither is volcano
\end_layout

\begin_layout Itemize
dotchart(UCBAdmissions[,,1])
\end_layout

\begin_layout Itemize
dotplot(Survived ~ Freq | Class, groups = Sex, data = B)
\end_layout

\begin_layout Itemize
dotplot(Admit ~ Freq | Dept, groups = Gender, data = C)
\end_layout

\end_deeper
\begin_layout Itemize
Mosaic plot
\end_layout

\begin_deeper
\begin_layout Itemize
mosaic(~ Survived + Class + Age + Sex, data = Titanic) (or just mosaic(Titanic))
\end_layout

\begin_layout Itemize
mosaic(~ Admit + Dept + Gender, data = UCBAdmissions)
\end_layout

\end_deeper
\begin_layout Itemize
Spine plots
\end_layout

\begin_deeper
\begin_layout Itemize
spineplot(xtabs(Freq ~ Admit + Gender, data = UCBAdmissions)) # rescaled
 barplot
\end_layout

\end_deeper
\begin_layout Itemize
Quantile-quantile plots: There are two ways to do this.
 One way is to compare two independent samples (of the same size).
 qqplot(x,y).
 Another way is to compare the sample quantiles of one variable to the theoretic
al quantiles of another distribution.
\end_layout

\begin_layout Standard
Given two samples 
\begin_inset Formula $\left\{ x_{1},\, x_{2},\,\ldots,\, x_{n}\right\} $
\end_inset

 and 
\begin_inset Formula $\left\{ y_{1},\, y_{2},\,\ldots,\, y_{n}\right\} $
\end_inset

, we may find the order statistics 
\begin_inset Formula $x_{(1)}\leq x_{(2)}\leq\cdots\leq x_{(n)}$
\end_inset

 and 
\begin_inset Formula $y_{(1)}\leq y_{(2)}\leq\cdots\leq y_{(n)}$
\end_inset

.
 Next, plot the 
\begin_inset Formula $n$
\end_inset

 points 
\begin_inset Formula $(x_{(1)},y_{(1)})$
\end_inset

, 
\begin_inset Formula $(x_{(2)},y_{(2)})$
\end_inset

 ,\SpecialChar \ldots{}
,
\begin_inset Formula $(x_{(n)},y_{(n)})$
\end_inset

.
\end_layout

\begin_layout Standard
It is clear that if 
\begin_inset Formula $x_{(k)}=y_{(k)}$
\end_inset

 for all 
\begin_inset Formula $k=1,2,\ldots,n$
\end_inset

, then we will have a straight line.
 It is also clear that in the real world, a straight line is NEVER observed,
 and instead we have a scatterplot that hopefully had a general linear trend.
 What do the rules tell us?
\end_layout

\begin_layout Itemize
If the 
\begin_inset Formula $y$
\end_inset

-intercept of the line is greater (less) than zero, then the center of the
 
\begin_inset Formula $Y$
\end_inset

 data is greater (less) than the center of the 
\begin_inset Formula $X$
\end_inset

 data.
\end_layout

\begin_layout Itemize
If the slope of the line is greater (less) than one, then the spread of
 the 
\begin_inset Formula $Y$
\end_inset

 data is greater (less) than the spread of the 
\begin_inset Formula $X$
\end_inset

 data..
\end_layout

\begin_layout Subsection
Lattice Graphics
\begin_inset CommandInset label
LatexCommand label
name "sub:Lattice-Graphics"

\end_inset


\end_layout

\begin_layout Standard
The following types of plots are useful when there is one variable of interest
 and there is a factor in the data set by which the variable is categorized.
 
\end_layout

\begin_layout Standard
It is sometimes nice to set 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lattice.options(default.theme = "col.whitebg")
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*
Side by side boxplots
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

library(lattice)
\begin_inset Newline newline
\end_inset

bwplot(~weight | feed, data = chickwts)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 4>>=
\begin_inset Newline newline
\end_inset

library(lattice)
\begin_inset Newline newline
\end_inset

print(bwplot(~ weight | feed, data = chickwts))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Boxplots of 
\family typewriter
weight
\family default
 by 
\family typewriter
feed
\family default
 type in the 
\family typewriter
chickwts
\family default
 data
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Scrap

\end_layout

\begin_layout Paragraph*
Histograms
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

histogram(~age | education, data = infert)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 4>>=
\begin_inset Newline newline
\end_inset

library(lattice)
\begin_inset Newline newline
\end_inset

print(histogram(~age | education, data = infert))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Histograms of 
\family typewriter
age
\family default
 by 
\family typewriter
education
\family default
 level from the 
\family typewriter
infert
\family default
 data
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*
Scatterplots
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

xyplot(Petal.Length ~ Petal.Width | Species, data = iris)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 4>>=
\begin_inset Newline newline
\end_inset

library(lattice)
\begin_inset Newline newline
\end_inset

print(xyplot(Petal.Length ~ Petal.Width | Species, data = iris))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
An 
\family typewriter
xyplot
\family default
 of 
\family typewriter
Petal.Length
\family default
 versus 
\family typewriter
Petal.Width
\family default
 by 
\family typewriter
Species
\family default
 in the 
\family typewriter
iris
\family default
 data
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*
Coplots
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

coplot(conc ~ uptake | Type * Treatment, data = CO2)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 4>>=
\begin_inset Newline newline
\end_inset

library(lattice)
\begin_inset Newline newline
\end_inset

print(coplot(conc ~ uptake | Type * Treatment, data = CO2))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
A 
\family typewriter
coplot
\family default
 of 
\family typewriter
conc
\family default
 versus 
\family typewriter
uptake
\family default
 by 
\family typewriter
Type
\family default
 and 
\family typewriter
Treatment
\family default
 in the 
\family typewriter
CO2
\family default
 data
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Chapter Exercises
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{section}{Chapter Exercises}
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{thm}{0}
\end_layout

\end_inset


\end_layout

\begin_layout Paragraph*

\series bold
Directions:
\series default
 
\end_layout

\begin_layout Standard
Open 
\family sans
R
\family default
 and issue the following commands at the command line to get started.
 Note that you need to have the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

RcmdrPlugin.IPSUR
\end_layout

\end_inset


\color inherit
 package installed, and for some exercises you need the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

e1071
\end_layout

\end_inset


\color inherit
 package.
\end_layout

\begin_layout LyX-Code

\family typewriter
library(RcmdrPlugin.IPSUR)
\begin_inset Newline newline
\end_inset

data(RcmdrTestDrive) 
\begin_inset Newline newline
\end_inset

attach(RcmdrTestDrive) 
\begin_inset Newline newline
\end_inset

names(RcmdrTestDrive)  # shows names of variables
\end_layout

\begin_layout Scrap
<<echo = FALSE, results = hide>>=
\begin_inset Newline newline
\end_inset

attach(RcmdrTestDrive)
\begin_inset Newline newline
\end_inset

names(RcmdrTestDrive)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
To load the data in the 
\family sans
R
\family default
 Commander (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Rcmdr
\end_layout

\end_inset


\color inherit
), click the 
\family sans
Data Set
\family default
 button, and select 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

RcmdrTestDrive
\end_layout

\end_inset


\color inherit
 as the active data set.
 To learn more about the data set and where it comes from, type 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?RcmdrTestDrive
\end_layout

\end_inset


\color inherit
 at the command line.
\end_layout

\begin_layout Exercise
\begin_inset CommandInset label
LatexCommand label
name "xca:summary-RcmdrTestDrive"

\end_inset

Perform a summary of all variables in 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

RcmdrTestDrive
\end_layout

\end_inset


\color inherit
.
 You can do this with the command
\color none
 
\begin_inset listings
lstparams "showstringspaces=false"
inline false
status open

\begin_layout Plain Layout

summary(RcmdrTestDrive)
\end_layout

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
Alternatively, you can do this in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Rcmdr
\end_layout

\end_inset


\color inherit
 with the sequence 
\family sans
Statistics
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset

 Summaries
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset

 Active Data Set
\family default
.
 Report the values of the summary statistics for each variable.
\end_layout

\end_deeper
\begin_layout Exercise
\begin_inset Branch answers
status open

\begin_layout Paragraph*
Answer:
\end_layout

\begin_layout Scrap
<<"Find summary statistics">>=
\begin_inset Newline newline
\end_inset

summary(RcmdrTestDrive)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Exercise
Make a table of the 
\emph on
race
\emph default
 variable.
 Do this with 
\family sans
Statistics
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset

 Summaries
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset

 IPSUR - Frequency Distributions
\family default
\emph on
...
\end_layout

\begin_deeper
\begin_layout Enumerate
Which ethnicity has the highest frequency?
\end_layout

\begin_layout Enumerate
Which ethnicity has the lowest frequency?
\end_layout

\begin_layout Enumerate
Include a bar graph of 
\emph on
race
\emph default
.
 Do this with 
\family sans
Graphs
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset


\family default
 
\family sans
IPSUR - Bar Graph
\family default
...
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Branch solutions
status open

\begin_layout Paragraph*
Solution:
\end_layout

\begin_layout Standard
First we will make a table of the 
\emph on
race
\emph default
 variable with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

table
\end_layout

\end_inset


\color inherit
 function.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

table(race)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Enumerate
For these data, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{names(table(race))[which(table(race)==max(table(race)))]}
\end_layout

\end_inset

 has the highest frequency.
\end_layout

\begin_layout Enumerate
For these data, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{names(table(race))[which(table(race)==min(table(race)))]}
\end_layout

\end_inset

 has the lowest frequency.
\end_layout

\begin_layout Enumerate
The graph is shown below.
\end_layout

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 6>>=
\begin_inset Newline newline
\end_inset

barplot(table(RcmdrTestDrive$race), main="", xlab="race", ylab="Frequency",
 legend.text=FALSE, col=NULL) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Exercise
Calculate the average 
\emph on
salary
\emph default
 by the factor 
\emph on
gender
\emph default
.
 Do this with 
\family sans
Statistics
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset

 Summaries
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset

 Table of Statistics
\family default
\emph on
...
\end_layout

\begin_deeper
\begin_layout Enumerate
Which 
\emph on
gender
\emph default
 has the highest mean 
\emph on
salary
\emph default
? 
\end_layout

\begin_layout Enumerate
Report the highest mean 
\emph on
salary
\emph default
.
\end_layout

\begin_layout Enumerate
Compare the spreads for the genders by calculating the standard deviation
 of 
\emph on
salary
\emph default
 by 
\emph on
gender
\emph default
.
 Which 
\emph on
gender
\emph default
 has the biggest standard deviation?
\end_layout

\begin_layout Enumerate
Make boxplots of 
\emph on
salary
\emph default
 by 
\emph on
gender
\emph default
 with the following method:
\end_layout

\begin_deeper
\begin_layout Quote
On the
\color none
 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Rcmdr
\end_layout

\end_inset


\color inherit
, click 
\family sans
Graphs
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset


\family default
 
\family sans
IPSUR - Boxplot
\family default
...
\begin_inset Newline newline
\end_inset

In the 
\family sans
Variable
\family default
 box, select 
\emph on
salar
\emph default
y.
\begin_inset Newline newline
\end_inset

Click the 
\family sans
Plot by groups
\family default
...
 box and select 
\emph on
gender
\emph default
.
 Click 
\family sans
OK
\family default
.
\begin_inset Newline newline
\end_inset

Click 
\family sans
OK
\family default
 to graph the boxplot.
\end_layout

\begin_layout Standard
How does the boxplot compare to your answers to (1) and (3)?
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
\noindent
\begin_inset Branch solutions
status open

\begin_layout Paragraph*
Solution:
\end_layout

\begin_layout Standard
We can generate a table listing the average salaries by gender with two
 methods.
 The first uses 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

tapply
\end_layout

\end_inset

:
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

x <- tapply(salary, list(gender = gender), mean)
\begin_inset Newline newline
\end_inset

x
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The second method uses the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

by
\end_layout

\end_inset


\color inherit
 function:
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

by(salary, gender, mean, na.rm = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Now to answer the questions:
\end_layout

\begin_layout Enumerate
Which gender has the highest mean salary? 
\end_layout

\begin_deeper
\begin_layout Standard
We can answer this by looking above.
 For these data, the gender with the highest mean salary is 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{names(x)[which(x==max(x))]}
\end_layout

\end_inset

.
\end_layout

\end_deeper
\begin_layout Enumerate
Report the highest mean salary.
\end_layout

\begin_deeper
\begin_layout Standard
Depending on our answer above, we would do something like 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline false
status open

\begin_layout Plain Layout

mean(salary[gender == 
\begin_inset Quotes eld
\end_inset

Male
\begin_inset Quotes erd
\end_inset

])
\end_layout

\end_inset

 for example.
 For these data, the highest mean 
\color inherit
salary
\color none
 is 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x[which(x==max(x))]
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
Compare the spreads for the genders by calculating the standard deviation
 of 
\emph on
salary
\emph default
 by 
\emph on
gender
\emph default
.
 Which gender has the biggest standard deviation?
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

y <- tapply(salary, list(gender = gender), sd)
\begin_inset Newline newline
\end_inset

y
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
For these data, the the largest standard deviation is approximately 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(y[which(y==max(y))],2)}
\end_layout

\end_inset

 which was attained by the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{names(y)[which(y==max(y))]}
\end_layout

\end_inset

 gender.
\end_layout

\end_deeper
\begin_layout Enumerate
Make boxplots of 
\emph on
salary
\emph default
 by 
\emph on
gender
\emph default
.
 How does the boxplot compare to your answers to (1) and (3)?
\end_layout

\begin_deeper
\begin_layout Standard
The graph is shown below.
\end_layout

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

boxplot(salary~gender, xlab="salary", ylab="gender", main="", notch=FALSE,
 varwidth=TRUE, horizontal=TRUE, data=RcmdrTestDrive) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Answers will vary.
 There should be some remarks that the center of the box is farther to the
 right for the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{names(x)[which(x==max(x))]}
\end_layout

\end_inset

 gender, and some recognition that the box is wider for the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{names(y)[which(y==max(y))]}
\end_layout

\end_inset

 gender.
\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Exercise
For this problem we will study the variable 
\emph on
reduction
\emph default
.
\end_layout

\begin_deeper
\begin_layout Enumerate
Find the order statistics and store them in a vector 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
.
 
\emph on
Hint: 
\emph default
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x <- sort(reduction)
\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
Find 
\begin_inset Formula $x_{(137)}$
\end_inset

, the 137
\begin_inset Formula $^{\text{th}}$
\end_inset

 order statistic.
\end_layout

\begin_layout Enumerate
Find the IQR.
\end_layout

\begin_layout Enumerate
Find the Five Number Summary (5NS).
\end_layout

\begin_layout Enumerate
Use the 5NS to calculate what the width of a boxplot of 
\emph on
reduction
\emph default
 would be.
\end_layout

\begin_layout Enumerate
Compare your answers (3) and (5).
 Are they the same? If not, are they close?
\end_layout

\begin_layout Enumerate
Make a boxplot of 
\emph on
reduction
\emph default
, and include the boxplot in your report.
 You can do this with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

boxplot
\end_layout

\end_inset

 
\color inherit
function, or in
\color none
 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Rcmdr
\end_layout

\end_inset


\color inherit
 with 
\family sans
Graphs
\family default
 
\family sans

\begin_inset Formula $\triangleright$
\end_inset


\family default
 
\family sans
IPSUR - Boxplot
\family default
...
\end_layout

\begin_layout Enumerate
Are there any potential/suspected outliers? If so, list their values.
 
\emph on
Hint:
\emph default
 use your answer to (a).
\end_layout

\begin_layout Enumerate
Using the rules discussed in the text, classify answers to (8), if any,
 as 
\emph on
potential
\emph default
 or 
\emph on
suspected
\emph default
 outliers.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Branch answers
status open

\begin_layout Paragraph*
Answers:
\end_layout

\begin_layout Scrap
<<echo = FALSE, results = hide>>=
\begin_inset Newline newline
\end_inset

x = sort(reduction)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x[137]
\begin_inset Newline newline
\end_inset

IQR(x)
\begin_inset Newline newline
\end_inset

fivenum(x)
\begin_inset Newline newline
\end_inset

fivenum(x)[4] - fivenum(x)[2]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\noindent
Compare your answers (3) and (5).
 Are they the same? If not, are they close?
\end_layout

\begin_layout Standard
Yes, they are close, within 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{abs(IQR(x)-(fivenum(x)[4] - fivenum(x)[2]))}
\end_layout

\end_inset

 of each other.
\end_layout

\begin_layout Standard
\noindent
The boxplot of 
\emph on
reduction
\emph default
 is below.
\end_layout

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 6>>=
\begin_inset Newline newline
\end_inset

boxplot(reduction, xlab="reduction", main="", notch=FALSE, varwidth=TRUE,
 horizontal=TRUE, data=RcmdrTestDrive) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

temp <- fivenum(x)
\begin_inset Newline newline
\end_inset

inF <- 1.5 * (temp[4] - temp[2]) + temp[4]
\begin_inset Newline newline
\end_inset

outF <- 3 * (temp[4] - temp[2]) + temp[4]
\begin_inset Newline newline
\end_inset

which(x > inF)
\begin_inset Newline newline
\end_inset

which(x > outF)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Observations 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{which(x > inF)}
\end_layout

\end_inset

 would be considered potential outliers, while observation(s) 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{which(x > outF)}
\end_layout

\end_inset

 would be considered a suspected outlier.
\end_layout

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Exercise
In this problem we will compare the variables 
\emph on
before
\emph default
 and 
\emph on
after
\emph default
.
 Don't forget 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

library(e1071)
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_deeper
\begin_layout Enumerate
Examine the two measures of center for both variables.
 Judging from these measures, which variable has a higher center?
\end_layout

\begin_layout Enumerate
Which measure of center is more appropriate for 
\emph on
before
\emph default
? (You may want to look at a boxplot.) Which measure of center is more appropriat
e for 
\emph on
after
\emph default
?
\end_layout

\begin_layout Enumerate
Based on your answer to (2), choose an appropriate measure of spread for
 each variable, calculate it, and report its value.
 Which variable has the biggest spread? (Note that you need to make sure
 that your measures are on the same scale.) 
\end_layout

\begin_layout Enumerate
Calculate and report the skewness and kurtosis for 
\emph on
before
\emph default
.
 Based on these values, how would you describe the shape of 
\emph on
before
\emph default
?
\end_layout

\begin_layout Enumerate
Calculate and report the skewness and kurtosis for 
\emph on
after
\emph default
.
 Based on these values, how would you describe the shape of 
\emph on
after
\emph default
?
\end_layout

\begin_layout Enumerate
Plot histograms of 
\emph on
before
\emph default
 and 
\emph on
after
\emph default
 and compare them to your answers to (4) and (5).
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Branch solutions
status open

\begin_layout Paragraph*
Solution:
\end_layout

\begin_layout Enumerate
Examine the two measures of center for both variables that you found in
 problem 1.
 Judging from these measures, which variable has a higher center?
\end_layout

\begin_deeper
\begin_layout Standard
We may take a look at the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary(RcmdrTestDrive)
\end_layout

\end_inset

 output from Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:summary-RcmdrTestDrive"

\end_inset

.
 Here we will repeat the relevant summary statistics.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

c(mean(before), median(before))
\begin_inset Newline newline
\end_inset

c(mean(after), median(after))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The idea is to look at the two measures and compare them to make a decision.
 In a nice world, both the mean and median of one variable will be larger
 than the other which sends a nice message.
 If We get a mixed message, then we should look for other information, such
 as extreme values in one of the variables, which is one of the reasons
 for the next part of the problem.
\end_layout

\end_deeper
\begin_layout Enumerate
Which measure of center is more appropriate for 
\emph on
before
\emph default
? (You may want to look at a boxplot.) Which measure of center is more appropriat
e for 
\emph on
after
\emph default
?
\end_layout

\begin_deeper
\begin_layout Standard
The boxplot of 
\emph on
before
\emph default
 is shown below.
\end_layout

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

boxplot(before, xlab="before", main="", notch=FALSE, varwidth=TRUE, horizontal=T
RUE, data=RcmdrTestDrive) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We want to watch out for extreme values (shown as circles separated from
 the box) or large departures from symmetry.
 If the distribution is fairly symmetric then the mean and median should
 be approximately the same.
 But if the distribution is highly skewed with extreme values then we should
 be skeptical of the sample mean, and fall back to the median which is resistant
 to extremes.
 By design, the before variable is set up to have a fairly symmetric distributio
n.
\end_layout

\begin_layout Standard
A boxplot of 
\emph on
after
\emph default
 is shown next.
\end_layout

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

boxplot(after, xlab="after", notch=FALSE, varwidth=TRUE, horizontal=TRUE,
 data=RcmdrTestDrive) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The same remarks apply to the 
\emph on
after
\emph default
 variable.
 The 
\emph on
after
\emph default
 variable has been designed to be left-skewed\SpecialChar \ldots{}
 thus, the median would likely
 be a good choice for this variable.
\end_layout

\end_deeper
\begin_layout Enumerate
Based on your answer to (2), choose an appropriate measure of spread for
 each variable, calculate it, and report its value.
 Which variable has the biggest spread? (Note that you need to make sure
 that your measures are on the same scale.) 
\end_layout

\begin_deeper
\begin_layout Standard
Since 
\emph on
before
\emph default
 has a symmetric, mound shaped distribution, an excellent measure of center
 would be the sample standard deviation.
 And since 
\emph on
after
\emph default
 is left-skewed, we should use the median absolute deviation.
 It is also acceptable to use the IQR, but we should rescale it appropriately,
 namely, by dividing by 1.349.
 The exact values are shown below.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

sd(before)
\begin_inset Newline newline
\end_inset

mad(after)
\begin_inset Newline newline
\end_inset

IQR(after)/1.349
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Judging from the values above, we would decide which variable has the higher
 spread.
 Look at how close the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mad
\end_layout

\end_inset

 and the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IQR
\end_layout

\end_inset

 (after suitable rescaling) are; it goes to show why the rescaling is important.
\end_layout

\end_deeper
\begin_layout Enumerate
Calculate and report the skewness and kurtosis for 
\emph on
before
\emph default
.
 Based on these values, how would you describe the shape of 
\emph on
before
\emph default
?
\end_layout

\begin_deeper
\begin_layout Standard
The values of these descriptive measures are shown below.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(e1071)
\begin_inset Newline newline
\end_inset

skewness(before)
\begin_inset Newline newline
\end_inset

kurtosis(before)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We should take the sample skewness value and compare it to 
\begin_inset Formula $2\sqrt{6/n}\approx$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(2*sqrt(6/length(before)),3)}
\end_layout

\end_inset

 in absolute value to see if it is substantially different from zero.
 The direction of skewness is decided by the sign (positive or negative)
 of the skewness value.
 
\end_layout

\begin_layout Standard
We should take the sample kurtosis value and compare it to 
\begin_inset Formula $2\cdot\sqrt{24/168}\approx$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(4*sqrt(6/length(before)),3)}
\end_layout

\end_inset

), in absolute value to see if the excess kurtosis is substantially different
 from zero.
 And take a look at the sign to see whether the distribution is platykurtic
 or leptokurtic.
\end_layout

\end_deeper
\begin_layout Enumerate
Calculate and report the skewness and kurtosis for 
\emph on
after
\emph default
.
 Based on these values, how would you describe the shape of 
\emph on
after
\emph default
?
\end_layout

\begin_deeper
\begin_layout Standard
The values of these descriptive measures are shown below.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

skewness(after)
\begin_inset Newline newline
\end_inset

kurtosis(after)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We should do for this one just like we did previously.
 We would again compare the sample skewness and kurtosis values (in absolute
 value) to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(2*sqrt(6/length(after)),3)}
\end_layout

\end_inset

 and 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(4*sqrt(6/length(after)),3)}
\end_layout

\end_inset

, respectively.
\end_layout

\end_deeper
\begin_layout Enumerate
Plot histograms of 
\emph on
before
\emph default
 and 
\emph on
after
\emph default
 and compare them to your answers to (4) and (5).
\end_layout

\begin_deeper
\begin_layout Standard
The graphs are shown below.
\end_layout

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

hist(before, xlab="before", data=RcmdrTestDrive) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

hist(after, xlab="after", data=RcmdrTestDrive) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Answers will vary.
 We are looking for visual consistency in the histograms to our statements
 above.
\end_layout

\end_deeper
\end_inset


\end_layout

\begin_layout Exercise
Describe the following data sets just as if you were communicating with
 an alien, but one who has had a statistics class.
 Mention the salient features (data type, important properties, anything
 special).
 Support your answers with the appropriate visual displays and descriptive
 statistics.
\end_layout

\begin_deeper
\begin_layout Enumerate
Conversion rates of Euro currencies stored in 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

euro
\end_layout

\end_inset

.
\end_layout

\begin_layout Enumerate
State abbreviations stored in 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

state.abb
\end_layout

\end_inset

.
\end_layout

\end_deeper
\begin_layout Chapter
Probability
\begin_inset CommandInset label
LatexCommand label
name "cha:Probability"

\end_inset


\end_layout

\begin_layout Standard
\noindent
In this chapter we define the basic terminology associated with probability
 and derive some of its properties.
 We discuss three interpretations of probability.
 We discuss conditional probability and independent events, along with Bayes'
 Theorem.
 We finish the chapter with an introduction to random variables, which paves
 the way for the next two chapters.
\end_layout

\begin_layout Standard
In this book we distinguish between two types of experiments: 
\emph on
deterministic
\emph default
 and 
\emph on
random
\emph default
.
 A 
\emph on
deterministic
\emph default
 experiment is one whose outcome may be predicted with certainty beforehand,
 such as combining Hydrogen and Oxygen, or adding two numbers such as 
\begin_inset Formula $2+3$
\end_inset

.
 A 
\emph on
random
\emph default
 experiment is one whose outcome is determined by chance.
 We posit that the outcome of a random experiment may not be predicted with
 certainty beforehand, even in principle.
 Examples of random experiments include tossing a coin, rolling a die, and
 throwing a dart on a board, how many red lights you encounter on the drive
 home, how many ants traverse a certain patch of sidewalk over a short period,
 
\emph on
etc
\emph default
.
\end_layout

\begin_layout Paragraph*
What do I want them to know?
\end_layout

\begin_layout Itemize
that there are multiple interpretations of probability, and the methods
 used depend somewhat on the philosophy chosen
\end_layout

\begin_layout Itemize
nuts and bolts of basic probability jargon: sample spaces, events, probability
 functions, 
\emph on
etc
\emph default
.
\end_layout

\begin_layout Itemize
how to count
\end_layout

\begin_layout Itemize
conditional probability and its relationship with independence
\end_layout

\begin_layout Itemize
Bayes' Rule and how it relates to the subjective view of probability
\end_layout

\begin_layout Itemize
what we mean by 'random variables', and where they come from
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig = TRUE, width = 4.5, height = 2.75>>=
\begin_inset Newline newline
\end_inset

require(diagram)
\begin_inset Newline newline
\end_inset

par(mex = 0.2, cex = 0.5)
\begin_inset Newline newline
\end_inset

openplotmat(frame.plot=TRUE)
\begin_inset Newline newline
\end_inset

straightarrow(from = c(0.46,0.74), to = c(0.53,0.71), arr.pos = 1)
\begin_inset Newline newline
\end_inset

straightarrow(from = c(0.3,0.65), to = c(0.3,0.51), arr.pos = 1)
\begin_inset Newline newline
\end_inset

textellipse(mid = c(0.74,0.55), box.col = grey(0.95), radx = 0.24, rady = 0.22,
 lab = c(expression(bold(underline(DETERMINISTIC))), expression(2*H[2]+O[2]
 %->% H[2]*O), "3 + 4 = 7"), cex = 2 )
\begin_inset Newline newline
\end_inset

textrect(mid = c(0.3, 0.75), radx = 0.15, rady = 0.1, lab = c("Experiments"),
 cex = 2 )
\begin_inset Newline newline
\end_inset

textellipse(mid = c(0.29,0.25), box.col = grey(0.95), radx = 0.27, rady = 0.22,
 lab = c(expression(bold(underline(RANDOM))), "toss coin, roll die", "count
 ants on sidewalk", "measure rainfall" ), cex = 2 )
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Two types of experiments
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Sample Spaces
\begin_inset CommandInset label
LatexCommand label
name "sec:Sample-Spaces"

\end_inset


\end_layout

\begin_layout Standard
For a random experiment 
\begin_inset Formula $E$
\end_inset

, the set of all possible outcomes of 
\begin_inset Formula $E$
\end_inset

 is called the 
\emph on
sample space
\begin_inset Index
status open

\begin_layout Plain Layout
sample space
\end_layout

\end_inset


\emph default
 and is denoted by the letter 
\begin_inset Formula $S$
\end_inset

.
 For a coin-toss experiment, 
\begin_inset Formula $S$
\end_inset

 would be the results 
\begin_inset Quotes eld
\end_inset

Head
\begin_inset Quotes erd
\end_inset

 and 
\begin_inset Quotes eld
\end_inset

Tail
\begin_inset Quotes erd
\end_inset

, which we may represent by 
\begin_inset Formula $S=\left\{ H,T\right\} $
\end_inset

.
 Formally, the performance of a random experiment is the unpredictable selection
 of an outcome in 
\begin_inset Formula $S$
\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
Most of the probability work in this book is done with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 package 
\begin_inset CommandInset citation
LatexCommand cite
key "Kernsprob"

\end_inset

.
 A sample space is (usually) represented by a 
\emph on
data frame
\emph default
, that is, a rectangular collection of variables (see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Multivariate-Data"

\end_inset

).
 Each row of the data frame corresponds to an outcome of the experiment.
 The data frame choice is convenient both for its simplicity and its compatibili
ty with the 
\family sans
R
\family default
 Commander.
 Data frames alone are, however, not sufficient to describe some of the
 more interesting probabilistic applications we will study later; to handle
 those we will need to consider a more general 
\emph on
list
\emph default
 data structure.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:howto-ps-objects"

\end_inset

 for details.
\end_layout

\begin_layout Example
Consider the random experiment of dropping a Styrofoam cup onto the floor
 from a height of four feet.
 The cup hits the ground and eventually comes to rest.
 It could land upside down, right side up, or it could land on its side.
 We represent these possible outcomes of the random experiment by the following.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

S <- data.frame(lands = c("down","up","side"))
\begin_inset Newline newline
\end_inset

S
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The sample space 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

S
\end_layout

\end_inset

 contains the column 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lands
\end_layout

\end_inset

 which stores the outcomes
\color inherit
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

"down"
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

"up"
\end_layout

\end_inset

,
\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

"side"
\end_layout

\end_inset

.

\color inherit
 
\end_layout

\end_deeper
\begin_layout Standard
Some sample spaces are so common that convenience wrappers were written
 to set them up with minimal effort.
 The underlying machinery that does the work includes the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

expand.grid
\end_layout

\end_inset


\color inherit
 function in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

base
\end_layout

\end_inset


\color inherit
 package, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

combn
\end_layout

\end_inset


\color inherit
 in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

combinat
\end_layout

\end_inset


\color inherit
 package 
\begin_inset CommandInset citation
LatexCommand cite
key "combinat"

\end_inset

, and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

permsn
\end_layout

\end_inset


\color inherit
 in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 package
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
The seasoned 
\family sans
R
\family default
 user can get the job done without the convenience wrappers.
 I encourage the beginner to use them to get started, but I also recommend
 that introductory students wean themselves as soon as possible.
 The wrappers were designed for ease and intuitive use, not for speed or
 efficiency.
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
Consider the random experiment of tossing a coin.
 The outcomes are 
\begin_inset Formula $H$
\end_inset

 and 
\begin_inset Formula $T$
\end_inset

.
 We can set up the sample space quickly with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

tosscoin
\end_layout

\end_inset

 
\color inherit
function:
\end_layout

\begin_layout Scrap
<<>>= 
\begin_inset Newline newline
\end_inset

library(prob)
\begin_inset Newline newline
\end_inset

tosscoin(1) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The number 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

1
\end_layout

\end_inset


\color inherit
 tells 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

tosscoin
\end_layout

\end_inset


\color inherit
 that we only want to toss the coin once.
 We could toss it three times: 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

tosscoin(3) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
Alternatively we could roll a fair die: 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

rolldie(1) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rolldie
\end_layout

\end_inset


\color inherit
 function defaults to a 6-sided die, but we can specify others with the
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

nsides
\end_layout

\end_inset


\color inherit
 argument.
 The command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rolldie(3, nsides = 4)
\end_layout

\end_inset

 would be used to 
\color inherit
roll a 4-sided die three times.
\end_layout

\begin_layout Standard
Perhaps we would like to draw one card from a standard set of playing cards
 (it is a long data frame):
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

head(cards()) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cards
\end_layout

\end_inset


\color inherit
 function that we just used has optional arguments 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

jokers
\end_layout

\end_inset


\color inherit
 (if you would like Jokers to be in the deck) and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

makespace
\end_layout

\end_inset


\color inherit
 which we will discuss later.
 There is also a 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

roulette
\end_layout

\end_inset


\color inherit
 function which returns the sample space associated with one spin on a roulette
 wheel.
 There are EU and USA versions available.
 Interested readers may contribute any other game or sample spaces that
 may be of general interest.
\end_layout

\begin_layout Subsection
Sampling from Urns
\begin_inset CommandInset label
LatexCommand label
name "sub:sampling-from-urns"

\end_inset


\end_layout

\begin_layout Standard
This is perhaps the most fundamental type of random experiment.
 We have an urn that contains a bunch of distinguishable objects (balls)
 inside.
 We shake up the urn, reach inside, grab a ball, and take a look.
 That's all.
\end_layout

\begin_layout Standard
But there are all sorts of variations on this theme.
 Maybe we would like to grab more than one ball -- say, two balls.
 What are all of the possible outcomes of the experiment now? It depends
 on how we sample.
 We could select a ball, take a look, put it back, and sample again.
 Another way would be to select a ball, take a look -- but do not put it
 back -- and sample again (equivalently, just reach in and grab two balls).
 There are certainly more possible outcomes of the experiment in the former
 case than in the latter.
 In the first (second) case we say that sampling is done 
\emph on
with
\emph default
 (
\emph on
without
\emph default
) 
\emph on
replacement
\emph default
.
\end_layout

\begin_layout Standard
There is more.
 Suppose we do not actually keep track of which ball came first.
 All we observe are the two balls, and we have no idea about the order in
 which they were selected.
 We call this 
\emph on
unordered sampling
\emph default
 (in contrast to 
\emph on
ordered
\emph default
) because the order of the selections does not matter with respect to what
 we observe.
 We might as well have selected the balls and put them in a bag before looking.
\end_layout

\begin_layout Standard
Note that this one general class of random experiments contains as a special
 case all of the common elementary random experiments.
 Tossing a coin twice is equivalent to selecting two balls labeled 
\begin_inset Formula $H$
\end_inset

 and 
\begin_inset Formula $T$
\end_inset

 from an urn, with replacement.
 The die-roll experiment is equivalent to selecting a ball from an urn with
 six elements, labeled 1 through 6.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\family default
 
\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 package accomplishes sampling from urns with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

urnsamples
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
urnsamples
\end_layout

\end_inset


\color inherit
 function, which has arguments 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

size
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

replace
\end_layout

\end_inset


\color inherit
, and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ordered
\end_layout

\end_inset


\color inherit
.
 The argument 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 represents the urn from which sampling is to be done.
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

size
\end_layout

\end_inset


\color inherit
 argument tells how large the sample will be.
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ordered
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

replace
\end_layout

\end_inset


\color inherit
 arguments are logical and specify how sampling will be performed.
 We will discuss each in turn.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:sample-urn-two-from-three"

\end_inset

Let our urn simply contain three balls, labeled 1, 2, and 3, respectively.
 We are going to take a sample of size 2 from the urn.
 
\end_layout

\begin_deeper
\begin_layout Subsubsection*
Ordered, With Replacement
\end_layout

\begin_layout Standard
If sampling is with replacement, then we can get any outcome 1, 2, or 3
 on any draw.
 Further, by 
\begin_inset Quotes eld
\end_inset

ordered
\begin_inset Quotes erd
\end_inset

 we mean that we shall keep track of the order of the draws that we observe.
 We can accomplish this in 
\family sans
R
\family default
 with
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>=
\begin_inset Newline newline
\end_inset

urnsamples(1:3, size = 2, replace = TRUE, ordered = TRUE)
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
Notice that rows 2 and 4 are identical, save for the order in which the
 numbers are shown.
 Further, note that every possible pair of the numbers 1 through 3 are listed.
 This experiment is equivalent to rolling a 3-sided die twice, which we
 could have accomplished with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rolldie(2, nsides = 3)
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Subsubsection*
Ordered, Without Replacement
\end_layout

\begin_layout Standard
Here sampling is without replacement, so we may not observe the same number
 twice in any row.
 Order is still important, however, so we expect to see the outcomes 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

1,2
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

2,1
\end_layout

\end_inset


\color inherit
 somewhere in our data frame.
 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

urnsamples(1:3, size = 2, replace = FALSE, ordered = TRUE)
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
This is just as we expected.
 Notice that there are less rows in this answer due to the more restrictive
 sampling procedure.
 If the numbers 1, 2, and 3 represented 
\begin_inset Quotes eld
\end_inset

Fred
\begin_inset Quotes erd
\end_inset

, 
\begin_inset Quotes eld
\end_inset

Mary
\begin_inset Quotes erd
\end_inset

, and 
\begin_inset Quotes eld
\end_inset

Sue
\begin_inset Quotes erd
\end_inset

, respectively, then this experiment would be equivalent to selecting two
 people of the three to serve as president and vice-president of a company,
 respectively, and the sample space shown above lists all possible ways
 that this could be done.
\end_layout

\begin_layout Subsubsection*
Unordered, Without Replacement
\end_layout

\begin_layout Standard
Again, we may not observe the same outcome twice, but in this case, we will
 only retain those outcomes which (when jumbled) would not duplicate earlier
 ones.
 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

urnsamples(1:3, size = 2, replace = FALSE, ordered = FALSE) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
This experiment is equivalent to reaching in the urn, picking a pair, and
 looking to see what they are.
 This is the default setting of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

urnsamples
\end_layout

\end_inset


\color inherit
, so we would have received the same output by simply typing 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

urnsamples(1:3, 2)
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Subsubsection*
Unordered, With Replacement
\end_layout

\begin_layout Standard
The last possibility is perhaps the most interesting.
 We replace the balls after every draw, but we do not remember the order
 in which the draws came.
 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

urnsamples(1:3, size = 2, replace = TRUE, ordered = FALSE) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
We may interpret this experiment in a number of alternative ways.
 One way is to consider this as simply putting two 3-sided dice in a cup,
 shaking the cup, and looking inside -- as in a game of 
\emph on
Liar's Dice
\emph default
, for instance.
 Each row of the sample space is a potential pair we could observe.
 Another way is to view each outcome as a separate method to distribute
 two identical golf balls into three boxes labeled 1, 2, and 3.
 Regardless of the interpretation, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

urnsamples
\end_layout

\end_inset


\color inherit
 lists every possible way that the experiment can conclude.
\end_layout

\end_deeper
\begin_layout Standard
Note that the urn does not need to contain numbers; we could have just as
 easily taken our urn to be 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x = c("Red","Blue","Green")
\end_layout

\end_inset


\color inherit
.
 But, there is an 
\series bold
important
\series default
 point to mention before proceeding.
 Astute readers will notice that in our example, the balls in the urn were
 
\shape italic
distinguishable
\shape default
 in the sense that each had a unique label to distinguish it from the others
 in the urn.
 A natural question would be, 
\begin_inset Quotes eld
\end_inset

What happens if your urn has indistinguishable elements, for example, what
 if 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x = c("Red","Red","Blue")
\end_layout

\end_inset


\color inherit
?
\begin_inset Quotes erd
\end_inset

 The answer is that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

urnsamples
\end_layout

\end_inset


\color inherit
 behaves as if each ball in the urn is distinguishable, regardless of its
 actual contents.
 We may thus imagine that while there are two red balls in the urn, the
 balls are such that we can tell them apart (in principle) by looking closely
 enough at the imperfections on their surface.
\end_layout

\begin_layout Standard
In this way, when the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 argument of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

urnsamples
\end_layout

\end_inset


\color inherit
 has repeated elements, the resulting sample space may appear to be 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ordered = TRUE
\end_layout

\end_inset


\color inherit
 even when, in fact, the call to the function was 
\color none

\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

urnsamples(..., ordered = FALSE)
\end_layout

\end_inset

.

\color inherit
 Similar remarks apply for the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

replace
\end_layout

\end_inset


\color inherit
 argument.
 
\end_layout

\begin_layout Section
Events
\begin_inset CommandInset label
LatexCommand label
name "sec:Events"

\end_inset


\end_layout

\begin_layout Standard
An 
\emph on
event
\begin_inset Index
status open

\begin_layout Plain Layout
event
\end_layout

\end_inset


\emph default
 
\begin_inset Formula $A$
\end_inset

 is merely a collection of outcomes, or in other words, a subset of the
 sample space
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
This naive definition works for finite or countably infinite sample spaces,
 but is inadequate for sample spaces in general.
 In this book, we will not address the subtleties that arise, but will refer
 the interested reader to any text on advanced probability or measure theory.
\end_layout

\end_inset

.
 After the performance of a random experiment 
\begin_inset Formula $E$
\end_inset

 we say that the event 
\begin_inset Formula $A$
\end_inset

 
\emph on
occurred
\emph default
 if the experiment's outcome belongs to 
\begin_inset Formula $A$
\end_inset

.
 We say that a bunch of events 
\begin_inset Formula $A_{1}$
\end_inset

, 
\begin_inset Formula $A_{2}$
\end_inset

, 
\begin_inset Formula $A_{3}$
\end_inset

, \SpecialChar \ldots{}
 are 
\emph on
mutually exclusive
\begin_inset Index
status open

\begin_layout Plain Layout
mutually exclusive
\end_layout

\end_inset


\emph default
 or 
\emph on
disjoint
\emph default
 if 
\begin_inset Formula $A_{i}\cap A_{j}=\emptyset$
\end_inset

 for any distinct pair 
\begin_inset Formula $A_{i}\neq A_{j}$
\end_inset

.
 For instance, in the coin-toss experiment the events 
\begin_inset Formula $A=\left\{ \mbox{Heads}\right\} $
\end_inset

 and 
\begin_inset Formula $B=\left\{ \mbox{Tails}\right\} $
\end_inset

 would be mutually exclusive.
 Now would be a good time to review the algebra of sets in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:The-Algebra-of"

\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
Given a data frame sample/probability space 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

S
\end_layout

\end_inset


\color inherit
, we may extract rows using the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

[]
\end_layout

\end_inset


\color inherit
 operator: 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

S <- tosscoin(2, makespace = TRUE) 
\begin_inset Newline newline
\end_inset

S[1:3, ] 
\begin_inset Newline newline
\end_inset

S[c(2,4), ] 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
and so forth.
 We may also extract rows that satisfy a logical expression using the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

subset
\end_layout

\end_inset

 
\color inherit
function, for instance 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=FALSE>>= 
\begin_inset Newline newline
\end_inset

S <- cards() 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

subset(S, suit == "Heart") 
\begin_inset Newline newline
\end_inset

subset(S, rank %in% 7:9)
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
We could continue indefinitely.
 Also note that mathematical expressions are allowed: 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

subset(rolldie(3), X1+X2+X3 > 16) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Subsection
Functions for Finding Subsets
\end_layout

\begin_layout Standard
It does not take long before the subsets of interest become complicated
 to specify.
 Yet the main idea remains: we have a particular logical condition to apply
 to each row.
 If the row satisfies the condition, then it should be in the subset.
 It should not be in the subset otherwise.
 The ease with which the condition may be coded depends of course on the
 question being asked.
 Here are a few functions to get started.
\end_layout

\begin_layout Subsubsection*
The 
\family typewriter
%in%
\family default
 function
\end_layout

\begin_layout Standard
The function 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

%in%
\end_layout

\end_inset


\color inherit
 helps to learn whether each value of one vector lies somewhere inside another
 vector.
 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=FALSE>>= 
\begin_inset Newline newline
\end_inset

x <- 1:10 
\begin_inset Newline newline
\end_inset

y <- 8:12 
\begin_inset Newline newline
\end_inset

y %in% x
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
Notice that the returned value is a vector of length 5 which tests whether
 each element of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

y
\end_layout

\end_inset


\color inherit
 is in 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
, in turn.
\end_layout

\begin_layout Subsubsection*
The 
\family typewriter
isin
\family default
 function
\end_layout

\begin_layout Standard
It is more common to want to know whether the 
\emph on
whole
\emph default
 vector 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

y
\end_layout

\end_inset

 is in 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
.
 We can do this with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

isin
\end_layout

\end_inset


\color inherit
 function.
 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

isin(x,y) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Of course, one may ask why we did not try something like 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

all(y %in% x)
\end_layout

\end_inset


\color inherit
, which would give a single result, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

TRUE
\end_layout

\end_inset


\color inherit
.
 The reason is that the answers are different in the case that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

y
\end_layout

\end_inset


\color inherit
 has repeated values.
 Compare: 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=FALSE>>= 
\begin_inset Newline newline
\end_inset

x <- 1:10 
\begin_inset Newline newline
\end_inset

y <- c(3,3,7) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

all(y %in% x)
\begin_inset Newline newline
\end_inset

isin(x,y) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
The reason for the above is of course that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 contains the value 3, but 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 does not have 
\emph on
two
\emph default
 3's.
 The difference is important when rolling multiple dice, playing cards,
 
\emph on
etc
\emph default
.
 Note that there is an optional argument 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ordered
\end_layout

\end_inset


\color inherit
 which tests whether the elements of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

y
\end_layout

\end_inset


\color inherit
 appear in 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 in the order in which they are appear in 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

y
\end_layout

\end_inset


\color inherit
.
 The consequences are 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

isin(x, c(3,4,5), ordered = TRUE) 
\begin_inset Newline newline
\end_inset

isin(x, c(3,5,4), ordered = TRUE) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
The connection to probability is that have a data frame sample space and
 we would like to find a subset of that space.
 A 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

data.frame
\end_layout

\end_inset


\color inherit
 method was written for 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

isin
\end_layout

\end_inset


\color inherit
 that simply applies the function to each row of the data frame.
 We can see the method in action with the following: 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=FALSE>>= 
\begin_inset Newline newline
\end_inset

S <- rolldie(4) 
\begin_inset Newline newline
\end_inset

subset(S, isin(S, c(2,2,6), ordered = TRUE)) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
There are a few other functions written to find useful subsets, namely,
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

countrep
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

isrep
\end_layout

\end_inset


\color inherit
.
 Essentially these were written to test for (or count) a specific number
 of designated values in outcomes.
 See the documentation for details.
\end_layout

\begin_layout Subsection
Set Union, Intersection, and Difference
\end_layout

\begin_layout Standard
Given subsets 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

, it is often useful to manipulate them in an algebraic fashion.
 To this end, we have three set operations at our disposal: union, intersection,
 and difference.
 Below is a table that summarizes the pertinent information about these
 operations.
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="4">
<features>
<column alignment="left" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset ERT
status collapsed

\begin_layout Plain Layout

% after 
\backslash

\backslash
: 
\backslash
hline or 
\backslash
cline{col1-col2} 
\backslash
cline{col3-col4} ...
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset

Name 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Denoted 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Defined by elements 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Code 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Union 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $A\cup B$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in 
\begin_inset Formula $A$
\end_inset

 or 
\begin_inset Formula $B$
\end_inset

 or both 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
union(A,B)
\family default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Intersection 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $A\cap B$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in both 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
intersect(A,B)
\family default
 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Difference 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $A\textbackslash B$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in 
\begin_inset Formula $A$
\end_inset

 but not in 
\begin_inset Formula $B$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family typewriter
setdiff(A,B)
\family default
 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Some examples follow.
 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=FALSE>>= 
\begin_inset Newline newline
\end_inset

S = cards() 
\begin_inset Newline newline
\end_inset

A = subset(S, suit == "Heart") 
\begin_inset Newline newline
\end_inset

B = subset(S, rank %in% 7:9)
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
We can now do some set algebra: 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

union(A,B) 
\begin_inset Newline newline
\end_inset

intersect(A,B) 
\begin_inset Newline newline
\end_inset

setdiff(A,B) 
\begin_inset Newline newline
\end_inset

setdiff(B,A) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
Notice that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

setdiff
\end_layout

\end_inset


\color inherit
 is not symmetric.
 Further, note that we can calculate the 
\emph on
complement
\emph default
 of a set 
\begin_inset Formula $A$
\end_inset

, denoted 
\begin_inset Formula $A^{c}$
\end_inset

 and defined to be the elements of 
\begin_inset Formula $S$
\end_inset

 that are not in 
\begin_inset Formula $A$
\end_inset

 simply with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

setdiff(S,A)
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Standard
There have been methods written for 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

intersect
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

setdiff
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

subset
\end_layout

\end_inset


\color inherit
, and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

union
\end_layout

\end_inset


\color inherit
 in the case that the input objects are of class 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ps
\end_layout

\end_inset


\color inherit
.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:howto-ps-objects"

\end_inset

.
\end_layout

\begin_layout Note
When the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 package loads you will notice a message: 
\begin_inset Quotes eld
\end_inset


\color none

\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

The
\end_layout

\end_inset

 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

following
\end_layout

\end_inset

 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

object(s)
\end_layout

\end_inset

 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

are masked from package:base
\end_layout

\end_inset

 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

: intersect
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

setdiff
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

union
\end_layout

\end_inset


\begin_inset Quotes erd
\end_inset


\color inherit
.
 The reason for this message is that there already exist methods for the
 functions 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

intersect
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

setdiff
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

subset
\end_layout

\end_inset


\color inherit
, and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

union
\end_layout

\end_inset


\color inherit
 in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

base
\end_layout

\end_inset


\color inherit
 package which ships with 
\family sans
R
\family default
.
 However, these methods were designed for when the arguments are vectors
 of the same mode.
 Since we are manipulating sample spaces which are data frames and lists,
 it was necessary to write methods to handle those cases as well.
 When the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 package is loaded, 
\family sans
R
\family default
 recognizes that there are multiple versions of the same function in the
 search path and acts to shield the new definitions from the existing ones.
 But there is no cause for alarm, thankfully, because the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 functions have been carefully defined to match the usual 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

base
\end_layout

\end_inset


\color inherit
 package definition in the case that the arguments are vectors.
\end_layout

\begin_layout Section
Model Assignment
\begin_inset CommandInset label
LatexCommand label
name "sec:Interpreting-Probabilities"

\end_inset


\end_layout

\begin_layout Standard
Let us take a look at the coin-toss experiment more closely.
 What do we mean when we say 
\begin_inset Quotes eld
\end_inset

the probability of Heads
\begin_inset Quotes erd
\end_inset

 or write 
\begin_inset Formula $\P(\mbox{Heads})$
\end_inset

? Given a coin and an itchy thumb, how do we go about finding what 
\begin_inset Formula $\P(\mbox{Heads})$
\end_inset

 should be?
\end_layout

\begin_layout Subsection
The Measure Theory Approach
\end_layout

\begin_layout Standard
This approach states that the way to handle 
\begin_inset Formula $\P(\mbox{Heads})$
\end_inset

 is to define a mathematical function, called a 
\emph on
probability measure
\emph default
, on the sample space.
 Probability measures satisfy certain axioms (to be introduced later) and
 have special mathematical properties, so not just any mathematical function
 will do.
 But in any given physical circumstance there are typically all sorts of
 probability measures from which to choose, and it is left to the experimenter
 to make a reasonable choice -- usually based on considerations of objectivity.
 For the tossing coin example, a valid probability measure assigns probability
 
\begin_inset Formula $p$
\end_inset

 to the event 
\begin_inset Formula $\left\{ \mbox{Heads}\right\} $
\end_inset

, where 
\begin_inset Formula $p$
\end_inset

 is some number 
\begin_inset Formula $0\leq p\leq1$
\end_inset

.
 An experimenter that wishes to incorporate the symmetry of the coin would
 choose 
\begin_inset Formula $p=1/2$
\end_inset

 to balance the likelihood of 
\begin_inset Formula $\left\{ \mbox{Heads}\right\} $
\end_inset

 and 
\begin_inset Formula $\left\{ \mbox{Tails}\right\} $
\end_inset

.
\end_layout

\begin_layout Standard
Once the probability measure is chosen (or determined), there is not much
 left to do.
 All assignments of probability are made by the probability function, and
 the experimenter needs only to plug the event 
\begin_inset Formula $\left\{ \mbox{Heads}\right\} $
\end_inset

 into to the probability function to find 
\begin_inset Formula $\P(\mbox{Heads})$
\end_inset

.
 In this way, the probability of an event is simply a calculated value,
 nothing more, nothing less.
 Of course this is not the whole story; there are many theorems and consequences
 associated with this approach that will keep us occupied for the remainder
 of this book.
 The approach is called 
\emph on
measure theory
\emph default
 because the measure (probability) of a set (event) is associated with how
 big it is (how likely it is to occur).
\end_layout

\begin_layout Standard
The measure theory approach is well suited for situations where there is
 symmetry to the experiment, such as flipping a balanced coin or spinning
 an arrow around a circle with well-defined pie slices.
 It is also handy because of its mathematical simplicity, elegance, and
 flexibility.
 There are literally volumes of information that one can prove about probability
 measures, and the cold rules of mathematics allow us to analyze intricate
 probabilistic problems with vigor.
 
\end_layout

\begin_layout Standard
The large degree of flexibility is also a disadvantage, however.
 When symmetry fails it is not always obvious what an 
\begin_inset Quotes eld
\end_inset

objective
\begin_inset Quotes erd
\end_inset

 choice of probability measure should be; for instance, what probability
 should we assign to 
\begin_inset Formula $\left\{ \mbox{Heads}\right\} $
\end_inset

 if we spin the coin rather than flip it? (It is not 
\begin_inset Formula $1/2$
\end_inset

.) Furthermore, the mathematical rules are restrictive when we wish to incorporat
e subjective knowledge into the model, knowledge which changes over time
 and depends on the experimenter, such as personal knowledge about the propertie
s of the specific coin being flipped, or of the person doing the flipping.
\end_layout

\begin_layout Standard
The mathematician who revolutionized this way to do probability theory was
 Andrey Kolmogorov, who published a landmark monograph in 1933.
 See 
\end_layout

\begin_layout Standard
\align center
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://www-history.mcs.st-andrews.ac.uk/Mathematicians/Kolmogorov.html
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
for more information.
\end_layout

\begin_layout Subsection
Relative Frequency Approach
\end_layout

\begin_layout Standard
This approach states that the way to determine 
\begin_inset Formula $\P(\mbox{Heads})$
\end_inset

 is to flip the coin repeatedly, in exactly the same way each time.
 Keep a tally of the number of flips and the number of Heads observed.
 Then a good approximation to 
\begin_inset Formula $\P(\mbox{Heads})$
\end_inset

 will be
\begin_inset Formula \begin{equation}
\P(\mbox{Heads})\approx\frac{\mbox{number of observed Heads}}{\mbox{total number of flips}}.\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The mathematical underpinning of this approach is the celebrated 
\series bold
Law of Large Numbers
\series default
, which may be loosely described as follows.
 Let 
\begin_inset Formula $E$
\end_inset

 be a random experiment in which the event 
\begin_inset Formula $A$
\end_inset

 either does or does not occur.
 Perform the experiment repeatedly, in an identical manner, in such a way
 that the successive experiments do not influence each other.
 After each experiment, keep a running tally of whether or not the event
 
\begin_inset Formula $A$
\end_inset

 occurred.
 Let 
\begin_inset Formula $S_{n}$
\end_inset

 count the number of times that 
\begin_inset Formula $A$
\end_inset

 occurred in the 
\begin_inset Formula $n$
\end_inset

 experiments.
 Then the law of large numbers says that 
\begin_inset Formula \begin{equation}
\frac{S_{n}}{n}\to\P(A)\mbox{ as }n\to\infty.\end{equation}

\end_inset


\end_layout

\begin_layout Standard
As the reasoning goes, to learn about the probability of an event 
\begin_inset Formula $A$
\end_inset

 we need only repeat the random experiment to get a reasonable estimate
 of the probability's value, and if we are not satisfied with our estimate
 then we may simply repeat the experiment more times all the while confident
 that with more and more experiments our estimate will stabilize to the
 true value.
 
\end_layout

\begin_layout Standard
The frequentist approach is good because it is relatively light on assumptions
 and does not worry about symmetry or claims of objectivity like the measure-the
oretic approach does.
 It is perfect for the spinning coin experiment.
 One drawback to the method is that one can never know the exact value of
 a probability, only a long-run approximation.
 It also does not work well with experiments that can not be repeated indefinite
ly, say, the probability that it will rain today, the chances that you get
 will get an A in your Statistics class, or the probability that the world
 is destroyed by nuclear war.
\end_layout

\begin_layout Standard
This approach was espoused by Richard von Mises in the early twentieth century,
 and some of his main ideas were incorporated into the measure theory approach.
 See 
\end_layout

\begin_layout Standard
\align center
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://www-history.mcs.st-andrews.ac.uk/Biographies/Mises.html
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
for more.
\end_layout

\begin_layout Subsection
The Subjective Approach
\end_layout

\begin_layout Standard
The subjective approach interprets probability as the experimenter's 
\emph on
degree of belief
\emph default
 that the event will occur.
 The estimate of the probability of an event is based on the totality of
 the individual's knowledge at the time.
 As new information becomes available, the estimate is modified accordingly
 to best reflect his/her current knowledge.
 The method by which the probabilities are updated is commonly done with
 Bayes' Rule, discussed in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Bayes'-Rule"

\end_inset

.
 
\end_layout

\begin_layout Standard
So for the coin toss example, a person may have 
\begin_inset Formula $\P(\mbox{Heads})=1/2$
\end_inset

 in the absence of additional information.
 But perhaps the observer knows additional information about the coin or
 the thrower that would shift the probability in a certain direction.
 For instance, parlor magicians may be trained to be quite skilled at tossing
 coins, and some are so skilled that they may toss a fair coin and get nothing
 but Heads, indefinitely.
 I have 
\emph on
seen
\emph default
 this.
 It was similarly claimed in 
\emph on
Bringing Down the House
\emph default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Mezrich2003"

\end_inset

 that MIT students were accomplished enough with cards to be able to cut
 a deck to the same location, every single time.
 In such cases, one clearly should use the additional information to assign
 
\begin_inset Formula $\P(\mbox{Heads})$
\end_inset

 away from the symmetry value of 
\begin_inset Formula $1/2$
\end_inset

.
\end_layout

\begin_layout Standard
This approach works well in situations that cannot be repeated indefinitely,
 for example, to assign your probability that you will get an A in this
 class, the chances of a devastating nuclear war, or the likelihood that
 a cure for the common cold will be discovered.
\end_layout

\begin_layout Standard
The roots of subjective probability reach back a long time.
 See 
\end_layout

\begin_layout Standard
\align center
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://en.wikipedia.org/wiki/Subjective_probability
\end_layout

\end_inset

 
\end_layout

\begin_layout Standard
\noindent
for a short discussion and links to references about the subjective approach.
\end_layout

\begin_layout Subsection
Equally Likely Model (ELM)
\end_layout

\begin_layout Standard
We have seen several approaches to the assignment of a probability model
 to a given random experiment and they are very different in their underlying
 interpretation.
 But they all cross paths when it comes to the equally likely model which
 assigns equal probability to all elementary outcomes of the experiment.
\end_layout

\begin_layout Standard
The ELM appears in the measure theory approach when the experiment boasts
 symmetry of some kind.
 If symmetry guarantees that all outcomes have equal 
\begin_inset Quotes eld
\end_inset

size
\begin_inset Quotes erd
\end_inset

, and if outcomes with equal 
\begin_inset Quotes eld
\end_inset

size
\begin_inset Quotes erd
\end_inset

 should get the same probability, then the ELM is a logical objective choice
 for the experimenter.
 Consider the balanced 6-sided die, the fair coin, or the dart board with
 equal-sized wedges.
\end_layout

\begin_layout Standard
The ELM appears in the subjective approach when the experimenter resorts
 to indifference or ignorance with respect to his/her knowledge of the outcome
 of the experiment.
 If the experimenter has no prior knowledge to suggest that (s)he prefer
 Heads over Tails, then it is reasonable for the him/her to assign equal
 subjective probability to both possible outcomes.
\end_layout

\begin_layout Standard
The ELM appears in the relative frequency approach as a fascinating fact
 of Nature: when we flip balanced coins over and over again, we observe
 that the proportion of times that the coin comes up Heads tends to 
\begin_inset Formula $1/2$
\end_inset

.
 Of course if we assume that the measure theory applies then we can prove
 that the sample proportion must tend to 1/2 as expected, but that is putting
 the cart before the horse, in a manner of speaking.
\end_layout

\begin_layout Standard
The ELM is only available when there are finitely many elements in the sample
 space.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
In the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 package, a probability space is an object of outcomes 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

S
\end_layout

\end_inset


\color inherit
 and a vector of probabilities (called 
\begin_inset Quotes eld
\end_inset


\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit

\begin_inset Quotes erd
\end_inset

) with entries that correspond to each outcome in 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

S
\end_layout

\end_inset


\color inherit
.
 When 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

S
\end_layout

\end_inset


\color inherit
 is a data frame, we may simply add a column called 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 to 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

S
\end_layout

\end_inset


\color inherit
 and we will be finished; the probability space will simply be a data frame
 which we may call 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

S
\end_layout

\end_inset


\color inherit
.
 In the case that S is a list, we may combine the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

outcomes
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 into a larger list, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

space
\end_layout

\end_inset


\color inherit
; it will have two components: 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

outcomes
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
.
 The only requirements we need are for the entries of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 to be nonnegative and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

sum(probs)
\end_layout

\end_inset


\color inherit
 to be one.
\end_layout

\begin_layout Standard
To accomplish this in 
\family sans
R
\family default
, we may use the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probspace
\end_layout

\end_inset


\color inherit
 function.
 The general syntax is 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probspace(x, probs)
\end_layout

\end_inset


\color inherit
, where 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 is a sample space of outcomes and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 is a vector (of the same length as the number of outcomes in 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
).
 The specific choice of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 depends on the context of the problem, and some examples follow to demonstrate
 some of the more common choices.
\end_layout

\begin_layout Example
The Equally Likely Model asserts that every outcome of the sample space
 has the same probability, thus, if a sample space has 
\begin_inset Formula $n$
\end_inset

 outcomes, then 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 would be a vector of length 
\begin_inset Formula $n$
\end_inset

 with identical entries 
\begin_inset Formula $1/n$
\end_inset

.
 The quickest way to generate 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 is with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rep
\end_layout

\end_inset


\color inherit
 function.
 We will start with the experiment of rolling a die, so that 
\begin_inset Formula $n=6$
\end_inset

.
 We will construct the sample space, generate the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 vector, and put them together with 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

probspace
\end_layout

\end_inset


\color inherit
.
 
\end_layout

\begin_deeper
\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

outcomes <- rolldie(1) 
\begin_inset Newline newline
\end_inset

p <- rep(1/6, times = 6) 
\begin_inset Newline newline
\end_inset

probspace(outcomes, probs = p) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probspace
\end_layout

\end_inset


\color inherit
 function is designed to save us some time in many of the most common situations.
 For example, due to the especial simplicity of the sample space in this
 case, we could have achieved the same result with only (note the name change
 for the first column) 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

probspace(1:6, probs = p) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
Further, since the equally likely model plays such a fundamental role in
 the study of probability the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probspace
\end_layout

\end_inset


\color inherit
 function will assume that the equally model is desired if no 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 are specified.
 Thus, we get the same answer with only 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

probspace(1:6) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
And finally, since rolling dice is such a common experiment in probability
 classes, the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rolldie
\end_layout

\end_inset


\color inherit
 function has an additional logical argument 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

makespace
\end_layout

\end_inset


\color inherit
 that will add a column of equally likely 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 to the generated sample space: 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

rolldie(1, makespace = TRUE)
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
\noindent
or just 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rolldie(1, TRUE)
\end_layout

\end_inset


\color inherit
.
 Many of the other sample space functions (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

tosscoin
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cards
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

roulette
\end_layout

\end_inset


\color inherit
, 
\shape italic
etc
\shape default
.) have similar 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

makespace
\end_layout

\end_inset


\color inherit
 arguments.
 Check the documentation for details.
\end_layout

\end_deeper
\begin_layout Standard
One sample space function that does NOT have a 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

makespace
\end_layout

\end_inset


\color inherit
 option is the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

urnsamples
\end_layout

\end_inset

 
\color inherit
function.
 This was intentional.
 The reason is that under the varied sampling assumptions the outcomes in
 the respective sample spaces are NOT, in general, equally likely.
 It is important for the user to carefully consider the experiment to decide
 whether or not the outcomes are equally likely and then use 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probspace
\end_layout

\end_inset


\color inherit
 to assign the model.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:unbalanced-coin"

\end_inset


\series bold
An unbalanced coin.

\series default
 While the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

makespace
\end_layout

\end_inset


\color inherit
 argument to 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

tosscoin
\end_layout

\end_inset


\color inherit
 is useful to represent the tossing of a 
\emph on
fair
\emph default
 coin, it is not always appropriate.
 For example, suppose our coin is not perfectly balanced, for instance,
 maybe the 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $H$
\end_inset


\begin_inset Quotes erd
\end_inset

 side is somewhat heavier such that the chances of a 
\begin_inset Formula $H$
\end_inset

 appearing in a single toss is 0.70 instead of 0.5.
 We may set up the probability space with 
\end_layout

\begin_deeper
\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

probspace(tosscoin(1), probs = c(0.70, 0.30)) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
The same procedure can be used to represent an unbalanced die, roulette
 wheel, 
\shape italic
etc
\shape default
.
\end_layout

\end_deeper
\begin_layout Subsection
Words of Warning
\end_layout

\begin_layout Standard
It should be mentioned that while the splendour of 
\family sans
R 
\family default
is uncontested, it, like everything else, has limits both with respect to
 the sample/probability spaces it can manage and with respect to the finite
 accuracy of the representation of most numbers (see the 
\family sans
R
\family default
 FAQ 7.31).
 When playing around with probability, one may be tempted to set up a probabilit
y space for tossing 100 coins or rolling 50 dice in an attempt to answer
 some scintillating question.
 (Bear in mind: rolling a die just 9 times has a sample space with over
 
\emph on
10 million
\emph default
 outcomes.)
\end_layout

\begin_layout Standard
Alas, even if there were enough RAM to barely hold the sample space (and
 there were enough time to wait for it to be generated), the infinitesimal
 probabilities that are associated with 
\emph on
so many
\emph default
 outcomes make it difficult for the underlying machinery to handle reliably.
 In some cases, special algorithms need to be called just to give something
 that holds asymptotically.
 User beware.
\end_layout

\begin_layout Section
Properties of Probability
\begin_inset CommandInset label
LatexCommand label
name "sec:Properties-of-Probability"

\end_inset


\end_layout

\begin_layout Subsection
Probability Functions
\begin_inset CommandInset label
LatexCommand label
name "sub:Probability-Functions"

\end_inset


\end_layout

\begin_layout Standard
A 
\emph on
probability function
\emph default
 is a rule that associates with each event 
\begin_inset Formula $A$
\end_inset

 of the sample space a unique number 
\begin_inset Formula $\P(A)=p$
\end_inset

, called the probability of 
\begin_inset Formula $A$
\end_inset

.
 Any probability function 
\begin_inset Formula $\P$
\end_inset

 satisfies the following three Kolmogorov Axioms:
\end_layout

\begin_layout Axiom
\begin_inset CommandInset label
LatexCommand label
name "ax:prob-nonnegative"

\end_inset


\begin_inset Formula $\P(A)\geq0$
\end_inset

 for any event 
\begin_inset Formula $A\subset S$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Axiom
\begin_inset CommandInset label
LatexCommand label
name "ax:total-mass-one"

\end_inset


\begin_inset Formula $\P(S)=1$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Axiom
\begin_inset CommandInset label
LatexCommand label
name "ax:countable-additivity"

\end_inset

If the events 
\begin_inset Formula $A_{1}$
\end_inset

, 
\begin_inset Formula $A_{2}$
\end_inset

, 
\begin_inset Formula $A_{3}$
\end_inset

\SpecialChar \ldots{}
 are disjoint then
\begin_inset Formula \begin{equation}
\P\left(\bigcup_{i=1}^{n}A_{i}\right)=\sum_{i=1}^{n}\P(A_{i})\mbox{ for every }n,\end{equation}

\end_inset

and furthermore,
\begin_inset Formula \begin{equation}
\P\left(\bigcup_{i=1}^{\infty}A_{i}\right)=\sum_{i=1}^{\infty}\P(A_{i}).\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The intuition behind the axioms: first, the probability of an event should
 never be negative.
 And since the sample space contains all possible outcomes, its probability
 should be one, or 100%.
 The final axiom may look intimidating, but it simply means that for a sequence
 of disjoint events (in other words, sets that do not overlap), their total
 probability (measure) should equal the sum of its parts.
 For example, the chance of rolling a 1 or a 2 on a die is the chance of
 rolling a 1 plus the chance of rolling a 2.
 The connection to measure theory could not be more clear.
\end_layout

\begin_layout Subsection
Properties
\end_layout

\begin_layout Standard
For any events 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

,
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\P(A^{c})=1-\P(A)$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "enu:prop-prob-complement"

\end_inset

 
\begin_inset Branch proofs
status open

\begin_layout Proof
Since 
\begin_inset Formula $A\cup A^{c}=S$
\end_inset

 and 
\begin_inset Formula $A\cap A^{c}=\emptyset$
\end_inset

, we have
\begin_inset Formula \[
1=\P(S)=\P(A\cup A^{c})=\P(A)+\P(A^{c}).\]

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $\P(\emptyset)=0$
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Proof
Note that 
\begin_inset Formula $\emptyset=S^{c}$
\end_inset

, and use Property 1.
\end_layout

\end_deeper
\begin_layout Enumerate
If 
\begin_inset Formula $A\subset B$
\end_inset

 , then 
\begin_inset Formula $\P(A)\leq\P(B)$
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Proof
Write 
\begin_inset Formula $B=A\cup\left(B\cap A^{c}\right)$
\end_inset

, and notice that 
\begin_inset Formula $A\cap\left(B\cap A^{c}\right)=\emptyset$
\end_inset

; thus
\begin_inset Formula \[
\P(B)=\P(A\cup\left(B\cap A^{c}\right))=\P(A)+\P\left(B\cap A^{c}\right)\geq\P(A),\]

\end_inset

since 
\begin_inset Formula $\P\left(B\cap A^{c}\right)\ge0$
\end_inset

.
 
\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset Formula $0\leq\P(A)\leq1$
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Proof
The left inequality is immediate from Axiom 
\begin_inset CommandInset ref
LatexCommand ref
reference "ax:prob-nonnegative"

\end_inset

, and the second inequality follows from Property 3 since 
\begin_inset Formula $A\subset S$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Enumerate

\series bold
\emph on
The General Addition Rule.
\series default
\emph default

\begin_inset Formula \begin{equation}
\P(A\cup B)=\P(A)+\P(B)-\P(A\cap B).\label{eq:general-addition-rule-1}\end{equation}

\end_inset


\end_layout

\begin_deeper
\begin_layout Standard
More generally, for events 
\begin_inset Formula $A_{1}$
\end_inset

, 
\begin_inset Formula $A_{2}$
\end_inset

, 
\begin_inset Formula $A_{3}$
\end_inset

,\SpecialChar \ldots{}
, 
\begin_inset Formula $A_{n}$
\end_inset

,
\begin_inset Formula \begin{equation}
\P\left(\bigcup_{i=1}^{n}A_{i}\right)=\sum_{i=1}^{n}\P(A_{i})-\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}\P(A_{i}\cap A_{j})+\cdots+(-1)^{n-1}\P\left(\bigcap_{i=1}^{n}A_{i}\right)\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Enumerate

\series bold
\emph on
The Theorem of Total Probability.

\series default
\emph default
 Let 
\begin_inset Formula $B_{1}$
\end_inset

, 
\begin_inset Formula $B_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $B_{n}$
\end_inset

 be mutually exclusive and exhaustive.
 Then
\begin_inset Formula \begin{equation}
\P(A)=\P(A\cap B_{1})+\P(A\cap B_{2})+\cdots+\P(A\cap B_{n}).\label{eq:theorem-total-probability}\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Assigning Probabilities
\end_layout

\begin_layout Standard
A model of particular interest is the 
\emph on
equally likely model
\emph default
.
 The idea is to divide the sample space 
\begin_inset Formula $S$
\end_inset

 into a finite collection of elementary events 
\begin_inset Formula $\left\{ a_{1},\ a_{2},\ldots,a_{N}\right\} $
\end_inset

 that are equally likely in the sense that each 
\begin_inset Formula $a_{i}$
\end_inset

 has equal chances of occurring.
 The probability function associated with this model must satisfy 
\begin_inset Formula $\P(S)=1$
\end_inset

, by Axiom 2.
 On the other hand, it must also satisfy
\begin_inset Formula \[
\P(S)=\P(\left\{ a_{1},\ a_{2},\ldots,a_{N}\right\} )=\P(a_{1}\cup a_{2}\cup\cdots\cup a_{N})=\sum_{i=1}^{N}\P(a_{i}),\]

\end_inset

by Axiom 3.
 Since 
\begin_inset Formula $\P(a_{i})$
\end_inset

 is the same for all 
\begin_inset Formula $i$
\end_inset

, each one necessarily equals 
\begin_inset Formula $1/N$
\end_inset

.
 
\end_layout

\begin_layout Standard
For an event 
\begin_inset Formula $A\subset S$
\end_inset

, we write it as a collection of elementary outcomes: if 
\begin_inset Formula $A=\left\{ a_{i_{1}},a_{i_{2}},\ldots,a_{i_{k}}\right\} $
\end_inset

 then 
\begin_inset Formula $A$
\end_inset

 has 
\begin_inset Formula $k$
\end_inset

 elements and 
\begin_inset Formula \begin{align*}
\P(A) & =\P(a_{i_{1}})+\P(a_{i_{2}})+\cdots+\P(a_{i_{k}}),\\
 & =\frac{1}{N}+\frac{1}{N}+\cdots+\frac{1}{N},\\
 & =\frac{k}{N}=\frac{\#(A)}{\#(S)}.\end{align*}

\end_inset

In other words, under the equally likely model, the probability of an event
 
\begin_inset Formula $A$
\end_inset

 is determined by the number of elementary events that 
\begin_inset Formula $A$
\end_inset

 contains.
\end_layout

\begin_layout Example
Consider the random experiment 
\begin_inset Formula $E$
\end_inset

 of tossing a coin.
 Then the sample space is 
\begin_inset Formula $S=\{H,T\}$
\end_inset

, and under the equally likely model, these two outcomes have 
\begin_inset Formula $\P(H)=\P(T)=1/2$
\end_inset

.
 This model is taken when it is reasonable to assume that the coin is fair.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Suppose the experiment 
\begin_inset Formula $E$
\end_inset

 consists of tossing a fair coin twice.
 The sample space may be represented by 
\begin_inset Formula $S=\{HH,\, HT,\, TH,\, TT\}$
\end_inset

.
 Given that the coin is fair and that the coin is tossed in an independent
 and identical manner, it is reasonable to apply the equally likely model.
 
\end_layout

\begin_layout Example
What is 
\begin_inset Formula $\P(\mbox{at least 1 Head})$
\end_inset

? Looking at the sample space we see the elements 
\begin_inset Formula $HH$
\end_inset

, 
\begin_inset Formula $HT$
\end_inset

, and 
\begin_inset Formula $TH$
\end_inset

 have at least one Head; thus, 
\begin_inset Formula $\P(\mbox{at least 1 Head})=3/4$
\end_inset

.
 
\end_layout

\begin_layout Example
What is 
\begin_inset Formula $\P(\mbox{no Heads})$
\end_inset

? Notice that the event 
\begin_inset Formula $\left\{ \mbox{no Heads}\right\} =\left\{ \mbox{at least one Head}\right\} ^{c}$
\end_inset

, which by Property 
\begin_inset CommandInset ref
LatexCommand ref
reference "enu:prop-prob-complement"

\end_inset

 means 
\begin_inset Formula $\P(\mbox{no Heads})=1-\P(\mbox{at least one Head})=1-3/4=1/4$
\end_inset

.
 It is obvious in this simple example that the only outcome with no Heads
 is 
\begin_inset Formula $TT$
\end_inset

, however, this complementation trick is useful in more complicated circumstance
s.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:three-child-family"

\end_inset

Imagine a three child family, each child being either Boy (
\begin_inset Formula $B$
\end_inset

) or Girl (
\begin_inset Formula $G$
\end_inset

).
 An example sequence of siblings would be 
\begin_inset Formula $BGB$
\end_inset

.
 The sample space may be written
\begin_inset Formula \[
S=\left\{ \begin{array}{cccc}
BBB, & BGB, & GBB, & GGB,\\
BBG, & BGG, & GBG, & GGG\end{array}\right\} .\]

\end_inset

Note that for many reasons (for instance, it turns out that girls are slightly
 more likely to be born than boys), this sample space is 
\emph on
not
\emph default
 equally likely.
 For the sake of argument, however, we will assume that the elementary outcomes
 each have probability 
\begin_inset Formula $1/8$
\end_inset

.
\end_layout

\begin_layout Example
What is 
\begin_inset Formula $\P(\mbox{exactly 2 Boys})$
\end_inset

? Inspecting the sample space reveals three outcomes with exactly two boys:
 
\begin_inset Formula $\left\{ BBG,\, BGB,\, GBB\right\} $
\end_inset

.
 Therefore 
\begin_inset Formula $\P(\mbox{exactly 2 Boys})=3/8$
\end_inset

.
 
\end_layout

\begin_layout Example
What is 
\begin_inset Formula $\P(\mbox{at most 2 Boys})$
\end_inset

? One way to solve the problem would be to count the outcomes that have
 2 or less Boys, but a quicker way would be to recognize that the only way
 that the event 
\begin_inset Formula $\left\{ \mbox{at most 2 Boys}\right\} $
\end_inset

 does 
\emph on
not
\emph default
 occur is the event 
\begin_inset Formula $\left\{ \mbox{all Girls}\right\} $
\end_inset

.
 Thus
\begin_inset Formula \[
\P(\mbox{at most 2 Boys})=1-\P(GGG)=1-1/8=7/8.\]

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Consider the experiment of rolling a six-sided die, and let the outcome
 be the face showing up when the die comes to rest.
 Then 
\begin_inset Formula $S=\left\{ 1,2,3,4,5,6\right\} $
\end_inset

.
 It is usually reasonable to suppose that the die is fair, so that the six
 outcomes are equally likely.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Consider a standard deck of 52 cards.
 These are usually labeled with the four 
\emph on
suits
\emph default
: Clubs, Diamonds, Hearts, and Spades, and the 13 
\emph on
ranks
\emph default
: 2, 3, 4, \SpecialChar \ldots{}
, 10, Jack (J), Queen (Q), King (K), and Ace (A).
 Depending on the game played, the Ace may be ranked below 2 or above King.
 
\end_layout

\begin_layout Example
Let the random experiment 
\begin_inset Formula $E$
\end_inset

 consist of drawing exactly one card from a well-shuffled deck, and let
 the outcome be the face of the card.
 Define the events 
\begin_inset Formula $A=\left\{ \mbox{draw an Ace}\right\} $
\end_inset

 and 
\begin_inset Formula $B=\left\{ \mbox{draw a Club}\right\} $
\end_inset

.
 Bear in mind: we are only drawing one card.
\end_layout

\begin_layout Example
Immediately we have 
\begin_inset Formula $\P(A)=4/52$
\end_inset

 since there are four Aces in the deck; similarly, there are 
\begin_inset Formula $13$
\end_inset

 Clubs which implies 
\begin_inset Formula $\P(B)=13/52$
\end_inset

.
\end_layout

\begin_layout Example
What is 
\begin_inset Formula $\P(A\cap B)$
\end_inset

? We realize that there is only one card of the 52 which is an Ace and a
 Club at the same time, namely, the Ace of Clubs.
 Therefore 
\begin_inset Formula $\P(A\cap B)=1/52$
\end_inset

.
\end_layout

\begin_layout Example
To find 
\begin_inset Formula $\P(A\cup B)$
\end_inset

 we may use the above with the General Addition Rule to get
\begin_inset Formula \begin{eqnarray*}
\P(A\cup B) & = & \P(A)+\P(B)-\P(A\cap B),\\
 & = & 4/52+13/52-1/52,\\
 & = & 16/52.\end{eqnarray*}

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Staying with the deck of cards, let another random experiment be the selection
 of a five card stud poker hand, where 
\begin_inset Quotes eld
\end_inset

five card stud
\begin_inset Quotes erd
\end_inset

 means that we draw exactly five cards from the deck without replacement,
 no more, and no less.
 It turns out that the sample space 
\begin_inset Formula $S$
\end_inset

 is so large and complicated that we will be obliged to settle for the trivial
 description 
\begin_inset Formula $S=\left\{ \mbox{all possible 5 card hands}\right\} $
\end_inset

 for the time being.
 We will have a more precise description later.
\end_layout

\begin_layout Example
What is 
\begin_inset Formula $\P(\mbox{Royal Flush})$
\end_inset

, or in other words, 
\begin_inset Formula $\P(\mbox{A, K, Q, J, 10 all in the same suit})$
\end_inset

? 
\end_layout

\begin_layout Example
It should be clear that there are only four possible royal flushes.
 Thus, if we could only count the number of outcomes in 
\begin_inset Formula $S$
\end_inset

 then we could simply divide four by that number and we would have our answer
 under the equally likely model.
 This is the subject of Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Methods-of-Counting"

\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
Probabilities are calculated in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 package with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 function.
\end_layout

\begin_layout Standard
Consider the experiment of drawing a card from a standard deck of playing
 cards.
 Let's denote the probability space associated with the experiment as 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

S
\end_layout

\end_inset


\color inherit
, and let the subsets 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

A
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

B
\end_layout

\end_inset


\color inherit
 be defined by the following: 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=FALSE>>= 
\begin_inset Newline newline
\end_inset

S <- cards(makespace = TRUE) 
\begin_inset Newline newline
\end_inset

A <- subset(S, suit == "Heart") 
\begin_inset Newline newline
\end_inset

B <- subset(S, rank %in% 7:9)
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
Now it is easy to calculate 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

prob(A) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
Note that we can get the same answer with 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

prob(S, suit == "Heart") 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
We also find 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob(B) = 0.23
\end_layout

\end_inset


\color inherit
 (listed here approximately, but 12/52 actually) and 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

prob(S) = 1
\end_layout

\end_inset


\color inherit
.
 Internally, the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 function operates by summing the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 column of its argument.
 It will find subsets on-the-fly if desired.
\end_layout

\begin_layout Standard
We have as yet glossed over the details.
 More specifically, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 has three arguments: 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset

,
\color inherit
 which is a probability space (or a subset of one), 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

event
\end_layout

\end_inset

,
\color inherit
 which is a logical expression used to define a subset, and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

given
\end_layout

\end_inset

,
\color inherit
 which is described in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Conditional-Probability"

\end_inset

.
\end_layout

\begin_layout Standard

\emph on
WARNING
\emph default
.
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

event
\end_layout

\end_inset


\color inherit
 argument is used to define a subset of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
, that is, the only outcomes used in the probability calculation will be
 those that are elements of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 and satisfy 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

event
\end_layout

\end_inset


\color inherit
 simultaneously.
 In other words, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob(x, event)
\end_layout

\end_inset


\color inherit
 calculates 
\end_layout

\begin_layout Standard

\color none
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline false
status open

\begin_layout Plain Layout

prob(intersect(x, subset(x, event)))
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Consequently, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 should be the entire probability space in the case that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

event
\end_layout

\end_inset


\color inherit
 is non-null.
\end_layout

\begin_layout Section
Counting Methods
\begin_inset CommandInset label
LatexCommand label
name "sec:Methods-of-Counting"

\end_inset


\end_layout

\begin_layout Standard
The equally-likely model is a convenient and popular way to analyze random
 experiments.
 And when the equally likely model applies, finding the probability of an
 event 
\begin_inset Formula $A$
\end_inset

 amounts to nothing more than counting the number of outcomes that 
\begin_inset Formula $A$
\end_inset

 contains (together with the number of events in 
\begin_inset Formula $S$
\end_inset

).
 Hence, to be a master of probability one must be skilled at counting outcomes
 in events of all kinds.
\end_layout

\begin_layout Proposition
The Multiplication Principle.
 Suppose that an experiment is composed of two successive steps.
 Further suppose that the first step may be performed in 
\begin_inset Formula $n_{1}$
\end_inset

 distinct ways while the second step may be performed in 
\begin_inset Formula $n_{2}$
\end_inset

 distinct ways.
 Then the experiment may be performed in 
\begin_inset Formula $n_{1}n_{2}$
\end_inset

 distinct ways.
\end_layout

\begin_layout Proposition
More generally, if the experiment is composed of 
\begin_inset Formula $k$
\end_inset

 successive steps which may be performed in 
\begin_inset Formula $n_{1}$
\end_inset

, 
\begin_inset Formula $n_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $n_{k}$
\end_inset

 distinct ways, respectively, then the experiment may be performed in 
\begin_inset Formula $n_{1}n_{2}\cdots n_{k}$
\end_inset

 distinct ways.
\end_layout

\begin_layout Example
We would like to order a pizza.
 It will be sure to have cheese (and marinara sauce), but we may elect to
 add one or more of the following five (5) available toppings:
\begin_inset Formula \[
\mbox{pepperoni, sausage, anchovies, olives, and green peppers.}\]

\end_inset

How many distinct pizzas are possible?
\end_layout

\begin_layout Example
There are many ways to approach the problem, but the quickest avenue employs
 the Multiplication Principle directly.
 We will separate the action of ordering the pizza into a series of stages.
 At the first stage, we will decide whether or not to include pepperoni
 on the pizza (two possibilities).
 At the next stage, we will decide whether or not to include sausage on
 the pizza (again, two possibilities).
 We will continue in this fashion until at last we will decide whether or
 not to include green peppers on the pizza.
\end_layout

\begin_layout Example
At each stage we will have had two options, or ways, to select a pizza to
 be made.
 The Multiplication Principle says that we should multiply the 2's to find
 the total number of possible pizzas: 
\begin_inset Formula $2\cdot2\cdot2\cdot2\cdot2=2^{5}=32$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
We would like to buy a desktop computer to study statistics.
 We go to a website to build our computer our way.
 Given a line of products we have many options to customize our computer.
 In particular, there are 2 choices for a processor, 3 different operating
 systems, 4 levels of memory, 4 hard drives of differing sizes, and 10 choices
 for a monitor.
 How many possible types of computer must Gell be prepared to build? 
\series bold
Answer:
\series default
 
\begin_inset Formula $2\cdot3\cdot4\cdot4\cdot10=960$
\end_inset

.
\end_layout

\begin_layout Subsection
Ordered Samples
\end_layout

\begin_layout Standard
Imagine a bag with 
\begin_inset Formula $n$
\end_inset

 distinguishable balls inside.
 Now shake up the bag and select 
\begin_inset Formula $k$
\end_inset

 balls at random.
 How many possible sequences might we observe?
\end_layout

\begin_layout Proposition
The number of ways in which one may select an ordered sample of 
\begin_inset Formula $k$
\end_inset

 subjects from a population that has 
\begin_inset Formula $n$
\end_inset

 distinguishable members is
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $n^{k}$
\end_inset

 if sampling is done with replacement,
\end_layout

\begin_layout Itemize
\begin_inset Formula $n(n-1)(n-2)\cdots(n-k+1)$
\end_inset

 if sampling is done without replacement.
\end_layout

\end_deeper
\begin_layout Standard
Recall from calculus the notation for 
\emph on
factorials
\emph default
: 
\begin_inset Formula \begin{eqnarray*}
1! & = & 1,\\
2! & = & 2\cdot1=2,\\
3! & = & 3\cdot2\cdot1=6,\\
 & \vdots\\
n! & = & n(n-1)(n-2)\cdots3\cdot2\cdot1.\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Fact
The number of permutations of 
\begin_inset Formula $n$
\end_inset

 elements is 
\begin_inset Formula $n!$
\end_inset

.
\end_layout

\begin_layout Example
Take a coin and flip it 7 times.
 How many sequences of Heads and Tails are possible? 
\series bold
Answer:
\series default
 
\begin_inset Formula $2^{7}=128$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
In a class of 20 students, we randomly select a class president, a class
 vice-president, and a treasurer.
 How many ways can this be done? 
\series bold
Answer:
\series default
 
\begin_inset Formula $20\cdot19\cdot18=6840$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
We rent five movies to watch over the span of two nights.
 We wish to watch 3 movies on the first night.
 How many distinct sequences of 3 movies could we possibly watch? 
\series bold
Answer:
\series default
 
\begin_inset Formula $5\cdot4\cdot3=60$
\end_inset

.
\end_layout

\begin_layout Subsection
Unordered Samples
\end_layout

\begin_layout Standard
The number of ways in which one may select an unordered sample of 
\begin_inset Formula $k$
\end_inset

 subjects from a population that has 
\begin_inset Formula $n$
\end_inset

 distinguishable members is
\end_layout

\begin_layout Itemize
\begin_inset Formula $(n-1+k)!/[(n-1)!k!]$
\end_inset

 if sampling is done with replacement,
\end_layout

\begin_layout Itemize
\begin_inset Formula $n!/[k!(n-k)!]$
\end_inset

 if sampling is done without replacement.
\end_layout

\begin_layout Standard
The quantity 
\begin_inset Formula $n!/[k!(n-k)!]$
\end_inset

 is called a 
\emph on
binomial coefficient
\emph default
 and plays a special role in mathematics; it is denoted
\begin_inset Formula \begin{equation}
{n \choose k}=\frac{n!}{k!(n-k)!}\label{eq:binomial-coefficient}\end{equation}

\end_inset

and is read 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $n$
\end_inset

 choose 
\begin_inset Formula $k$
\end_inset


\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Example
You rent five movies to watch over the span of two nights, but only wish
 to watch 3 movies the first night.
 Your friend, Fred, wishes to borrow some movies to watch at his house on
 the first night.
 You owe Fred a favor, and allow him to select 2 movies from the set of
 5.
 How many choices does Fred have? 
\series bold
Answer:
\series default
 
\begin_inset Formula ${5 \choose 2}=10$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Place 3 six-sided dice into a cup.
 Next, shake the cup well and pour out the dice.
 How many distinct rolls are possible? 
\series bold
Answer:
\series default
 
\begin_inset Formula $(6-1+3)!/[(6-1)!3!]={8 \choose 5}=56$
\end_inset

.
 
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The factorial 
\begin_inset Formula $n!$
\end_inset

 is computed with the command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

factorial(n)
\end_layout

\end_inset


\color inherit
 and the binomial coefficient 
\begin_inset Formula ${n \choose k}$
\end_inset

 with the command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

choose(n,k)
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Standard
The sample spaces we have computed so far have been relatively small, and
 we can visually study them without much trouble.
 However, it is 
\emph on
very
\emph default
 easy to generate sample spaces that are prohibitively large.
 And while 
\family sans
R
\family default
 is wonderful and powerful and does almost everything except wash windows,
 even 
\family sans
R
\family default
 has limits of which we should be mindful.
\end_layout

\begin_layout Standard
But we often do not need to actually generate the sample space; it suffices
 to count the number of outcomes.
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

nsamp
\end_layout

\end_inset


\color inherit
 function will calculate the number of rows in a sample space made by 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

urnsamples
\end_layout

\end_inset


\color inherit
 without actually devoting the memory resources necessary to generate the
 space.
 The arguments are 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

n
\end_layout

\end_inset


\color inherit
, the number of (distinguishable) objects in the urn, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

k
\end_layout

\end_inset


\color inherit
, the sample size, and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

replace
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ordered
\end_layout

\end_inset

,
\color inherit
 as above.
\end_layout

\begin_layout Standard
\align center
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="3">
<features>
<column alignment="left" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Verse

ordered = TRUE
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
lstparams "showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Verse

ordered = FALSE
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
lstparams "showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Verse

replace = TRUE
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $n^{k}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{(n-1+k)!}{(n-1)!k!}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
lstparams "showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Verse

replace = FALSE
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{n!}{(n-k)!}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula ${n \choose k}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Sampling 
\begin_inset Formula $k$
\end_inset

 from 
\begin_inset Formula $n$
\end_inset

 objects with 
\family typewriter
urnsamples
\family default

\begin_inset CommandInset label
LatexCommand label
name "tab:Sampling-k-from-n"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
We will compute the number of outcomes for each of the four 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

urnsamples
\end_layout

\end_inset


\color inherit
 examples that we saw in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:sample-urn-two-from-three"

\end_inset

.
 Recall that we took a sample of size two from an urn with three distinguishable
 elements.
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

nsamp(n=3, k=2, replace = TRUE, ordered = TRUE) 
\begin_inset Newline newline
\end_inset

nsamp(n=3, k=2, replace = FALSE, ordered = TRUE) 
\begin_inset Newline newline
\end_inset

nsamp(n=3, k=2, replace = FALSE, ordered = FALSE) 
\begin_inset Newline newline
\end_inset

nsamp(n=3, k=2, replace = TRUE, ordered = FALSE) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
Compare these answers with the length of the data frames generated above.
\end_layout

\begin_layout Subsubsection*
The Multiplication Principle
\end_layout

\begin_layout Standard
A benefit of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

nsamp
\end_layout

\end_inset


\color inherit
 is that it is 
\emph on
vectorized
\emph default
 so that entering vectors instead of numbers for 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

n
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

k
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

replace
\end_layout

\end_inset


\color inherit
, and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ordered
\end_layout

\end_inset


\color inherit
 results in a vector of corresponding answers.
 This becomes particularly convenient for combinatorics problems.
\end_layout

\begin_layout Example
There are 11 artists who each submit a portfolio containing 7 paintings
 for competition in an art exhibition.
 Unfortunately, the gallery director only has space in the winners' section
 to accommodate 12 paintings in a row equally spread over three consecutive
 walls.
 The director decides to give the first, second, and third place winners
 each a wall to display the work of their choice.
 The walls boast 31 separate lighting options apiece.
 How many displays are possible?
\end_layout

\begin_deeper
\begin_layout Standard
Answer: The judges will pick 3 (ranked) winners out of 11 (with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rep = FALSE
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ord = TRUE
\end_layout

\end_inset


\color inherit
).
 Each artist will select 4 of his/her paintings from 7 for display in a
 row (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rep = FALSE
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ord = TRUE
\end_layout

\end_inset


\color inherit
), and lastly, each of the 3 walls has 31 lighting possibilities (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rep = TRUE
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ord = TRUE
\end_layout

\end_inset


\color inherit
).
 These three numbers can be calculated quickly with 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=FALSE>>= 
\begin_inset Newline newline
\end_inset

n <- c(11,7,31) 
\begin_inset Newline newline
\end_inset

k <- c(3,4,3) 
\begin_inset Newline newline
\end_inset

r <- c(FALSE,FALSE,TRUE) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

x <- nsamp(n, k, rep = r, ord = TRUE) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
(Notice that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ordered
\end_layout

\end_inset


\color inherit
 is always 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

TRUE
\end_layout

\end_inset


\color inherit
; 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

nsamp
\end_layout

\end_inset


\color inherit
 will recycle 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ordered
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

replace
\end_layout

\end_inset


\color inherit
 to the appropriate length.) By the Multiplication Principle, the number
 of ways to complete the experiment is the product of the entries of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
: 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

prod(x) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
Compare this with the some other ways to compute the same thing: 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

(11*10*9)*(7*6*5*4)*313 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
or alternatively 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

prod(9:11)*prod(4:7)*313 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
or even 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

prod(factorial(c(11,7))/factorial(c(8,3)))*313 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\end_deeper
\begin_layout Standard
As one can guess, in many of the standard counting problems there aren't
 substantial savings in the amount of typing; it is about the same using
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

nsamp
\end_layout

\end_inset


\color inherit
 versus 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

factorial
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

choose
\end_layout

\end_inset


\color inherit
.
 But the virtue of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

nsamp
\end_layout

\end_inset


\color inherit
 
\family typewriter
l
\family default
ies in its collecting the relevant counting formulas in a one-stop shop.
 Ultimately, it is up to the user to choose the method that works best for
 him/herself.
 
\end_layout

\begin_layout Example

\series bold
The Birthday Problem.

\series default
 Suppose that there are 
\begin_inset Formula $n$
\end_inset

 people together in a room.
 Each person announces the date of his/her birthday in turn.
 The question is: what is the probability of at least one match? If we let
 the event 
\begin_inset Formula $A$
\end_inset

 represent 
\begin_inset Formula $\left\{ \mbox{there is at least one match}\right\} $
\end_inset

, then would like to know 
\begin_inset Formula $\P(A)$
\end_inset

, but as we will see, it is more convenient to calculate 
\begin_inset Formula $\P(A^{c})$
\end_inset

.
\end_layout

\begin_layout Example
For starters we will ignore leap years and assume that there are only 365
 days in a year.
 Second, we will assume that births are equally distributed over the course
 of a year (which is not true due to all sorts of complications such as
 hospital delivery schedules).
 See 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://en.wikipedia.org/wiki/Birthday_problem
\end_layout

\end_inset

 for more.
\end_layout

\begin_layout Example
Let us next think about the sample space.
 There are 365 possibilities for the first person's birthday, 365 possibilities
 for the second, and so forth.
 The total number of possible birthday sequences is therefore 
\begin_inset Formula $\#(S)=365^{n}$
\end_inset

.
\end_layout

\begin_layout Example
Now we will use the complementation trick we saw in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:three-child-family"

\end_inset

.
 We realize that the only situation in which 
\begin_inset Formula $A$
\end_inset

 does 
\emph on
not
\emph default
 occur is if there are 
\emph on
no
\emph default
 matches among all people in the room, that is, only when everybody's birthday
 is different, so
\begin_inset Formula \[
\P(A)=1-\P(A^{c})=1-\frac{\#(A^{c})}{\#(S)},\]

\end_inset

since the outcomes are equally likely.
 Let us then suppose that there are no matches.
 The first person has one of 365 possible birthdays.
 The second person must not match the first, thus, the second person has
 only 364 available birthdays from which to choose.
 Similarly, the third person has only 363 possible birthdays, and so forth,
 until we reach the 
\begin_inset Formula $n$
\end_inset


\begin_inset Formula $^{\text{th}}$
\end_inset

 person, who has only 
\begin_inset Formula $365-n+1$
\end_inset

 remaining possible days for a birthday.
 By the Multiplication Principle, we have 
\begin_inset Formula $\#(A^{c})=365\cdot364\cdots(365-n+1)$
\end_inset

, and
\begin_inset Formula \begin{equation}
\P(A)=1-\frac{365\cdot364\cdots(365-n+1)}{365^{n}}=1-\frac{364}{365}\cdot\frac{363}{365}\cdots\frac{(365-n+1)}{365}.\end{equation}

\end_inset


\end_layout

\begin_layout Example
As a surprising consequence, consider this: how many people does it take
 to be in the room so that the probability of at least one match is at least
 0.50? Clearly, if there is only 
\begin_inset Formula $n=1$
\end_inset

 person in the room then the probability of a match is zero, and when there
 are 
\begin_inset Formula $n=366$
\end_inset

 people in the room there is a 100% chance of a match (recall that we are
 ignoring leap years).
 So how many people does it take so that there is an equal chance of a match
 and no match?
\end_layout

\begin_layout Example
When I have asked this question to students, the usual response is 
\begin_inset Quotes eld
\end_inset

somewhere around 
\begin_inset Formula $n=180$
\end_inset

 people
\begin_inset Quotes erd
\end_inset

 in the room.
 The reasoning seems to be that in order to get a 50% chance of a match,
 there should be 50% of the available days to be occupied.
 The number of students in a typical classroom is 25, so as a companion
 question I ask students to estimate the probability of a match when there
 are 
\begin_inset Formula $n=25$
\end_inset

 students in the room.
 Common estimates are a 1%, or 0.5%, or even 0.1% chance of a match.
 After they have given their estimates, we go around the room and each student
 announces their birthday.
 More often than not, we observe a match in the class, to the students'
 disbelief.
\end_layout

\begin_layout Example
Students are usually surprised to hear that, using the formula above, one
 needs only 
\begin_inset Formula $n=23$
\end_inset

 students to have a greater than 50% chance of at least one match.
 Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-Birthday-Problem"

\end_inset

 shows a graph of the birthday probabilities:
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 4>>=
\begin_inset Newline newline
\end_inset

g <- Vectorize(pbirthday.ipsur)
\begin_inset Newline newline
\end_inset

plot(1:50, g(1:50), xlab = "Number of people in room", ylab = "Prob(at least
 one match)")
\begin_inset Newline newline
\end_inset

abline(h = 0.5)
\begin_inset Newline newline
\end_inset

abline(v = 23, lty = 2)
\begin_inset Newline newline
\end_inset

remove(g)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The birthday problem
\begin_inset CommandInset label
LatexCommand label
name "fig:The-Birthday-Problem"

\end_inset


\end_layout

\end_inset


\size small
The horizontal line is at 
\begin_inset Formula $p=0.50$
\end_inset

 and the vertical line is at 
\begin_inset Formula $n=23$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Scrap

\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
We can make the plot in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:The-Birthday-Problem"

\end_inset

 with the following sequence of commands.
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "basicstyle={\ttfamily},breaklines=true,showstringspaces=false,tabsize=2"
inline false
status open

\begin_layout Plain Layout

	g <- Vectorize(pbirthday.ipsur)
\end_layout

\begin_layout Verse

	plot(1:50, g(1:50),
\end_layout

\begin_layout Verse

			xlab = "Number of people in room",
\end_layout

\begin_layout Verse

			ylab = "Prob(at least one match)",
\end_layout

\begin_layout Verse

			main = "The Birthday Problem")
\end_layout

\begin_layout Plain Layout

	abline(h = 0.5)
\end_layout

\begin_layout Plain Layout

	abline(v = 23, lty = 2)	# dashed line
\end_layout

\end_inset


\end_layout

\begin_layout Standard
There is a 
\family sans
Birthday problem
\family default
 item in the 
\family sans
Probability
\family default
 menu of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

RcmdrPlugin.IPSUR
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Standard
In the base 
\family sans
R
\family default
 version, one can compute approximate probabilities for the more general
 case of probabilities other than 1/2, for differing total number of days
 in the year, and even for more than two matches.
\end_layout

\begin_layout Section
Conditional Probability
\begin_inset CommandInset label
LatexCommand label
name "sec:Conditional-Probability"

\end_inset


\end_layout

\begin_layout Standard
Consider a full deck of 52 standard playing cards.
 Now select two cards from the deck, in succession.
 Let 
\begin_inset Formula $A=\left\{ \mbox{first card drawn is an Ace}\right\} $
\end_inset

 and 
\begin_inset Formula $B=\left\{ \mbox{second card drawn is an Ace}\right\} $
\end_inset

.
 Since there are four Aces in the deck, it is natural to assign 
\begin_inset Formula $\P(A)=4/52$
\end_inset

.
 Suppose we look at the first card.
 What now is the probability of 
\begin_inset Formula $B$
\end_inset

? Of course, the answer depends on the value of the first card.
 If the first card is an Ace, then the probability that the second also
 is an Ace should be 
\begin_inset Formula $3/51$
\end_inset

, but if the first card is not an Ace, then the probability that the second
 is an Ace should be 
\begin_inset Formula $4/51$
\end_inset

.
 As notation for these two situations we write
\begin_inset Formula \[
\P(B|A)=3/51,\quad\P(B|A^{c})=4/51.\]

\end_inset


\end_layout

\begin_layout Definition
The conditional probability of 
\begin_inset Formula $B$
\end_inset

 given 
\begin_inset Formula $A$
\end_inset

, denoted 
\begin_inset Formula $\P(B|A)$
\end_inset

, is defined by
\begin_inset Formula \begin{equation}
\P(B|A)=\frac{\P(A\cap B)}{\P(A)},\quad\mbox{if }\P(A)>0.\end{equation}

\end_inset

We will not be discussing a conditional probability of 
\begin_inset Formula $B$
\end_inset

 given 
\begin_inset Formula $A$
\end_inset

 when 
\begin_inset Formula $\P(A)=0$
\end_inset

, even though this theory exists, is well developed, and forms the foundation
 for the study of stochastic processes
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Conditional probability in this case is defined by means of 
\emph on
conditional expectation
\emph default
, a topic that is well beyond the scope of this text.
 The interested reader should consult an advanced text on probability theory,
 such as Billingsley, Resnick, or Ash Dooleans-Dade.
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Example
Toss a coin twice.
 The sample space is given by 
\begin_inset Formula $S=\left\{ HH,\ HT,\ TH,\ TT\right\} $
\end_inset

.
 Let 
\begin_inset Formula $A=\left\{ \mbox{a head occurs}\right\} $
\end_inset

 and 
\begin_inset Formula $B=\left\{ \mbox{a head and tail occur}\right\} $
\end_inset

.
 It should be clear that 
\begin_inset Formula $\P(A)=3/4$
\end_inset

, 
\begin_inset Formula $\P(B)=2/4$
\end_inset

, and 
\begin_inset Formula $\P(A\cap B)=2/4$
\end_inset

.
 What now are the probabilities 
\begin_inset Formula $\P(A|B)$
\end_inset

 and 
\begin_inset Formula $\P(B|A)$
\end_inset

?
\begin_inset Formula \[
\P(A|B)=\frac{\P(A\cap B)}{\P(B)}=\frac{2/4}{2/4}=1,\]

\end_inset

in other words, once we know that a Head and Tail occur, we may be certain
 that a Head occurs.
 Next
\begin_inset Formula \[
\P(B|A)=\frac{\P(A\cap B)}{\P(A)}=\frac{2/4}{3/4}=\frac{2}{3},\]

\end_inset

which means that given the information that a Head has occurred, we no longer
 need to account for the outcome 
\begin_inset Formula $TT$
\end_inset

, and the remaining three outcomes are equally likely with exactly two outcomes
 lying in the set 
\begin_inset Formula $B$
\end_inset

.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:Toss-a-six-sided-die-twice"

\end_inset

Toss a six-sided die twice.
 The sample space consists of all ordered pairs 
\begin_inset Formula $(i,j)$
\end_inset

 of the numbers 
\begin_inset Formula $1,2,\ldots,6$
\end_inset

, that is, 
\begin_inset Formula $S=\left\{ (1,1),\ (1,2),\ldots,(6,6)\right\} $
\end_inset

.
 We know from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Methods-of-Counting"

\end_inset

 that 
\begin_inset Formula $\#(S)=6^{2}=36$
\end_inset

.
 Let 
\begin_inset Formula $A=\left\{ \mbox{outcomes match}\right\} $
\end_inset

 and 
\begin_inset Formula $B=\left\{ \mbox{sum of outcomes at least 8}\right\} $
\end_inset

.
 The sample space may be represented by a matrix:
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="1" columns="1">
<features>
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" rotate="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
First Roll
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="7">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Second Roll
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\varprod$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\varprod$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size larger
\begin_inset Formula $\bigcirc$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\varprod$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size larger
\begin_inset Formula $\bigcirc$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size larger
\begin_inset Formula $\bigcirc$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size huge
\begin_inset Formula $\otimes$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size larger
\begin_inset Formula $\bigcirc$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size larger
\begin_inset Formula $\bigcirc$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size larger
\begin_inset Formula $\bigcirc$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size larger
\begin_inset Formula $\bigcirc$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size huge
\begin_inset Formula $\otimes$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size larger
\begin_inset Formula $\bigcirc$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size larger
\begin_inset Formula $\bigcirc$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size larger
\begin_inset Formula $\bigcirc$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size larger
\begin_inset Formula $\bigcirc$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size larger
\begin_inset Formula $\bigcirc$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size huge
\begin_inset Formula $\otimes$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Rolling two dice
\begin_inset CommandInset label
LatexCommand label
name "tab:Rolling-two-dice"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Example
The outcomes lying in the event 
\begin_inset Formula $A$
\end_inset

 are marked with the symbol 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\varprod$
\end_inset


\begin_inset Quotes erd
\end_inset

, the outcomes falling in 
\begin_inset Formula $B$
\end_inset

 are marked with 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\bigcirc$
\end_inset


\begin_inset Quotes erd
\end_inset

, and those in both 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are marked 
\begin_inset Quotes eld
\end_inset


\begin_inset Formula $\otimes$
\end_inset


\begin_inset Quotes erd
\end_inset

.
 Now it is clear that 
\begin_inset Formula $\P(A)=6/36$
\end_inset

, 
\begin_inset Formula $\P(B)=15/36$
\end_inset

, and 
\begin_inset Formula $\P(A\cap B)=3/36$
\end_inset

.
 Finally, 
\begin_inset Formula \[
\P(A|B)=\frac{3/36}{15/36}=\frac{1}{5},\quad\P(B|A)=\frac{3/36}{6/36}=\frac{1}{2}.\]

\end_inset

Again, we see that given the knowledge that 
\begin_inset Formula $B$
\end_inset

 occurred (the 15 outcomes in the lower right triangle), there are 3 of
 the 15 that fall into the set 
\begin_inset Formula $A$
\end_inset

, thus the probability is 
\begin_inset Formula $3/15$
\end_inset

.
 Similarly, given that 
\begin_inset Formula $A$
\end_inset

 occurred (we are on the diagonal), there are 3 out of 6 outcomes that also
 fall in 
\begin_inset Formula $B$
\end_inset

, thus, the probability of 
\begin_inset Formula $B$
\end_inset

 given 
\begin_inset Formula $A$
\end_inset

 is 1/2.
 
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
Continuing with Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Toss-a-six-sided-die-twice"

\end_inset

, the first thing to do is set up the probability space with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rolldie
\end_layout

\end_inset


\color inherit
 function.
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

library(prob)
\begin_inset Newline newline
\end_inset

S <- rolldie(2, makespace = TRUE)  # assumes ELM
\begin_inset Newline newline
\end_inset

head(S)                            #  first few rows
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Next we define the events
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

A <- subset(S, X1 == X2)
\begin_inset Newline newline
\end_inset

B <- subset(S, X1 + X2 >= 8)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
And now we are ready to calculate probabilities.
 To do conditional probability, we use the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

given
\end_layout

\end_inset


\color inherit
 argument of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 function:
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

prob(A, given = B)
\begin_inset Newline newline
\end_inset

prob(B, given = A)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Note that we do not actually need to define the events 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 separately as long as we reference the original probability space 
\begin_inset Formula $S$
\end_inset

 as the first argument of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 calculation:
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

prob(S, X1==X2, given = (X1 + X2 >= 8) )
\begin_inset Newline newline
\end_inset

prob(S, X1+X2 >= 8, given = (X1==X2) )
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Subsection
Properties and Rules
\end_layout

\begin_layout Standard
The following theorem establishes that conditional probabilities behave
 just like regular probabilities when the conditioned event is fixed.
 
\end_layout

\begin_layout Theorem
For any fixed event 
\begin_inset Formula $A$
\end_inset

 with 
\begin_inset Formula $\P(A)>0$
\end_inset

,
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\P(B|A)\geq0,$
\end_inset

 for all events 
\begin_inset Formula $B\subset S$
\end_inset

,
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\P(S|A)=1$
\end_inset

, and
\end_layout

\begin_layout Enumerate
If 
\begin_inset Formula $B_{1}$
\end_inset

, 
\begin_inset Formula $B_{2}$
\end_inset

, 
\begin_inset Formula $B_{3}$
\end_inset

,\SpecialChar \ldots{}
 are disjoint events, then
\begin_inset Formula \begin{equation}
\P\left(\left.\bigcup_{k=1}^{\infty}B_{k}\:\right|A\right)=\sum_{k=1}^{\infty}\P(B_{k}|A).\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Standard
In other words, 
\begin_inset Formula $\P(\cdot|A)$
\end_inset

 is a legitimate probability function.
 With this fact in mind, the following properties are immediate:
\end_layout

\begin_layout Proposition
For any events 
\begin_inset Formula $A$
\end_inset

, 
\begin_inset Formula $B$
\end_inset

, and 
\begin_inset Formula $C$
\end_inset

 with 
\begin_inset Formula $\P(A)>0$
\end_inset

,
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\P(B^{c}|A)=1-\P(B|A).$
\end_inset


\end_layout

\begin_layout Enumerate
If 
\begin_inset Formula $B\subset C$
\end_inset

 then 
\begin_inset Formula $\P(B|A)\leq\P(C|A)$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\P[(B\cup C)|A]=\P(B|A)+\P(C|A)-\P[(B\cap C|A)].$
\end_inset


\end_layout

\begin_layout Enumerate

\series bold
The Multiplication Rule.

\series default
 For any two events 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

,
\begin_inset Formula \begin{equation}
\P(A\cap B)=\P(A)\P(B|A).\label{eq:multiplication-rule-short}\end{equation}

\end_inset

And more generally, for events 
\begin_inset Formula $A_{1}$
\end_inset

, 
\begin_inset Formula $A_{2}$
\end_inset

, 
\begin_inset Formula $A_{3}$
\end_inset

,\SpecialChar \ldots{}
, 
\begin_inset Formula $A_{n}$
\end_inset

,
\begin_inset Formula \begin{equation}
\P(A_{1}\cap A_{2}\cap\cdots\cap A_{n})=\P(A_{1})\P(A_{2}|A_{1})\cdots\P(A_{n}|A_{1}\cap A_{2}\cap\cdots\cap A_{n-1}).\label{eq:multiplication-rule-long}\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Standard
The Multiplication Rule is very important because it allows us to find probabili
ties in random experiments that have a sequential structure, as the next
 example shows.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:two-cards-both-aces"

\end_inset

At the beginning of the section we drew two cards from a standard playing
 deck.
 Now we may answer our original question, what is 
\begin_inset Formula $\P(\mbox{both Aces})$
\end_inset

?
\begin_inset Formula \[
\P(\mbox{both Aces})=\P(A\cap B)=\P(A)\P(B|A)=\frac{4}{52}\cdot\frac{3}{51}\approx0.00452.\]

\end_inset


\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\begin_inset CommandInset label
LatexCommand label
name "sub:howto-ps-objects"

\end_inset


\end_layout

\begin_layout Standard
Continuing Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:two-cards-both-aces"

\end_inset

, we set up the probability space by way of a three step process.
 First we employ the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cards
\end_layout

\end_inset

 function to get a data frame 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

L
\end_layout

\end_inset

 with two columns: 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rank
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

suit
\end_layout

\end_inset

.
 Both columns are stored internally as factors with 13 and 4 levels, respectivel
y.
\end_layout

\begin_layout Standard
Next we sample two cards randomly from the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

L
\end_layout

\end_inset


\color inherit
 data frame by way of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

urnsamples
\end_layout

\end_inset

 function.
 It returns a list 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

M
\end_layout

\end_inset

 which contains all possible pairs of rows from 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

L
\end_layout

\end_inset

 (there are 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

choose(52,2)
\end_layout

\end_inset

 of them).
 The sample space for this experiment is exactly the list 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

M
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
At long last we associate a probability model with the sample space.
 This is right down the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probspace
\end_layout

\end_inset

 functio
\color inherit
n's alley.
 It assumes the equally likely model by default.
 We call this result 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

N
\end_layout

\end_inset

 which is an object of class
\color inherit
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ps
\end_layout

\end_inset


\color inherit
 -- short for 
\begin_inset Quotes eld
\end_inset

probability space
\begin_inset Quotes erd
\end_inset

.
 
\end_layout

\begin_layout Standard
But do not be intimidated.
 The object 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

N
\end_layout

\end_inset


\color inherit
 is nothing more than a list with two elements: 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

outcomes
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
.
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

outcomes
\end_layout

\end_inset


\color inherit
 element is itself just another list, with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

choose(52,2)
\end_layout

\end_inset


\color inherit
 entries, each one a data frame with two rows which correspond to the pair
 of cards chosen.
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 element is just a vector with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

choose(52,2)
\end_layout

\end_inset


\color inherit
 entries all the same: 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

1/choose(52,2)
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Standard
Putting all of this together we do
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(prob)
\begin_inset Newline newline
\end_inset

L <- cards()
\begin_inset Newline newline
\end_inset

M <- urnsamples(L, size = 2)
\begin_inset Newline newline
\end_inset

N <- probspace(M)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Now that we have the probability space 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

N
\end_layout

\end_inset


\color inherit
 we are ready to do some probability.
 We use the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset

 function, just like before.
 The only trick is to specify the event of interest correctly, and recall
 that we were interested in 
\color inherit

\begin_inset Formula $\P(\mbox{both Aces})$
\end_inset

.
 But if the cards are both Aces then the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

rank
\end_layout

\end_inset


\color inherit
 of both cards should be 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

"A"
\end_layout

\end_inset


\color inherit
, which sounds like a job for the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

all
\end_layout

\end_inset


\color inherit
 function:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

prob(N, all(rank == "A"))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Note that this value matches what we found in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:two-cards-both-aces"

\end_inset

, above.
 We could calculate all sorts of probabilities at this point; we are limited
 only by the complexity of the event's computer representation.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:urn-7-red-3-green"

\end_inset

Consider an urn with 10 balls inside, 7 of which are red and 3 of which
 are green.
 Select 3 balls successively from the urn.
 Let 
\begin_inset Formula $A=\left\{ 1^{\text{st}}\mbox{ ball is red}\right\} $
\end_inset

, 
\begin_inset Formula $B=\left\{ 2^{\text{nd}}\mbox{ ball is red}\right\} $
\end_inset

, and 
\begin_inset Formula $C=\left\{ 3^{\text{rd}}\mbox{ ball is red}\right\} $
\end_inset

.
 Then
\begin_inset Formula \[
\P(\mbox{all 3 balls are red})=\P(A\cap B\cap C)=\frac{7}{10}\cdot\frac{6}{9}\cdot\frac{5}{8}\approx0.2917.\]

\end_inset


\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:urn-7-red-3-green"

\end_inset

 is similar to Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:two-cards-both-aces"

\end_inset

, but it is even easier.
 We need to set up an urn (vector 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

L
\end_layout

\end_inset


\color inherit
) to hold the balls, we sample from 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

L
\end_layout

\end_inset


\color inherit
 to get the sample space (data frame 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

M
\end_layout

\end_inset


\color inherit
), and we associate a probability vector (column 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
) with the outcomes (rows of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

M
\end_layout

\end_inset


\color inherit
) of the sample space.
 The final result is a probability space (an ordinary data frame 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

N
\end_layout

\end_inset


\color inherit
).
\end_layout

\begin_layout Standard
It is easier for us this time because our urn is a vector instead of a 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cards()
\end_layout

\end_inset

 data frame.
 Before there were two dimensions of information associated with the outcomes
 (rank and suit) but presently we have only one dimension (color).
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(prob)
\begin_inset Newline newline
\end_inset

L <- rep(c("red","green"), times = c(7,3))
\begin_inset Newline newline
\end_inset

M <- urnsamples(L, size = 3, replace = FALSE, ordered = TRUE)
\begin_inset Newline newline
\end_inset

N <- probspace(M)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Now let us think about how to set up the event 
\begin_inset Formula $\left\{ \mbox{all 3 balls are red}\right\} $
\end_inset

.
 Rows of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

N
\end_layout

\end_inset


\color inherit
 that satisfy this condition have 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

X1=="red" & X2=="red" & X3=="red"
\end_layout

\end_inset


\color inherit
, but there must be an easier way.
 Indeed, there is.
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

isrep
\end_layout

\end_inset


\color inherit
 function (short for 
\begin_inset Quotes eld
\end_inset

is repeated
\begin_inset Quotes erd
\end_inset

) in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 package was written for this purpose.
 The command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

isrep(N,"red",3)
\end_layout

\end_inset


\color inherit
 will test each row of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

N
\end_layout

\end_inset


\color inherit
 to see whether the value 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

"red"
\end_layout

\end_inset


\color inherit
 appears 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

3
\end_layout

\end_inset


\color inherit
 times.
 The result is exactly what we need to define an event with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 function.
 Observe
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

prob(N, isrep(N, "red", 3))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Note that this answer matches what we found in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:urn-7-red-3-green"

\end_inset

.
 Now let us try some other probability questions.
 What is the probability of getting two 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

"red"
\end_layout

\end_inset

s?
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

prob(N, isrep(N, "red", 2))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Note that the exact value is 
\begin_inset Formula $21/40$
\end_inset

; we will learn a quick way to compute this in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:other-discrete-distributions"

\end_inset

.
 What is the probability of observing 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

"red"
\end_layout

\end_inset

, then 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

"green"
\end_layout

\end_inset

, then 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

"red"
\end_layout

\end_inset

?
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

prob(N, isin(N, c("red","green","red"), ordered = TRUE))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Note that the exact value is 
\begin_inset Formula $7/20$
\end_inset

 (do it with the Multiplication Rule).
 What is the probability of observing 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

"red"
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

"green"
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

"red"
\end_layout

\end_inset

, in no particular order?
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

prob(N, isin(N, c("red","green","red")))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We already knew this.
 It is the probability of observing two 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

"red"
\end_layout

\end_inset

s, above.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Consider two urns, the first with 5 red balls and 3 green balls, and the
 second with 2 red balls and 6 green balls.
 Your friend randomly selects one ball from the first urn and transfers
 it to the second urn, without disclosing the color of the ball.
 You select one ball from the second urn.
 What is the probability that the selected ball is red? Let 
\begin_inset Formula $A=\left\{ \mbox{transferred ball is red}\right\} $
\end_inset

 and 
\begin_inset Formula $B=\left\{ \mbox{selected ball is red}\right\} $
\end_inset

.
 Write
\begin_inset Formula \begin{align*}
B & =S\cap B\\
 & =(A\cup A^{c})\cap B\\
 & =(A\cap B)\cup(A^{c}\cap B)\end{align*}

\end_inset

and notice that 
\begin_inset Formula $A\cap B$
\end_inset

 and 
\begin_inset Formula $A^{c}\cap B$
\end_inset

 are disjoint.
 Therefore
\begin_inset Formula \begin{align*}
\P(B) & =\P(A\cap B)+\P(A^{c}\cap B)\\
 & =\P(A)\P(B|A)+\P(A^{c})\P(B|A^{c})\\
 & =\frac{5}{8}\cdot\frac{3}{9}+\frac{3}{8}\cdot\frac{2}{9}\\
 & =\frac{21}{72}\ \end{align*}

\end_inset

(which is 7/24 in lowest terms).
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
We saw the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

RcmdrTestDrive
\end_layout

\end_inset


\color inherit
 data set in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:introduction-to-R"

\end_inset

 in which a two-way table of the smoking status versus the gender was
\end_layout

\begin_deeper
\begin_layout Scrap
<<echo = FALSE>>=
\begin_inset Newline newline
\end_inset

.Table <- xtabs(~smoke+gender, data=RcmdrTestDrive)
\begin_inset Newline newline
\end_inset

addmargins(.Table) # Table with Marginal Distributions
\begin_inset Newline newline
\end_inset

remove(.Table)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
If one person were selected at random from the data set, then we see from
 the two-way table that 
\begin_inset Formula $\P(\mbox{Female})=70/168$
\end_inset

 and 
\begin_inset Formula $\P(\mbox{Smoker})=32/168$
\end_inset

.
 Now suppose that one of the subjects quits smoking, but we do not know
 the person's gender.
 If we select one subject at random, what now is 
\begin_inset Formula $\P(\mbox{Female})$
\end_inset

? Let 
\begin_inset Formula $A=\left\{ \mbox{the quitter is a female}\right\} $
\end_inset

 and 
\begin_inset Formula $B=\left\{ \mbox{selected person is a female}\right\} $
\end_inset

.
 Write
\begin_inset Formula \begin{align*}
B & =S\cap B\\
 & =(A\cup A^{c})\cap B\\
 & =(A\cap B)\cup(A^{c}\cap B)\end{align*}

\end_inset

and notice that 
\begin_inset Formula $A\cap B$
\end_inset

 and 
\begin_inset Formula $A^{c}\cap B$
\end_inset

 are disjoint.
 Therefore
\begin_inset Formula \begin{align*}
\P(B) & =\P(A\cap B)+\P(A^{c}\cap B),\\
 & =\P(A)\P(B|A)+\P(A^{c})\P(B|A^{c}),\\
 & =\frac{5}{8}\cdot\frac{3}{9}+\frac{3}{8}\cdot\frac{2}{9},\\
 & =\frac{21}{72},\end{align*}

\end_inset

(which is 7/24 in lowest terms).
\end_layout

\end_deeper
\begin_layout Standard
Using the same reasoning, we can return to the example from the beginning
 of the section and show that
\begin_inset Formula \[
\P(\left\{ \mbox{second card is an Ace}\right\} )=4/52.\]

\end_inset

.
 
\end_layout

\begin_layout Section
Independent Events
\begin_inset CommandInset label
LatexCommand label
name "sec:Independent-Events"

\end_inset


\end_layout

\begin_layout Standard
Toss a coin twice.
 The sample space is 
\begin_inset Formula $S=\left\{ HH,\ HT,\ TH,\ TT\right\} $
\end_inset

.
 We know that 
\begin_inset Formula $\P(1^{\text{st}}\mbox{ toss is }H)=2/4$
\end_inset

, 
\begin_inset Formula $\P(2^{\text{nd}}\mbox{ toss is }H)=2/4$
\end_inset

, and 
\begin_inset Formula $\P(\mbox{both }H)=1/4$
\end_inset

.
 Then
\begin_inset Formula \begin{align*}
\P(2^{\text{nd}}\mbox{ toss is }H\ |\ 1^{\text{st}}\mbox{ toss is }H) & =\frac{\P(\mbox{both }H)}{\P(1^{\text{st}}\mbox{ toss is }H)},\\
 & =\frac{1/4}{2/4},\\
 & =\P(2^{\text{nd}}\mbox{ toss is }H).\end{align*}

\end_inset

Intuitively, this means that the information that the first toss is 
\begin_inset Formula $H$
\end_inset

 has no bearing on the probability that the second toss is 
\begin_inset Formula $H$
\end_inset

.
 The coin does not remember the result of the first toss.
 
\end_layout

\begin_layout Definition
Events 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are said to be 
\emph on
independent
\emph default
 if 
\begin_inset Formula \begin{equation}
\P(A\cap B)=\P(A)\P(B).\end{equation}

\end_inset

Otherwise, the events are said to be 
\emph on
dependent
\emph default
.
 
\end_layout

\begin_layout Standard
The connection with the above example stems from the following.
 We know from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Conditional-Probability"

\end_inset

 that when 
\begin_inset Formula $\P(B)>0$
\end_inset

 we may write 
\begin_inset Formula \begin{equation}
\P(A|B)=\frac{\P(A\cap B)}{\P(B)}.\end{equation}

\end_inset

In the case that 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are independent, the numerator of the fraction factors so that 
\begin_inset Formula $\P(B)$
\end_inset

 cancels with the result:
\begin_inset Formula \begin{equation}
\P(A|B)=\P(A)\quad\mbox{when \mbox{\emph{A},\emph{ B}} are independent.}\end{equation}

\end_inset

The interpretation in the case of independence is that the information that
 the event 
\begin_inset Formula $B$
\end_inset

 occurred does not influence the probability of the event 
\begin_inset Formula $A$
\end_inset

 occurring.
 Similarly, 
\begin_inset Formula $\P(B|A)=\P(B)$
\end_inset

, and so the occurrence of the event 
\begin_inset Formula $A$
\end_inset

 likewise does not affect the probability of event 
\begin_inset Formula $B$
\end_inset

.
 It may seem more natural to define 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 to be independent when 
\begin_inset Formula $\P(A|B)=\P(A)$
\end_inset

; however, the conditional probability 
\begin_inset Formula $\P(A|B)$
\end_inset

 is only defined when 
\begin_inset Formula $\P(B)>0$
\end_inset

.
 Our definition is not limited by this restriction.
 It can be shown that when 
\begin_inset Formula $\P(A),\ \P(B)>0$
\end_inset

 the two notions of independence are equivalent.
\end_layout

\begin_layout Proposition
If the events 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are independent then
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B^{c}$
\end_inset

 are independent,
\end_layout

\begin_layout Itemize
\begin_inset Formula $A^{c}$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are independent,
\end_layout

\begin_layout Itemize
\begin_inset Formula $A^{c}$
\end_inset

 and 
\begin_inset Formula $B^{c}$
\end_inset

 are independent.
\end_layout

\end_deeper
\begin_layout Proof
Suppose that 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are independent.
 We will show the second one; the others are similar.
 We need to show that
\begin_inset Formula \[
\P(A^{c}\cap B)=\P(A^{c})\P(B).\]

\end_inset

To this end, note that the Multiplication Rule, Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:multiplication-rule-short"

\end_inset

 implies 
\begin_inset Formula \begin{eqnarray*}
\P(A^{c}\cap B) & = & \P(B)\P(A^{c}|B),\\
 & = & \P(B)[1-\P(A|B)],\\
 & = & \P(B)\P(A^{c}).\end{eqnarray*}

\end_inset


\end_layout

\begin_layout Definition
The events 
\begin_inset Formula $A$
\end_inset

, 
\begin_inset Formula $B$
\end_inset

, and 
\begin_inset Formula $C$
\end_inset

 are 
\emph on
mutually independent
\emph default
 if the following four conditions are met: 
\begin_inset Formula \begin{eqnarray*}
\P(A\cap B) & = & \P(A)\P(B),\\
\P(A\cap C) & = & \P(A)\P(C),\\
\P(B\cap C) & = & \P(B)\P(C),\end{eqnarray*}

\end_inset

and
\begin_inset Formula \[
\P(A\cap B\cap C)=\P(A)\P(B)\P(C).\]

\end_inset

If only the first three conditions hold then 
\begin_inset Formula $A$
\end_inset

, 
\begin_inset Formula $B$
\end_inset

, and 
\begin_inset Formula $C$
\end_inset

 are said to be independent 
\emph on
pairwise
\emph default
.
 Note that pairwise independence is not the same as mutual independence
 when the number of events is larger than two.
\end_layout

\begin_layout Standard
We can now deduce the pattern for 
\begin_inset Formula $n$
\end_inset

 events, 
\begin_inset Formula $n>3$
\end_inset

.
 The events will be mutually independent only if they satisfy the product
 equality pairwise, then in groups of three, in groups of four, and so forth,
 up to all 
\begin_inset Formula $n$
\end_inset

 events at once.
 For 
\begin_inset Formula $n$
\end_inset

 events, there will be 
\begin_inset Formula $2^{n}-n-1$
\end_inset

 equations that must be satisfied (see Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:numb-cond-indep"

\end_inset

).
 Although these requirements for a set of events to be mutually independent
 may seem stringent, the good news is that for most of the situations considered
 in this book the conditions will all be met (or at least we will suppose
 that they are).
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:toss-ten-coins"

\end_inset

Toss ten coins.
 What is the probability of observing at least one Head? Answer: Let 
\begin_inset Formula $A_{i}=\left\{ \mbox{the }i^{\text{th}}\mbox{ coin shows }H\right\} ,\ i=1,2,\ldots,10$
\end_inset

.
 Supposing that we toss the coins in such a way that they do not interfere
 with each other, this is one of the situations where all of the 
\begin_inset Formula $A_{i}$
\end_inset

 may be considered mutually independent due to the nature of the tossing.
 Of course, the only way that there will not be at least one Head showing
 is if all tosses are Tails.
 Therefore,
\begin_inset Formula \begin{align*}
\P(\mbox{at least one }H) & =1-\P(\mbox{all }T),\\
 & =1-\P(A_{1}^{c}\cap A_{2}^{c}\cap\cdots\cap A_{10}^{c}),\\
 & =1-\P(A_{1}^{c})\P(A_{2}^{c})\cdots\P(A_{10}^{c}),\\
 & =1-\left(\frac{1}{2}\right)^{10},\end{align*}

\end_inset

which is approximately 
\begin_inset Formula $0.9990234$
\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Example
Toss ten coins.
 What is the probability of observing at least one Head?
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

S <- tosscoin(10, makespace = TRUE)
\begin_inset Newline newline
\end_inset

A <- subset(S, isrep(S, vals = "T", nrep = 10))
\begin_inset Newline newline
\end_inset

1 - prob(A)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Compare this answer to what we got in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:toss-ten-coins"

\end_inset

.
\end_layout

\end_deeper
\begin_layout Subsection*
Independent, Repeated Experiments
\end_layout

\begin_layout Standard
Generalizing from above it is common to repeat a certain experiment multiple
 times under identical conditions and in an independent manner.
 We have seen many examples of this already: tossing a coin repeatedly,
 rolling a die or dice, 
\shape italic
etc
\shape default
.
\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

iidspace
\end_layout

\end_inset


\color inherit
 function was designed specifically for this situation.
 It has three arguments: 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset

,
\color inherit
 which is a vector of outcomes, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ntrials
\end_layout

\end_inset

,
\color inherit
 which is an integer telling how many times to repeat the experiment, and
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 to specify the probabilities of the outcomes of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 in a single trial.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example

\series bold
An unbalanced coin
\series default
 (continued, see Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:unbalanced-coin"

\end_inset

).
 It was easy enough to set up the probability space for one unbalanced toss,
 however, the situation becomes more complicated when there are many tosses
 involved.
 Clearly, the outcome 
\begin_inset Formula $HHH$
\end_inset

 should not have the same probability as 
\begin_inset Formula $TTT$
\end_inset

, which should again not have the same probability as 
\begin_inset Formula $HTH$
\end_inset

.
 At the same time, there is symmetry in the experiment in that the coin
 does not remember the face it shows from toss to toss, and it is easy enough
 to toss the coin in a similar way repeatedly.
\end_layout

\begin_deeper
\begin_layout Standard
We may represent tossing our unbalanced coin three times with the following:
 
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>= 
\begin_inset Newline newline
\end_inset

iidspace(c("H","T"), ntrials = 3, probs = c(0.7, 0.3)) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
As expected, the outcome 
\begin_inset Formula $HHH$
\end_inset

 has the largest probability, while 
\begin_inset Formula $TTT$
\end_inset

 has the smallest.
 (Since the trials are independent, 
\begin_inset Formula $\P(HHH)=0.7^{3}$
\end_inset

 and 
\begin_inset Formula $\P(TTT)=0.3^{3}$
\end_inset

, 
\shape italic
etc
\shape default
.) Note that the result of the function call is a probability space, not
 a sample space (which we could construct already with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

tosscoin
\end_layout

\end_inset


\color inherit
 or 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

urnsamples
\end_layout

\end_inset


\color inherit
 functions).
 The same procedure could be used to model an unbalanced die or any other
 experiment that may be represented with a vector of possible outcomes.
\end_layout

\end_deeper
\begin_layout Standard
Note that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

iidspace
\end_layout

\end_inset


\color inherit
 will assume 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 has equally likely outcomes if no 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 argument is specified.
 Also note that the argument 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 is a 
\emph on
vector
\emph default
, not a data frame.
 Something like 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

iidspace(tosscoin(1),...)
\end_layout

\end_inset

 
\color inherit
would give an error.
\end_layout

\begin_layout Section
Bayes' Rule
\begin_inset CommandInset label
LatexCommand label
name "sec:Bayes'-Rule"

\end_inset


\end_layout

\begin_layout Standard
We mentioned the subjective view of probability in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Interpreting-Probabilities"

\end_inset

.
 In this section we introduce a rule that allows us to update our probabilities
 when new information becomes available.
 
\end_layout

\begin_layout Theorem

\series bold
\emph on
(Bayes' Rule).

\series default
\emph default
 Let 
\begin_inset Formula $B_{1}$
\end_inset

, 
\begin_inset Formula $B_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $B_{n}$
\end_inset

 be mutually exclusive and exhaustive and let 
\begin_inset Formula $A$
\end_inset

 be an event with 
\begin_inset Formula $\P(A)>0$
\end_inset

.
 Then 
\begin_inset Formula \begin{equation}
\P(B_{k}|A)=\frac{\P(B_{k})\P(A|B_{k})}{\sum_{i=1}^{n}\P(B_{i})\P(A|B_{i})},\quad k=1,2,\ldots,n.\label{eq:bayes-rule}\end{equation}

\end_inset


\end_layout

\begin_layout Proof
The proof follows from looking at 
\begin_inset Formula $\P(B_{k}\cap A)$
\end_inset

 in two different ways.
 For simplicity, suppose that 
\begin_inset Formula $P(B_{k})>0$
\end_inset

 for all 
\begin_inset Formula $k$
\end_inset

.
 Then
\begin_inset Formula \[
\P(A)\P(B_{k}|A)=\P(B_{k}\cap A)=\P(B_{k})\P(A|B_{k}).\]

\end_inset

Since 
\begin_inset Formula $\P(A)>0$
\end_inset

 we may divide through to obtain 
\begin_inset Formula \[
\P(B_{k}|A)=\frac{\P(B_{k})\P(A|B_{k})}{\P(A)}.\]

\end_inset

Now remembering that 
\begin_inset Formula $\left\{ B_{k}\right\} $
\end_inset

 is a partition, the Theorem of Total Probability (Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:theorem-total-probability"

\end_inset

) gives the denominator of the last expression to be
\begin_inset Formula \[
\P(A)=\sum_{k=1}^{n}\P(B_{k}\cap A)=\sum_{k=1}^{n}\P(B_{k})\P(A|B_{k}).\]

\end_inset


\end_layout

\begin_layout Standard
What does it mean? Usually in applications we are given (or know) 
\emph on
a priori
\emph default
 probabilities 
\begin_inset Formula $\P(B_{k})$
\end_inset

.
 We go out and collect some data, which we represent by the event 
\begin_inset Formula $A$
\end_inset

.
 We want to know: how do we 
\series bold
update
\series default
 
\begin_inset Formula $\P(B_{k})$
\end_inset

 to 
\begin_inset Formula $\P(B_{k}|A)$
\end_inset

? The answer: Bayes' Rule.
\end_layout

\begin_layout Example

\series bold
\begin_inset CommandInset label
LatexCommand label
name "exa:misfiling-assistants"

\end_inset

Misfiling Assistants
\emph on
.

\series default
\emph default
 In this problem, there are three assistants working at a company: Moe,
 Larry, and Curly.
 Their primary job duty is to file paperwork in the filing cabinet when
 papers become available.
 The three assistants have different work schedules:
\end_layout

\begin_layout Example
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="4">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Moe
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Larry
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Curly
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Workload
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
60%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
30%
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10%
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
That is, Moe works 60% of the time, Larry works 30% of the time, and Curly
 does the remaining 10%, and they file documents at approximately the same
 speed.
 Suppose a person were to select one of the documents from the cabinet at
 random.
 Let 
\begin_inset Formula $M$
\end_inset

 be the event
\begin_inset Formula \[
M=\left\{ \mbox{Moe filed the document}\right\} \]

\end_inset

and let 
\begin_inset Formula $L$
\end_inset

 and 
\begin_inset Formula $C$
\end_inset

 be the events that Larry and Curly, respectively, filed the document.
 What are these events' respective probabilities? In the absence of additional
 information, reasonable prior probabilities would just be
\end_layout

\begin_layout Example
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="4">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Moe
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Larry
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Curly
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Prior Probability
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\P(M)=0.60$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\P(L)=0.30$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\P(C)=0.10$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
Now, the boss comes in one day, opens up the file cabinet, and selects a
 file at random.
 The boss discovers that the file has been misplaced.
 The boss is so angry at the mistake that (s)he threatens to fire the one
 who erred.
 The question is: who misplaced the file?
\end_layout

\begin_layout Example
The boss decides to use probability to decide, and walks straight to the
 workload schedule.
 (S)he reasons that, since the three employees work at the same speed, the
 probability that a randomly selected file would have been filed by each
 one would be proportional to his workload.
 The boss notifies 
\series bold
Moe
\series default
 that he has until the end of the day to empty his desk.
\end_layout

\begin_layout Example
But Moe argues in his defense that the boss has ignored additional information.
 Moe's likelihood of having misfiled a document is smaller than Larry's
 and Curly's, since he is a diligent worker who pays close attention to
 his work.
 Moe admits that he works longer than the others, but he doesn't make as
 many mistakes as they do.
 Thus, Moe recommends that -- before making a decision -- the boss should
 update the probability (initially based on workload alone) to incorporate
 the likelihood of having observed a misfiled document.
\end_layout

\begin_layout Example
And, as it turns out, the boss has information about Moe, Larry, and Curly's
 filing accuracy in the past (due to historical performance evaluations).
 The performance information may be represented by the following table:
\end_layout

\begin_layout Example
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="4">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Moe
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Larry
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Curly
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Misfile Rate
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.003
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.007
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0.010
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
In other words, on the average, Moe misfiles 0.3% of the documents he is
 supposed to file.
 Notice that Moe was correct: he is the most accurate filer, followed by
 Larry, and lastly Curly.
 If the boss were to make a decision based only on the worker's overall
 accuracy, then 
\series bold
Curly
\series default
 should get the axe.
 But Curly hears this and interjects that he only works a short period during
 the day, and consequently makes mistakes only very rarely; there is only
 the tiniest chance that he misfiled this particular document.
\end_layout

\begin_layout Example
The boss would like to use this updated information to update the probabilities
 for the three assistants, that is, (s)he wants to use the additional likelihood
 that the document was misfiled to update his/her beliefs about the likely
 culprit.
 Let 
\begin_inset Formula $A$
\end_inset

 be the event that a document is misfiled.
 What the boss would like to know are the three probabilities 
\begin_inset Formula \[
\P(M|A),\mbox{ }\P(L|A),\mbox{ and }\P(C|A).\]

\end_inset

We will show the calculation for 
\begin_inset Formula $\P(M|A)$
\end_inset

, the other two cases being similar.
 We use Bayes' Rule in the form
\begin_inset Formula \[
\P(M|A)=\frac{\P(M\cap A)}{\P(A)}.\]

\end_inset

Let's try to find 
\begin_inset Formula $\P(M\cap A)$
\end_inset

, which is just 
\begin_inset Formula $\P(M)\cdot\P(A|M)$
\end_inset

 by the Multiplication Rule.
 We already know 
\begin_inset Formula $\P(M)=0.6$
\end_inset

 and 
\begin_inset Formula $\P(A|M)$
\end_inset

 is nothing more than Moe's misfile rate, given above to be 
\begin_inset Formula $\P(A|M)=0.003$
\end_inset

.
 Thus, we compute
\begin_inset Formula \[
\P(M\cap A)=(0.6)(0.003)=0.0018.\]

\end_inset

Using the same procedure we may calculate
\begin_inset Formula \[
\P(L|A)=0.0021\mbox{ and }\P(C|A)=0.0010.\]

\end_inset

Now let's find the denominator, 
\begin_inset Formula $\P(A)$
\end_inset

.
 The key here is the notion that if a file is misplaced, then either Moe
 or Larry or Curly must have filed it; there is no one else around to do
 the misfiling.
 Further, these possibilities are mutually exclusive.
 We may use the Theorem of Total Probability 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:theorem-total-probability"

\end_inset

 to write
\begin_inset Formula \[
\P(A)=\P(A\cap M)+\P(A\cap L)+\P(A\cap C).\]

\end_inset

Luckily, we have computed these above.
 Thus
\begin_inset Formula \[
\P(A)=0.0018+0.0021+0.0010=0.0049.\]

\end_inset

Therefore, Bayes' Rule yields
\begin_inset Formula \[
\P(M|A)=\frac{0.0018}{0.0049}\approx0.37.\]

\end_inset

This last quantity is called the posterior probability that Moe misfiled
 the document, since it incorporates the observed data that a randomly selected
 file was misplaced (which is governed by the misfile rate).
 We can use the same argument to calculate
\end_layout

\begin_layout Example
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="4">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Moe
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Larry
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Curly
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Posterior Probability
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\P(M|A)\approx0.37$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\P(L|A)\approx0.43$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\P(C|A)\approx0.20$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
The conclusion: 
\series bold
Larry
\series default
 gets the axe.
 What is happening is an intricate interplay between the time on the job
 and the misfile rate.
 It is not obvious who the winner (or in this case, loser) will be, and
 the statistician needs to consult Bayes' Rule to determine the best course
 of action.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:misfiling-assistants-multiple"

\end_inset

Suppose the boss gets a change of heart and does not fire anybody.
 But the next day (s)he randomly selects another file and again finds it
 to be misplaced.
 To decide whom to fire now, the boss would use the same procedure, with
 one small change.
 (S)he would not use the prior probabilities 
\begin_inset Formula $ $
\end_inset

60%, 30%, and 10%; those are old news.
 Instead, she would replace the prior probabilities with the posterior probabili
ties just calculated.
 After the math she will have new posterior probabilities, updated even
 more from the day before.
\end_layout

\begin_layout Example
In this way, probabilities found by Bayes' rule are always on the cutting
 edge, always updated with respect to the best information available at
 the time.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
There are not any special functions for Bayes' Rule in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset

 package, but problems like the ones above are easy enough to do by hand.
\end_layout

\begin_layout Example

\series bold
Misfiling assistants
\series default
 (continued from Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:misfiling-assistants"

\end_inset

).
 We store the prior probabilities and the likelihoods in vectors and go
 to town.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

prior <- c(0.6, 0.3, 0.1)
\begin_inset Newline newline
\end_inset

like <- c(0.003, 0.007, 0.010)
\begin_inset Newline newline
\end_inset

post <- prior * like
\begin_inset Newline newline
\end_inset

post / sum(post)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Standard
Compare these answers with what we got in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:misfiling-assistants"

\end_inset

.
 We would replace 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prior
\end_layout

\end_inset

 with
\color inherit
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

post
\end_layout

\end_inset

 in a future calculation.
 We could raise 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

like
\end_layout

\end_inset

 to a power to see how the posterior is affected by future document mistakes.
 (Do you see why? Think back to Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Independent-Events"

\end_inset

.)
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Let us incorporate the posterior probability 
\color none
(
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

post
\end_layout

\end_inset

) information from the last example and suppose that the assistants misfile
 seven more documents.
 Using Bayes' Rule, what would the new posterior probabilities be?
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

newprior <- post
\begin_inset Newline newline
\end_inset

post <- newprior * like^7
\begin_inset Newline newline
\end_inset

post / sum(post)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Example
We see that the individual with the highest probability of having misfiled
 all eight documents given the observed data is no longer Larry, but Curly.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
There are two important points.
 First, we did not divide 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

post
\end_layout

\end_inset

 by the sum of its entries until the very last step; we do not need to calculate
 it, and it will save us computing time to postpone normalization until
 absolutely necessary, namely, until we finally want to interpret them as
 probabilities.
\end_layout

\begin_layout Standard
Second, the reader might be wondering what the boss would get if (s)he skipped
 the intermediate step of calculating the posterior after only one misfiled
 document.
 What if she started from the 
\emph on
original
\emph default
 prior, then observed eight misfiled documents, and calculated the posterior?
 What would she get? It must be the same answer, of course.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

fastpost <- prior * like^8
\begin_inset Newline newline
\end_inset

fastpost / sum(fastpost)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Compare this to what we got in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:misfiling-assistants-multiple"

\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Section
Random Variables
\begin_inset CommandInset label
LatexCommand label
name "sec:Random-Variables"

\end_inset


\end_layout

\begin_layout Standard
We already know about experiments, sample spaces, and events.
 In this section, we are interested in a 
\emph on
number
\emph default
 that is associated with the experiment.
 We conduct a random experiment 
\begin_inset Formula $E$
\end_inset

 and after learning the outcome 
\begin_inset Formula $\omega$
\end_inset

 in 
\begin_inset Formula $S$
\end_inset

 we calculate a number 
\begin_inset Formula $X$
\end_inset

.
 That is, to each outcome 
\begin_inset Formula $\omega$
\end_inset

 in the sample space we associate a number 
\begin_inset Formula $X(\omega)=x$
\end_inset

.
 
\end_layout

\begin_layout Definition
A 
\emph on
random variable
\emph default
 
\begin_inset Formula $X$
\end_inset

 is a function 
\begin_inset Formula $X:S\to\R$
\end_inset

 that associates to each outcome 
\begin_inset Formula $\omega\in S$
\end_inset

 exactly one number 
\begin_inset Formula $X(\omega)=x$
\end_inset

.
 
\end_layout

\begin_layout Standard
We usually denote random variables by uppercase letters such as 
\begin_inset Formula $X$
\end_inset

, 
\begin_inset Formula $Y$
\end_inset

, and 
\begin_inset Formula $Z$
\end_inset

, and we denote their observed values by lowercase letters 
\begin_inset Formula $x$
\end_inset

, 
\begin_inset Formula $y$
\end_inset

, and 
\begin_inset Formula $z$
\end_inset

.
 Just as 
\begin_inset Formula $S$
\end_inset

 is the set of all possible outcomes of 
\begin_inset Formula $E$
\end_inset

, we call the set of all possible values of 
\begin_inset Formula $X$
\end_inset

 the 
\emph on
support
\emph default
 of 
\begin_inset Formula $X$
\end_inset

 and denote it by 
\begin_inset Formula $S_{X}$
\end_inset

.
\end_layout

\begin_layout Example
Let 
\begin_inset Formula $E$
\end_inset

 be the experiment of flipping a coin twice.
 We have seen that the sample space is 
\begin_inset Formula $S=\left\{ HH,\ HT,\ TH,\ TT\right\} $
\end_inset

.
 Now define the random variable 
\begin_inset Formula $X=\mbox{the number of heads}$
\end_inset

.
 That is, for example, 
\begin_inset Formula $X(HH)=2$
\end_inset

, while 
\begin_inset Formula $X(HT)=1$
\end_inset

.
 We may make a table of the possibilities:
\end_layout

\begin_layout Example
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="5">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\omega\in S$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $HH$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $HT$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $TH$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $TT$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $X(\omega)=x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
Taking a look at the second row of the table, we see that the support of
 
\begin_inset Formula $X$
\end_inset

 -- the set of all numbers that 
\begin_inset Formula $X$
\end_inset

 assumes -- would be 
\begin_inset Formula $S_{X}=\left\{ 0,1,2\right\} $
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Let 
\begin_inset Formula $E$
\end_inset

 be the experiment of flipping a coin repeatedly until observing a Head.
 The sample space would be 
\begin_inset Formula $S=\left\{ H,\ TH,\ TTH,\ TTTH,\ \ldots\right\} $
\end_inset

.
 Now define the random variable 
\begin_inset Formula $Y=\mbox{the number of Tails before the first head}$
\end_inset

.
 Then the support of 
\begin_inset Formula $Y$
\end_inset

 would be 
\begin_inset Formula $S_{Y}=\left\{ 0,1,2,\ldots\right\} $
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Let 
\begin_inset Formula $E$
\end_inset

 be the experiment of tossing a coin in the air, and define the random variable
 
\begin_inset Formula $Z=\mbox{the time (in seconds) until the coin hits the ground}$
\end_inset

.
 In this case, the sample space is inconvenient to describe.
 Yet the support of 
\begin_inset Formula $Z$
\end_inset

 would be 
\begin_inset Formula $(0,\infty)$
\end_inset

.
 Of course, it is reasonable to suppose that the coin will return to Earth
 in a short amount of time; in practice, the set 
\begin_inset Formula $(0,\infty)$
\end_inset

 is admittedly too large.
 However, we will find that in many circumstances it is mathematically convenien
t to study the extended set rather than a restricted one.
\end_layout

\begin_layout Standard
There are important differences between the supports of 
\begin_inset Formula $X$
\end_inset

, 
\begin_inset Formula $Y$
\end_inset

, and 
\begin_inset Formula $Z$
\end_inset

.
 The support of 
\begin_inset Formula $X$
\end_inset

 is a finite collection of elements that can be inspected all at once.
 And while the support of 
\begin_inset Formula $Y$
\end_inset

 cannot be exhaustively written down, its elements can nevertheless be listed
 in a naturally ordered sequence.
 Random variables with supports similar to those of 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are called 
\emph on
discrete random variables
\emph default
.
 We study these in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Discrete-Distributions"

\end_inset

.
\end_layout

\begin_layout Standard
In contrast, the support of 
\begin_inset Formula $Z$
\end_inset

 is a continuous interval, containing all rational and irrational positive
 real numbers.
 For this reason
\begin_inset Foot
status open

\begin_layout Plain Layout
This isn't really the reason, but it serves as an effective litmus test
 at the introductory level.
 See Billingsley or Resnick.
\end_layout

\end_inset

, random variables with supports like 
\begin_inset Formula $Z$
\end_inset

 are called 
\emph on
continuous random variables
\emph default
, to be studied in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Continuous-Distributions"

\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The primary vessel for this task is the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

addrv
\end_layout

\end_inset


\color inherit
 function.
 There are two ways to use it, and we will describe both.
\end_layout

\begin_layout Subsubsection*
Supply a Defining Formula
\end_layout

\begin_layout Standard
The first method is based on the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

transform
\end_layout

\end_inset


\color inherit
 function.
 See 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?transform
\end_layout

\end_inset

.

\color inherit
 The idea is to write a formula defining the random variable inside the
 function, and it will be added as a column to the data frame.
 As an example, let us roll a 4-sided die three times, and let us define
 the random variable 
\begin_inset Formula $U=X1-X2+X3$
\end_inset

.
 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=FALSE>>= 
\begin_inset Newline newline
\end_inset

S <- rolldie(3, nsides = 4, makespace = TRUE) 
\begin_inset Newline newline
\end_inset

S <- addrv(S, U = X1-X2+X3) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
Now let's take a look at the values of 
\begin_inset Formula $U$
\end_inset

.
 In the interest of space, we will only reproduce the first few rows of
 
\begin_inset Formula $S$
\end_inset

 (there are 
\begin_inset Formula $4^{3}=64$
\end_inset

 rows in total).
 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

head(S)
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
We see from the 
\begin_inset Formula $U$
\end_inset

 column it is operating just like it should.
 We can now answer questions like
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

prob(S, U > 6) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Subsubsection*
Supply a Function
\end_layout

\begin_layout Standard
Sometimes we have a function laying around that we would like to apply to
 some of the outcome variables, but it is unfortunately tedious to write
 out the formula defining what the new variable would be.
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

addrv
\end_layout

\end_inset


\color inherit
 function has an argument 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

FUN
\end_layout

\end_inset


\color inherit
 specifically for this case.
 Its value should be a legitimate function from 
\family sans
R
\family default
, such as 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

sum
\end_layout

\end_inset


\color inherit
, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mean
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

median
\end_layout

\end_inset


\color inherit
, 
\emph on
etc
\emph default
.
 Or, you can define your own function.
 Continuing the previous example, let's define 
\begin_inset Formula $V=\max(X1,X2,X3)$
\end_inset

 and 
\begin_inset Formula $W=X1+X2+X3$
\end_inset

.
 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=FALSE>>= 
\begin_inset Newline newline
\end_inset

S <- addrv(S, FUN = max, invars = c("X1","X2","X3"), name = "V") 
\begin_inset Newline newline
\end_inset

S <- addrv(S, FUN = sum, invars = c("X1","X2","X3"), name = "W") 
\begin_inset Newline newline
\end_inset

head(S) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
Notice that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

addrv
\end_layout

\end_inset


\color inherit
 has an 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

invars
\end_layout

\end_inset


\color inherit
 argument to specify exactly to which columns one would like to apply the
 function 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

FUN
\end_layout

\end_inset


\color inherit
.
 If no input variables are specified, then 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

addrv
\end_layout

\end_inset


\color inherit
 will apply 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

FUN
\end_layout

\end_inset


\color inherit
 to all non-
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
 columns.
 Further, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

addrv
\end_layout

\end_inset


\color inherit
 has an optional argument 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

name
\end_layout

\end_inset


\color inherit
 to give the new variable; this can be useful when adding several random
 variables to a probability space (as above).
 If not specified, the default name is 
\begin_inset Quotes eld
\end_inset


\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

X
\end_layout

\end_inset


\color inherit

\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Subsubsection*
Marginal Distributions
\end_layout

\begin_layout Standard
As we can see above, often after adding a random variable 
\begin_inset Formula $V$
\end_inset

 to a probability space one will find that 
\begin_inset Formula $V$
\end_inset

 has values that are repeated, so that it becomes difficult to understand
 what the ultimate behavior of 
\begin_inset Formula $V$
\end_inset

 actually is.
 We can use the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

marginal
\end_layout

\end_inset


\color inherit
 function to aggregate the rows of the sample space by values of 
\begin_inset Formula $V$
\end_inset

, all the while accumulating the probability associated with 
\begin_inset Formula $V$
\end_inset

's distinct values.
 Continuing our example from above, suppose we would like to focus entirely
 on the values and probabilities of 
\begin_inset Formula $V=\max(X1,X2,X3)$
\end_inset

.
 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

marginal(S, vars = "V") 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
We could save the probability space of 
\begin_inset Formula $V$
\end_inset

 in a data frame and study it further, if we wish.
 As a final remark, we can calculate the marginal distributions of multiple
 variables desired using the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

vars
\end_layout

\end_inset


\color inherit
 argument.
 For example, suppose we would like to examine the joint distribution of
 
\begin_inset Formula $V$
\end_inset

 and 
\begin_inset Formula $W$
\end_inset

.
 
\end_layout

\begin_layout Scrap
<<echo=TRUE,print=TRUE>>= 
\begin_inset Newline newline
\end_inset

marginal(S, vars = c("V", "W")) 
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
Note that the default value of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

vars
\end_layout

\end_inset


\color inherit
 is the names of all columns except 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

probs
\end_layout

\end_inset


\color inherit
.
 This can be useful if there are duplicated rows in the probability space.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Chapter Exercises
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{section}{Chapter Exercises}
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{thm}{0}
\end_layout

\end_inset


\end_layout

\begin_layout Scrap
<<echo = FALSE, results = hide>>=
\begin_inset Newline newline
\end_inset

rnorm(1)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Exercise
\begin_inset CommandInset label
LatexCommand label
name "xca:numb-cond-indep"

\end_inset

Prove the assertion given in the text: the number of conditions that the
 events 
\begin_inset Formula $A_{1}$
\end_inset

, 
\begin_inset Formula $A_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $A_{n}$
\end_inset

 must satisfy in order to be mutually independent is 
\begin_inset Formula $2^{n}-n-1$
\end_inset

.
 (
\emph on
Hint
\emph default
: think about Pascal's triangle.)
\end_layout

\begin_layout Standard
\begin_inset Branch answers
status open

\begin_layout Paragraph*
Answer:
\end_layout

\begin_layout Standard
The events must satisfy the product equalities two at a time, of which there
 are 
\begin_inset Formula ${n \choose 2}$
\end_inset

, then they must satisfy an additional 
\begin_inset Formula ${n \choose 3}$
\end_inset

 conditions three at a time, and so on, until they satisfy the 
\begin_inset Formula ${n \choose n}=1$
\end_inset

 condition including all 
\begin_inset Formula $n$
\end_inset

 events.
 In total, there are 
\begin_inset Formula \[
{n \choose 2}+{n \choose 3}+\cdots+{n \choose n}=\sum_{k=0}^{n}{n \choose k}-\left[{n \choose 0}+{n \choose 1}\right]\]

\end_inset

conditions to be satisfied, but the binomial series in the expression on
 the right is the sum of the entries of the 
\begin_inset Formula $n$
\end_inset


\begin_inset Formula $^{\text{th}}$
\end_inset

 row of Pascal's triangle, which is 
\begin_inset Formula $2^{n}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Scrap

\end_layout

\begin_layout Chapter
Discrete Distributions
\begin_inset CommandInset label
LatexCommand label
name "cha:Discrete-Distributions"

\end_inset


\end_layout

\begin_layout Standard
\noindent
In this chapter we introduce discrete random variables, those who take values
 in a finite or countably infinite support set.
 We discuss probability mass functions and some special expectations, namely,
 the mean, variance and standard deviation.
 Some of the more important discrete distributions are explored in detail,
 and the more general concept of expectation is defined, which paves the
 way for moment generating functions.
\end_layout

\begin_layout Standard
We give special attention to the empirical distribution since it plays such
 a fundamental role with respect to re sampling and Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:resampling-methods"

\end_inset

; it will also be needed in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Kolmogorov-Smirnov-Goodness-of-Fit-Test"

\end_inset

 where we discuss the Kolmogorov-Smirnov test.
 Following this is a section in which we introduce a catalogue of discrete
 random variables that can be used to model experiments.
\end_layout

\begin_layout Standard
There are some comments on simulation, and we mention transformations of
 random variables in the discrete case.
 The interested reader who would like to learn more about any of the assorted
 discrete distributions mentioned here should take a look at 
\emph on
Univariate Discrete Distributions
\emph default
 by Johnson 
\emph on
et al 
\emph default

\begin_inset CommandInset citation
LatexCommand cite
key "Johnson1993"

\end_inset

.
\end_layout

\begin_layout Paragraph*
What do I want them to know?
\end_layout

\begin_layout Itemize
how to choose a reasonable discrete model under a variety of physical circumstan
ces
\end_layout

\begin_layout Itemize
the notion of mathematical expectation, how to calculate it, and basic propertie
s
\end_layout

\begin_layout Itemize
moment generating functions (yes, I want them to hear about those)
\end_layout

\begin_layout Itemize
the general tools of the trade for manipulation of continuous random variables,
 integration, 
\emph on
etc
\emph default
.
\end_layout

\begin_layout Itemize
some details on a couple of discrete models, and exposure to a bunch of
 other ones
\end_layout

\begin_layout Itemize
how to make new discrete random variables from old ones
\end_layout

\begin_layout Section
Discrete Random Variables
\begin_inset CommandInset label
LatexCommand label
name "sec:discrete-random-variables"

\end_inset


\end_layout

\begin_layout Subsection
Probability Mass Functions
\begin_inset CommandInset label
LatexCommand label
name "sub:probability-mass-functions"

\end_inset


\end_layout

\begin_layout Standard
Discrete random variables are characterized by their supports which take
 the form 
\begin_inset Formula \begin{equation}
S_{X}=\{u_{1},u_{2},\ldots,u_{k}\}\mbox{ or }S_{X}=\{u_{1},u_{2},u_{3}\ldots\}.\end{equation}

\end_inset

Every discrete random variable 
\begin_inset Formula $X$
\end_inset

 has associated with it a probability mass function (PMF) 
\begin_inset Formula $f_{X}:S_{X}\to[0,1]$
\end_inset

 defined by 
\begin_inset Formula \begin{equation}
f_{X}(x)=\P(X=x),\quad x\in S_{X}.\end{equation}

\end_inset

Since values of the PMF represent probabilities, we know from Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Probability"

\end_inset

 that PMFs enjoy certain properties.
 In particular, all PMFs satisfy 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $f_{X}(x)>0$
\end_inset

 for 
\begin_inset Formula $x\in S$
\end_inset

,
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\sum_{x\in S}f_{X}(x)=1$
\end_inset

, and
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\P(X\in A)=\sum_{x\in A}f_{X}(x)$
\end_inset

, for any event 
\begin_inset Formula $A\subset S$
\end_inset

.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:Toss-a-coin"

\end_inset

Toss a coin 3 times.
 The sample space would be
\begin_inset Formula \[
S=\left\{ HHH,\ HTH,\ THH,\ TTH,\ HHT,\ HTT,\ THT,\ TTT\right\} .\]

\end_inset

Now let 
\begin_inset Formula $X$
\end_inset

 be the number of Heads observed.
 Then 
\begin_inset Formula $X$
\end_inset

 has support 
\begin_inset Formula $S_{X}=\left\{ 0,1,2,3\right\} $
\end_inset

.
 Assuming that the coin is fair and was tossed in exactly the same way each
 time, it is not unreasonable to suppose that the outcomes in the sample
 space are all equally likely.
 What is the PMF of 
\begin_inset Formula $X$
\end_inset

? Notice that 
\begin_inset Formula $X$
\end_inset

 is zero exactly when the outcome 
\begin_inset Formula $TTT$
\end_inset

 occurs, and this event has probability 
\begin_inset Formula $1/8$
\end_inset

.
 Therefore, 
\begin_inset Formula $f_{X}(0)=1/8$
\end_inset

, and the same reasoning shows that 
\begin_inset Formula $f_{X}(3)=1/8$
\end_inset

.
 Exactly three outcomes result in 
\begin_inset Formula $X=1$
\end_inset

, thus, 
\begin_inset Formula $f_{X}(1)=3/8$
\end_inset

 and 
\begin_inset Formula $f_{X}(3)$
\end_inset

 holds the remaining 
\begin_inset Formula $3/8$
\end_inset

 probability (the total is 1).
 We can represent the PMF with a table:
\end_layout

\begin_layout Example
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="6">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x\in S_{X}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Total
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $f_{X}(x)=\P(X=x)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3/8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3/8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Mean, Variance, and Standard Deviation
\begin_inset CommandInset label
LatexCommand label
name "sub:mean-variance-sd"

\end_inset


\end_layout

\begin_layout Standard
There are numbers associated with PMFs.
 One important example is the mean 
\begin_inset Formula $\mu$
\end_inset

, also known as 
\begin_inset Formula $\E X$
\end_inset

 (which we will discuss later):
\begin_inset Formula \begin{equation}
\mu=\E X=\sum_{x\in S}xf_{X}(x),\end{equation}

\end_inset

provided the (potentially infinite) series 
\begin_inset Formula $\sum|x|f_{X}(x)$
\end_inset

 is convergent.
 Another important number is the variance:
\begin_inset Formula \begin{equation}
\sigma^{2}=\sum_{x\in S}(x-\mu)^{2}f_{X}(x),\end{equation}

\end_inset

which can be computed (see Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:variance-shortcut"

\end_inset

) with the alternate formula 
\begin_inset Formula $\sigma^{2}=\sum x{}^{2}f_{X}(x)-\mu^{2}$
\end_inset

.
 Directly defined from the variance is the standard deviation 
\begin_inset Formula $\sigma=\sqrt{\sigma^{2}}$
\end_inset

.
 
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:disc-pmf-mean"

\end_inset

We will calculate the mean of 
\begin_inset Formula $X$
\end_inset

 in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Toss-a-coin"

\end_inset

.
\begin_inset Formula \[
\mu=\sum_{x=0}^{3}xf_{X}(x)=0\cdot\frac{1}{8}+1\cdot\frac{3}{8}+2\cdot\frac{3}{8}+3\cdot\frac{1}{8}=3.5.\]

\end_inset

We interpret 
\begin_inset Formula $\mu=3.5$
\end_inset

 by reasoning that if we were to repeat the random experiment many times,
 independently each time, observe many corresponding outcomes of the random
 variable 
\begin_inset Formula $X$
\end_inset

, and take the sample mean of the observations, then the calculated value
 would fall close to 3.5.
 The approximation would get better as we observe more and more values of
 
\begin_inset Formula $X$
\end_inset

 (another form of the Law of Large Numbers; see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Interpreting-Probabilities"

\end_inset

).
 Another way it is commonly stated is that 
\begin_inset Formula $X$
\end_inset

 is 3.5 
\begin_inset Quotes eld
\end_inset

on the average
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

in the long run
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Remark
Note that although we say 
\begin_inset Formula $X$
\end_inset

 is 3.5 on the average, we must keep in mind that our 
\begin_inset Formula $X$
\end_inset

 never actually equals 3.5 (in fact, it is impossible for 
\begin_inset Formula $X$
\end_inset

 to equal 3.5).
\end_layout

\begin_layout Standard
Related to the probability mass function 
\begin_inset Formula $f_{X}(x)=\P(X=x)$
\end_inset

 is another important function called the cumulative distribution function
 (CDF), 
\begin_inset Formula $F_{X}$
\end_inset

.
 It is defined by the formula
\begin_inset Formula \begin{equation}
F_{X}(t)=\P(X\leq t),\quad-\infty<t<\infty.\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We know that all PMFs satisfy certain properties, and a similar statement
 may be made for CDFs.
 In particular, any CDF 
\begin_inset Formula $F_{X}$
\end_inset

 satisfies
\end_layout

\begin_layout Itemize
\begin_inset Formula $F_{X}$
\end_inset

 is nondecreasing (
\begin_inset Formula $t_{1}\leq t_{2}$
\end_inset

 implies 
\begin_inset Formula $F_{X}(t_{1})\leq F_{X}(t_{2})$
\end_inset

).
\end_layout

\begin_layout Itemize
\begin_inset Formula $F_{X}$
\end_inset

 is right-continuous (
\begin_inset Formula $\lim_{t\to a^{+}}F_{X}(t)=F_{X}(a)$
\end_inset

 for all 
\begin_inset Formula $a\in\R$
\end_inset

).
\end_layout

\begin_layout Itemize
\begin_inset Formula $\lim_{t\to-\infty}F_{X}(t)=0$
\end_inset

 and 
\begin_inset Formula $\lim_{t\to\infty}F_{X}(t)=1$
\end_inset

.
\end_layout

\begin_layout Standard
We say that 
\begin_inset Formula $X$
\end_inset

 has the distribution 
\begin_inset Formula $F_{X}$
\end_inset

 and we write 
\begin_inset Formula $X\sim F_{X}$
\end_inset

.
 In an abuse of notation we will also write 
\begin_inset Formula $X\sim f_{X}$
\end_inset

 and for the named distributions the PMF or CDF will be identified by the
 family name instead of the defining formula.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\begin_inset CommandInset label
LatexCommand label
name "sub:disc-rv-how-r"

\end_inset


\end_layout

\begin_layout Standard
The mean and variance of a discrete random variable is easy to compute at
 the console.
 Let's return to Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:disc-pmf-mean"

\end_inset

.
 We will start by defining a vector 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 containing the support of 
\begin_inset Formula $X$
\end_inset

, and a vector 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

f
\end_layout

\end_inset


\color inherit
 to contain the values of 
\begin_inset Formula $f_{X}$
\end_inset

 at the respective outcomes in 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
:
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

x <- c(0,1,2,3)
\begin_inset Newline newline
\end_inset

f <- c(1/8, 3/8, 3/8, 1/8)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
To calculate the mean 
\begin_inset Formula $\mu$
\end_inset

, we need to multiply the corresponding values of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

f
\end_layout

\end_inset


\color inherit
 and add them.
 This is easily accomplished in 
\family sans
R
\family default
 since operations on vectors are performed 
\emph on
element-wise
\emph default
 (see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Functions-and-Expressions"

\end_inset

): 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

mu <- sum(x * f)
\begin_inset Newline newline
\end_inset

mu
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
To compute the variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

, we subtract the value of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mu
\end_layout

\end_inset


\color inherit
 from each entry in 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
, square the answers, multiply by 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

f
\end_layout

\end_inset


\color inherit
, and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

sum
\end_layout

\end_inset


\color inherit
.
 The standard deviation 
\begin_inset Formula $\sigma$
\end_inset

 is simply the square root of 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

sigma2 <- sum((x-mu)^2 * f)
\begin_inset Newline newline
\end_inset

sigma2
\begin_inset Newline newline
\end_inset

sigma <- sqrt(sigma2)
\begin_inset Newline newline
\end_inset

sigma
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Finally, we may find the values of the CDF 
\begin_inset Formula $F_{X}$
\end_inset

 on the support by accumulating the probabilities in 
\begin_inset Formula $f_{X}$
\end_inset

 with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cumsum
\end_layout

\end_inset


\color inherit
 function.
 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

F = cumsum(f)
\begin_inset Newline newline
\end_inset

F
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
As easy as this is, it is even easier to do with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

distrEx
\end_layout

\end_inset


\color inherit
 package 
\begin_inset CommandInset citation
LatexCommand cite
key "Ruckdescheldistr"

\end_inset

.
 We define a random variable 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

X
\end_layout

\end_inset

 as an object, then compute things from the object such as mean, variance,
 and standard deviation with the functions 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

E
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

var
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

sd
\end_layout

\end_inset

: 
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

library(distrEx)
\begin_inset Newline newline
\end_inset

X <- DiscreteDistribution(supp = 0:3, prob = c(1,3,3,1)/8)
\begin_inset Newline newline
\end_inset

E(X); var(X); sd(X)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Section
The Discrete Uniform Distribution
\begin_inset CommandInset label
LatexCommand label
name "sec:disc-uniform-dist"

\end_inset


\end_layout

\begin_layout Standard
We have seen the basic building blocks of discrete distributions and we
 now study particular models that statisticians often encounter in the field.
 Perhaps the most fundamental of all is the 
\emph on
discrete uniform
\emph default
 distribution.
\end_layout

\begin_layout Standard
A random variable 
\begin_inset Formula $X$
\end_inset

 with the discrete uniform distribution on the integers 
\begin_inset Formula $1,2,\ldots,m$
\end_inset

 has PMF
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{1}{m},\quad x=1,2,\ldots,m.\end{equation}

\end_inset

We write 
\begin_inset Formula $X\sim\mathsf{disunif}(m)$
\end_inset

.
 A random experiment where this distribution occurs is the choice of an
 integer at random between 1 and 100, inclusive.
 Let 
\begin_inset Formula $X$
\end_inset

 be the number chosen.
 Then 
\begin_inset Formula $X\sim\mathsf{disunif}(m=100)$
\end_inset

 and 
\begin_inset Formula \[
\P(X=x)=\frac{1}{100},\quad x=1,\ldots,100.\]

\end_inset

We find a direct formula for the mean of 
\begin_inset Formula $X\sim\mathsf{disunif}(m)$
\end_inset

:
\begin_inset Formula \begin{equation}
\mu=\sum_{x=1}^{m}xf_{X}(x)=\sum_{x=1}^{m}x\cdot\frac{1}{m}=\frac{1}{m}(1+2+\cdots+m)=\frac{m+1}{2},\end{equation}

\end_inset

where we have used the famous identity 
\begin_inset Formula $1+2+\cdots+m=m(m+1)/2$
\end_inset

.
 That is, if we repeatedly choose integers at random from 1 to 
\begin_inset Formula $m$
\end_inset

 then, on the average, we expect to get 
\begin_inset Formula $(m+1)/2$
\end_inset

.
 To get the variance we first calculate
\begin_inset Formula \[
\sum_{x=1}^{m}x^{2}f_{X}(x)=\frac{1}{m}\sum_{x=1}^{m}x^{2}=\frac{1}{m}\frac{m(m+1)(2m+1)}{6}=\frac{(m+1)(2m+1)}{6},\]

\end_inset

 and finally,
\begin_inset Formula \begin{equation}
\sigma^{2}=\sum_{x=1}^{m}x^{2}f_{X}(x)-\mu^{2}=\frac{(m+1)(2m+1)}{6}-\left(\frac{m+1}{2}\right)^{2}=\cdots=\frac{m^{2}-1}{12}.\end{equation}

\end_inset


\end_layout

\begin_layout Example
Roll a die and let 
\begin_inset Formula $X$
\end_inset

 be the upward face showing.
 Then 
\begin_inset Formula $m=6$
\end_inset

, 
\begin_inset Formula $\mu=7/2=3.5$
\end_inset

, and 
\begin_inset Formula $\sigma^{2}=(6^{2}-1)/12=35/12$
\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Paragraph*
From the console:
\end_layout

\begin_layout Standard
One can choose an integer at random with the 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Verse

sample
\end_layout

\end_inset

 function.
 The general syntax to simulate a discrete uniform random variable is 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Verse

sample(x, size, replace = TRUE)
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
The argument 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Verse

x
\end_layout

\end_inset

 identifies the numbers from which to randomly sample.
 If 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Verse

x
\end_layout

\end_inset

 is a number, then sampling is done from 1 to 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Verse

x
\end_layout

\end_inset

.
 The argument 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Verse

size
\end_layout

\end_inset

 tells how big the sample size should be, and 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Verse

replace
\end_layout

\end_inset

 tells whether or not numbers should be replaced in the urn after having
 been sampled.
 The default option is 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

replace = FALSE
\end_layout

\end_inset


\color none
 but for discrete uniforms the sampled values should be replaced.
 Some examples follow.
\end_layout

\begin_layout Subsection
Examples
\end_layout

\begin_layout Itemize
To roll a fair die 3000 times, do 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

sample(6, size = 3000, replace = TRUE)
\end_layout

\end_inset

.
\end_layout

\begin_layout Itemize
To choose 27 random numbers from 30 to 70, do 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

sample(30:70, size = 27, replace = TRUE)
\end_layout

\end_inset

.
\end_layout

\begin_layout Itemize
To flip a fair coin 1000 times, do 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

sample(c("H","T"), size = 1000, replace = TRUE)
\end_layout

\end_inset

.
\end_layout

\begin_layout Paragraph*
With the 
\family sans
R
\family default
 Commander:
\end_layout

\begin_layout Standard
Follow the sequence 
\family sans
Probability 
\begin_inset Formula $\triangleright$
\end_inset

 Discrete Distributions 
\begin_inset Formula $\triangleright$
\end_inset

 Discrete Uniform distribution 
\begin_inset Formula $\triangleright$
\end_inset

 Simulate Discrete uniform variates\SpecialChar \ldots{}
.
 
\end_layout

\begin_layout Standard
Suppose we would like to roll a fair die 3000 times.
 In the 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

Number of samples
\end_layout

\end_inset

 field we enter 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

1
\end_layout

\end_inset

.
 Next, we describe what interval of integers to be sampled.
 Since there are six faces numbered 1 through 6, we set 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

from = 1
\end_layout

\end_inset

, we set 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

to = 6
\end_layout

\end_inset

, and set 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

by = 1
\end_layout

\end_inset

 (to indicate that we travel from 1 to 6 in increments of 1 unit).
 We will generate a list of 3000 numbers selected from among 1, 2, \SpecialChar \ldots{}
, 6,
 and we store the results of the simulation.
 For the time being, we select 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

New Data set
\end_layout

\end_inset

.
 Click 
\family sans
OK
\family default
.
\end_layout

\begin_layout Standard
Since we are defining a new data set, the 
\family sans
R
\family default
 Commander requests a name for the data set.
 The default name is 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

Simset1
\end_layout

\end_inset

, although in principle you could name it whatever you like (according to
 
\family sans
R
\family default
's rules for object names).
 We wish to have a list that is 3000 long, so we set 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

Sample Size = 3000
\end_layout

\end_inset

 and click 
\family sans
OK
\family default
.
\end_layout

\begin_layout Standard
In the 
\family sans
R
\family default
 Console window, the 
\family sans
R
\family default
 Commander should tell you that 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

Simset1
\end_layout

\end_inset

 has been initialized, and it should also alert you that 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

There was 1 discrete uniform variate sample stored in Simset 1.
\end_layout

\end_inset


\color none
.
 To take a look at the rolls of the die, we click 
\family sans
\color inherit
View data set
\family default
\color none
 and a window opens.
 
\end_layout

\begin_layout Standard
The default name for the variable is 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

disunif.sim1
\end_layout

\end_inset

.
\end_layout

\begin_layout Section
The Binomial Distribution
\begin_inset CommandInset label
LatexCommand label
name "sec:binom-dist"

\end_inset


\end_layout

\begin_layout Standard
The binomial distribution is based on a 
\emph on
Bernoulli trial
\emph default
, which is a random experiment in which there are only two possible outcomes:
 success (
\begin_inset Formula $S$
\end_inset

) and failure (
\begin_inset Formula $F$
\end_inset

).
 We conduct the Bernoulli trial and let 
\begin_inset Formula \begin{equation}
X=\begin{cases}
1 & \mbox{if the outcome is \ensuremath{S}},\\
0 & \mbox{if the outcome is \ensuremath{F}}.\end{cases}\end{equation}

\end_inset

If the probability of success is 
\begin_inset Formula $p$
\end_inset

 then the probability of failure must be 
\begin_inset Formula $1-p=q$
\end_inset

 and the PMF of 
\begin_inset Formula $X$
\end_inset

 is
\begin_inset Formula \begin{equation}
f_{X}(x)=p^{x}(1-p)^{1-x},\quad x=0,1.\end{equation}

\end_inset

It is easy to calculate 
\begin_inset Formula $\mu=\E X=p$
\end_inset

 and 
\begin_inset Formula $\E X^{2}=p$
\end_inset

 so that 
\begin_inset Formula $\sigma^{2}=p-p^{2}=p(1-p)$
\end_inset

.
\end_layout

\begin_layout Subsection
The Binomial Model
\begin_inset CommandInset label
LatexCommand label
name "sub:The-Binomial-Model"

\end_inset


\end_layout

\begin_layout Standard
The Binomial model has three defining properties:
\end_layout

\begin_layout Itemize
Bernoulli trials are conducted 
\begin_inset Formula $n$
\end_inset

 times,
\end_layout

\begin_layout Itemize
the trials are independent,
\end_layout

\begin_layout Itemize
the probability of success 
\begin_inset Formula $p$
\end_inset

 does not change between trials.
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $X$
\end_inset

 counts the number of successes in the 
\begin_inset Formula $n$
\end_inset

 independent trials, then the PMF of 
\begin_inset Formula $X$
\end_inset

 is 
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
f_{X}(x)={n \choose x}p^{x}(1-p)^{n-x},\quad x=0,1,2,\ldots,n.\end{equation}

\end_inset

We say that 
\begin_inset Formula $X$
\end_inset

 has a 
\emph on
binomial distribution
\emph default
 and we write 
\begin_inset Formula $X\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)$
\end_inset

.
 It is clear that 
\begin_inset Formula $f_{X}(x)\geq0$
\end_inset

 for all 
\begin_inset Formula $x$
\end_inset

 in the support because the value is the product of nonnegative numbers.
 We next check that 
\begin_inset Formula $\sum f(x)=1$
\end_inset

:
\begin_inset Formula \[
\sum_{x=0}^{n}{n \choose x}p^{x}(1-p)^{n-x}=[p+(1-p)]^{n}=1^{n}=1.\]

\end_inset

We next find the mean:
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{alignat*}{1}
\mu= & \sum_{x=0}^{n}x\,{n \choose x}p^{x}(1-p)^{n-x},\\
= & \sum_{x=1}^{n}x\,\frac{n!}{x!(n-x)!}p^{x}q^{n-x},\\
= & n\cdot p\sum_{x=1}^{n}\frac{(n-1)!}{(x-1)!(n-x)!}p^{x-1}q^{n-x},\\
= & np\,\sum_{x-1=0}^{n-1}{n-1 \choose x-1}p^{(x-1)}(1-p)^{(n-1)-(x-1)},\\
= & np.\end{alignat*}

\end_inset

 A similar argument shows that 
\begin_inset Formula $\E X(X-1)=n(n-1)p^{2}$
\end_inset

 (see Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:binom-factorial-expectation"

\end_inset

).
 Therefore
\begin_inset Formula \begin{alignat*}{1}
\sigma^{2}= & \E X(X-1)+\E X-[\E X]^{2},\\
= & n(n-1)p^{2}+np-(np)^{2},\\
= & n^{2}p^{2}-np^{2}+np-n^{2}p^{2},\\
= & np-np^{2}=np(1-p).\end{alignat*}

\end_inset


\end_layout

\begin_layout Example
A four-child family.
 Each child may be either a boy (
\begin_inset Formula $B$
\end_inset

) or a girl (
\begin_inset Formula $G$
\end_inset

).
 For simplicity we suppose that 
\begin_inset Formula $\P(B)=\P(G)=1/2$
\end_inset

 and that the genders of the children are determined independently.
 If we let 
\begin_inset Formula $X$
\end_inset

 count the number of 
\begin_inset Formula $B$
\end_inset

's, then 
\begin_inset Formula $X\sim\mathsf{binom}(\mathtt{size}=4,\,\mathtt{prob}=1/2)$
\end_inset

.
 Further, 
\begin_inset Formula $\P(X=2)$
\end_inset

 is
\begin_inset Formula \[
f_{X}(2)={4 \choose 2}(1/2)^{2}(1/2)^{2}=\frac{6}{2^{4}}.\]

\end_inset

The mean number of boys is 
\begin_inset Formula $4(1/2)=2$
\end_inset

 and the variance of 
\begin_inset Formula $X$
\end_inset

 is 
\begin_inset Formula $4(1/2)(1/2)=1$
\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The corresponding 
\family sans
R
\family default
 function for the PMF and CDF are 
\color none

\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dbinom
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

pbinom
\end_layout

\end_inset

, respectively.
 We demonstrate their use in the following examples.
 
\end_layout

\begin_layout Example
We can calculate it in 
\family sans
R
\family default
 Commander under the 
\family sans
Binomial Distribution
\family default
 menu with the 
\family sans
Binomial probabilities
\family default
 menu item.
\end_layout

\begin_deeper
\begin_layout Scrap
<<echo = FALSE>>=
\begin_inset Newline newline
\end_inset

A <- data.frame(Pr=dbinom(0:4, size = 4, prob = 0.5))
\begin_inset Newline newline
\end_inset

rownames(A) <- 0:4 
\begin_inset Newline newline
\end_inset

A
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Standard
We know that the 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset Formula $\mathsf{binom}(\mathtt{size}=4,\,\mathtt{prob}=1/2)$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
 distribution is supported on the integers 0, 1, 2, 3, and 4; thus the table
 is complete.
 We can read off the answer to be 
\begin_inset Formula $\P(X=2)=0.3750$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Roll 12 dice simultaneously, and let 
\begin_inset Formula $X$
\end_inset

 denote the number of 6's that appear.
 We wish to find the probability of getting seven, eight, or nine 6's.
 If we let 
\begin_inset Formula $S=\left\{ \mbox{get a 6 on one roll}\right\} $
\end_inset

, then 
\begin_inset Formula $\P(S)=1/6$
\end_inset

 and the rolls constitute Bernoulli trials; thus 
\begin_inset Formula $X\sim\mathsf{binom}(\mathtt{size=}12,\ \mathtt{prob=}1/6)$
\end_inset

 and our task is to find 
\begin_inset Formula $\P(7\leq X\leq9)$
\end_inset

.
 This is just
\begin_inset Formula \[
\P(7\leq X\leq9)=\sum_{x=7}^{9}{12 \choose x}(1/6)^{x}(5/6)^{12-x}.\]

\end_inset

 Again, one method to solve this problem would be to generate a probability
 mass table and add up the relevant rows.
 However, an alternative method is to notice that 
\begin_inset Formula $\P(7\leq X\leq9)=\P(X\leq9)-\P(X\leq6)=F_{X}(9)-F_{X}(6)$
\end_inset

, so we could get the same answer by using the 
\family sans
Binomial tail probabilities\SpecialChar \ldots{}
 
\family default
menu in the 
\family sans
R
\family default
 Commander or the following from the command line: 
\end_layout

\begin_deeper
\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

pbinom(9, size=12, prob=1/6) - pbinom(6, size=12, prob=1/6)
\begin_inset Newline newline
\end_inset

diff(pbinom(c(6,9), size = 12, prob = 1/6))  # same thing
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:toss-coin-3-withR"

\end_inset

Toss a coin three times and let 
\begin_inset Formula $X$
\end_inset

 be the number of Heads observed.
 We know from before that 
\begin_inset Formula $X\sim\mathsf{binom}(\mathtt{size}=3,\,\mathtt{prob}=1/2)$
\end_inset

 which implies the following PMF:
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="5">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x=\mbox{\#of Heads}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $f(x)=\P(X=x)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3/8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3/8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1/8
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Our next goal is to write down the CDF of 
\begin_inset Formula $X$
\end_inset

 explicitly.
 The first case is easy: it is impossible for 
\begin_inset Formula $X$
\end_inset

 to be negative, so if 
\begin_inset Formula $x<0$
\end_inset

 then we should have 
\begin_inset Formula $\P(X\leq x)=0$
\end_inset

.
 Now choose a value 
\begin_inset Formula $x$
\end_inset

 satisfying 
\begin_inset Formula $0\leq x<1$
\end_inset

, say, 
\begin_inset Formula $x=0.3$
\end_inset

.
 The only way that 
\begin_inset Formula $X\leq x$
\end_inset

 could happen would be if 
\begin_inset Formula $X=0$
\end_inset

, therefore, 
\begin_inset Formula $\P(X\leq x)$
\end_inset

 should equal 
\begin_inset Formula $\P(X=0)$
\end_inset

, and the same is true for any 
\begin_inset Formula $0\leq x<1$
\end_inset

.
 Similarly, for any 
\begin_inset Formula $1\leq x<2$
\end_inset

, say, 
\begin_inset Formula $x=1.73$
\end_inset

, the event 
\begin_inset Formula $\left\{ X\leq x\right\} $
\end_inset

 is exactly the event 
\begin_inset Formula $\left\{ X=0\mbox{ or }X=1\right\} $
\end_inset

.
 Consequently, 
\begin_inset Formula $\P(X\leq x)$
\end_inset

 should equal 
\begin_inset Formula $\P(X=0\mbox{ or }X=1)=\P(X=0)+\P(X=1)$
\end_inset

.
 Continuing in this fashion, we may figure out the values of 
\begin_inset Formula $F_{X}(x)$
\end_inset

 for all possible inputs 
\begin_inset Formula $-\infty<x<\infty$
\end_inset

, and we may summarize our observations with the following piecewise defined
 function:
\begin_inset Formula \[
F_{X}(x)=\P(X\leq x)=\begin{cases}
0, & x<0,\\
\frac{1}{8}, & 0\leq x<1,\\
\frac{1}{8}+\frac{3}{8}=\frac{4}{8}, & 1\leq x<2,\\
\frac{4}{8}+\frac{3}{8}=\frac{7}{8}, & 2\leq x<3,\\
1, & x\geq3.\end{cases}\]

\end_inset

In particular, the CDF of 
\begin_inset Formula $X$
\end_inset

 is defined for the entire real line, 
\begin_inset Formula $\R$
\end_inset

.
 The CDF is right continuous and nondecreasing.
 A graph of the 
\begin_inset Formula $\mathsf{binom}(\mathtt{size}=3,\,\mathtt{prob}=1/2)$
\end_inset

 CDF is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:binom-cdf-base"

\end_inset

.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig = true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

plot(0, xlim = c(-1.2, 4.2), ylim = c(-0.04, 1.04), type = "n", xlab = "number
 of successes", ylab = "cumulative probability")
\begin_inset Newline newline
\end_inset

abline(h = c(0,1), lty = 2, col = "grey")
\begin_inset Newline newline
\end_inset

lines(stepfun(0:3, pbinom(-1:3, size = 3, prob = 0.5)), verticals = FALSE,
 do.p = FALSE)
\begin_inset Newline newline
\end_inset

points(0:3, pbinom(0:3, size = 3, prob = 0.5), pch = 16, cex = 1.2)
\begin_inset Newline newline
\end_inset

points(0:3, pbinom(-1:2, size = 3, prob = 0.5), pch = 1, cex = 1.2)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Graph of the 
\begin_inset Formula $\mathsf{binom}(\mathtt{size}=3,\,\mathtt{prob}=1/2)$
\end_inset

 CDF
\begin_inset CommandInset label
LatexCommand label
name "fig:binom-cdf-base"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Another way to do Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:toss-coin-3-withR"

\end_inset

 is with the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

distr
\end_layout

\end_inset


\color inherit
 family of packages 
\begin_inset CommandInset citation
LatexCommand cite
key "Ruckdescheldistr"

\end_inset

.
 They use an object oriented approach to random variables, that is, a random
 variable is stored in an object 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

X
\end_layout

\end_inset


\color inherit
, and then questions about the random variable translate to functions on
 and involving 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

X
\end_layout

\end_inset


\color inherit
.
 Random variables with distributions from the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

base
\end_layout

\end_inset


\color inherit
 package are specified by capitalizing the name of the distribution.
\end_layout

\begin_deeper
\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

library(distr)
\begin_inset Newline newline
\end_inset

X <- Binom(size = 3, prob = 1/2)
\begin_inset Newline newline
\end_inset

X
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The analogue of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dbinom
\end_layout

\end_inset


\color inherit
 function for 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

X
\end_layout

\end_inset


\color inherit
 is the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

d(X)
\end_layout

\end_inset


\color inherit
 function, and the analogue of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

pbinom
\end_layout

\end_inset


\color inherit
 function is the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

p(X)
\end_layout

\end_inset


\color inherit
 function.
 Compare the following:
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

d(X)(1)   # pmf of X evaluated at x = 1
\begin_inset Newline newline
\end_inset

p(X)(2)   # cdf of X evaluated at x = 2
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Standard
Random variables defined via the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

distr
\end_layout

\end_inset


\color inherit
 package may be 
\emph on
plotted
\emph default
, which will return graphs of the PMF, CDF, and quantile function (introduced
 in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Normal-Quantiles-QF"

\end_inset

).
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:binom-plot-distr"

\end_inset

 for an example.
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 6>>=
\begin_inset Newline newline
\end_inset

plot(X, cex = 0.2)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The 
\family sans
binom
\family default
(
\family typewriter
size
\family default
 = 3, 
\family typewriter
prob
\family default
 = 0.5) distribution from the 
\family typewriter
distr
\family default
 package
\begin_inset CommandInset label
LatexCommand label
name "fig:binom-plot-distr"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="5">
<features>
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<row>
<cell multicolumn="1" alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Given 
\begin_inset Formula $X\sim\mathsf{dbinom}(\mathtt{size}=n,\,\mathtt{prob}=p)$
\end_inset

.
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
How to do:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
with 
\begin_inset Formula $\mathtt{stats}$
\end_inset

 (default) 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
with 
\begin_inset Formula $\mathtt{distr}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
PMF: 
\begin_inset Formula $\P(X=x)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathtt{dbinom(x,size=n,prob=p)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathtt{d(X)(x)}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
CDF: 
\begin_inset Formula $\P(X\leq x)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathtt{pbinom(x,size=n,prob=p)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathtt{p(X)(x)}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Simulate 
\begin_inset Formula $k$
\end_inset

 variates
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathtt{rbinom(k,size=n,prob=p)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\mathtt{r(X)(k)}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell multicolumn="1" alignment="right" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
For 
\begin_inset Formula $\mathtt{distr}$
\end_inset

 need 
\family typewriter
X <-
\family default
 
\begin_inset Formula $\mathtt{Binom(size=}n\mathtt{,\ prob=}p\mathtt{)}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Correspondence between 
\family typewriter
stats
\family default
 and 
\family typewriter
distr
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Expectation and Moment Generating Functions
\begin_inset CommandInset label
LatexCommand label
name "sec:expectation-and-mgfs"

\end_inset


\end_layout

\begin_layout Subsection
The Expectation Operator
\begin_inset CommandInset label
LatexCommand label
name "sub:expectation-operator"

\end_inset


\end_layout

\begin_layout Standard
We next generalize some of the concepts from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:mean-variance-sd"

\end_inset

.
 There we saw that every
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Not every, only those PMFs for which the (potentially infinite) series converges.
\end_layout

\end_inset

 PMF has two important numbers associated with it:
\begin_inset Formula \begin{equation}
\mu=\sum_{x\in S}xf_{X}(x),\quad\sigma^{2}=\sum_{x\in S}(x-\mu)^{2}f_{X}(x).\end{equation}

\end_inset

Intuitively, for repeated observations of 
\begin_inset Formula $X$
\end_inset

 we would expect the sample mean to closely approximate 
\begin_inset Formula $\mu$
\end_inset

 as the sample size increases without bound.
 For this reason we call 
\begin_inset Formula $\mu$
\end_inset

 the 
\emph on
expected value
\emph default
 of 
\begin_inset Formula $X$
\end_inset

 and we write 
\begin_inset Formula $\mu=\E X$
\end_inset

, where 
\begin_inset Formula $\E$
\end_inset

 is an 
\emph on
expectation operator
\emph default
.
\end_layout

\begin_layout Definition
More generally, given a function 
\begin_inset Formula $g$
\end_inset

 we define the 
\emph on
expected value of
\emph default
 
\begin_inset Formula $g(X)$
\end_inset

 by
\begin_inset Formula \begin{equation}
\E\, g(X)=\sum_{x\in S}g(x)f_{X}(x),\end{equation}

\end_inset

provided the (potentially infinite) series 
\begin_inset Formula $\sum_{x}|g(x)|f(x)$
\end_inset

 is convergent.
 We say that 
\begin_inset Formula $\E g(X)$
\end_inset

 
\emph on
exists
\emph default
.
\end_layout

\begin_layout Standard
In this notation the variance is 
\begin_inset Formula $\sigma^{2}=\E(X-\mu)^{2}$
\end_inset

 and we prove the identity 
\begin_inset Formula \begin{equation}
\E(X-\mu)^{2}=\E X^{2}-(\E X)^{2}\end{equation}

\end_inset

in Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:variance-shortcut"

\end_inset

.
 Intuitively, for repeated observations of 
\begin_inset Formula $X$
\end_inset

 we would expect the sample mean of the 
\begin_inset Formula $g(X)$
\end_inset

 values to closely approximate 
\begin_inset Formula $\E\, g(X)$
\end_inset

 as the sample size increases without bound.
\end_layout

\begin_layout Standard
Let us take the analogy further.
 If we expect 
\begin_inset Formula $g(X)$
\end_inset

 to be close to 
\begin_inset Formula $\E g(X)$
\end_inset

 on the average, where would we expect 
\begin_inset Formula $3g(X)$
\end_inset

 to be on the average? It could only be 
\begin_inset Formula $3\E g(X)$
\end_inset

.
 The following theorem makes this idea precise.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "pro:expectation-properties"

\end_inset

For any functions 
\begin_inset Formula $g$
\end_inset

 and 
\begin_inset Formula $h$
\end_inset

, any random variable 
\begin_inset Formula $X$
\end_inset

, and any constant 
\begin_inset Formula $c$
\end_inset

: 
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\E\: c=c$
\end_inset

,
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\E[c\cdot g(X)]=c\E g(X)$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $\E[g(X)+h(X)]=\E g(X)+\E h(X)$
\end_inset

,
\end_layout

\begin_layout Standard
provided 
\begin_inset Formula $\E g(X)$
\end_inset

 and 
\begin_inset Formula $\E h(X)$
\end_inset

 exist.
\end_layout

\end_deeper
\begin_layout Proof
Go directly from the definition.
 For example,
\begin_inset Formula \[
\E[c\cdot g(X)]=\sum_{x\in S}c\cdot g(x)f_{X}(x)=c\cdot\sum_{x\in S}g(x)f_{X}(x)=c\E g(X).\]

\end_inset


\end_layout

\begin_layout Subsection
Moment Generating Functions
\begin_inset CommandInset label
LatexCommand label
name "sub:MGFs"

\end_inset


\end_layout

\begin_layout Definition
Given a random variable 
\begin_inset Formula $X$
\end_inset

, its 
\emph on
moment generating function
\emph default
 (abbreviated MGF) is defined by the formula
\begin_inset Formula \begin{equation}
M_{X}(t)=\E\me^{tX}=\sum_{x\in S}\me^{tx}f_{X}(x),\end{equation}

\end_inset

provided the (potentially infinite) series is convergent for all 
\begin_inset Formula $t$
\end_inset

 in a neighborhood of zero (that is, for all 
\begin_inset Formula $-\epsilon<t<\epsilon$
\end_inset

, for some 
\begin_inset Formula $\epsilon>0$
\end_inset

).
 
\end_layout

\begin_layout Standard
Note that for any MGF 
\begin_inset Formula $M_{X}$
\end_inset

, 
\begin_inset Formula \begin{equation}
M_{X}(0)=\E\me^{0\cdot X}=\E1=1.\end{equation}

\end_inset

We will calculate the MGF for the two distributions introduced above.
\end_layout

\begin_layout Example
Find the MGF for 
\begin_inset Formula $X\sim\mathsf{disunif}(m)$
\end_inset

.
 
\end_layout

\begin_layout Example
Since 
\begin_inset Formula $f(x)=1/m$
\end_inset

, the MGF takes the form
\begin_inset Formula \[
M(t)=\sum_{x=1}^{m}\me^{tx}\frac{1}{m}=\frac{1}{m}(\me^{t}+\me^{2t}+\cdots+\me^{mt}),\quad\mbox{for any \ensuremath{t}.}\]

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Find the MGF for 
\begin_inset Formula $X\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{alignat*}{1}
M_{X}(t)= & \sum_{x=0}^{n}\me^{tx}\,{n \choose x}\, p^{x}(1-p)^{n-x},\\
= & \sum_{x=0}^{n-x}{n \choose x}\,(p\me^{t})^{x}q^{n-x},\\
= & (p\me^{t}+q)^{n},\quad\mbox{for any \ensuremath{t}.}\end{alignat*}

\end_inset


\end_layout

\begin_layout Subsection*
Applications
\end_layout

\begin_layout Standard
We will discuss three applications of moment generating functions in this
 book.
 The first is the fact that an MGF may be used to accurately identify the
 probability distribution that generated it, which rests on the following:
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:mgf-unique"

\end_inset

The moment generating function, if it exists in a neighborhood of zero,
 determines a probability distribution 
\emph on
uniquely
\emph default
.
 
\end_layout

\begin_layout Proof
Unfortunately, the proof of such a theorem is beyond the scope of a text
 like this one.
 Interested readers could consult Billingsley 
\begin_inset CommandInset citation
LatexCommand cite
key "Billingsley1995"

\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
We will see an example of Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:mgf-unique"

\end_inset

 in action.
\end_layout

\begin_layout Example
Suppose we encounter a random variable which has MGF 
\begin_inset Formula \[
M_{X}(t)=(0.3+0.7\me^{t})^{13}.\]

\end_inset

Then 
\begin_inset Formula $X\sim\mathsf{binom}(\mathtt{size}=13,\,\mathtt{prob}=0.7)$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
An MGF is also known as a 
\begin_inset Quotes eld
\end_inset

Laplace Transform
\begin_inset Quotes erd
\end_inset

 and is manipulated in that context in many branches of science and engineering.
\end_layout

\begin_layout Subsection*
Why is it called a Moment Generating Function?
\end_layout

\begin_layout Standard
This brings us to the second powerful application of MGFs.
 Many of the models we study have a simple MGF, indeed, which permits us
 to determine the mean, variance, and even higher moments very quickly.
 Let us see why.
 We already know that
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{alignat*}{1}
M(t)= & \sum_{x\in S}\me^{tx}f(x).\end{alignat*}

\end_inset

Take the derivative with respect to 
\begin_inset Formula $t$
\end_inset

 to get
\begin_inset Formula \begin{equation}
M'(t)=\frac{\diff}{\diff t}\left(\sum_{x\in S}\me^{tx}f(x)\right)=\sum_{x\in S}\ \frac{\diff}{\diff t}\left(\me^{tx}f(x)\right)=\sum_{x\in S}x\me^{tx}f(x),\end{equation}

\end_inset

and so if we plug in zero for 
\begin_inset Formula $t$
\end_inset

 we see 
\begin_inset Formula \begin{equation}
M'(0)=\sum_{x\in S}x\me^{0}f(x)=\sum_{x\in S}xf(x)=\mu=\E X.\end{equation}

\end_inset

Similarly, 
\begin_inset Formula $M''(t)=\sum x^{2}\me^{tx}f(x)$
\end_inset

 so that 
\begin_inset Formula $M''(0)=\E X^{2}$
\end_inset

.
 And in general, we can see
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
We are glossing over some significant mathematical details in our derivation.
 Suffice it to say that when the MGF exists in a neighborhood of 
\begin_inset Formula $t=0$
\end_inset

, the exchange of differentiation and summation is valid in that neighborhood,
 and our remarks hold true.
\end_layout

\end_inset

 that
\begin_inset Formula \begin{equation}
M_{X}^{(r)}(0)=\E X^{r}=\mbox{\ensuremath{r^{th}}moment of \ensuremath{X}about the origin.}\end{equation}

\end_inset

These are also known as 
\emph on
raw moments
\emph default
 and are sometimes denoted 
\begin_inset Formula $\mu_{r}'$
\end_inset

.
 In addition to these are the so called 
\emph on
central moments
\emph default
 
\begin_inset Formula $\mu_{r}$
\end_inset

 defined by
\begin_inset Formula \begin{equation}
\mu_{r}=\E(X-\mu)^{r},\quad r=1,2,\ldots\end{equation}

\end_inset


\end_layout

\begin_layout Example
Let 
\begin_inset Formula $X\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)\mbox{ with \ensuremath{M(t)=(q+p\me^{t})^{n}}}$
\end_inset

.
 We calculated the mean and variance of a binomial random variable in Section
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:binom-dist"

\end_inset

 by means of the binomial series.
 But look how quickly we find the mean and variance with the moment generating
 function.
\end_layout

\begin_layout Example
\begin_inset Formula \begin{alignat*}{1}
M'(t)= & n(q+p\me^{t})^{n-1}p\me^{t}\left|_{t=0}\right.,\\
= & n\cdot1^{n-1}p,\\
= & np.\end{alignat*}

\end_inset

And
\begin_inset Formula \begin{alignat*}{1}
M''(0)= & n(n-1)[q+p\me^{t}]^{n-2}(p\me^{t})^{2}+n[q+p\me^{t}]^{n-1}p\me^{t}\left|_{t=0}\right.,\\
\E X^{2}= & n(n-1)p^{2}+np.\end{alignat*}

\end_inset

Therefore 
\begin_inset Formula \begin{alignat*}{1}
\sigma^{2}= & \E X^{2}-(\E X)^{2},\\
= & n(n-1)p^{2}+np-n^{2}p^{2},\\
= & np-np^{2}=npq.\end{alignat*}

\end_inset

See how much easier that was?
\end_layout

\begin_layout Remark
We learned in this section that 
\begin_inset Formula $M^{(r)}(0)=\E X^{r}$
\end_inset

.
 We remember from Calculus II that certain functions 
\begin_inset Formula $f$
\end_inset

 can be represented by a Taylor series expansion about a point 
\begin_inset Formula $a$
\end_inset

, which takes the form
\begin_inset Formula \begin{equation}
f(x)=\sum_{r=0}^{\infty}\frac{f^{(r)}(a)}{r!}(x-a)^{r},\quad\mbox{for all \ensuremath{|x-a|<R},}\end{equation}

\end_inset

where 
\begin_inset Formula $R$
\end_inset

 is called the 
\emph on
radius of convergence
\emph default
 of the series (see Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Sequences-and-Series"

\end_inset

).
 We combine the two to say that if an MGF exists for all 
\begin_inset Formula $t$
\end_inset

 in the interval 
\begin_inset Formula $(-\epsilon,\epsilon)$
\end_inset

, then we can write
\begin_inset Formula \begin{equation}
M_{X}(t)=\sum_{r=0}^{\infty}\frac{\E X^{r}}{r!}t^{r},\quad\mbox{for all \ensuremath{|t|<\epsilon}.}\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

distrEx
\end_layout

\end_inset


\color inherit
 package provides an expectation operator 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

E
\end_layout

\end_inset


\color inherit
 which can be used on random variables that have been defined in the ordinary
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

distr
\end_layout

\end_inset

 sense:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

X <- Binom(size = 3, prob = 0.45)
\begin_inset Newline newline
\end_inset

library(distrEx)
\begin_inset Newline newline
\end_inset

E(X)
\begin_inset Newline newline
\end_inset

E(3*X + 4)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
For discrete random variables with finite support, the expectation is simply
 computed with direct summation.
 In the case that the random variable has infinite support and the function
 is crazy, then the expectation is not computed directly, rather, it is
 estimated by first generating a random sample from the underlying model
 and next computing a sample mean of the function of interest.
 
\end_layout

\begin_layout Standard
There are methods for other population parameters:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

var(X)
\begin_inset Newline newline
\end_inset

sd(X)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
There are even methods for 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IQR
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mad
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

skewness
\end_layout

\end_inset

, 
\color inherit
and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

kurtosis
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Section
The Empirical Distribution
\begin_inset CommandInset label
LatexCommand label
name "sec:empirical-distribution"

\end_inset


\end_layout

\begin_layout Standard
Do an experiment 
\begin_inset Formula $n$
\end_inset

 times and observe 
\begin_inset Formula $n$
\end_inset

 values 
\begin_inset Formula $x_{1}$
\end_inset

, 
\begin_inset Formula $x_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $x_{n}$
\end_inset

 of a random variable 
\begin_inset Formula $X$
\end_inset

.
 For simplicity in most of the discussion that follows it will be convenient
 to imagine that the observed values are distinct, but the remarks are valid
 even when the observed values are repeated.
 
\end_layout

\begin_layout Definition
The 
\emph on
empirical cumulative distribution function
\emph default
 
\begin_inset Formula $F_{n}$
\end_inset

 (written ECDF)
\begin_inset Index
status open

\begin_layout Plain Layout
Empirical distribution
\end_layout

\end_inset

 is the probability distribution that places probability mass 
\begin_inset Formula $1/n$
\end_inset

 on each of the values 
\begin_inset Formula $x_{1}$
\end_inset

, 
\begin_inset Formula $x_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $x_{n}$
\end_inset

.
 The empirical PMF takes the form
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{1}{n},\quad x\in\left\{ x_{1},x_{2},...,x_{n}\right\} .\end{equation}

\end_inset

If the value 
\begin_inset Formula $x_{i}$
\end_inset

 is repeated 
\begin_inset Formula $k$
\end_inset

 times, the mass at 
\begin_inset Formula $x_{i}$
\end_inset

 is accumulated to 
\begin_inset Formula $k/n$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
The mean of the empirical distribution is
\begin_inset Formula \begin{equation}
\mu=\sum_{x\in S}xf_{X}(x)=\sum_{i=1}^{n}x_{i}\cdot\frac{1}{n}\end{equation}

\end_inset

and we recognize this last quantity to be the sample mean, 
\begin_inset Formula $\xbar$
\end_inset

.
 The variance of the empirical distribution is
\begin_inset Formula \begin{equation}
\sigma^{2}=\sum_{x\in S}(x-\mu)^{2}f_{X}(x)=\sum_{i=1}^{n}(x_{i}-\xbar)^{2}\cdot\frac{1}{n}\end{equation}

\end_inset

and this last quantity looks very close to what we already know to be the
 sample variance.
\begin_inset Formula \begin{equation}
s^{2}=\frac{1}{n-1}\sum_{i=1}^{n}(x_{i}-\xbar)^{2}.\end{equation}

\end_inset

The 
\emph on
empirical quantile function
\emph default
 is the inverse of the ECDF.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Normal-Quantiles-QF"

\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The empirical distribution is not directly available as a distribution in
 the same way that the other base probability distributions are, but there
 are plenty of resources available for the determined investigator.
 
\end_layout

\begin_layout Standard
Given a data vector of observed values 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
, we can see the empirical CDF with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ecdf
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
ecdf
\end_layout

\end_inset


\color inherit
 function:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x <- c(4, 7, 9, 11, 12)
\begin_inset Newline newline
\end_inset

ecdf(x)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The above shows that the returned value of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ecdf(x)
\end_layout

\end_inset

 is not a 
\emph on
\color inherit
number
\emph default
\color none
 but rather
\color inherit
 a 
\emph on
function
\emph default
.
 The ECDF is not usually used by itself in this form, by itself.
 More commonly it is used as an intermediate step in a more complicated
 calculation, for instance, in hypothesis testing (see Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Hypothesis-Testing"

\end_inset

) or resampling (see Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:resampling-methods"

\end_inset

).
 It is nevertheless instructive to see what the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ecdf
\end_layout

\end_inset


\color inherit
 looks like, and there is a special plot method for 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ecdf
\end_layout

\end_inset


\color inherit
 objects.
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

plot(ecdf(x))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

plot(ecdf(x))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The empirical CDF
\begin_inset CommandInset label
LatexCommand label
name "fig:empirical-CDF"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:empirical-CDF"

\end_inset

.

\color none
 The graph is of a right-continuous function with jumps exactly at the locations
 stored in 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset

.
 
\color inherit
There are no repeated values in 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset

 so all of the jumps are equal to 
\begin_inset Formula $1/5=0.2$
\end_inset

.
\end_layout

\begin_layout Standard
The empirical PDF is not usually of particular interest in itself, but if
 we really wanted we could define a function to serve as the empirical PDF:
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

epdf <- function(x) function(t){sum(x %in% t)/length(x)}
\begin_inset Newline newline
\end_inset

x <- c(0,0,1)
\begin_inset Newline newline
\end_inset

epdf(x)(0)       # should be 2/3
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
To simulate from the empirical distribution supported on the vector 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

x
\end_layout

\end_inset


\color inherit
, we use the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

sample
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
sample
\end_layout

\end_inset


\color inherit
 function.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x <- c(0,0,1)
\begin_inset Newline newline
\end_inset

sample(x, size = 7, replace = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We can get the empirical quantile function in 
\family sans
R
\family default
 with 
\color none

\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

quantile(x, probs = p, type = 1)
\end_layout

\end_inset


\color inherit
; see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Normal-Quantiles-QF"

\end_inset

.
\end_layout

\begin_layout Standard
As we hinted above, the empirical distribution is significant more because
 of how and where it appears in more sophisticated applications.
 We will explore some of these in later chapters -- see, for instance, Chapter
 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:resampling-methods"

\end_inset

.
\end_layout

\begin_layout Section
Other Discrete Distributions
\begin_inset CommandInset label
LatexCommand label
name "sec:other-discrete-distributions"

\end_inset


\end_layout

\begin_layout Standard
The binomial and discrete uniform distributions are popular, and rightly
 so; they are simple and form the foundation for many other more complicated
 distributions.
 But the particular uniform and binomial models only apply to a limited
 range of problems.
 In this section we introduce situations for which we need more than what
 the uniform and binomial offer.
\end_layout

\begin_layout Subsection
Dependent Bernoulli Trials
\begin_inset CommandInset label
LatexCommand label
name "sec:non-bernoulli-trials"

\end_inset


\end_layout

\begin_layout Subsubsection*
The Hypergeometric Distribution
\begin_inset CommandInset label
LatexCommand label
name "sub:hypergeometric-dist"

\end_inset


\end_layout

\begin_layout Standard
Consider an urn with 7 white balls and 5 black balls.
 Let our random experiment be to randomly select 4 balls, without replacement,
 from the urn.
 Then the probability of observing 3 white balls (and thus 1 black ball)
 would be 
\begin_inset Formula \begin{equation}
\P(3W,1B)=\frac{{7 \choose 3}{5 \choose 1}}{{12 \choose 4}}.\end{equation}

\end_inset

More generally, we sample without replacement 
\begin_inset Formula $K$
\end_inset

 times from an urn with 
\begin_inset Formula $M$
\end_inset

 white balls and 
\begin_inset Formula $N$
\end_inset

 black balls.
 Let 
\begin_inset Formula $X$
\end_inset

 be the number of white balls in the sample.
 The PMF of 
\begin_inset Formula $X$
\end_inset

 is 
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{{M \choose x}{N \choose K-x}}{{M+N \choose K}}.\end{equation}

\end_inset

We say that 
\begin_inset Formula $X$
\end_inset

 has a 
\emph on
hypergeometric distribution
\emph default
 and write 
\begin_inset Formula $X\sim\mathsf{hyper}(\mathtt{m}=M,\,\mathtt{n}=N,\,\mathtt{k}=K)$
\end_inset

.
 
\end_layout

\begin_layout Standard
The support set for the hypergeometric distribution is a little bit tricky.
 It is tempting to say that 
\begin_inset Formula $x$
\end_inset

 should go from 0 (no white balls in the sample) to 
\begin_inset Formula $K$
\end_inset

 (no black balls in the sample), but that does not work if 
\begin_inset Formula $K>M$
\end_inset

, because it is impossible to have more white balls in the sample than there
 were white balls originally in the urn.
 We have the same trouble if 
\begin_inset Formula $K>N$
\end_inset

.
 The good news is that the majority of examples we study have 
\begin_inset Formula $K\leq M$
\end_inset

 and 
\begin_inset Formula $K\leq N$
\end_inset

 and we will happily take the support to be 
\begin_inset Formula $x=0,\ 1,\ \ldots,\ K$
\end_inset

.
 
\end_layout

\begin_layout Standard
It is shown in Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:hyper-mean-variance"

\end_inset

 that 
\begin_inset Formula \begin{equation}
\mu=K\frac{M}{M+N},\quad\sigma^{2}=K\frac{MN}{(M+N)^{2}}\frac{M+N-K}{M+N-1}.\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The associated 
\family sans
R
\family default
 functions for the PMF and CDF are 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

dhyper(x, m, n, k)
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

phyper
\end_layout

\end_inset

, respectively.
 There are two more functions: 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

qhyper
\end_layout

\end_inset

, which we will discuss in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Normal-Quantiles-QF"

\end_inset

, and 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

rhyper
\end_layout

\end_inset

, discussed below.
\end_layout

\begin_layout Example
Suppose in a certain shipment of 250 Pentium processors there are 17 defective
 processors.
 A quality control consultant randomly collects 5 processors for inspection
 to determine whether or not they are defective.
 Let 
\begin_inset Formula $X$
\end_inset

 denote the number of defectives in the sample.
 
\end_layout

\begin_layout Enumerate
Find the probability of exactly 3 defectives in the sample, that is, find
 
\begin_inset Formula $\P(X=3)$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Standard

\emph on
Solution:
\emph default
 We know that 
\begin_inset Formula $X\sim\mathsf{hyper}(\mathtt{m}=17,\,\mathtt{n}=233,\,\mathtt{k}=5)$
\end_inset

.
 So the required probability is just
\begin_inset Formula \[
f_{X}(3)=\frac{{17 \choose 3}{233 \choose 2}}{{250 \choose 5}}.\]

\end_inset

To calculate it in 
\family sans
R
\family default
 we just type 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

dhyper(3, m = 17, n = 233, k = 5)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
To find it with the 
\family sans
R
\family default
 Commander we go 
\family sans
Probability
\family default
 
\begin_inset Formula $\triangleright$
\end_inset

 
\family sans
Discrete Distributions
\family default
 
\begin_inset Formula $\triangleright$
\end_inset

 
\family sans
Hypergeometric distribution
\family default
 
\begin_inset Formula $\triangleright$
\end_inset

 
\family sans
Hypergeometric probabilities
\family default
\SpecialChar \ldots{}
.We fill in the parameters 
\begin_inset Formula $m=17$
\end_inset

, 
\begin_inset Formula $n=233$
\end_inset

, and 
\begin_inset Formula $k=5$
\end_inset

.
 Click 
\family sans
OK
\family default
, and the following table is shown in the window.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

A <- data.frame(Pr=dhyper(0:4, m = 17, n = 233, k = 5))
\begin_inset Newline newline
\end_inset

rownames(A) <- 0:4 
\begin_inset Newline newline
\end_inset

A
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We wanted 
\begin_inset Formula $\P(X=3)$
\end_inset

, and this is found from the table to be approximately 0.0024.
 The value is rounded to the fourth decimal place.
\end_layout

\begin_layout Standard
We know from our above discussion that the sample space should be 
\begin_inset Formula $x=0,1,2,3,4,5$
\end_inset

, yet, in the table the probabilities are only displayed for 
\begin_inset Formula $x=1,2,3$
\end_inset

, and 4.
 What is happening? As it turns out, the 
\family sans
R
\family default
 Commander will only display probabilities that are 0.00005 or greater.
 Since 
\begin_inset Formula $x=5$
\end_inset

 is not shown, it suggests that the outcome has a tiny probability.
 To find its exact value we use the 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

dhyper
\end_layout

\end_inset

 function:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

dhyper(5, m = 17, n = 233, k = 5)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
In other words, 
\begin_inset Formula $\P(X=5)\approx0.0000007916049$
\end_inset

, a small number indeed.
\end_layout

\end_deeper
\begin_layout Enumerate
Find the probability that there are at most 2 defectives in the sample,
 that is, compute 
\begin_inset Formula $\P(X\leq2)$
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Standard

\emph on
Solution:
\emph default
 Since 
\begin_inset Formula $\P(X\leq2)=\P(X=0,1,2)$
\end_inset

, one way to do this would be to add the 0, 1, and 2 entries in the above
 table.
 this gives 
\begin_inset Formula $0.7011+0.2602+0.0362=0.9975$
\end_inset

.
 Our answer should be correct up to the accuracy of 4 decimal places.
 However, a more precise method is provided by the 
\family sans
R
\family default
 Commander.
 Under the 
\family sans
Hypergeometric distribution
\family default
 menu we select 
\family sans
Hypergeometric tail probabilities
\emph on
\SpecialChar \ldots{}

\family default
\emph default
.
 We fill in the parameters 
\begin_inset Formula $m$
\end_inset

, 
\begin_inset Formula $n$
\end_inset

, and 
\begin_inset Formula $k$
\end_inset

 as before, but in the 
\family sans
Variable value(s)
\family default
 dialog box we enter the value 2.
 We notice that the 
\family typewriter
Lower tail
\family default
 option is checked, and we leave that alone.
 Click 
\family sans
OK
\family default
.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

phyper(2, m = 17, n = 233, k = 5)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
And thus 
\begin_inset Formula $\P(X\leq2)\approx0.9975771$
\end_inset

.
 We have confirmed that the above answer was correct up to four decimal
 places.
\end_layout

\end_deeper
\begin_layout Enumerate
Find 
\begin_inset Formula $\P(X>1)$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Standard
The table did not give us the explicit probability 
\begin_inset Formula $\P(X=5)$
\end_inset

, so we can not use the table to give us this probability.
 We need to use another method.
 Since 
\begin_inset Formula $\P(X>1)=1-\P(X\leq1)=1-F_{X}(1)$
\end_inset

, we can find the probability with 
\family sans
Hypergeometric tail probabilities
\emph on
\SpecialChar \ldots{}

\family default
\emph default
.
 We enter 1 for 
\family sans
Variable Value(s)
\family default
, we enter the parameters as before, and in this case we choose the 
\family typewriter
Upper tail
\family default
 option.
 This results in the following output.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

phyper(1, m = 17, n = 233, k = 5, lower.tail = FALSE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
In general,
\color none
 the 
\family typewriter
Upper tail
\family default
 option of a tail probabilities dialog computes 
\begin_inset Formula $\P(X>x)$
\end_inset

 for all given 
\family sans
\color inherit
Variable Value(s)
\family default
\color none
 
\begin_inset Formula $x$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Enumerate
Generate 
\begin_inset Formula $100,000$
\end_inset

 observations of the random variable 
\begin_inset Formula $X$
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Standard
We can randomly simulate as many observations of 
\begin_inset Formula $X$
\end_inset

 as we want in 
\family sans
R
\family default
 Commander.
 Simply choose 
\family sans
Simulate hypergeometric variates\SpecialChar \ldots{}

\family default
 in the 
\family sans
Hypergeometric distribution
\family default
 dialog.
\end_layout

\begin_layout Standard
In the 
\family sans
Number of samples
\family default
 dialog, type 1.
 Enter the parameters as above.
 Under the 
\family sans
Store Values
\family default
 section, make sure 
\family sans
New Data set
\family default
 is selected.
 Click 
\family sans
OK
\family default
.
 
\end_layout

\begin_layout Standard
A new dialog should open, with the default name 
\family typewriter
Simset1
\family default
.
 We could change this if we like, according to the rules for 
\family sans
R
\family default
 object names.
 In the sample size box, enter 100000.
 Click 
\family sans
OK
\family default
.
 
\end_layout

\begin_layout Standard
In the Console Window, 
\family sans
R
\family default
 Commander should issue an alert that 
\family typewriter
Simset1
\family default
 has been initialized, and in a few seconds, it should also state that 100,000
 hypergeometric variates were stored in 
\family typewriter
hyper.sim1
\family default
.
 We can view the sample by clicking the 
\family sans
View Data Set
\family typewriter
 
\family default
button on the 
\family sans
R
\family default
 Commander interface.
\end_layout

\begin_layout Standard
We know from our formulas that 
\begin_inset Formula $\mu=K\cdot M/(M+N)=5*17/250=0.34$
\end_inset

.
 We can check our formulas using the fact that with repeated observations
 of 
\begin_inset Formula $X$
\end_inset

 we would expect about 0.34 defectives on the average.
 To see how our sample reflects the true mean, we can compute the sample
 mean
\end_layout

\begin_layout Verse

\family typewriter
\color blue
Rcmdr> mean(Simset2$hyper.sim1, na.rm=TRUE)
\begin_inset Newline newline
\end_inset

[1] 0.340344
\end_layout

\begin_layout Verse

\family typewriter
\color blue
Rcmdr> sd(Simset2$hyper.sim1, na.rm=TRUE)
\begin_inset Newline newline
\end_inset

[1] 0.5584982
\end_layout

\begin_layout Verse

\family typewriter
\color blue
\begin_inset Formula $\vdots$
\end_inset


\end_layout

\begin_layout Standard
We see that when given many independent observations of 
\begin_inset Formula $X$
\end_inset

, the sample mean is very close to the true mean 
\begin_inset Formula $\mu$
\end_inset

.
 We can repeat the same idea and use the sample standard deviation to estimate
 the true standard deviation of 
\begin_inset Formula $X$
\end_inset

.
 From the output above our estimate is 0.5584982, and from our formulas we
 get
\begin_inset Formula \[
\sigma^{2}=K\frac{MN}{(M+N)^{2}}\frac{M+N-K}{M+N-1}\approx0.3117896,\]

\end_inset

 with 
\begin_inset Formula $\sigma=\sqrt{\sigma^{2}}\approx0.5583811944$
\end_inset

.
 Our estimate was pretty close.
\end_layout

\begin_layout Standard
From the console we can generate random hypergeometric variates with the
 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

rhyper
\end_layout

\end_inset

 function, as demonstrated below.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

rhyper(10, m = 17, n = 233, k = 5)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Subsubsection*
Sampling With and Without Replacement
\begin_inset CommandInset label
LatexCommand label
name "sub:Sampling-With-and"

\end_inset


\end_layout

\begin_layout Standard
Suppose that we have a large urn with, say, 
\begin_inset Formula $M$
\end_inset

 white balls and 
\begin_inset Formula $N$
\end_inset

 black balls.
 We take a sample of size 
\begin_inset Formula $n$
\end_inset

 from the urn, and let 
\begin_inset Formula $X$
\end_inset

 count the number of white balls in the sample.
 If we sample
\end_layout

\begin_layout Description
without
\begin_inset space ~
\end_inset

replacement, then 
\begin_inset Formula $X\sim\mathsf{hyper}(\mathtt{m=}M,\,\mathtt{n}=N,\,\mathtt{k}=n)$
\end_inset

 and has mean and variance
\begin_inset Formula \begin{alignat*}{1}
\mu= & n\frac{M}{M+N},\\
\sigma^{2}= & n\frac{MN}{(M+N)^{2}}\frac{M+N-n}{M+N-1},\\
= & n\frac{M}{M+N}\left(1-\frac{M}{M+N}\right)\frac{M+N-n}{M+N-1}.\end{alignat*}

\end_inset

On the other hand, if we sample
\end_layout

\begin_layout Description
with
\begin_inset space ~
\end_inset

replacement, then 
\begin_inset Formula $X\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=M/(M+N))$
\end_inset

 with mean and variance
\begin_inset Formula \begin{alignat*}{1}
\mu= & n\frac{M}{M+N},\\
\sigma^{2}= & n\frac{M}{M+N}\left(1-\frac{M}{M+N}\right).\end{alignat*}

\end_inset


\end_layout

\begin_layout Standard
We see that both sampling procedures have the same mean, and the method
 with the larger variance is the 
\begin_inset Quotes eld
\end_inset

with replacement
\begin_inset Quotes erd
\end_inset

 scheme.
 The factor by which the variances differ,
\begin_inset Formula \begin{equation}
\frac{M+N-n}{M+N-1},\end{equation}

\end_inset

is called a 
\emph on
finite population correction
\emph default
.
 For a fixed sample size 
\begin_inset Formula $n$
\end_inset

, as 
\begin_inset Formula $M,N\to\infty$
\end_inset

 it is clear that the correction goes to 1, that is, for infinite populations
 the sampling schemes are essentially the same with respect to mean and
 variance.
\end_layout

\begin_layout Subsection
Waiting Time Distributions
\begin_inset CommandInset label
LatexCommand label
name "sec:Waiting-Time-Distributions"

\end_inset


\end_layout

\begin_layout Standard
Another important class of problems is associated with the amount of time
 it takes for a specified event of interest to occur.
 For example, we could flip a coin repeatedly until we observe Heads.
 We could toss a piece of paper repeatedly until we make it in the trash
 can.
\end_layout

\begin_layout Subsubsection*
The Geometric Distribution
\begin_inset CommandInset label
LatexCommand label
name "sub:The-Geometric-Distribution"

\end_inset


\end_layout

\begin_layout Standard
Suppose that we conduct Bernoulli trials repeatedly, noting the successes
 and failures.
 Let 
\begin_inset Formula $X$
\end_inset

 be the number of failures before a success.
 If 
\begin_inset Formula $\P(S)=p$
\end_inset

 then 
\begin_inset Formula $X$
\end_inset

 has PMF
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
f_{X}(x)=p(1-p)^{x},\quad x=0,1,2,\ldots\end{equation}

\end_inset

(Why?) We say that 
\begin_inset Formula $X$
\end_inset

 has a 
\emph on
Geometric distribution
\emph default
 and we write 
\begin_inset Formula $X\sim\mathsf{geom}(\mathtt{prob}=p)$
\end_inset

.
 The associated 
\family sans
R
\family default
 functions are 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

dgeom(x, prob)
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

pgeom
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

qgeom
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

rhyper
\end_layout

\end_inset

, which give the PMF, CDF, quantile function, and simulate random variates,
 respectively.
\end_layout

\begin_layout Standard
Again it is clear that 
\begin_inset Formula $f(x)\geq0$
\end_inset

 and we check that 
\begin_inset Formula $\sum f(x)=1$
\end_inset

 (see Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:geom-series"

\end_inset

 in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Sequences-and-Series"

\end_inset

):
\begin_inset Formula \begin{alignat*}{1}
\sum_{x=0}^{\infty}p(1-p)^{x}= & p\sum_{x=0}^{\infty}q^{x}=p\,\frac{1}{1-q}=1.\end{alignat*}

\end_inset

We will find in the next section that the mean and variance are
\begin_inset Formula \begin{equation}
\mu=\frac{1-p}{p}=\frac{q}{p}\mbox{ and }\sigma^{2}=\frac{q}{p^{2}}.\end{equation}

\end_inset


\end_layout

\begin_layout Example
The Pittsburgh Steelers place kicker, Jeff Reed, made 81.2% of his attempted
 field goals in his career up to 2006.
 Assuming that his successive field goal attempts are approximately Bernoulli
 trials, find the probability that Jeff misses at least 5 field goals before
 his first successful goal.

\emph on
 
\end_layout

\begin_layout Example

\emph on
Solution
\emph default
: If 
\begin_inset Formula $X=$
\end_inset

 the number of missed goals until Jeff's first success, then 
\begin_inset Formula $X\sim\mathsf{geom}(\mathtt{prob}=0.812)$
\end_inset

 and we want 
\begin_inset Formula $\P(X\geq5)=\P(X>4)$
\end_inset

.
 We can find this in 
\family sans
R
\family default
 with 
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

pgeom(4, prob = 0.812, lower.tail = FALSE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Note
Some books use a slightly different definition of the geometric distribution.
 They consider Bernoulli trials and let 
\begin_inset Formula $Y$
\end_inset

 count instead the number of trials until a success, so that 
\begin_inset Formula $Y$
\end_inset

 has PMF
\begin_inset Formula \begin{equation}
f_{Y}(y)=p(1-p)^{y-1},\quad y=1,2,3,\ldots\end{equation}

\end_inset

When they say 
\begin_inset Quotes eld
\end_inset

geometric distribution
\begin_inset Quotes erd
\end_inset

, this is what they mean.
 It is not hard to see that the two definitions are related.
 In fact, if 
\begin_inset Formula $X$
\end_inset

 denotes our geometric and 
\begin_inset Formula $Y$
\end_inset

 theirs, then 
\begin_inset Formula $Y=X+1$
\end_inset

.
 Consequently, they have 
\begin_inset Formula $\mu_{Y}=\mu_{X}+1$
\end_inset

 and 
\begin_inset Formula $\sigma_{Y}^{2}=\sigma_{X}^{2}$
\end_inset

.
\end_layout

\begin_layout Subsubsection*
The Negative Binomial Distribution
\begin_inset CommandInset label
LatexCommand label
name "sub:The-Negative-Binomial"

\end_inset


\end_layout

\begin_layout Standard
We may generalize the problem and consider the case where we wait for 
\emph on
more
\emph default
 than one success.
 Suppose that we conduct Bernoulli trials repeatedly, noting the respective
 successes and failures.
 Let 
\begin_inset Formula $X$
\end_inset

 count the number of failures before 
\begin_inset Formula $r$
\end_inset

 successes.
 If 
\begin_inset Formula $\P(S)=p$
\end_inset

 then 
\begin_inset Formula $X$
\end_inset

 has PMF
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
f_{X}(x)={r+x-1 \choose r-1}\, p^{r}(1-p)^{x},\quad x=0,1,2,\ldots\end{equation}

\end_inset

We say that 
\begin_inset Formula $X$
\end_inset

 has a 
\emph on
Negative Binomial distribution
\emph default
 and write 
\begin_inset Formula $X\sim\mathsf{nbinom}(\mathtt{size}=r,\,\mathtt{prob}=p)$
\end_inset

.
 The associated 
\family sans
R
\family default
 functions are 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

dnbinom(x, size, prob)
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

pnbinom
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

qnbinom
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

rnbinom
\end_layout

\end_inset

, which give the PMF, CDF, quantile function, and simulate random variates,
 respectively.
\end_layout

\begin_layout Standard
As usual it should be clear that 
\begin_inset Formula $f_{X}(x)\geq0$
\end_inset

 and the fact that 
\begin_inset Formula $\sum f_{X}(x)=1$
\end_inset

 follows from a generalization of the geometric series by means of a Maclaurin's
 series expansion:
\begin_inset Formula \begin{alignat}{1}
\frac{1}{1-t}= & \sum_{k=0}^{\infty}t^{k},\quad\mbox{for \ensuremath{-1<t<1}},\mbox{ and}\\
\frac{1}{(1-t)^{r}}= & \sum_{k=0}^{\infty}{r+k-1 \choose r-1}\, t^{k},\quad\mbox{for \ensuremath{-1<t<1}}.\end{alignat}

\end_inset

Therefore 
\begin_inset Formula \begin{equation}
\sum_{x=0}^{\infty}f_{X}(x)=p^{r}\sum_{x=0}^{\infty}{r+x-1 \choose r-1}\, q^{x}=p^{r}(1-q)^{-r}=1,\end{equation}

\end_inset

since 
\begin_inset Formula $|q|=|1-p|<1$
\end_inset

.
 
\end_layout

\begin_layout Example
We flip a coin repeatedly and let 
\begin_inset Formula $X$
\end_inset

 count the number of Tails until we get seven Heads.
 What is 
\begin_inset Formula $\P(X=5)?$
\end_inset


\end_layout

\begin_layout Example

\emph on
Solution:
\emph default
 We know that 
\begin_inset Formula $X\sim\mathsf{nbinom}(\mathtt{size}=7,\,\mathtt{prob}=1/2)$
\end_inset

.
 
\begin_inset Formula \[
\P(X=5)=f_{X}(5)={7+5-1 \choose 7-1}(1/2)^{7}(1/2)^{5}={11 \choose 6}2^{-12}\]

\end_inset

and we can get this in 
\family sans
R
\family default
 with
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

dnbinom(5, size = 7, prob = 0.5)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Let us next compute the MGF of 
\begin_inset Formula $X\sim\mathsf{nbinom}(\mathtt{size}=r,\,\mathtt{prob}=p)$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{alignat*}{1}
M_{X}(t)= & \sum_{x=0}^{\infty}\me^{tx}\ {r+x-1 \choose r-1}p^{r}q^{x}\\
= & p^{r}\sum_{x=0}^{\infty}{r+x-1 \choose r-1}[q\me^{t}]^{x}\\
= & p^{r}(1-qe^{t})^{-r},\quad\mbox{provided \ensuremath{|q\me^{t}|<1,}}\end{alignat*}

\end_inset

and so 
\begin_inset Formula \begin{equation}
M_{X}(t)=\left(\frac{p}{1-q\me^{t}}\right)^{r},\quad\mbox{for \ensuremath{q\me^{t}<1}}.\end{equation}

\end_inset

We see that 
\begin_inset Formula $q\me^{t}<1$
\end_inset

 when 
\begin_inset Formula $t<-\ln(1-p)$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Example
Let 
\begin_inset Formula $X\sim\mathsf{nbinom}(\mathtt{size}=r,\mathtt{prob}=p)\mbox{ with \ensuremath{M(t)=p^{r}(1-q\me^{t})^{-r}}}$
\end_inset

.
 We proclaimed above the values of the mean and variance.
 Now we are equipped with the tools to find these directly.
\end_layout

\begin_layout Example
\begin_inset Formula \begin{alignat*}{1}
M'(t)= & p^{r}(-r)(1-q\me^{t})^{-r-1}(-q\me^{t}),\\
= & rq\me^{t}p^{r}(1-q\me^{t})^{-r-1},\\
= & \frac{rq\me^{t}}{1-q\me^{t}}M(t),\mbox{ and so }\\
M'(0)= & \frac{rq}{1-q}\cdot1=\frac{rq}{p}.\end{alignat*}

\end_inset

Thus 
\begin_inset Formula $\mu=rq/p$
\end_inset

.
 We next find 
\begin_inset Formula $\E X^{2}$
\end_inset

.
\begin_inset Formula \begin{alignat*}{1}
M''(0)= & \left.\frac{rq\me^{t}(1-q\me^{t})-rq\me^{t}(-q\me^{t})}{(1-q\me^{t})^{2}}M(t)+\frac{rq\me^{t}}{1-q\me^{t}}M'(t)\right|_{t=0},\\
= & \frac{rqp+rq^{2}}{p^{2}}\cdot1+\frac{rq}{p}\left(\frac{rq}{p}\right),\\
= & \frac{rq}{p^{2}}+\left(\frac{rq}{p}\right)^{2}.\end{alignat*}

\end_inset

Finally we may say 
\begin_inset Formula $\sigma^{2}=M''(0)-[M'(0)]^{2}=rq/p^{2}.$
\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
A random variable has MGF
\begin_inset Formula \[
M_{X}(t)=\left(\frac{0.19}{1-0.81\me^{t}}\right)^{31}.\]

\end_inset

Then 
\begin_inset Formula $X\sim\mathsf{nbinom}(\mathtt{size}=31,\,\mathtt{prob}=0.19)$
\end_inset

.
\end_layout

\begin_layout Note
As with the Geometric distribution, some books use a slightly different
 definition of the Negative Binomial distribution.
 They consider Bernoulli trials and let 
\begin_inset Formula $Y$
\end_inset

 be the number of trials until 
\begin_inset Formula $r$
\end_inset

 successes, so that 
\begin_inset Formula $Y$
\end_inset

 has PMF
\begin_inset Formula \begin{equation}
f_{Y}(y)={y-1 \choose r-1}p^{r}(1-p)^{y-r},\quad y=r,r+1,r+2,\ldots\end{equation}

\end_inset

It is again not hard to see that if 
\begin_inset Formula $X$
\end_inset

 denotes our Negative Binomial and 
\begin_inset Formula $Y$
\end_inset

 theirs, then 
\begin_inset Formula $Y=X+r$
\end_inset

.
 Consequently, they have 
\begin_inset Formula $\mu_{Y}=\mu_{X}+r$
\end_inset

 and 
\begin_inset Formula $\sigma_{Y}^{2}=\sigma_{X}^{2}$
\end_inset

.
\end_layout

\begin_layout Subsection
Arrival Processes
\begin_inset CommandInset label
LatexCommand label
name "sec:Arrival-Processes"

\end_inset


\end_layout

\begin_layout Subsubsection*
The Poisson Distribution
\begin_inset CommandInset label
LatexCommand label
name "sub:The-Poisson-Distribution"

\end_inset


\end_layout

\begin_layout Standard
This is a distribution associated with 
\begin_inset Quotes eld
\end_inset

rare events
\begin_inset Quotes erd
\end_inset

, for reasons which will become clear in a moment.
 The events might be:
\end_layout

\begin_layout Itemize
traffic accidents,
\end_layout

\begin_layout Itemize
typing errors, or
\end_layout

\begin_layout Itemize
customers arriving in a bank.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\lambda$
\end_inset

 be the average number of events in the time interval 
\begin_inset Formula $[0,1]$
\end_inset

.
 Let the random variable 
\begin_inset Formula $X$
\end_inset

 count the number of events occurring in the interval.
 Then under certain reasonable conditions it can be shown that
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
f_{X}(x)=\P(X=x)=\me^{-\lambda}\frac{\lambda^{x}}{x!},\quad x=0,1,2,\ldots\end{equation}

\end_inset

We use the notation 
\begin_inset Formula $X\sim\mathsf{pois}(\mathtt{lambda}=\lambda)$
\end_inset

.
 The associated 
\family sans
R
\family default
 functions are 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

dpois(x, lambda)
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

ppois
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

qpois
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

rpois
\end_layout

\end_inset

, which give the PMF, CDF, quantile function, and simulate random variates,
 respectively.
\end_layout

\begin_layout Paragraph*
What are the reasonable conditions?
\end_layout

\begin_layout Standard
Divide 
\begin_inset Formula $[0,1]$
\end_inset

 into subintervals of length 
\begin_inset Formula $1/n$
\end_inset

.
 A 
\emph on
Poisson process
\emph default

\begin_inset Index
status open

\begin_layout Plain Layout
Poisson process
\end_layout

\end_inset

 satisfies the following conditions:
\end_layout

\begin_layout Itemize
the probability of an event occurring in a particular subinterval is 
\begin_inset Formula $\approx\lambda/n$
\end_inset

.
\end_layout

\begin_layout Itemize
the probability of two or more events occurring in any subinterval is 
\begin_inset Formula $\approx0$
\end_inset

.
\end_layout

\begin_layout Itemize
occurrences in disjoint subintervals are independent.
\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:poisson-process"

\end_inset

If 
\begin_inset Formula $X$
\end_inset

 counts the number of events in the interval 
\begin_inset Formula $[0,t]$
\end_inset

 and 
\begin_inset Formula $\lambda$
\end_inset

 is the average number that occur in unit time, then 
\begin_inset Formula $X\sim\mathsf{pois}(\mathtt{lambda}=\lambda t)$
\end_inset

, that is,
\begin_inset Formula \begin{equation}
\P(X=x)=\me^{-\lambda t}\frac{(\lambda t)^{x}}{x!},\quad x=0,1,2,3\ldots\end{equation}

\end_inset


\end_layout

\begin_layout Example
On the average, five cars arrive at a particular car wash every hour.
 Let 
\begin_inset Formula $X$
\end_inset

 count the number of cars that arrive from 10AM to 11AM.
 Then 
\begin_inset Formula $X\sim\mathsf{pois}(\mathtt{lambda}=5)$
\end_inset

.
 Also, 
\begin_inset Formula $\mu=\sigma^{2}=5$
\end_inset

.
 What is the probability that no car arrives during this period? 
\end_layout

\begin_deeper
\begin_layout Standard
Solution: The probability that no car arrives is 
\begin_inset Formula \[
\P(X=0)=\me^{-5}\frac{5^{0}}{0!}=\me^{-5}\approx0.0067.\]

\end_inset


\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Example
Suppose the car wash above is in operation from 8AM to 6PM, and we let 
\begin_inset Formula $Y$
\end_inset

 be the number of customers that appear in this period.
 Since this period covers a total of 10 hours, from Remark 
\begin_inset CommandInset ref
LatexCommand ref
reference "rem:poisson-process"

\end_inset

 we get that 
\begin_inset Formula $Y\sim\mathsf{pois}(\mathtt{lambda}=5\ast10=50)$
\end_inset

.
 What is the probability that there are between 48 and 50 customers, inclusive?
\end_layout

\begin_deeper
\begin_layout Standard
Solution: We want 
\begin_inset Formula $\P(48\leq Y\leq50)=\P(X\leq50)-\P(X\leq47)$
\end_inset

.
 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

diff(ppois(c(47, 50), lambda = 50))
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Section
Functions of Discrete Random Variables
\begin_inset CommandInset label
LatexCommand label
name "sec:functions-discrete-rvs"

\end_inset


\end_layout

\begin_layout Standard
We have built a large catalogue of discrete distributions, but the tools
 of this section will give us the ability to consider infinitely many more.
 Given a random variable 
\begin_inset Formula $X$
\end_inset

 and a given function 
\begin_inset Formula $h$
\end_inset

, we may consider 
\begin_inset Formula $Y=h(X)$
\end_inset

.
 Since the values of 
\begin_inset Formula $X$
\end_inset

 are determined by chance, so are the values of 
\begin_inset Formula $Y$
\end_inset

.
 The question is, what is the PMF of the random variable 
\begin_inset Formula $Y$
\end_inset

? The answer, of course, depends on 
\begin_inset Formula $h$
\end_inset

.
 In the case that 
\begin_inset Formula $h$
\end_inset

 is one-to-one (see Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Differential-and-Integral"

\end_inset

), the solution can be found by simple substitution.
\end_layout

\begin_layout Example
Let 
\begin_inset Formula $X\sim\mathsf{nbinom}(\mathtt{size}=r,\,\mathtt{prob}=p)$
\end_inset

.
 We saw in 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:other-discrete-distributions"

\end_inset

 that 
\begin_inset Formula $X$
\end_inset

 represents the number of failures until 
\begin_inset Formula $r$
\end_inset

 successes in a sequence of Bernoulli trials.
 Suppose now that instead we were interested in counting the number of trials
 (successes and failures) until the 
\begin_inset Formula $r$
\end_inset


\begin_inset Formula $^{\text{th}}$
\end_inset

 success occurs, which we will denote by 
\begin_inset Formula $Y$
\end_inset

.
 In a given performance of the experiment, the number of failures (
\begin_inset Formula $X$
\end_inset

) and the number of successes (
\begin_inset Formula $r$
\end_inset

) together will comprise the total number of trials (
\begin_inset Formula $Y$
\end_inset

), or in other words, 
\begin_inset Formula $X+r=Y$
\end_inset

.
 We may let 
\begin_inset Formula $h$
\end_inset

 be defined by 
\begin_inset Formula $h(x)=x+r$
\end_inset

 so that 
\begin_inset Formula $Y=h(X)$
\end_inset

, and we notice that 
\begin_inset Formula $h$
\end_inset

 is linear and hence one-to-one.
 Finally, 
\begin_inset Formula $X$
\end_inset

 takes values 
\begin_inset Formula $0,\ 1,\ 2,\ldots$
\end_inset

 implying that the support of 
\begin_inset Formula $Y$
\end_inset

 would be 
\begin_inset Formula $\left\{ r,\ r+1,\ r+2,\ldots\right\} $
\end_inset

.
 Solving for 
\begin_inset Formula $X$
\end_inset

 we get 
\begin_inset Formula $X=Y-r$
\end_inset

.
 Examining the PMF of 
\begin_inset Formula $X$
\end_inset


\begin_inset Formula \begin{equation}
f_{X}(x)={r+x-1 \choose r-1}\, p^{r}(1-p)^{x},\end{equation}

\end_inset

we can substitute 
\begin_inset Formula $x=y-r$
\end_inset

 to get
\begin_inset Formula \begin{eqnarray*}
f_{Y}(y) & = & f_{X}(y-r),\\
 & = & {r+(y-r)-1 \choose r-1}\, p^{r}(1-p)^{y-r},\\
 & = & {y-1 \choose r-1}\, p^{r}(1-p)^{y-r},\quad y=r,\, r+1,\ldots\end{eqnarray*}

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Even when the function 
\begin_inset Formula $h$
\end_inset

 is not one-to-one, we may still find the PMF of 
\begin_inset Formula $Y$
\end_inset

 simply by accumulating, for each 
\begin_inset Formula $y$
\end_inset

, the probability of all the 
\begin_inset Formula $x$
\end_inset

's that are mapped to that 
\begin_inset Formula $y$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Proposition
Let 
\begin_inset Formula $X$
\end_inset

 be a discrete random variable with PMF 
\begin_inset Formula $f_{X}$
\end_inset

 supported on the set 
\begin_inset Formula $S_{X}$
\end_inset

.
 Let 
\begin_inset Formula $Y=h(X)$
\end_inset

 for some function 
\begin_inset Formula $h$
\end_inset

.
 Then 
\begin_inset Formula $Y$
\end_inset

 has PMF 
\begin_inset Formula $f_{Y}$
\end_inset

 defined by
\begin_inset Formula \begin{equation}
f_{Y}(y)=\sum_{\{x\in S_{X}|\, h(x)=y\}}f_{X}(x)\end{equation}

\end_inset

 
\end_layout

\begin_layout Example
Let 
\begin_inset Formula $X\sim\mathsf{binom}(\mathtt{size}=4,\,\mathtt{prob}=1/2)$
\end_inset

, and let 
\begin_inset Formula $Y=(X-1)^{2}$
\end_inset

.
 Consider the following table:
\end_layout

\begin_layout Example
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="3" columns="6">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $f_{X}(x)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1/16$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1/4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $6/16$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1/4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1/16$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y=(x-2)^{2}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
From this we see that 
\begin_inset Formula $Y$
\end_inset

 has support 
\begin_inset Formula $S_{Y}=\{0,1,4,9\}$
\end_inset

.
 We also see that 
\begin_inset Formula $h(x)=(x-1)^{2}$
\end_inset

 is not one-to-one on the support of 
\begin_inset Formula $X$
\end_inset

, because both 
\begin_inset Formula $x=0$
\end_inset

 and 
\begin_inset Formula $x=2$
\end_inset

 are mapped by 
\begin_inset Formula $h$
\end_inset

 to 
\begin_inset Formula $y=1$
\end_inset

.
 Nevertheless, we see that 
\begin_inset Formula $Y=0$
\end_inset

 only when 
\begin_inset Formula $X=1$
\end_inset

, which has probability 
\begin_inset Formula $1/4$
\end_inset

; therefore, 
\begin_inset Formula $f_{Y}(0)$
\end_inset

 should equal 
\begin_inset Formula $1/4$
\end_inset

.
 A similar approach works for 
\begin_inset Formula $y=4$
\end_inset

 and 
\begin_inset Formula $y=9$
\end_inset

.
 And 
\begin_inset Formula $Y=1$
\end_inset

 exactly when 
\begin_inset Formula $X=0$
\end_inset

 or 
\begin_inset Formula $X=2$
\end_inset

, which has total probability 
\begin_inset Formula $7/16$
\end_inset

.
 In summary, the PMF of 
\begin_inset Formula $Y$
\end_inset

 may be written:
\end_layout

\begin_layout Example
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="5">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $y$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
0
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $f_{X}(x)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1/4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $7/16$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1/4$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $1/16$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
Note that there is not a special name for the distribution of 
\begin_inset Formula $Y$
\end_inset

, it is just an example of what to do when the transformation of a random
 variable is not one-to-one.
 The method is the same for more complicated problems.
\end_layout

\begin_layout Proposition
If 
\begin_inset Formula $X$
\end_inset

 is a random variable with 
\begin_inset Formula $\E X=\mu$
\end_inset

 and 
\begin_inset Formula $\mbox{Var}(X)=\sigma^{2}$
\end_inset

, then the mean and variance of 
\begin_inset Formula $Y=mX+b$
\end_inset

 is 
\begin_inset Formula \begin{equation}
\mu_{Y}=m\mu+b,\quad\sigma_{Y}^{2}=m^{2}\sigma^{2},\quad\sigma_{Y}=|m|\sigma.\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Chapter Exercises
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{section}{Chapter Exercises}
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{thm}{0}
\end_layout

\end_inset


\end_layout

\begin_layout Exercise
A recent national study showed that approximately 44.7% of college students
 have used Wikipedia as a source in at least one of their term papers.
 Let 
\begin_inset Formula $X$
\end_inset

 equal the number of students in a random sample of size 
\begin_inset Formula $n=31$
\end_inset

 who have used Wikipedia as a source.
 
\end_layout

\begin_deeper
\begin_layout Enumerate
How is 
\begin_inset Formula $X$
\end_inset

 distributed? 
\begin_inset Formula \[
X\sim\mathsf{binom}(\mathtt{size}=31,\,\mathtt{prob}=0.447)\]

\end_inset


\end_layout

\begin_layout Enumerate
Sketch the probability mass function (roughly).
\end_layout

\begin_deeper
\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 3, width = 6>>=
\begin_inset Newline newline
\end_inset

xmin <- qbinom(.0005, size=31 , prob=0.447) 
\begin_inset Newline newline
\end_inset

xmax <- qbinom(.9995, size=31 , prob=0.447) 
\begin_inset Newline newline
\end_inset

.x <- xmin:xmax 
\begin_inset Newline newline
\end_inset

plot(.x, dbinom(.x, size=31, prob=0.447), xlab="Number of Successes", ylab="Probabi
lity Mass",    main="Binomial Dist'n: Trials = 31, Prob of success = 0.447",
 type="h") 
\begin_inset Newline newline
\end_inset

points(.x, dbinom(.x, size=31, prob=0.447), pch=16) 
\begin_inset Newline newline
\end_inset

abline( h = 0, lty = 2, col = "grey" ) 
\begin_inset Newline newline
\end_inset

remove(.x, xmin, xmax)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
Sketch the cumulative distribution function (roughly).
\end_layout

\begin_deeper
\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 3, width = 6>>=
\begin_inset Newline newline
\end_inset

xmin <- qbinom(.0005, size=31 , prob=0.447) 
\begin_inset Newline newline
\end_inset

xmax <- qbinom(.9995, size=31 , prob=0.447) 
\begin_inset Newline newline
\end_inset

.x <- xmin:xmax 
\begin_inset Newline newline
\end_inset

plot( stepfun(.x, pbinom((xmin-1):xmax, size=31, prob=0.447)), verticals=FALSE,
 do.p=FALSE, xlab="Number of Successes", ylab="Cumulative Probability", main="Bin
omial Dist'n: Trials = 31, Prob of success = 0.447") 
\begin_inset Newline newline
\end_inset

points( .x, pbinom(xmin:xmax, size=31, prob=0.447), pch = 16, cex=1.2 ) 
\begin_inset Newline newline
\end_inset

points( .x, pbinom((xmin-1):(xmax-1), size=31, prob=0.447), pch = 1,    cex=1.2
 ) 
\begin_inset Newline newline
\end_inset

abline( h = 1, lty = 2, col = "grey" ) 
\begin_inset Newline newline
\end_inset

abline( h = 0, lty = 2, col = "grey" ) 
\begin_inset Newline newline
\end_inset

remove(.x, xmin, xmax) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
Find the probability that 
\begin_inset Formula $X$
\end_inset

 is equal to 17.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

dbinom(17, size = 31, prob = 0.447)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
Find the probability that 
\begin_inset Formula $X$
\end_inset

 is at most 13.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

pbinom(13, size = 31, prob = 0.447)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
Find the probability that 
\begin_inset Formula $X$
\end_inset

 is bigger than 11.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

pbinom(11, size = 31, prob = 0.447, lower.tail = FALSE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
Find the probability that 
\begin_inset Formula $X$
\end_inset

 is at least 15.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

pbinom(14, size = 31, prob = 0.447, lower.tail = FALSE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
Find the probability that 
\begin_inset Formula $X$
\end_inset

 is between 16 and 19, inclusive.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

sum(dbinom(16:19, size = 31, prob = 0.447))
\begin_inset Newline newline
\end_inset

diff(pbinom(c(19,15), size = 31, prob = 0.447, lower.tail = FALSE))
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
Give the mean of 
\begin_inset Formula $X$
\end_inset

, denoted 
\begin_inset Formula $\E X$
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(distrEx)
\begin_inset Newline newline
\end_inset

X = Binom(size = 31, prob = 0.447)
\begin_inset Newline newline
\end_inset

E(X)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
Give the variance of 
\begin_inset Formula $X$
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

var(X)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
Give the standard deviation of 
\begin_inset Formula $X$
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

sd(X)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
Find 
\begin_inset Formula $\E(4X+51.324)$
\end_inset


\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

E(4*X + 51.324)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\end_deeper
\begin_layout Scrap
<<echo = FALSE, results = hide>>=
\begin_inset Newline newline
\end_inset

rnorm(1)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Exercise
For the following situations, decide what the distribution of 
\begin_inset Formula $X$
\end_inset

 should be.
 In nearly every case, there are additional assumptions that should be made
 for the distribution to apply; identify those assumptions (which may or
 may not hold in practice.)
\end_layout

\begin_layout Enumerate
We shoot basketballs at a basketball hoop, and count the number of shots
 until we make a goal.
 Let 
\begin_inset Formula $X$
\end_inset

 denote the number of missed shots.
 On a normal day we would typically make about 37% of the shots.
\end_layout

\begin_layout Enumerate
In a local lottery in which a three digit number is selected randomly, let
 
\begin_inset Formula $X$
\end_inset

 be the number selected.
\end_layout

\begin_layout Enumerate
We drop a Styrofoam cup to the floor twenty times, each time recording whether
 the cup comes to rest perfectly right side up, or not.
 Let 
\begin_inset Formula $X$
\end_inset

 be the number of times the cup lands perfectly right side up.
\end_layout

\begin_layout Enumerate
We toss a piece of trash at the garbage can from across the room.
 If we miss the trash can, we retrieve the trash and try again, continuing
 to toss until we make the shot.
 Let 
\begin_inset Formula $X$
\end_inset

 denote the number of missed shots.
 
\end_layout

\begin_layout Enumerate
Working for the border patrol, we inspect shipping cargo as when it enters
 the harbor looking for contraband.
 A certain ship comes to port with 557 cargo containers.
 Standard practice is to select 10 containers randomly and inspect each
 one very carefully, classifying it as either having contraband or not.
 Let 
\begin_inset Formula $X$
\end_inset

 count the number of containers that illegally contain contraband.
\end_layout

\begin_layout Enumerate
At the same time every year, some migratory birds land in a bush outside
 for a short rest.
 On a certain day, we look outside and let 
\begin_inset Formula $X$
\end_inset

 denote the number of birds in the bush.
\end_layout

\begin_layout Enumerate
We count the number of rain drops that fall in a circular area on a sidewalk
 during a ten minute period of a thunder storm.
\end_layout

\begin_layout Enumerate
We count the number of moth eggs on our window screen.
\end_layout

\begin_layout Enumerate
We count the number of blades of grass in a one square foot patch of land.
\end_layout

\begin_layout Enumerate
We count the number of pats on a baby's back until (s)he burps.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Exercise
Find the constant 
\begin_inset Formula $c$
\end_inset

 so that the given function is a valid PDF of a random variable 
\begin_inset Formula $X$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $f(x)=Cx^{n},\quad0<x<1$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $f(x)=Cx\me^{-x},\quad0<x<\infty$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $f(x)=\me^{-(x-C)},\quad7<x<\infty.$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $f(x)=Cx^{3}(1-x)^{2},\quad0<x<1.$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula ${\displaystyle f(x)=C(1+x^{2}/4)^{-1}},\quad-\infty<x<\infty.$
\end_inset


\end_layout

\begin_layout Exercise
\begin_inset CommandInset label
LatexCommand label
name "xca:variance-shortcut"

\end_inset

Show that 
\begin_inset Formula $\E(X-\mu)^{2}=\E X^{2}-\mu^{2}$
\end_inset

.
 
\emph on
Hint
\emph default
: expand the quantity 
\begin_inset Formula $(X-\mu)^{2}$
\end_inset

 and distribute the expectation over the resulting terms.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Exercise
\begin_inset CommandInset label
LatexCommand label
name "xca:binom-factorial-expectation"

\end_inset

If 
\begin_inset Formula $X\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)$
\end_inset

 show that 
\begin_inset Formula $\E X(X-1)=n(n-1)p^{2}$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Exercise
\begin_inset CommandInset label
LatexCommand label
name "xca:hyper-mean-variance"

\end_inset

Calculate the mean and variance of the hypergeometric distribution.
 Show that 
\begin_inset Formula \begin{equation}
\mu=K\frac{M}{M+N},\quad\sigma^{2}=K\frac{MN}{(M+N)^{2}}\frac{M+N-K}{M+N-1}.\end{equation}

\end_inset


\end_layout

\begin_layout Chapter
Continuous Distributions
\begin_inset CommandInset label
LatexCommand label
name "cha:Continuous-Distributions"

\end_inset


\end_layout

\begin_layout Standard
\noindent
The focus of the last chapter was on random variables whose support can
 be written down in a list of values (finite or countably infinite), such
 as the number of successes in a sequence of Bernoulli trials.
 Now we move to random variables whose support is a whole range of values,
 say, an interval 
\begin_inset Formula $(a,b)$
\end_inset

.
 It is shown in later classes that it is impossible to write all of the
 numbers down in a list; there are simply too many of them.
 
\end_layout

\begin_layout Standard
This chapter begins with continuous random variables and the associated
 PDFs and CDFs The continuous uniform distribution is highlighted, along
 with the Gaussian, or normal, distribution.
 Some mathematical details pave the way for a catalogue of models.
\end_layout

\begin_layout Standard
The interested reader who would like to learn more about any of the assorted
 discrete distributions mentioned below should take a look at 
\emph on
Continuous Univariate Distributions, Volumes 1
\emph default
 and 
\emph on
2
\emph default
 by Johnson 
\emph on
et al 
\emph default

\begin_inset CommandInset citation
LatexCommand cite
key "Johnson1994,Johnson1995"

\end_inset

.
\end_layout

\begin_layout Paragraph*
What do I want them to know?
\end_layout

\begin_layout Itemize
how to choose a reasonable continuous model under a variety of physical
 circumstances
\end_layout

\begin_layout Itemize
basic correspondence between continuous versus discrete random variables
\end_layout

\begin_layout Itemize
the general tools of the trade for manipulation of continuous random variables,
 integration, 
\emph on
etc
\emph default
.
\end_layout

\begin_layout Itemize
some details on a couple of continuous models, and exposure to a bunch of
 other ones
\end_layout

\begin_layout Itemize
how to make new continuous random variables from old ones
\end_layout

\begin_layout Section
Continuous Random Variables
\begin_inset CommandInset label
LatexCommand label
name "sec:continuous-random-variables"

\end_inset


\end_layout

\begin_layout Subsection
Probability Density Functions
\begin_inset CommandInset label
LatexCommand label
name "sub:probability-density-functions"

\end_inset


\end_layout

\begin_layout Standard
Continuous random variables have supports that look like
\begin_inset Formula \begin{equation}
S_{X}=[a,b]\mbox{ or }(a,b),\end{equation}

\end_inset

or unions of intervals of the above form.
 Examples of random variables that are often taken to be continuous are:
\end_layout

\begin_layout Itemize
the height or weight of an individual,
\end_layout

\begin_layout Itemize
other physical measurements such as the length or size of an object, and
\end_layout

\begin_layout Itemize
durations of time (usually).
\end_layout

\begin_layout Standard
Every continuous random variable 
\begin_inset Formula $X$
\end_inset

 has a 
\emph on
probability density function
\emph default
 (PDF) denoted 
\begin_inset Formula $f_{X}$
\end_inset

 associated with it
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Not true.
 There are pathological random variables with no density function.
 (This is one of the crazy things that can happen in the world of measure
 theory).
 But in this book we will not get even close to these anomalous beasts,
 and regardless it can be proved that the CDF always exists.
\end_layout

\end_inset

 that satisfies three basic properties:
\end_layout

\begin_layout Enumerate
\begin_inset Formula $f_{X}(x)>0$
\end_inset

 for 
\begin_inset Formula $x\in S_{X}$
\end_inset

,
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\int_{x\in S_{X}}f_{X}(x)\,\diff x=1$
\end_inset

, and
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\P(X\in A)=\int_{x\in A}f_{X}(x)\:\diff x$
\end_inset

, for an event 
\begin_inset Formula $A\subset S_{X}$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "enu: contrvcond3"

\end_inset


\end_layout

\begin_layout Remark
We can say the following about continuous random variables:
\end_layout

\begin_deeper
\begin_layout Itemize
Usually, the set 
\begin_inset Formula $A$
\end_inset

 in 
\begin_inset CommandInset ref
LatexCommand ref
reference "enu: contrvcond3"

\end_inset

 takes the form of an interval, for example, 
\begin_inset Formula $A=[c,d]$
\end_inset

, in which case
\begin_inset Formula \begin{equation}
\P(X\in A)=\int_{c}^{d}f_{X}(x)\:\diff x.\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
It follows that the probability that 
\begin_inset Formula $X$
\end_inset

 falls in a given interval is simply the 
\emph on
area under the curve 
\emph default
of 
\begin_inset Formula $f_{X}$
\end_inset

 over the interval.
\end_layout

\begin_layout Itemize
Since the area of a line 
\begin_inset Formula $x=c$
\end_inset

 in the plane is zero, 
\begin_inset Formula $\P(X=c)=0$
\end_inset

 for any value 
\begin_inset Formula $c$
\end_inset

.
 In other words, the chance that 
\begin_inset Formula $X$
\end_inset

 equals a particular value 
\begin_inset Formula $c$
\end_inset

 is zero, and this is true for any number 
\begin_inset Formula $c$
\end_inset

.
 Moreover, when 
\begin_inset Formula $a<b$
\end_inset

 all of the following probabilities are the same: 
\begin_inset Formula \begin{equation}
\P(a\leq X\leq b)=\P(a<X\leq b)=\P(a\leq X<b)=\P(a<X<b).\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
The PDF 
\begin_inset Formula $f_{X}$
\end_inset

 can sometimes be greater than 1.
 This is in contrast to the discrete case; every nonzero value of a PMF
 is a probability which is restricted to lie in the interval 
\begin_inset Formula $[0,1]$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Standard
We met the cumulative distribution function, 
\begin_inset Formula $F_{X}$
\end_inset

, in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Discrete-Distributions"

\end_inset

.
 Recall that it is defined by 
\begin_inset Formula $F_{X}(t)=\P(X\leq t)$
\end_inset

, for 
\begin_inset Formula $-\infty<t<\infty$
\end_inset

.
 While in the discrete case the CDF is unwieldy, in the continuous case
 the CDF has a relatively convenient form:
\begin_inset Formula \begin{equation}
F_{X}(t)=\P(X\leq t)=\int_{-\infty}^{t}f_{X}(x)\:\diff x,\quad-\infty<t<\infty.\end{equation}

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Remark
For any continuous CDF 
\begin_inset Formula $F_{X}$
\end_inset

 the following are true.
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $F_{X}$
\end_inset

 is nondecreasing , that is, 
\begin_inset Formula $t_{1}\leq t_{2}$
\end_inset

 implies 
\begin_inset Formula $F_{X}(t_{1})\leq F_{X}(t_{2})$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $F_{X}$
\end_inset

 is continuous (see Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Differential-and-Integral"

\end_inset

).
 Note the distinction from the discrete case: CDFs of discrete random variables
 are not continuous, they are only right continuous.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\lim_{t\to-\infty}F_{X}(t)=0$
\end_inset

 and 
\begin_inset Formula $\lim_{t\to\infty}F_{X}(t)=1$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Standard
There is a handy relationship between the CDF and PDF in the continuous
 case.
 Consider the derivative of 
\begin_inset Formula $F_{X}$
\end_inset

:
\begin_inset Formula \begin{equation}
F'_{X}(t)=\frac{\diff}{\diff t}F_{X}(t)=\frac{\diff}{\diff t}\,\int_{-\infty}^{t}f_{X}(x)\,\diff x=f_{X}(t),\end{equation}

\end_inset

the last equality being true by the Fundamental Theorem of Calculus, part
 (2) (see Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Differential-and-Integral"

\end_inset

).
 In short, 
\begin_inset Formula $(F_{X})'=f_{X}$
\end_inset

 in the continuous case
\begin_inset Foot
status open

\begin_layout Plain Layout
In the discrete case, 
\begin_inset Formula $f_{X}(x)=F_{X}(x)-\lim_{t\to x^{-}}F_{X}(t)$
\end_inset

.
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Subsection
Expectation of Continuous Random Variables
\begin_inset CommandInset label
LatexCommand label
name "sub:Expectation-of-Continuous"

\end_inset


\end_layout

\begin_layout Standard
For a continuous random variable 
\begin_inset Formula $X$
\end_inset

 the expected value of 
\begin_inset Formula $g(X)$
\end_inset

 is 
\begin_inset Formula \begin{equation}
\E g(X)=\int_{x\in S}g(x)f_{X}(x)\:\diff x,\end{equation}

\end_inset

provided the (potentially improper) integral 
\begin_inset Formula $\int_{S}|g(x)|\, f(x)\diff x$
\end_inset

 is convergent.
 One important example is the mean 
\begin_inset Formula $\mu$
\end_inset

, also known as 
\begin_inset Formula $\E X$
\end_inset

:
\begin_inset Formula \begin{equation}
\mu=\E X=\int_{x\in S}xf_{X}(x)\:\diff x,\end{equation}

\end_inset

provided 
\begin_inset Formula $\int_{S}|x|f(x)\diff x$
\end_inset

 is finite.
 Also there is the variance
\begin_inset Formula \begin{equation}
\sigma^{2}=\E(X-\mu)^{2}=\int_{x\in S}(x-\mu)^{2}f_{X}(x)\,\diff x,\end{equation}

\end_inset

which can be computed with the alternate formula 
\begin_inset Formula $\sigma^{2}=\E X^{2}-(\E X)^{2}$
\end_inset

.
 In addition, there is the standard deviation 
\begin_inset Formula $\sigma=\sqrt{\sigma^{2}}$
\end_inset

.
 The moment generating function is given by
\begin_inset Formula \begin{equation}
M_{X}(t)=\E\:\me^{tX}=\int_{-\infty}^{\infty}\me^{tx}f_{X}(x)\:\diff x,\end{equation}

\end_inset

provided the integral exists (is finite) for all 
\begin_inset Formula $t$
\end_inset

 in a neighborhood of 
\begin_inset Formula $t=0$
\end_inset

.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:cont-pdf3x2"

\end_inset

Let the continuous random variable 
\begin_inset Formula $X$
\end_inset

 have PDF 
\begin_inset Formula \[
f_{X}(x)=3x^{2},\quad0\leq x\leq1.\]

\end_inset

We will see later that 
\begin_inset Formula $f_{X}$
\end_inset

 belongs to the 
\emph on
Beta
\emph default
 family of distributions.
 It is easy to see that 
\begin_inset Formula $\int_{-\infty}^{\infty}f(x)\diff x=1$
\end_inset

.
\begin_inset Formula \begin{align*}
\int_{-\infty}^{\infty}f_{X}(x)\diff x & =\int_{0}^{1}3x^{2}\:\diff x\\
 & =\left.x^{3}\right|_{x=0}^{1}\\
 & =1^{3}-0^{3}\\
 & =1.\end{align*}

\end_inset

This being said, we may find 
\begin_inset Formula $\P(0.14\leq X<0.71)$
\end_inset

.
\begin_inset Formula \begin{align*}
\P(0.14\leq X<0.71) & =\int_{0.14}^{0.71}3x^{2}\diff x,\\
 & =\left.x^{3}\right|_{x=0.14}^{0.71}\\
 & =0.71^{3}-0.14^{3}\\
 & \approx0.355167.\end{align*}

\end_inset

We can find the mean and variance in an identical manner.
\begin_inset Formula \begin{align*}
\mu=\int_{-\infty}^{\infty}xf_{X}(x)\diff x & =\int_{0}^{1}x\cdot3x^{2}\:\diff x,\\
 & =\frac{3}{4}x^{4}|_{x=0}^{1},\\
 & =\frac{3}{4}.\end{align*}

\end_inset

It would perhaps be best to calculate the variance with the shortcut formula
 
\begin_inset Formula $\sigma^{2}=\E X^{2}-\mu^{2}$
\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{align*}
\E X^{2}=\int_{-\infty}^{\infty}x^{2}f_{X}(x)\diff x & =\int_{0}^{1}x^{2}\cdot3x^{2}\:\diff x\\
 & =\left.\frac{3}{5}x^{5}\right|_{x=0}^{1}\\
 & =3/5.\end{align*}

\end_inset

which gives 
\begin_inset Formula $\sigma^{2}=3/5-(3/4)^{2}=3/80$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:cont-pdf-3x4"

\end_inset

We will try one with unbounded support to brush up on improper integration.
 Let the random variable 
\begin_inset Formula $X$
\end_inset

 have PDF 
\begin_inset Formula \[
f_{X}(x)=\frac{3}{x^{4}},\quad x>1.\]

\end_inset

We can show that 
\begin_inset Formula $\int_{-\infty}^{\infty}f(x)\diff x=1$
\end_inset

:
\begin_inset Formula \begin{align*}
\int_{-\infty}^{\infty}f_{X}(x)\diff x & =\int_{1}^{\infty}\frac{3}{x^{4}}\:\diff x\\
 & =\lim_{t\to\infty}\int_{1}^{t}\frac{3}{x^{4}}\:\diff x\\
 & =\lim_{t\to\infty}\ \left.3\,\frac{1}{-3}x^{-3}\right|_{x=1}^{t}\\
 & =-\left(\lim_{t\to\infty}\frac{1}{t^{3}}-1\right)\\
 & =1.\end{align*}

\end_inset

We calculate 
\begin_inset Formula $\P(3.4\leq X<7.1)$
\end_inset

:
\begin_inset Formula \begin{align*}
\P(3.4\leq X<7.1) & =\int_{3.4}^{7.1}3x^{-4}\diff x\\
 & =\left.3\,\frac{1}{-3}x^{-3}\right|_{x=3.4}^{7.1}\\
 & =-1(7.1^{-3}-3.4^{-3})\\
 & \approx0.0226487123.\end{align*}

\end_inset

We locate the mean and variance just like before.
\begin_inset Formula \begin{align*}
\mu=\int_{-\infty}^{\infty}xf_{X}(x)\diff x & =\int_{1}^{\infty}x\cdot\frac{3}{x^{4}}\:\diff x\\
 & =\left.3\,\frac{1}{-2}x^{-2}\right|_{x=1}^{\infty}\\
 & =-\frac{3}{2}\left(\lim_{t\to\infty}\frac{1}{t^{2}}-1\right)\\
 & =\frac{3}{2}.\end{align*}

\end_inset

Again we use the shortcut 
\begin_inset Formula $\sigma^{2}=\E X^{2}-\mu^{2}$
\end_inset

:
\begin_inset Formula \begin{align*}
\E X^{2}=\int_{-\infty}^{\infty}x^{2}f_{X}(x)\diff x & =\int_{1}^{\infty}x^{2}\cdot\frac{3}{x^{4}}\:\diff x\\
 & =\left.3\:\frac{1}{-1}x^{-1}\right|_{x=1}^{\infty}\\
 & =-3\left(\lim_{t\to\infty}\frac{1}{t^{2}}-1\right)\\
 & =3,\end{align*}

\end_inset

which closes the example with 
\begin_inset Formula $\sigma^{2}=3-(3/2)^{2}=3/4$
\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
There exist utilities to calculate probabilities and expectations for general
 continuous random variables, but it is better to find a built-in model,
 if possible.
 Sometimes it is not possible.
 We show how to do it the long way, and the 
\begin_inset listings
lstparams "basicstyle={\ttfamily},breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

distr
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family sans
R
\family default
 packages ! 
\family typewriter
distr
\end_layout

\end_inset

 package way.
\end_layout

\begin_layout Example
Let 
\begin_inset Formula $X$
\end_inset

 have PDF 
\begin_inset Formula $f(x)=3x^{2}$
\end_inset

, 
\begin_inset Formula $0<x<1$
\end_inset

 and find 
\begin_inset Formula $\P(0.14\leq X\leq0.71)$
\end_inset

.
 (We will ignore that 
\begin_inset Formula $X$
\end_inset

 is a beta random variable for the sake of argument.)
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

f <- function(x) 3*x^2
\begin_inset Newline newline
\end_inset

integrate(f, lower = 0.14, upper = 0.71)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Compare this to the answer we found in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:cont-pdf3x2"

\end_inset

.
 We could integrate the function 
\begin_inset Formula $xf(x)=$
\end_inset

 
\begin_inset listings
lstparams "basicstyle={\ttfamily},breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

3*x^3
\end_layout

\end_inset

 from zero to one to get the mean, and use the shortcut 
\begin_inset Formula $\sigma^{2}=\E X^{2}-\left(\E X\right)^{2}$
\end_inset

 for the variance.
 
\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Example
Let 
\begin_inset Formula $X$
\end_inset

 have PDF 
\begin_inset Formula $f(x)=3/x^{4}$
\end_inset

, 
\begin_inset Formula $x>1$
\end_inset

.
 We may integrate the function 
\begin_inset Formula $xf(x)=$
\end_inset

 
\begin_inset listings
lstparams "basicstyle={\ttfamily},breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

3/x^3
\end_layout

\end_inset

 from zero to infinity to get the mean of 
\begin_inset Formula $X$
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

g <- function(x) 3/x^3
\begin_inset Newline newline
\end_inset

integrate(g, lower = 1, upper = Inf)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Compare this to the answer we got in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:cont-pdf-3x4"

\end_inset

.
 Use 
\begin_inset listings
lstparams "basicstyle={\ttfamily},breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

-Inf
\end_layout

\end_inset

 for 
\begin_inset Formula $-\infty$
\end_inset

.
\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Example
Let us redo Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:cont-pdf3x2"

\end_inset

 with the 
\begin_inset listings
lstparams "basicstyle={\ttfamily},breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

distr
\end_layout

\end_inset

 package.
 The method is similar to that encountered in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:disc-rv-how-r"

\end_inset

 in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Discrete-Distributions"

\end_inset

.
 We define an absolutely continuous random variable:
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(distr)
\begin_inset Newline newline
\end_inset

f <- function(x) 3*x^2
\begin_inset Newline newline
\end_inset

X <- AbscontDistribution(d = f, low1 = 0, up1 = 1)
\begin_inset Newline newline
\end_inset

p(X)(0.71) - p(X)(0.14)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Compare this answers we found earlier.
 Now let us try expectation with the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

distrEx
\end_layout

\end_inset

 package 
\begin_inset CommandInset citation
LatexCommand cite
key "Ruckdescheldistr"

\end_inset

:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(distrEx)
\begin_inset Newline newline
\end_inset

E(X)
\begin_inset Newline newline
\end_inset

var(X)
\begin_inset Newline newline
\end_inset

3/80
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Compare these answers to the ones we found in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:cont-pdf3x2"

\end_inset

.
 Why are they different? Because the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

distrEx
\end_layout

\end_inset

 package resorts to numerical methods when it encounters a model it does
 not recognize.
 This means that the answers we get for calculations may not exactly match
 the theoretical values.
 Be careful.
\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Section
The Continuous Uniform Distribution
\begin_inset CommandInset label
LatexCommand label
name "sec:The-Continuous-Uniform"

\end_inset


\end_layout

\begin_layout Standard
A random variable 
\begin_inset Formula $X$
\end_inset

 with the continuous uniform distribution on the interval 
\begin_inset Formula $(a,b)$
\end_inset

 has PDF
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{1}{b-a},\quad a<x<b.\end{equation}

\end_inset

The associated 
\family sans
R
\family default
 function is 
\color none

\begin_inset Formula $\mathsf{dunif}(\mathtt{min}=a,\,\mathtt{max}=b)$
\end_inset

.
 We write 
\begin_inset Formula $X\sim\mathsf{unif}(\mathtt{min}=a,\,\mathtt{max}=b)$
\end_inset

.
 Due to the particularly simple form of this PDF we can also write down
 explicitly a formula for the CDF 
\begin_inset Formula $F_{X}$
\end_inset

:
\begin_inset Formula \begin{equation}
F_{X}(t)=\begin{cases}
0, & t<0,\\
\frac{t-a}{b-a}, & a\leq t<b,\\
1, & t\geq b.\end{cases}\label{eq:unif-cdf}\end{equation}

\end_inset


\color inherit
The continuous uniform distribution is the continuous analogue of the discrete
 uniform distribution; it is used to model experiments whose outcome is
 an interval of numbers that are 
\begin_inset Quotes eld
\end_inset

equally likely
\begin_inset Quotes erd
\end_inset

 in the sense that any two intervals of equal length in the support have
 the same probability associated with them.
\end_layout

\begin_layout Example
Choose a number in [0,1] at random, and let 
\begin_inset Formula $X$
\end_inset

 be the number chosen.
 Then 
\begin_inset Formula $X\sim\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)$
\end_inset

.
 
\end_layout

\begin_layout Standard
The mean of 
\color none

\begin_inset Formula $X\sim\mathsf{unif}(\mathtt{min}=a,\,\mathtt{max}=b)$
\end_inset


\color inherit
 is relatively simple to calculate:
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{align*}
\mu=\E X & =\int_{-\infty}^{\infty}x\, f_{X}(x)\,\diff x,\\
 & =\int_{a}^{b}x\ \frac{1}{b-a}\ \diff x,\\
 & =\left.\frac{1}{b-a}\ \frac{x^{2}}{2}\ \right|_{x=a}^{b},\\
 & =\frac{1}{b-a}\ \frac{b^{2}-a^{2}}{2},\\
 & =\frac{b+a}{2},\end{align*}

\end_inset

using the popular formula for the difference of squares.
 The variance 
\color none
is left to Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:variance-dunif"

\end_inset

.
\end_layout

\begin_layout Section
The Normal Distribution
\begin_inset CommandInset label
LatexCommand label
name "sec:The-Normal-Distribution"

\end_inset


\end_layout

\begin_layout Standard
We say that 
\begin_inset Formula $X$
\end_inset

 has a 
\emph on
normal distribution
\emph default
 if it has PDF
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{1}{\sigma\sqrt{2\pi}}\exp\left\{ \frac{-(x-\mu)^{2}}{2\sigma^{2}}\right\} ,\quad-\infty<x<\infty.\end{equation}

\end_inset


\color none
We write 
\begin_inset Formula $X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

, and t
\color inherit
he associated 
\family sans
R
\family default
 function is 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dnorm(x, mean = 0, sd = 1)
\end_layout

\end_inset


\color none
.
\end_layout

\begin_layout Standard

\color none
The familiar bell-shaped curve, the normal distribution is also known as
 the 
\emph on
\color inherit
Gaussian distribution
\emph default
\color none
 because the German mathematician C.
\begin_inset space ~
\end_inset

F.
\begin_inset space ~
\end_inset

Gauss largely contributed to its mathematical development.
 This distribution is by far the most important distribution, continuous
 or discrete.

\color inherit
 The normal model appears in the theory of all sorts of natural phenomena,
 from to the way particles of smoke dissipate in a closed room, to the journey
 of a bottle in the ocean to the white noise of cosmic background radiation.
\end_layout

\begin_layout Standard
When 
\begin_inset Formula $\mu=0$
\end_inset

 and 
\begin_inset Formula $\sigma=1$
\end_inset

 we say that the random variable has a 
\emph on
standard normal
\emph default
 distribution and we typically write 
\color none

\begin_inset Formula $Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset


\color inherit
.
 The lowercase Greek letter phi (
\begin_inset Formula $\phi$
\end_inset

) is used to denote the standard normal PDF and the capital Greek letter
 phi 
\begin_inset Formula $\Phi$
\end_inset

 is used to denote the standard normal CDF: for 
\begin_inset Formula $-\infty<z<\infty$
\end_inset

,
\begin_inset Formula \begin{equation}
\phi(z)=\frac{1}{\sqrt{2\pi}}\,\me^{-z^{2}/2}\mbox{ and }\Phi(t)=\int_{-\infty}^{t}\phi(z)\,\diff z.\end{equation}

\end_inset


\end_layout

\begin_layout Proposition
If 
\color none

\begin_inset Formula $X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset


\color inherit
 then 
\begin_inset Formula \begin{equation}
Z=\frac{X-\mu}{\sigma}\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1).\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
TODO: put in proof of this with a change of variables
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The MGF of 
\begin_inset Formula $Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

 is relatively easy to derive:
\begin_inset Formula \begin{eqnarray*}
M_{Z}(t) & = & \int_{-\infty}^{\infty}\me^{tz}\frac{1}{\sqrt{2\pi}}\me^{-z^{2}/2}\diff z,\\
 & = & \int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}\exp\left\{ -\frac{1}{2}\left(z^{2}+2tz+t^{2}\right)+\frac{t^{2}}{2}\right\} \diff z,\\
 & = & \me^{t^{2}/2}\left(\int_{-\infty}^{\infty}\frac{1}{\sqrt{2\pi}}\me^{-[z-(-t)]^{2}/2}\diff z\right),\end{eqnarray*}

\end_inset

and the quantity in the parentheses is the total area under a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=-t,\,\mathtt{sd}=1)$
\end_inset

 density, which is one.
 Therefore,
\begin_inset Formula \begin{equation}
M_{Z}(t)=\me^{-t^{2}/2},\quad-\infty<t<\infty.\end{equation}

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
The MGF of 
\begin_inset Formula $X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 is then not difficult either because 
\begin_inset Formula \[
Z=\frac{X-\mu}{\sigma},\mbox{ or rewriting, }X=\sigma Z+\mu.\]

\end_inset

Therefore: 
\begin_inset Formula \[
M_{X}(t)=\E\me^{tX}=\E\me^{t(\sigma Z+\mu)}=\E\me^{\sigma tX}\me^{\mu}=\me^{t\mu}M_{Z}(\sigma t),\]

\end_inset

and we know that 
\begin_inset Formula $M_{Z}(t)=\me^{t^{2}/2}$
\end_inset

, thus substituting we get
\begin_inset Formula \[
M_{X}(t)=\me^{t\mu}\me^{(\sigma t)^{2}/2}=\exp\left\{ \mu t+\sigma^{2}t^{2}/2\right\} ,\]

\end_inset

for 
\begin_inset Formula $-\infty<t<\infty$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Note Note
status open

\begin_layout Plain Layout
TODO: put in how to get mean and variance of Normal
\end_layout

\end_inset


\end_layout

\begin_layout Fact
The same argument above shows that if 
\begin_inset Formula $X$
\end_inset

 has MGF 
\begin_inset Formula $M_{X}(t)$
\end_inset

 then the MGF of 
\begin_inset Formula $Y=a+bX$
\end_inset

 is 
\begin_inset Formula \begin{equation}
M_{Y}(t)=\me^{ta}M_{X}(bt).\end{equation}

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
The 68-95-99.7 Rule.
 We saw in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Measures-of-Spread"

\end_inset

 that when an empirical distribution is approximately bell shaped there
 are specific proportions of the observations which fall at varying distances
 from the (sample) mean.
 We can see where these come from -- and obtain more precise proportions
 -- with the following:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

pnorm(1:3)-pnorm(-(1:3))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:iq-model"

\end_inset

Let the random experiment consist of a person taking an IQ test, and let
 
\begin_inset Formula $X$
\end_inset

 be the score on the test.
 The scores on such a test are typically standardized to have a mean of
 100 and a standard deviation of 15.
 What is 
\begin_inset Formula $\P(85\leq X\leq115)$
\end_inset

?
\end_layout

\begin_layout Example
Solution: this one is easy because the limits 85 and 115 fall exactly one
 standard deviation (below and above, respectively) from the mean of 100.
 The answer is therefore approximately 68%.
\end_layout

\begin_layout Subsection
Normal Quantiles and the Quantile Function
\begin_inset CommandInset label
LatexCommand label
name "sub:Normal-Quantiles-QF"

\end_inset


\end_layout

\begin_layout Standard
Until now we have been given two values and our task has been to find the
 area under the PDF between those values.
 In this section, we go in reverse: we are given an area, and we would like
 to find the value(s) that correspond to that area.
 
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:iq-quantile-state-problem"

\end_inset

Assuming the IQ model of Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:iq-model"

\end_inset

, what is the lowest possible IQ score that a person can have and still
 be in the top 1% of all IQ scores?
\end_layout

\begin_layout Example
Solution: If a person is in the top 1%, then that means that 99% of the
 people have lower IQ scores.
 So, in other words, we are looking for a value 
\begin_inset Formula $x$
\end_inset

 such that 
\begin_inset Formula $F(x)=\P(X\leq x)$
\end_inset

 satisfies 
\begin_inset Formula $F(x)=0.99$
\end_inset

, or yet another way to say it is that we would like to solve the equation
 
\begin_inset Formula $F(x)-0.99=0$
\end_inset

.
 For the sake of argument, let us see how to do this the long way.
 We define the function 
\begin_inset Formula $g(x)=F(x)-0.99$
\end_inset

, and then look for the root of 
\begin_inset Formula $g$
\end_inset

 with the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

uniroot
\end_layout

\end_inset

 function.
 It uses numerical procedures to find the root so we need to give it an
 interval of 
\begin_inset Formula $x$
\end_inset

 values in which to search for the root.
 We can get an educated guess from the Empirical Rule 
\begin_inset CommandInset ref
LatexCommand ref
reference "fac:Empirical-Rule"

\end_inset

; the root should be somewhere between two and three standard deviations
 (15 each) above the mean (which is 100).
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

g <- function(x) pnorm(x, mean = 100, sd = 15) - 0.99
\begin_inset Newline newline
\end_inset

uniroot(g, interval = c(130, 145))
\begin_inset Newline newline
\end_inset

@
\begin_inset Newline newline
\end_inset

<<echo = FALSE, results = hide>>=
\begin_inset Newline newline
\end_inset

temp <- round(uniroot(g, interval = c(130, 145))$root, 4)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The answer is shown in 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

$root
\end_layout

\end_inset

 which is approximately 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{temp}
\end_layout

\end_inset

, that is, a person with this IQ score or higher falls in the top 1% of
 all IQ scores.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
The discussion in example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:iq-quantile-state-problem"

\end_inset

 was centered on the search for a value 
\begin_inset Formula $x$
\end_inset

 that solved an equation 
\begin_inset Formula $F(x)=p$
\end_inset

, for some given probability 
\begin_inset Formula $p$
\end_inset

, or in mathematical parlance, the search for 
\begin_inset Formula $F^{-1}$
\end_inset

, the inverse of the CDF of 
\begin_inset Formula $X$
\end_inset

, evaluated at 
\begin_inset Formula $p$
\end_inset

.
 This is so important that it merits a definition all its own.
\end_layout

\begin_layout Definition
The 
\emph on
quantile function
\emph default

\begin_inset Foot
status collapsed

\begin_layout Plain Layout
The precise definition of the quantile function is 
\begin_inset Formula $Q_{X}(p)=\inf\left\{ x:\ F_{X}(x)\geq p\right\} $
\end_inset

, so at least it is well defined (though perhaps infinite) for the values
 
\begin_inset Formula $p=0$
\end_inset

 and 
\begin_inset Formula $p=1$
\end_inset

.
\end_layout

\end_inset

 of a random variable 
\begin_inset Formula $X$
\end_inset

 is the inverse of its cumulative distribution function:
\begin_inset Formula \begin{equation}
Q_{X}(p)=\min\left\{ x:\ F_{X}(x)\geq p\right\} ,\quad0<p<1.\end{equation}

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Remark
Here are some properties of quantile functions:
\end_layout

\begin_deeper
\begin_layout Enumerate
The quantile function is defined and finite for all 
\begin_inset Formula $0<p<1$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $Q_{X}$
\end_inset

 is left-continuous (see Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Differential-and-Integral"

\end_inset

).
 For discrete random variables it is a step function, and for continuous
 random variables it is a continuous function.
\end_layout

\begin_layout Enumerate
In the continuous case the graph of 
\begin_inset Formula $Q_{X}$
\end_inset

 may be obtained by reflecting the graph of 
\begin_inset Formula $F_{X}$
\end_inset

 about the line 
\begin_inset Formula $y=x$
\end_inset

.
 In the discrete case, before reflecting one should: 1) connect the dots
 to get rid of the jumps -- this will make the graph look like a set of
 stairs, 2) erase the horizontal lines so that only vertical lines remain,
 and finally 3) swap the open circles with the solid dots.
 Please see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:binom-plot-distr"

\end_inset

 for a comparison.
 
\end_layout

\begin_layout Enumerate
The two limits 
\begin_inset Formula \[
\lim_{p\to0^{+}}Q_{X}(p)\quad\mbox{and}\quad\lim_{p\to1^{-}}Q_{X}(p)\]

\end_inset

always exist, but may be infinite (that is, sometimes 
\begin_inset Formula $\lim_{p\to0}Q(p)=-\infty$
\end_inset

 and/or 
\begin_inset Formula $\lim_{p\to1}Q(p)=\infty$
\end_inset

).
\end_layout

\end_deeper
\begin_layout Standard
As the reader might expect, the standard normal distribution is a very special
 case and has its own special notation.
\end_layout

\begin_layout Definition
For 
\begin_inset Formula $0<\alpha<1$
\end_inset

, the symbol 
\begin_inset Formula $z_{\alpha}$
\end_inset

 denotes the unique solution of the equation 
\begin_inset Formula $\P(Z>z_{\alpha})=\alpha$
\end_inset

, where 
\begin_inset Formula $Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

.
 It can be calculated in one of two equivalent ways: 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

qnorm(
\end_layout

\end_inset


\begin_inset Formula $1-\alpha$
\end_inset


\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

)
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

qnorm(
\end_layout

\end_inset


\begin_inset Formula $\alpha$
\end_inset


\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

, lower.tail = FALSE)
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
There are a few other very important special cases which we will encounter
 in later chapters.
 
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
Quantile functions are defined for all of the base distributions with the
 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

q
\end_layout

\end_inset

 prefix to the distribution name, except for the ECDF whose quantile function
 is exactly the 
\begin_inset Formula $Q_{x}(p)=$
\end_inset


\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

quantile(x, probs = 
\end_layout

\end_inset


\begin_inset Formula $p$
\end_inset

 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

, type = 1)
\end_layout

\end_inset

 function.
 
\end_layout

\begin_layout Example
Back to Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:iq-quantile-state-problem"

\end_inset

, we are looking for 
\begin_inset Formula $Q_{X}(0.99)$
\end_inset

, where 
\begin_inset Formula $X\sim\mathsf{norm}(\mathtt{mean}=100,\,\mathtt{sd}=15)$
\end_inset

.
 It could not be easier to do with 
\family sans
R
\family default
.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

qnorm(0.99, mean = 100, sd = 15)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Example
Compare this answer to the one obtained earlier with 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

uniroot
\end_layout

\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Find the values 
\begin_inset Formula $z_{0.025}$
\end_inset

, 
\begin_inset Formula $z_{0.01}$
\end_inset

, and 
\begin_inset Formula $z_{0.005}$
\end_inset

 (these will play an important role from Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Estimation"

\end_inset

 onward).
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

qnorm(c(0.025, 0.01, 0.005), lower.tail = FALSE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Note the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lower.tail
\end_layout

\end_inset

 argument.
 We would get the same answer with 
\begin_inset listings
lstparams "showstringspaces=false"
inline false
status open

\begin_layout Plain Layout

qnorm(c(0.975, 0.99, 0.995))
\end_layout

\end_inset


\end_layout

\begin_layout Section
Functions of Continuous Random Variables
\begin_inset CommandInset label
LatexCommand label
name "sec:Functions-of-Continuous"

\end_inset


\end_layout

\begin_layout Standard
The goal of this section is to determine the distribution of 
\begin_inset Formula $U=g(X)$
\end_inset

 based on the distribution of 
\begin_inset Formula $X$
\end_inset

.
 In the discrete case all we needed to do was back substitute for 
\begin_inset Formula $x=g^{-1}(u)$
\end_inset

 in the PMF of 
\begin_inset Formula $X$
\end_inset

 (sometimes accumulating probability mass along the way).
 In the continuous case, however, we need more sophisticated tools.
 Now would be a good time to review Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Differential-and-Integral"

\end_inset

.
\end_layout

\begin_layout Subsection
The PDF Method
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "pro:func-cont-rvs-pdf-formula"

\end_inset

Let 
\begin_inset Formula $X$
\end_inset

 have PDF 
\begin_inset Formula $f_{X}$
\end_inset

 and let 
\begin_inset Formula $g$
\end_inset

 be a function which is one-to-one with a differentiable inverse 
\begin_inset Formula $g^{-1}$
\end_inset

.
 Then the PDF of 
\begin_inset Formula $U=g(X)$
\end_inset

 is given by
\begin_inset Formula \begin{equation}
f_{U}(u)=f_{X}\left[g^{-1}(u)\right]\ \left|\frac{\diff}{\diff u}g^{-1}(u)\right|.\label{eq:univ-trans-pdf-long}\end{equation}

\end_inset


\end_layout

\begin_layout Remark
The formula in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:univ-trans-pdf-long"

\end_inset

 is nice, but does not really make any sense.
 It is better to write in the intuitive form
\begin_inset Formula \begin{equation}
f_{U}(u)=f_{X}(x)\left|\frac{\diff x}{\diff u}\right|.\label{eq:univ-trans-pdf-short}\end{equation}

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:lnorm-transformation"

\end_inset

Let 
\color none

\begin_inset Formula $X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset


\color inherit
, and let 
\begin_inset Formula $Y=\me^{X}$
\end_inset

.
 What is the PDF of 
\begin_inset Formula $Y$
\end_inset

? 
\end_layout

\begin_layout Example
Solution: Notice first that 
\begin_inset Formula $\me^{x}>0$
\end_inset

 for any 
\begin_inset Formula $x$
\end_inset

, so the support of 
\begin_inset Formula $Y$
\end_inset

 is 
\begin_inset Formula $(0,\infty)$
\end_inset

.
 Since the transformation is monotone, we can solve 
\begin_inset Formula $y=\me^{x}$
\end_inset

 for 
\begin_inset Formula $x$
\end_inset

 to get 
\begin_inset Formula $x=\ln\, y$
\end_inset

, giving 
\begin_inset Formula $\diff x/\diff y=1/y$
\end_inset

.
 Therefore, for any 
\begin_inset Formula $y>0$
\end_inset

,
\begin_inset Formula \[
f_{Y}(y)=f_{X}(\ln y)\cdot\left|\frac{1}{y}\right|=\frac{1}{\sigma\sqrt{2\pi}}\exp\left\{ \frac{(\ln y-\mu)^{2}}{2\sigma^{2}}\right\} \cdot\frac{1}{y},\]

\end_inset

where we have dropped the absolute value bars since 
\begin_inset Formula $y>0$
\end_inset

.
 The random variable 
\begin_inset Formula $Y$
\end_inset

 is said to have a 
\emph on
lognormal distribution
\emph default
; see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Other-Continuous-Distributions"

\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:lin-trans-norm"

\end_inset

Suppose 
\begin_inset Formula $X\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

 and let 
\begin_inset Formula $Y=4-3X$
\end_inset

.
 What is the PDF of 
\begin_inset Formula $Y$
\end_inset

?
\end_layout

\begin_layout Standard
The support of 
\begin_inset Formula $X$
\end_inset

 is 
\begin_inset Formula $(-\infty,\infty)$
\end_inset

, and as 
\begin_inset Formula $x$
\end_inset

 goes from 
\begin_inset Formula $-\infty$
\end_inset

 to 
\begin_inset Formula $\infty$
\end_inset

, the quantity 
\begin_inset Formula $y=4-3x$
\end_inset

 also traverses 
\begin_inset Formula $(-\infty,\infty)$
\end_inset

.
 Solving for 
\begin_inset Formula $x$
\end_inset

 in the equation 
\begin_inset Formula $y=4-3x$
\end_inset

 yields 
\begin_inset Formula $x=-(y-4)/3$
\end_inset

 giving 
\begin_inset Formula $\diff x/\diff y=-1/3$
\end_inset

.
 And since
\begin_inset Formula \[
f_{X}(x)=\frac{1}{\sqrt{2\pi}}\me^{-x^{2}/2},\quad-\infty<x<\infty,\]

\end_inset

 we have 
\begin_inset Formula \begin{eqnarray*}
f_{Y}(y) & = & f_{X}\left(\frac{y-4}{3}\right)\cdot\left|-\frac{1}{3}\right|,\quad-\infty<y<\infty,\\
 & = & \frac{1}{3\sqrt{2\pi}}\me^{-(y-4)^{2}/2\cdot3^{2}},\quad-\infty<y<\infty.\end{eqnarray*}

\end_inset

We recognize the PDF of 
\begin_inset Formula $Y$
\end_inset

 to be that of a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=4,\,\mathtt{sd}=3)$
\end_inset

 distribution.
 Indeed, we may use an identical argument as the above to prove the following
 fact:
\end_layout

\begin_layout Fact
\begin_inset CommandInset label
LatexCommand label
name "fac:lin-trans-norm-is-norm"

\end_inset

If 
\begin_inset Formula $X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 and if 
\begin_inset Formula $Y=a+bX$
\end_inset

 for constants 
\begin_inset Formula $a$
\end_inset

 and 
\begin_inset Formula $b$
\end_inset

, with 
\begin_inset Formula $b\neq0$
\end_inset

, then 
\begin_inset Formula $Y\sim\mathsf{norm}(\mathtt{mean}=a+b\mu,\,\mathtt{sd}=|b|\sigma)$
\end_inset

.
 
\end_layout

\begin_layout Standard
Note that it is sometimes easier to 
\emph on
postpone
\emph default
 solving for the inverse transformation 
\begin_inset Formula $x=x(u)$
\end_inset

.
 Instead, leave the transformation in the form 
\begin_inset Formula $u=u(x)$
\end_inset

 and calculate the derivative of the 
\emph on
original
\emph default
 transformation
\begin_inset Formula \begin{equation}
\diff u/\diff x=g'(x).\end{equation}

\end_inset

Once this is known, we can get the PDF of 
\begin_inset Formula $U$
\end_inset

 with
\begin_inset Formula \begin{equation}
f_{U}(u)=f_{X}(x)\left|\frac{1}{\diff u/\diff x}\right|.\end{equation}

\end_inset

In many cases there are cancellations and the work is shorter.
 Of course, it is not always true that
\begin_inset Formula \begin{equation}
\frac{\diff x}{\diff u}=\frac{1}{\diff u/\diff x},\label{eq:univ-jacob-recip}\end{equation}

\end_inset

but for the well-behaved examples in this book the trick works just fine.
\end_layout

\begin_layout Remark
In the case that 
\begin_inset Formula $g$
\end_inset

 is not monotone we cannot apply Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:func-cont-rvs-pdf-formula"

\end_inset

 directly.
 However, hope is not lost.
 Rather, we break the support of 
\begin_inset Formula $X$
\end_inset

 into pieces such that 
\begin_inset Formula $g$
\end_inset

 is monotone on each one.
 We apply Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:func-cont-rvs-pdf-formula"

\end_inset

 on each piece, and finish up by adding the results together.
\end_layout

\begin_layout Subsection
The CDF method
\end_layout

\begin_layout Standard
We know from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:continuous-random-variables"

\end_inset

 that 
\begin_inset Formula $f_{X}=F_{X}'$
\end_inset

 in the continuous case.
 Starting from the equation 
\begin_inset Formula $F_{Y}(y)=\P(Y\leq y)$
\end_inset

, we may substitute 
\begin_inset Formula $g(X)$
\end_inset

 for 
\begin_inset Formula $Y$
\end_inset

, then solve for 
\begin_inset Formula $X$
\end_inset

 to obtain 
\begin_inset Formula $\P[X\leq g^{-1}(y)]$
\end_inset

, which is just another way to write 
\begin_inset Formula $F_{X}[g^{-1}(y)]$
\end_inset

.
 Differentiating this last quantity with respect to 
\begin_inset Formula $y$
\end_inset

 will yield the PDF of 
\begin_inset Formula $Y$
\end_inset

.
\end_layout

\begin_layout Example
Suppose 
\begin_inset Formula $X\sim\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)$
\end_inset

 and suppose that we let 
\begin_inset Formula $Y=-\ln\, X$
\end_inset

.
 What is the PDF of 
\begin_inset Formula $Y$
\end_inset

?
\end_layout

\begin_layout Example
The support set of 
\begin_inset Formula $X$
\end_inset

 is 
\begin_inset Formula $(0,1),$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 traverses 
\begin_inset Formula $(0,\infty)$
\end_inset

 as 
\begin_inset Formula $x$
\end_inset

 ranges from 
\begin_inset Formula $0$
\end_inset

 to 
\begin_inset Formula $1$
\end_inset

, so the support set of 
\begin_inset Formula $Y$
\end_inset

 is 
\begin_inset Formula $S_{Y}=(0,\infty)$
\end_inset

.
 For any 
\begin_inset Formula $y>0$
\end_inset

, we consider
\begin_inset Formula \[
F_{Y}(y)=\P(Y\leq y)=\P(-\ln\, X\leq y)=\P(X\geq\me^{-y})=1-\P(X<\me^{-y}),\]

\end_inset

where the next to last equality follows because the exponential function
 is 
\emph on
monotone
\emph default
 (this point will be revisited later).
 Now since 
\begin_inset Formula $X$
\end_inset

 is continuous the two probabilities 
\begin_inset Formula $\P(X<\me^{-y})$
\end_inset

 and 
\begin_inset Formula $\P(X\leq\me^{-y})$
\end_inset

 are equal; thus
\begin_inset Formula \[
1-\P(X<\me^{-y})=1-\P(X\leq\me^{-y})=1-F_{X}(\me^{-y}).\]

\end_inset

Now recalling that the CDF of a 
\begin_inset Formula $\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)$
\end_inset

 random variable satisfies 
\begin_inset Formula $F(u)=u$
\end_inset

 (see Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:unif-cdf"

\end_inset

), we can say 
\begin_inset Formula \[
F_{Y}(y)=1-F_{X}(\me^{-y})=1-\me^{-y},\quad\mbox{for }y>0.\]

\end_inset

We have consequently found the formula for the CDF of 
\begin_inset Formula $Y$
\end_inset

; to obtain the PDF 
\begin_inset Formula $f_{Y}$
\end_inset

 we need only differentiate 
\begin_inset Formula $F_{Y}$
\end_inset

:
\begin_inset Formula \[
f_{Y}(y)=\frac{\diff}{\diff y}\left(1-\me^{-y}\right)=0-\me^{-y}(-1),\]

\end_inset

or 
\begin_inset Formula $f_{Y}(y)=\me^{-y}$
\end_inset

 for 
\begin_inset Formula $y>0$
\end_inset

.
 This turns out to be a member of the exponential family of distributions,
 see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Other-Continuous-Distributions"

\end_inset

.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example

\series bold
\emph on
The Probability Integral Transform
\series default
\emph default
.
 Given a continuous random variable 
\begin_inset Formula $X$
\end_inset

 with strictly increasing CDF 
\begin_inset Formula $F_{X}$
\end_inset

, let the random variable 
\begin_inset Formula $Y$
\end_inset

 be defined by 
\begin_inset Formula $Y=F_{X}(X)$
\end_inset

.
 Then the distribution of 
\begin_inset Formula $Y$
\end_inset

 is 
\begin_inset Formula $\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)$
\end_inset

.
 
\end_layout

\begin_layout Proof
We employ the CDF method.
 First note that the support of 
\begin_inset Formula $Y$
\end_inset

 is 
\begin_inset Formula $(0,1)$
\end_inset

.
 Then for any 
\begin_inset Formula $0<y<1$
\end_inset

,
\begin_inset Formula \[
F_{Y}(y)=\P(Y\leq y)=\P(F_{X}(X)\leq y).\]

\end_inset

Now since 
\begin_inset Formula $F_{X}$
\end_inset

 is strictly increasing, it has a well defined inverse function 
\begin_inset Formula $F_{X}^{-1}$
\end_inset

.
 Therefore,
\begin_inset Formula \[
\P(F_{X}(X)\leq y)=\P(X\leq F_{X}^{-1}(y))=F_{X}[F_{X}^{-1}(y)]=y.\]

\end_inset

Summarizing, we have seen that 
\begin_inset Formula $F_{Y}(y)=y$
\end_inset

, 
\begin_inset Formula $0<y<1$
\end_inset

.
 But this is exactly the CDF of a 
\begin_inset Formula $\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=1)$
\end_inset

 random variable.
 
\end_layout

\begin_layout Fact
The Probability Integral Transform is true for all continuous random variables
 with continuous CDFs, not just for those with strictly increasing CDFs
 (but the proof is more complicated).
 The transform is 
\series bold
not
\series default
 true for discrete random variables, or for continuous random variables
 having a discrete component (that is, with jumps in their CDF).
 
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:distn-of-z-squared"

\end_inset

Let 
\begin_inset Formula $Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

 and let 
\begin_inset Formula $U=Z^{2}$
\end_inset

.
 What is the PDF of 
\begin_inset Formula $U$
\end_inset

? 
\end_layout

\begin_layout Example
Notice first that 
\begin_inset Formula $Z^{2}\geq0$
\end_inset

, and thus the support of 
\begin_inset Formula $U$
\end_inset

 is 
\begin_inset Formula $[0,\infty)$
\end_inset

.
 And for any 
\begin_inset Formula $u\geq0$
\end_inset

, 
\begin_inset Formula \[
F_{U}(u)=\P(U\leq u)=\P(Z^{2}\leq u).\]

\end_inset

But 
\begin_inset Formula $Z^{2}\leq u$
\end_inset

 occurs if and only if 
\begin_inset Formula $-\sqrt{u}\leq Z\leq\sqrt{u}$
\end_inset

.
 The last probability above is simply the area under the standard normal
 PDF from 
\begin_inset Formula $-\sqrt{u}$
\end_inset

 to 
\begin_inset Formula $\sqrt{u}$
\end_inset

, and since 
\begin_inset Formula $\phi$
\end_inset

 is symmetric about 0, we have
\begin_inset Formula \[
\P(Z^{2}\leq u)=2\P(0\leq Z\leq\sqrt{u})=2\left[F_{Z}(\sqrt{u})-F_{Z}(0)\right]=2\Phi(\sqrt{u})-1,\]

\end_inset

because 
\begin_inset Formula $\Phi(0)=1/2$
\end_inset

.
 To find the PDF of 
\begin_inset Formula $U$
\end_inset

 we differentiate the CDF recalling that 
\begin_inset Formula $\Phi'=\phi$
\end_inset

.
\begin_inset Formula \[
f_{U}(u)=\left(2\Phi(\sqrt{u})-1\right)'=2\phi(\sqrt{u})\cdot\frac{1}{2\sqrt{u}}=u^{-1/2}\phi(\sqrt{u}).\]

\end_inset

Substituting,
\begin_inset Formula \[
f_{U}(u)=u^{-1/2}\frac{1}{\sqrt{2\pi}}\,\me^{-(\sqrt{u})^{2}/2}=(2\pi u)^{-1/2}\me^{-u},\quad u>0.\]

\end_inset

This is what we will later call a 
\emph on
chi-square distribution with 1 degree of freedom
\emph default
.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Other-Continuous-Distributions"

\end_inset

.
 
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

distr
\end_layout

\end_inset

 package has functionality to investigate transformations of univariate
 distributions.
 There are exact results for ordinary transformations of the standard distributi
ons, and 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

distr
\end_layout

\end_inset

 takes advantage of these in many cases.
 
\color inherit
For instance, the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

distr
\end_layout

\end_inset

 package can handle the transformation in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:lin-trans-norm"

\end_inset

 quite nicely:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(distr)
\begin_inset Newline newline
\end_inset

X <- Norm(mean = 0, sd = 1)
\begin_inset Newline newline
\end_inset

Y <- 4 - 3*X
\begin_inset Newline newline
\end_inset

Y
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
So 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

distr
\end_layout

\end_inset

 
\begin_inset Quotes eld
\end_inset

knows
\begin_inset Quotes erd
\end_inset

 that a linear transformation of a normal random variable is again normal,
 and it even knows what the correct 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

mean
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

sd
\end_layout

\end_inset

 should be.
 But it is impossible for 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

distr
\end_layout

\end_inset

 to know everything, and it is not long before we venture outside of the
 transformations that 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

distr
\end_layout

\end_inset

 recognizes.
 Let us try Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:lnorm-transformation"

\end_inset

:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

Y <- exp(X)
\begin_inset Newline newline
\end_inset

Y
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard

\color none
The result is an object of class 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

AbscontDistribution
\end_layout

\end_inset

, which is one of the classes that 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

distr
\end_layout

\end_inset

 uses to denote general distributions that it does not recognize (it turns
 out that 
\begin_inset Formula $Z$
\end_inset

 has a 
\emph on
\color inherit
lognormal
\emph default
\color none
 distribution; see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Other-Continuous-Distributions"

\end_inset

).
 A simplified description of the process that 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

distr
\end_layout

\end_inset

 undergoes when it encounters a transformation 
\begin_inset Formula $Y=g(X)$
\end_inset

 that it does not recognize is
\end_layout

\begin_layout Enumerate
Randomly generate many, many copies 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 from the distribution of 
\begin_inset Formula $X$
\end_inset

,
\end_layout

\begin_layout Enumerate
Compute 
\begin_inset Formula $Y_{1}=g(X_{1})$
\end_inset

, 
\begin_inset Formula $Y_{2}=g(X_{2})$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $Y_{n}=g(X_{n})$
\end_inset

 and store them for use.
\end_layout

\begin_layout Enumerate
Calculate the PDF, CDF, quantiles, and random variates using the simulated
 values of 
\begin_inset Formula $Y$
\end_inset

.
\end_layout

\begin_layout Standard

\color none
As long as the transformation is sufficiently nice, such as a linear transformat
ion, the exponential, absolute value, 
\emph on
\color inherit
etc.
\emph default
\color none
, the d-p-q functions are calculated analytically based on the d-p-q functions
 associated with 
\begin_inset Formula $X$
\end_inset

.
 But if we try a crazy transformation then we are greeted by a warning:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

W <- sin(exp(X) + 27)
\begin_inset Newline newline
\end_inset

W
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The warning confirms that the d-p-q functions are not calculated analytically,
 but are instead based on the randomly simulated values of 
\begin_inset Formula $Y$
\end_inset

.
 
\emph on
We must be careful to remember this.

\emph default
 The nature of random simulation means that we can get different answers
 to the same question: watch what happens when we compute 
\begin_inset Formula $\P(W\leq0.5)$
\end_inset

 using the 
\begin_inset Formula $W$
\end_inset

 above, then define 
\begin_inset Formula $W$
\end_inset

 again, and compute the (supposedly) same 
\begin_inset Formula $\P(W\leq0.5)$
\end_inset

 a few moments later.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

p(W)(0.5)
\begin_inset Newline newline
\end_inset

W <- sin(exp(X) + 27)
\begin_inset Newline newline
\end_inset

p(W)(0.5)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The answers are not the same! Furthermore, if we were to repeat the process
 we would get yet another answer for 
\begin_inset Formula $\P(W\leq0.5)$
\end_inset

.
 
\end_layout

\begin_layout Standard
The answers were close, though.
 And the underlying randomly generated 
\begin_inset Formula $X$
\end_inset

's were not the same so it should hardly be a surprise that the calculated
 
\begin_inset Formula $W$
\end_inset

's were not the same, either.
 This serves as a warning (in concert with the one that 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

distr
\end_layout

\end_inset


\color inherit
 provides) that we should be careful to remember that complicated transformation
s computed by 
\family sans
R
\family default
 are only approximate and may fluctuate slightly due to the nature of the
 way the estimates are calculated.
\end_layout

\begin_layout Section
Other Continuous Distributions
\begin_inset CommandInset label
LatexCommand label
name "sec:Other-Continuous-Distributions"

\end_inset


\end_layout

\begin_layout Subsection
Waiting Time Distributions
\begin_inset CommandInset label
LatexCommand label
name "sub:Waiting-Time-Distributions"

\end_inset


\end_layout

\begin_layout Standard
In some experiments, the random variable being measured is the time until
 a certain event occurs.
 For example, a quality control specialist may be testing a manufactured
 product to see how long it takes until it fails.
 An efficiency expert may be recording the customer traffic at a retail
 store to streamline scheduling of staff.
 
\end_layout

\begin_layout Subsection*
The Exponential Distribution
\begin_inset CommandInset label
LatexCommand label
name "sub:The-Exponential-Distribution"

\end_inset


\end_layout

\begin_layout Standard
We say that 
\begin_inset Formula $X$
\end_inset

 has an 
\emph on
exponential distribution
\emph default
 and write 
\begin_inset Formula $X\sim\mathsf{exp}(\mathtt{rate}=\lambda)$
\end_inset

.

\color none
 
\end_layout

\begin_layout Standard

\color none
\begin_inset Formula \begin{equation}
f_{X}(x)=\lambda\me^{-\lambda x},\quad x>0\end{equation}

\end_inset


\color inherit
The associated 
\family sans
R
\family default
 functions are 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

dexp(x, rate = 1)
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

pexp
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

qexp
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

rexp
\end_layout

\end_inset

, which give the PDF, CDF, quantile function, and simulate random variates,
 respectively.
\end_layout

\begin_layout Standard

\color none
The parameter 
\begin_inset Formula $\lambda$
\end_inset

 measures the rate of arrivals (to be described later) and must be positive.

\color inherit
 The CDF is given by the formula
\begin_inset Formula \begin{equation}
F_{X}(t)=1-\me^{-\lambda t},\quad t>0.\end{equation}

\end_inset

The mean is 
\begin_inset Formula $\mu=1/\lambda$
\end_inset

 and the variance is 
\begin_inset Formula $\sigma^{2}=1/\lambda^{2}$
\end_inset

.
 
\end_layout

\begin_layout Standard
The exponential distribution is closely related to the Poisson distribution.
 If customers arrive at a store according to a Poisson process with rate
 
\begin_inset Formula $\lambda$
\end_inset

 and if 
\begin_inset Formula $Y$
\end_inset

 counts the number of customers that arrive in the time interval 
\begin_inset Formula $[0,t)$
\end_inset

, then we saw in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:other-discrete-distributions"

\end_inset

 that 
\begin_inset Formula $Y\sim\mathsf{pois}(\mathtt{lambda}=\lambda t).$
\end_inset

 Now consider a different question: let us start our clock at time 0 and
 stop the clock when the first customer arrives.
 Let 
\begin_inset Formula $X$
\end_inset

 be the length of this random time interval.
 Then 
\begin_inset Formula $X\sim\mathsf{exp}(\mathtt{rate}=\lambda)$
\end_inset

.
 Observe the following string of equalities:
\begin_inset Formula \begin{align*}
\P(X>t) & =\P(\mbox{first arrival after time \emph{t}}),\\
 & =\P(\mbox{no events in [0,\emph{t})}),\\
 & =\P(Y=0),\\
 & =\me^{-\lambda t},\end{align*}

\end_inset

where the last line is the PMF of 
\begin_inset Formula $Y$
\end_inset

 evaluated at 
\begin_inset Formula $y=0$
\end_inset

.
 In other words, 
\begin_inset Formula $\P(X\leq t)=1-\me^{-\lambda t}$
\end_inset

, which is exactly the CDF of an 
\begin_inset Formula $\mathsf{exp}(\mathtt{rate}=\lambda)$
\end_inset

 distribution.
\end_layout

\begin_layout Standard
The exponential distribution is said to be 
\emph on
memoryless
\emph default
 because exponential random variables "forget" how old they are at every
 instant.
 That is, the probability that we must wait an additional five hours for
 a customer to arrive, given that we have already waited seven hours, is
 exactly the probability that we needed to wait five hours for a customer
 in the first place.
 In mathematical symbols, for any 
\begin_inset Formula $s,\, t>0$
\end_inset

,
\begin_inset Formula \begin{equation}
\P(X>s+t\,|\, X>t)=\P(X>s).\end{equation}

\end_inset

See Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:prove-the-memoryless"

\end_inset

.
\end_layout

\begin_layout Subsection*
The Gamma Distribution
\begin_inset CommandInset label
LatexCommand label
name "sub:The-Gamma-Distribution"

\end_inset


\end_layout

\begin_layout Standard
This is a generalization of the exponential distribution.
 We say that 
\begin_inset Formula $X$
\end_inset

 has a gamma distribution and write 
\begin_inset Formula $X\sim\mathsf{gamma}(\mathtt{shape}=\alpha,\,\mathtt{rate}=\lambda)$
\end_inset

.
 It has PDF
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{\lambda^{\alpha}}{\Gamma(\alpha)}\: x^{\alpha-1}\me^{-\lambda x},\quad x>0.\end{equation}

\end_inset

The associated 
\family sans
R
\family default
 functions are 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

dgamma(x, shape, rate = 1)
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

pgamma
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

qgamma
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

rgamma
\end_layout

\end_inset

, which give the PDF, CDF, quantile function, and simulate random variates,
 respectively.

\color none
 
\color inherit
If 
\begin_inset Formula $\alpha=1$
\end_inset

 then 
\begin_inset Formula $X\sim\mathsf{exp}(\mathtt{rate}=\lambda)$
\end_inset

.
 The mean is 
\begin_inset Formula $\mu=\alpha/\lambda$
\end_inset

 and the variance is 
\begin_inset Formula $\sigma^{2}=\alpha/\lambda^{2}$
\end_inset

.
\end_layout

\begin_layout Standard
To motivate the gamma distribution recall that if 
\begin_inset Formula $X$
\end_inset

 measures the length of time until the first event occurs in a Poisson process
 with rate 
\begin_inset Formula $\lambda$
\end_inset

 then 
\begin_inset Formula $X\sim\mathsf{exp}(\mathtt{rate}=\lambda)$
\end_inset

.
 If we let 
\begin_inset Formula $Y$
\end_inset

 measure the length of time until the 
\begin_inset Formula $\alpha^{\text{th}}$
\end_inset

 event occurs then 
\begin_inset Formula $Y\sim\mathsf{gamma}(\mathtt{shape}=\alpha,\,\mathtt{rate}=\lambda)$
\end_inset

.
 When 
\begin_inset Formula $\alpha$
\end_inset

 is an integer this distribution is also known as the 
\emph on
Erlang
\emph default
 distribution.
\end_layout

\begin_layout Example
At a car wash, two customers arrive per hour on the average.
 We decide to measure how long it takes until the third customer arrives.
 If 
\begin_inset Formula $Y$
\end_inset

 denotes this random time then 
\begin_inset Formula $Y\sim\mathsf{gamma}(\mathtt{shape}=3,\,\mathtt{rate}=1/2)$
\end_inset

.
\end_layout

\begin_layout Subsection
The Chi square, Student's 
\begin_inset Formula $t$
\end_inset

, and Snedecor's 
\begin_inset Formula $F$
\end_inset

 Distributions
\begin_inset CommandInset label
LatexCommand label
name "sub:The-Chi-Square-t-F"

\end_inset


\end_layout

\begin_layout Subsection*
The Chi square Distribution
\begin_inset CommandInset label
LatexCommand label
name "sub:The-Chi-Square"

\end_inset


\end_layout

\begin_layout Standard
A random variable 
\begin_inset Formula $X$
\end_inset

 with PDF
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{1}{\Gamma(p/2)2^{p/2}}x^{p/2-1}\me^{-x/2},\quad x>0,\end{equation}

\end_inset

is said to have a 
\emph on
chi-square distribution
\emph default
 with 
\begin_inset Formula $p$
\end_inset

 
\emph on
degrees of freedom
\emph default
.
 We write 
\begin_inset Formula $X\sim\mathsf{chisq}(\mathtt{df}=p)$
\end_inset

.
 The associated 
\family sans
R
\family default
 functions are 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

dchisq(x, df)
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

pchisq
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

qchisq
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

rchisq
\end_layout

\end_inset

, which give the PDF, CDF, quantile function, and simulate random variates,
 respectively.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:chisq-dist-vary-df"

\end_inset

.
 In an obvious notation we may define 
\begin_inset Formula $\chi_{\alpha}^{2}(p)$
\end_inset

 as the number on the 
\begin_inset Formula $x$
\end_inset

-axis such that there is exactly 
\begin_inset Formula $\alpha$
\end_inset

 area under the 
\begin_inset Formula $\mathsf{chisq}(\mathtt{df}=p)$
\end_inset

 curve to its right.
\end_layout

\begin_layout Standard
The code to produce Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:chisq-dist-vary-df"

\end_inset

 is
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

curve(dchisq(x, df = 3), from = 0, to = 20, ylab = "y")
\begin_inset Newline newline
\end_inset

ind <- c(4, 5, 10, 15)
\begin_inset Newline newline
\end_inset

for (i in ind) curve(dchisq(x, df = i), 0, 20, add = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

curve(dchisq(x, df = 3), from = 0, to = 20, ylab = "y")
\begin_inset Newline newline
\end_inset

ind <- c(4, 5, 10, 15)
\begin_inset Newline newline
\end_inset

for (i in ind) curve(dchisq(x, df = i), 0, 20, add = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Chi square distribution for various degrees of freedom
\begin_inset CommandInset label
LatexCommand label
name "fig:chisq-dist-vary-df"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Remark
Here are some useful things to know about the chi-square distribution.
\end_layout

\begin_deeper
\begin_layout Enumerate
If 
\begin_inset Formula $Z\sim\mathtt{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

, then 
\begin_inset Formula $Z^{2}\sim\mathsf{chisq}(\mathtt{df}=1)$
\end_inset

.
 We saw this in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:distn-of-z-squared"

\end_inset

, and the fact is important when it comes time to find the distribution
 of the sample variance, 
\begin_inset Formula $S^{2}$
\end_inset

.
 See Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Xbar-andS"

\end_inset

 in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Samp-Var-Dist"

\end_inset

.
\end_layout

\begin_layout Enumerate
The chi-square distribution is supported on the positive 
\begin_inset Formula $x$
\end_inset

-axis, with a right-skewed distribution.
\end_layout

\begin_layout Enumerate
The 
\begin_inset Formula $\mathsf{chisq}(\mathtt{df}=p)$
\end_inset

 distribution is the same as a 
\begin_inset Formula $\mathsf{gamma}(\mathtt{shape}=p/2,\,\mathtt{rate}=1/2)$
\end_inset

 distribution.
\end_layout

\begin_layout Enumerate
The MGF of 
\begin_inset Formula $X\sim\mathsf{chisq}(\mathtt{df}=p)$
\end_inset

 is
\begin_inset Formula \begin{equation}
M_{X}(t)=\left(1-2t\right)^{-p},\quad t<1/2.\label{eq:mgf-chisq}\end{equation}

\end_inset


\end_layout

\end_deeper
\begin_layout Subsection*
Student's 
\begin_inset Formula $t$
\end_inset

 distribution
\begin_inset CommandInset label
LatexCommand label
name "sub:Student's-t-distribution"

\end_inset


\end_layout

\begin_layout Standard
A random variable 
\begin_inset Formula $X$
\end_inset

 with PDF
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{\Gamma\left[(r+1)/2\right]}{\sqrt{r\pi}\,\Gamma(r/2)}\left(1+\frac{x^{2}}{r}\right)^{-(r+1)/2},\quad-\infty<x<\infty\end{equation}

\end_inset

is said to have 
\emph on
Student's
\emph default
 
\begin_inset Formula $t$
\end_inset

 distribution with 
\begin_inset Formula $r$
\end_inset

 
\emph on
degrees of freedom
\emph default
, and we write 
\begin_inset Formula $X\sim\mathsf{t}(\mathtt{df}=r)$
\end_inset

.
 The associated 
\family sans
R
\family default
 functions are 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

dt
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

pt
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

qt
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

rt
\end_layout

\end_inset

, which give the PDF, CDF, quantile function, and simulate random variates,
 respectively.

\color none
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:sampling-from-normal-dist"

\end_inset

.
\end_layout

\begin_layout Subsection*
Snedecor's 
\begin_inset Formula $F$
\end_inset

 distribution
\begin_inset CommandInset label
LatexCommand label
name "sub:snedecor-F-distribution"

\end_inset


\end_layout

\begin_layout Standard
A random variable 
\begin_inset Formula $X$
\end_inset

 with p.d.f.
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{\Gamma[(m+n)/2]}{\Gamma(m/2)\Gamma(n/2)}\left(\frac{m}{n}\right)^{m/2}x^{m/2-1}\left(1+\frac{m}{n}x\right)^{-(m+n)/2},\quad x>0.\end{equation}

\end_inset

is said to have an 
\begin_inset Formula $F$
\end_inset

 distribution with 
\begin_inset Formula $(m,n)$
\end_inset

 degrees of freedom.
 We write 
\begin_inset Formula $X\sim\mathsf{f}(\mathtt{df1}=m,\,\mathtt{df2}=n)$
\end_inset

.
 The associated 
\family sans
R
\family default
 functions are 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

df(x, df1, df2)
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

pf
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

qf
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

rf
\end_layout

\end_inset

, which give the PDF, CDF, quantile function, and simulate random variates,
 respectively.

\color none
 
\color inherit
We define 
\color none

\begin_inset Formula $F_{\alpha}(m,n)$
\end_inset


\color inherit
 as the number on the 
\begin_inset Formula $x$
\end_inset

-axis such that there is exactly 
\begin_inset Formula $\alpha$
\end_inset

 area under the 
\begin_inset Formula $\mathsf{f}(\mathtt{df1}=m,\,\mathtt{df2}=n)$
\end_inset

 curve to its right.

\color none
 
\end_layout

\begin_layout Remark
Here are some notes about the 
\begin_inset Formula $F$
\end_inset

 distribution.
\end_layout

\begin_deeper
\begin_layout Enumerate
If 
\begin_inset Formula $X\sim\mathsf{f}(\mathtt{df1}=m,\,\mathtt{df2}=n)$
\end_inset

 and 
\begin_inset Formula $Y=1/X$
\end_inset

, then 
\begin_inset Formula $Y\sim\mathsf{f}(\mathtt{df1}=n,\,\mathtt{df2}=m)$
\end_inset

.
 Historically, this fact was especially convenient.
 In the old days, statisticians used printed tables for their statistical
 calculations.
 Since the 
\begin_inset Formula $F$
\end_inset

 tables were symmetric in 
\begin_inset Formula $m$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

, it meant that publishers could cut the size of their printed tables in
 half.
 It plays less of a role today now that personal computers are widespread.
\end_layout

\begin_layout Enumerate
If 
\begin_inset Formula $X\sim\mathsf{t}(\mathtt{df}=r)$
\end_inset

, then 
\begin_inset Formula $X^{2}\sim\mathsf{f}(\mathtt{df1}=1,\,\mathtt{df2}=r)$
\end_inset

.
 We will see this again in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:slr-overall-F-statistic"

\end_inset

.
\end_layout

\end_deeper
\begin_layout Subsection
Other Popular Distributions
\begin_inset CommandInset label
LatexCommand label
name "sub:Other-Popular-Distributions"

\end_inset


\end_layout

\begin_layout Subsubsection*
The Cauchy Distribution
\begin_inset CommandInset label
LatexCommand label
name "sub:The-Cauchy-Distribution"

\end_inset


\end_layout

\begin_layout Standard
This is a special case of the Student's 
\begin_inset Formula $t$
\end_inset

 distribution.
 It has PDF
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{1}{\beta\pi}\left[1+\left(\frac{x-m}{\beta}\right)^{2}\right]^{-1},\quad-\infty<x<\infty\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We write 
\begin_inset Formula $X\sim\mathsf{cauchy}(\mathtt{location}=m,\,\mathtt{scale}=\beta)$
\end_inset

.
 The associated 
\family sans
R
\family default
 function is 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

dcauchy(x, location = 0, scale = 1)
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
It is easy to see that a 
\begin_inset Formula $\mathsf{cauchy}(\mathtt{location}=0,\,\mathtt{scale}=1)$
\end_inset

 distribution is the same as a 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=1)$
\end_inset

 distribution.
 The 
\begin_inset Formula $\mathsf{cauchy}$
\end_inset

 distribution looks like a 
\begin_inset Formula $\mathsf{norm}$
\end_inset

 distribution but with very heavy tails.
 The mean (and variance) do not exist, that is, they are infinite.
 The median is represented by the 
\begin_inset Formula $\mathtt{location}$
\end_inset

 parameter, and the 
\begin_inset Formula $\mathtt{scale}$
\end_inset

 parameter influences the spread of the distribution about its median.
\end_layout

\begin_layout Subsubsection*
The Beta Distribution
\begin_inset CommandInset label
LatexCommand label
name "sub:The-Beta-Distribution"

\end_inset


\end_layout

\begin_layout Standard
This is a generalization of the continuous uniform distribution.
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{\Gamma(\alpha+\beta)}{\Gamma(\alpha)\Gamma(\beta)}\: x^{\alpha-1}(1-x)^{\beta-1},\quad0<x<1\end{equation}

\end_inset

We write 
\begin_inset Formula $X\sim\mathsf{beta}(\mathtt{shape1}=\alpha,\,\mathtt{shape2}=\beta)$
\end_inset

.
 The associated 
\family sans
R
\family default
 function is 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

dbeta(x, shape1, shape2)
\end_layout

\end_inset

.
 The mean and variance are
\begin_inset Formula \begin{equation}
\mu=\frac{\alpha}{\alpha+\beta}\mbox{ and }\sigma^{2}=\frac{\alpha\beta}{\left(\alpha+\beta\right)^{2}\left(\alpha+\beta+1\right)}.\end{equation}

\end_inset

See Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:cont-pdf3x2"

\end_inset

.
 This distribution comes up a lot in Bayesian statistics because it is a
 good model for one's prior beliefs about a population proportion 
\begin_inset Formula $p$
\end_inset

, 
\begin_inset Formula $0\leq p\leq1$
\end_inset

.
\end_layout

\begin_layout Subsubsection*
The Logistic Distribution
\begin_inset CommandInset label
LatexCommand label
name "sub:The-Logistic-Distribution"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{1}{\sigma}\exp\left(-\frac{x-\mu}{\sigma}\right)\left[1+\exp\left(-\frac{x-\mu}{\sigma}\right)\right]^{-2},\quad-\infty<x<\infty.\end{equation}

\end_inset

We write 
\begin_inset Formula $X\sim\mathsf{logis}(\mathtt{location}=\mu,\,\mathtt{scale}=\sigma)$
\end_inset

.
 The associated 
\family sans
R
\family default
 function is 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

dlogis(x, location = 0, scale = 1)
\end_layout

\end_inset

.
 The logistic distribution comes up in differential equations as a model
 for population growth under certain assumptions.
 The mean is 
\begin_inset Formula $\mu$
\end_inset

 and the variance is 
\begin_inset Formula $\pi^{2}\sigma^{2}/3$
\end_inset

.
\end_layout

\begin_layout Subsubsection*
The Lognormal Distribution
\begin_inset CommandInset label
LatexCommand label
name "sub:The-Lognormal-Distribution"

\end_inset


\end_layout

\begin_layout Standard
This is a distribution derived from the normal distribution (hence the name).
 If 
\begin_inset Formula $U\sim\mathtt{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

, then 
\begin_inset Formula $X=\me^{U}$
\end_inset

has PDF
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{1}{\sigma x\sqrt{2\pi}}\exp\left[\frac{-(\ln x-\mu)^{2}}{2\sigma^{2}}\right],\quad0<x<\infty.\end{equation}

\end_inset

We write 
\begin_inset Formula $X\sim\mathsf{lnorm}(\mathtt{meanlog}=\mu,\,\mathtt{sdlog}=\sigma)$
\end_inset

.
 The associated 
\family sans
R
\family default
 function is 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

dlnorm(x, meanlog = 0, sdlog = 1)
\end_layout

\end_inset

.
 Notice that the support is concentrated on the positive 
\begin_inset Formula $x$
\end_inset

 axis; the distribution is right-skewed with a heavy tail.
 See Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:lnorm-transformation"

\end_inset

.
\end_layout

\begin_layout Subsubsection*
The Weibull Distribution
\begin_inset CommandInset label
LatexCommand label
name "sub:The-Weibull-Distribution"

\end_inset


\end_layout

\begin_layout Standard
This has PDF
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{\alpha}{\beta}\left(\frac{x}{\beta}\right)^{\alpha-1}\exp\left(\frac{x}{\beta}\right)^{\alpha},\quad x>0.\end{equation}

\end_inset

We write 
\begin_inset Formula $X\sim\mathsf{weibull}(\mathtt{shape}=\alpha,\,\mathtt{scale}=\beta)$
\end_inset

.
 The associated 
\family sans
R
\family default
 function is 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=4"
inline true
status open

\begin_layout Plain Layout

dweibull(x, shape, scale = 1)
\end_layout

\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
There is some support of moments and moment generating functions for some
 continuous probability distributions included in the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

actuar
\end_layout

\end_inset


\color inherit
 package 
\begin_inset CommandInset citation
LatexCommand cite
key "Dutangactuar"

\end_inset

.
 The convention is 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

m
\end_layout

\end_inset


\color inherit
 in front of the distribution name for raw moments, and 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

mgf
\end_layout

\end_inset


\color inherit
 in front of the distribution name for the moment generating function.
 At the time of this writing, the following distributions are supported:
 gamma, inverse Gaussian, (non-central) chi-squared, exponential, and uniform.
\end_layout

\begin_layout Example
Calculate the first four raw moments for 
\begin_inset Formula $X\sim\mathsf{gamma}(\mathtt{shape}=13,\,\mathtt{rate}=1)$
\end_inset

 and plot the moment generating function.
\end_layout

\begin_layout Example
We load the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

actuar
\end_layout

\end_inset


\color inherit
 package and use the functions 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

mgamma
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

mgfgamma
\end_layout

\end_inset

:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(actuar)
\begin_inset Newline newline
\end_inset

mgamma(1:4, shape = 13, rate = 1)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
For the plot we can use the function in the following form:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

plot(function(x){mgfgamma(x, shape = 13, rate = 1)}, from=-0.1, to=0.1, ylab
 = "gamma mgf")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

plot(function(x){mgfgamma(x, shape = 13, rate = 1)}, from=-0.1, to=0.1, ylab
 = "gamma mgf")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Plot of the 
\family sans
gamma
\family default
(
\family typewriter
shape
\family default
 = 13, 
\family typewriter
rate
\family default
 = 1) MGF 
\begin_inset CommandInset label
LatexCommand label
name "fig:gamma-mgf"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Chapter Exercises
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{section}{Chapter Exercises}
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{thm}{0}
\end_layout

\end_inset


\end_layout

\begin_layout Scrap

\end_layout

\begin_layout Exercise
Find the constant 
\begin_inset Formula $c$
\end_inset

 so that the given function is a valid PDF of a random variable 
\begin_inset Formula $X$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $f(x)=Cx^{n},\quad0<x<1$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $f(x)=Cx\me^{-x},\quad0<x<\infty$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $f(x)=\me^{-(x-C)},\quad7<x<\infty.$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $f(x)=Cx^{3}(1-x)^{2},\quad0<x<1.$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula ${\displaystyle f(x)=C(1+x^{2}/4)^{-1}},\quad-\infty<x<\infty.$
\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Scrap
<<echo = FALSE, results = hide>>=
\begin_inset Newline newline
\end_inset

rnorm(1)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Exercise
For the following random experiments, decide what the distribution of 
\begin_inset Formula $X$
\end_inset

 should be.
 In nearly every case, there are additional assumptions that should be made
 for the distribution to apply; identify those assumptions (which may or
 may not strictly hold in practice).
\end_layout

\begin_deeper
\begin_layout Enumerate
We throw a dart at a dart board.
 Let 
\begin_inset Formula $X$
\end_inset

 denote the squared linear distance from the bulls-eye to the where the
 dart landed.
\end_layout

\begin_layout Enumerate
We randomly choose a textbook from the shelf at the bookstore and let 
\begin_inset Formula $P$
\end_inset

 denote the proportion of the total pages of the book devoted to exercises.
 
\end_layout

\begin_layout Enumerate
We measure the time it takes for the water to completely drain out of the
 kitchen sink.
\end_layout

\begin_layout Enumerate
We randomly sample strangers at the grocery store and ask them how long
 it will take them to drive home.
 
\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Exercise
If 
\begin_inset Formula $Z$
\end_inset

 is 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

, find 
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\P(Z>2.64)$
\end_inset


\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

pnorm(2.64, lower.tail = FALSE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset Formula $\P(0\leq Z<0.87)$
\end_inset


\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

pnorm(0.87) - 1/2
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Enumerate
\begin_inset Formula $\P(|Z|>1.39)$
\end_inset

 (Hint: draw a picture!)
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

2 * pnorm(-1.39)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Exercise
\begin_inset CommandInset label
LatexCommand label
name "xca:variance-dunif"

\end_inset

Calculate the variance of 
\color none

\begin_inset Formula $X\sim\mathsf{unif}(\mathtt{min}=a,\,\mathtt{max}=b)$
\end_inset


\color inherit
.
 Hint: First calculate 
\begin_inset Formula $\E X^{2}$
\end_inset

.
\end_layout

\begin_layout Exercise
type the exercise here
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Exercise
\begin_inset CommandInset label
LatexCommand label
name "xca:prove-the-memoryless"

\end_inset

Prove the memoryless property for exponential random variables.
 That is, for 
\begin_inset Formula $X\sim\mathsf{exp}(\mathtt{rate}=\lambda)$
\end_inset

 show that for any 
\begin_inset Formula $s,t>0$
\end_inset

,
\begin_inset Formula \[
\P(X>s+t\,|\, X>t)=\P(X>s).\]

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Scrap

\end_layout

\begin_layout Chapter
Multivariate Distributions
\begin_inset CommandInset label
LatexCommand label
name "cha:Multivariable-Distributions"

\end_inset


\end_layout

\begin_layout Standard
\noindent
We have built up quite a catalogue of distributions, discrete and continuous.
 They were all univariate, however, meaning that we only considered one
 random variable at a time.
 We can imagine nevertheless many random variables associated with a single
 person: their height, their weight, their wrist circumference (all continuous),
 or their eye/hair color, shoe size, whether they are right handed, left
 handed, or ambidextrous (all categorical), and we can even surmise reasonable
 probability distributions to associate with each of these variables.
 
\end_layout

\begin_layout Standard
But there is a difference: for a single person, these variables are related.
 For instance, a person's height betrays a lot of information about that
 person's weight.
\end_layout

\begin_layout Standard
The concept we are hinting at is the notion of 
\emph on
dependence
\emph default
 between random variables.
 It is the focus of this chapter to study this concept in some detail.
 Along the way, we will pick up additional models to add to our catalogue.
 Moreover, we will study certain classes of dependence, and clarify the
 special case when there is no dependence, namely, independence.
\end_layout

\begin_layout Standard
The interested reader who would like to learn more about any of the below
 mentioned multivariate distributions should take a look at 
\emph on
Discrete Multivariate Distributions
\emph default
 by Johnson 
\emph on
et al 
\emph default

\begin_inset CommandInset citation
LatexCommand cite
key "Johnson1997"

\end_inset

 or 
\emph on
Continuous Multivariate Distributions
\emph default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Kotz2000"

\end_inset

 by Kotz 
\emph on
et al
\emph default
.
\end_layout

\begin_layout Paragraph*
What do I want them to know?
\end_layout

\begin_layout Itemize
the basic notion of dependence and how it is manifested with multiple variables
 (two, in particular)
\end_layout

\begin_layout Itemize
joint versus marginal distributions/expectation (discrete and continuous)
\end_layout

\begin_layout Itemize
some numeric measures of dependence
\end_layout

\begin_layout Itemize
conditional distributions, in the context of independence and exchangeability
\end_layout

\begin_layout Itemize
some details of at least one multivariate model (discrete and continuous)
\end_layout

\begin_layout Itemize
what it looks like when there are more than two random variables present
\end_layout

\begin_layout Section
Joint and Marginal Probability Distributions
\begin_inset CommandInset label
LatexCommand label
name "sec:Joint-Probability-Distributions"

\end_inset


\end_layout

\begin_layout Standard
Consider two discrete random variables 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 with PMFs 
\begin_inset Formula $f_{X}$
\end_inset

 and 
\begin_inset Formula $f_{Y}$
\end_inset

 that are supported on the sample spaces 
\begin_inset Formula $S_{X}$
\end_inset

 and 
\begin_inset Formula $S_{Y}$
\end_inset

, respectively.
 Let 
\begin_inset Formula $S_{X,Y}$
\end_inset

 denote the set of all possible observed 
\emph on
pairs
\emph default
 
\begin_inset Formula $(x,y)$
\end_inset

, called the 
\emph on
joint support set
\emph default
 of 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

.
 Then the 
\emph on
joint probability mass function
\emph default
 of 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 is the function 
\begin_inset Formula $f_{X,Y}$
\end_inset

 defined by
\begin_inset Formula \begin{equation}
f_{X,Y}(x,y)=\P(X=x,\, Y=y),\quad\mbox{for }(x,y)\in S_{X,Y}.\label{eq:joint-pmf}\end{equation}

\end_inset

Every joint PMF satisfies
\begin_inset Formula \begin{equation}
f_{X,Y}(x,y)>0\mbox{ for all }(x,y)\in S_{X,Y},\end{equation}

\end_inset

and
\begin_inset Formula \begin{equation}
\sum_{(x,y)\in S_{X,Y}}f_{X,Y}(x,y)=1.\end{equation}

\end_inset

It is customary to extend the function 
\begin_inset Formula $f_{X,Y}$
\end_inset

 to be defined on all of 
\begin_inset Formula $\R^{2}$
\end_inset

 by setting 
\begin_inset Formula $f_{X,Y}(x,y)=0$
\end_inset

 for 
\begin_inset Formula $(x,y)\not\in S_{X,Y}$
\end_inset

.
 
\end_layout

\begin_layout Standard
In the context of this chapter, the PMFs 
\begin_inset Formula $f_{X}$
\end_inset

 and 
\begin_inset Formula $f_{Y}$
\end_inset

 are called the 
\emph on
marginal PMFs
\emph default
 of 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

, respectively.
 If we are given only the joint PMF then we may recover each of the marginal
 PMFs by using the Theorem of Total Probability (see Equation
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:theorem-total-probability"

\end_inset

): observe
\begin_inset Formula \begin{eqnarray}
f_{X}(x) & = & \P(X=x),\\
 & = & \sum_{y\in S_{Y}}\P(X=x,\, Y=y),\\
 & = & \sum_{y\in S_{Y}}f_{X,Y}(x,y).\end{eqnarray}

\end_inset

By interchanging the roles of 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 it is clear that 
\begin_inset Formula \begin{equation}
f_{Y}(y)=\sum_{x\in S_{Y}}f_{X,Y}(x,y).\label{eq:marginal-pmf}\end{equation}

\end_inset

Given the joint PMF we may recover the marginal PMFs, but the converse is
 not true.
 Even if we have 
\emph on
both
\emph default
 marginal distributions they are not sufficient to determine the joint PMF;
 more information is needed
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
We are not at a total loss, however.
 There are Frechet bounds which pose limits on how large (and small) the
 joint distribution must be at each point.
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
Associated with the joint PMF is the 
\emph on
joint cumulative distribution function
\emph default
 
\begin_inset Formula $F_{X,Y}$
\end_inset

 defined by
\begin_inset Formula \[
F_{X,Y}(x,y)=\P(X\leq x,\, Y\leq y),\quad\mbox{for }(x,y)\in\R^{2}.\]

\end_inset

The bivariate joint CDF is not quite as tractable as the univariate CDFs,
 but in principle we could calculate it by adding up quantities of the form
 in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:joint-pmf"

\end_inset

.
 The joint CDF is typically not used in practice due to its inconvenient
 form; one can usually get by with the joint PMF alone.
\end_layout

\begin_layout Standard
We now introduce some examples of bivariate discrete distributions.
 The first we have seen before, and the second is based on the first.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:toss-two-dice-joint-pmf"

\end_inset

Roll a fair die twice.
 Let 
\begin_inset Formula $X$
\end_inset

 be the face shown on the first roll, and let 
\begin_inset Formula $Y$
\end_inset

 be the face shown on the second roll.
 We have already seen this example in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Probability"

\end_inset

, Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Toss-a-six-sided-die-twice"

\end_inset

.
 For this example, it suffices to define
\begin_inset Formula \[
f_{X,Y}(x,y)=\frac{1}{36},\quad x=1,\ldots,6,\ y=1,\ldots,6.\]

\end_inset

The marginal PMFs are given by 
\begin_inset Formula $f_{X}(x)=1/6$
\end_inset

, 
\begin_inset Formula $x=1,2,\ldots,6$
\end_inset

, and 
\begin_inset Formula $f_{Y}(y)=1/6$
\end_inset

, 
\begin_inset Formula $y=1,2,\ldots,6$
\end_inset

, since
\begin_inset Formula \[
f_{X}(x)=\sum_{y=1}^{6}\frac{1}{36}=\frac{1}{6},\quad x=1,\ldots,6,\]

\end_inset

and the same computation with the letters switched works for 
\begin_inset Formula $Y$
\end_inset

.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
In the previous example, and in many other ones, the joint support can be
 written as a product set of the support of 
\begin_inset Formula $X$
\end_inset

 
\begin_inset Quotes eld
\end_inset

times
\begin_inset Quotes erd
\end_inset

 the support of 
\begin_inset Formula $Y$
\end_inset

, that is, it may be represented as a cartesian product set, or rectangle,
 
\begin_inset Formula $S_{X,Y}=S_{X}\times S_{Y}$
\end_inset

, where 
\begin_inset Formula $S_{X}\times S_{Y}=\left\{ (x,y):\ x\in S_{X},\, y\in S_{Y}\right\} $
\end_inset

.
 As we shall see presently in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Independent-Random-Variables"

\end_inset

, this form is a necessary condition for 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 to be 
\emph on
independent
\emph default
 (or alternatively 
\emph on
exchangeable
\emph default
 when 
\begin_inset Formula $S_{X}=S_{Y}$
\end_inset

).
 But please note that in general it is not required for 
\begin_inset Formula $S_{X,Y}$
\end_inset

 to be of rectangle form.
 We next investigate just such an example.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:max-sum-two-dice"

\end_inset

Let the random experiment again be to roll a fair die twice, except now
 let us define the random variables 
\begin_inset Formula $U$
\end_inset

 and 
\begin_inset Formula $V$
\end_inset

 by
\begin_inset Formula \begin{eqnarray*}
U & = & \mbox{the maximum of the two rolls, and }\\
V & = & \mbox{the sum of the two rolls.}\end{eqnarray*}

\end_inset

We see that the support of 
\begin_inset Formula $U$
\end_inset

 is 
\begin_inset Formula $S_{U}=\left\{ 1,2,\ldots,6\right\} $
\end_inset

 and the support of 
\begin_inset Formula $V$
\end_inset

 is 
\begin_inset Formula $S_{V}=\left\{ 2,3,\ldots,12\right\} $
\end_inset

.
 We may represent the sample space with a matrix, and for each entry in
 the matrix we may calculate the value that 
\begin_inset Formula $U$
\end_inset

 assumes.
 The result is in the left half of Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:max-and-sum-two-dice"

\end_inset

.
 
\end_layout

\begin_layout Example
We can use the table to calculate the marginal PMF of 
\begin_inset Formula $U$
\end_inset

, because from Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Toss-a-six-sided-die-twice"

\end_inset

 we know that each entry in the matrix has probability 
\begin_inset Formula $1/36$
\end_inset

 associated with it.
 For instance, there is only one outcome in the matrix with 
\begin_inset Formula $U=1$
\end_inset

, namely, the top left corner.
 This single entry has probability 
\begin_inset Formula $1/36$
\end_inset

, therefore, it must be that 
\begin_inset Formula $f_{U}(1)=\P(U=1)=1/36$
\end_inset

.
 Similarly we see that there are three entries in the matrix with 
\begin_inset Formula $U=2$
\end_inset

, thus 
\begin_inset Formula $f_{U}(2)=3/36$
\end_inset

.
 Continuing in this fashion we will find the marginal distribution of 
\begin_inset Formula $U$
\end_inset

 may be written
\begin_inset Formula \begin{equation}
f_{U}(u)=\frac{2u-1}{36},\quad u=1,\,2,\ldots,6.\end{equation}

\end_inset


\end_layout

\begin_layout Example
We may do a similar thing for 
\begin_inset Formula $V$
\end_inset

; see the right half of Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:max-and-sum-two-dice"

\end_inset

.
 Collecting all of the probability we will find that the marginal PMF of
 
\begin_inset Formula $V$
\end_inset

 is
\begin_inset Formula \begin{equation}
f_{V}(v)=\frac{6-|v-7|}{36},\quad v=2,\,3,\ldots,12.\end{equation}

\end_inset


\end_layout

\begin_layout Example
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset space \hfill{}
\end_inset


\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="7">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $U$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset Formula $U=\max(X,Y)$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\begin_inset Float table
wide false
sideways false
status collapsed

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="7">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $V$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
11
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
12
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
\begin_inset Formula $V=X+Y$
\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset space \hfill{}
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Maximum 
\begin_inset Formula $U$
\end_inset

 and sum 
\begin_inset Formula $V$
\end_inset

 of a pair of dice rolls 
\begin_inset Formula $(X,Y)$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "tab:max-and-sum-two-dice"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
We may collapse the two matrices from Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:max-and-sum-two-dice"

\end_inset

 into one, big matrix of pairs of values 
\begin_inset Formula $(u,v)$
\end_inset

.
 The result is shown in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:-max-sum-two-dice-joint"

\end_inset

.
 
\end_layout

\begin_layout Example
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="7" columns="7">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(U,V)$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(1,2)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(2,3)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(3,4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(4,5)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(5,6)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(6,7)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(2,3)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(2,4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(3,5)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(4,6)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(5,7)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(6,8)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(3,4)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(3,5)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(3,6)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(4,7)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(5,8)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(6,9)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(4,5)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(4,6)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(4,7)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(4,8)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(5,9)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(6,10)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(5,6)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(5,7)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(5,8)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(5,9)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(5,10)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(6,11)
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(6,7)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(6,8)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(6,9)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(6,10)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(6,11)
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
(6,12)
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Joint values of 
\begin_inset Formula $U=\max(X,Y)$
\end_inset

 and 
\begin_inset Formula $V=X+Y$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "tab:-max-sum-two-dice-joint"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
Again, each of these pairs has probability 
\begin_inset Formula $1/36$
\end_inset

 associated with it and we are looking at the joint PDF of 
\begin_inset Formula $(U,V)$
\end_inset

 albeit in an unusual form.
 Many of the pairs are repeated, but some of them are not: 
\begin_inset Formula $(1,2)$
\end_inset

 appears twice, but 
\begin_inset Formula $(2,3)$
\end_inset

 appears only once.
 We can make more sense out of this by writing a new table with 
\begin_inset Formula $U$
\end_inset

 on one side and 
\begin_inset Formula $V$
\end_inset

 along the top.
 We will accumulate the probability just like we did in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:toss-two-dice-joint-pmf"

\end_inset

.
 See Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:max-sum-joint-pmf"

\end_inset

.
\end_layout

\begin_layout Example
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="8" columns="13">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
7
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
8
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
9
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
10
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
11
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
12
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
Total
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $1/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $1/36$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $1/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $3/36$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $1/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $5/36$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $1/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $7/36$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $1/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $9/36$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
6
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $1/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $11/36$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
Total
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $1/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $3/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $4/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $5/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $6/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $5/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $4/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $3/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $2/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
\begin_inset Formula $1/36$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\size small
1
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
The joint PMF of 
\begin_inset Formula $(U,V)$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "tab:max-sum-joint-pmf"

\end_inset

 
\end_layout

\end_inset


\size small
The outcomes of 
\begin_inset Formula $U$
\end_inset

 are along the left and the outcomes of 
\begin_inset Formula $V$
\end_inset

 are along the top.
 Empty entries in the table have zero probability.
 The row totals (on the right) and column totals (on the bottom) correspond
 to the marginal distribution of 
\begin_inset Formula $U$
\end_inset

 and 
\begin_inset Formula $V$
\end_inset

, respectively.
 
\end_layout

\end_inset


\end_layout

\begin_layout Example
The joint support of 
\begin_inset Formula $(U,V)$
\end_inset

 is concentrated along the main diagonal; note that the nonzero entries
 do not form a rectangle.
 Also notice that if we form row and column totals we are doing exactly
 the same thing as Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:marginal-pmf"

\end_inset

, so that the marginal distribution of 
\begin_inset Formula $U$
\end_inset

 is the list of totals in the right 
\begin_inset Quotes eld
\end_inset

margin
\begin_inset Quotes erd
\end_inset

 of the Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:max-sum-joint-pmf"

\end_inset

, and the marginal distribution of 
\begin_inset Formula $V$
\end_inset

 is the list of totals in the bottom 
\begin_inset Quotes eld
\end_inset

margin
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
Continuing the reasoning for the discrete case, given two continuous random
 variables 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 there similarly exists
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Strictly speaking, the joint density function does not necessarily exist.
 But the joint CDF always exists.
\end_layout

\end_inset

 a function 
\begin_inset Formula $f_{X,Y}(x,y)$
\end_inset

 associated with 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 called the 
\emph on
joint probability density function
\emph default
 of 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

.
 Every joint PDF satisfies
\begin_inset Formula \begin{equation}
f_{X,Y}(x,y)\geq0\mbox{ for all }(x,y)\in S_{X,Y},\end{equation}

\end_inset

and
\begin_inset Formula \begin{equation}
\iintop_{S_{X,Y}}f_{X,Y}(x,y)\,\diff x\,\diff y=1.\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In the continuous case there is not such a simple interpretation for the
 joint PDF; however, we do have one for the joint CDF, namely,
\begin_inset Formula \[
F_{X,Y}(x,y)=\P(X\leq x,\, Y\leq y)=\int_{-\infty}^{x}\int_{-\infty}^{y}f_{X,Y}(u,v)\,\diff v\,\diff u,\]

\end_inset

for 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset Formula $(x,y)\in\R^{2}$
\end_inset

.
 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
If 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 have the joint PDF 
\begin_inset Formula $f_{X,Y}$
\end_inset

, then the marginal density of 
\begin_inset Formula $X$
\end_inset

 may be recovered by
\begin_inset Formula \begin{equation}
f_{X}(x)=\int_{S_{Y}}f_{X,Y}(x,y)\,\diff y,\quad x\in S_{X}\end{equation}

\end_inset

and the marginal PDF of 
\begin_inset Formula $Y$
\end_inset

 may be found with 
\begin_inset Formula \begin{equation}
f_{Y}(y)=\int_{S_{X}}f_{X,Y}(x,y)\,\diff x,\quad y\in S_{Y}.\end{equation}

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:joint-pdf"

\end_inset

Let the joint PDF of 
\begin_inset Formula $(X,Y)$
\end_inset

 be given by
\begin_inset Formula \[
f_{X,Y}(x,y)=\frac{6}{5}\left(x+y^{2}\right),\quad0<x<1,\ 0<y<1.\]

\end_inset

The marginal PDF of 
\begin_inset Formula $X$
\end_inset

 is
\begin_inset Formula \begin{eqnarray*}
f_{X}(x) & = & \int_{0}^{1}\frac{6}{5}\left(x+y^{2}\right)\,\diff y,\\
 & = & \left.\frac{6}{5}\left(xy+\frac{y^{3}}{3}\right)\right|_{y=0}^{1},\\
 & = & \frac{6}{5}\left(x+\frac{1}{3}\right),\end{eqnarray*}

\end_inset

for 
\begin_inset Formula $0<x<1$
\end_inset

, and the marginal PDF of 
\begin_inset Formula $Y$
\end_inset

 is
\begin_inset Formula \begin{eqnarray*}
f_{Y}(y) & = & \int_{0}^{1}\frac{6}{5}\left(x+y^{2}\right)\,\diff x,\\
 & = & \left.\frac{6}{5}\left(\frac{x^{2}}{2}+xy^{2}\right)\right|_{x=0}^{1},\\
 & = & \frac{6}{5}\left(\frac{1}{2}+y^{2}\right),\end{eqnarray*}

\end_inset

for 
\begin_inset Formula $0<y<1$
\end_inset

.
 In this example the joint support set was a rectangle 
\begin_inset Formula $[0,1]\times[0,1]$
\end_inset

, but it turns out that 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are not independent.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Independent-Random-Variables"

\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
We will show how to do Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:max-sum-two-dice"

\end_inset

 using 
\family sans
R
\family default
; it is much simpler to do it with 
\family sans
R
\family default
 than without.
 First we set up the sample space with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rolldie
\end_layout

\end_inset


\color inherit
 function.
 Next, we add random variables 
\begin_inset Formula $U$
\end_inset

 and 
\begin_inset Formula $V$
\end_inset

 with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

addrv
\end_layout

\end_inset


\color inherit
 function.
 We take a look at the very top of the data frame (probability space) to
 make sure that everything is operating according to plan.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

S <- rolldie(2, makespace = TRUE)
\begin_inset Newline newline
\end_inset

S <- addrv(S, FUN = max, invars = c("X1","X2"), name = "U")
\begin_inset Newline newline
\end_inset

S <- addrv(S, FUN = sum, invars = c("X1","X2"), name = "V")
\begin_inset Newline newline
\end_inset

head(S)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Yes, the 
\begin_inset Formula $U$
\end_inset

 and 
\begin_inset Formula $V$
\end_inset

 columns have been added to the data frame and have been computed correctly.
 This result would be fine as it is, but the data frame has too many rows:
 there are repeated pairs 
\begin_inset Formula $(u,v)$
\end_inset

 which show up as repeated rows in the data frame.
 The goal is to aggregate the rows of 
\begin_inset Formula $S$
\end_inset

 such that the result has exactly one row for each unique pair 
\begin_inset Formula $(u,v)$
\end_inset

 with positive probability.
 This sort of thing is exactly the task for which the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

marginal
\end_layout

\end_inset


\color inherit
 function was designed.
 We may take a look at the joint distribution of 
\begin_inset Formula $U$
\end_inset

 and 
\begin_inset Formula $V$
\end_inset

 (we only show the first few rows of the data frame, but the complete one
 has 11 rows).
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

UV <- marginal(S, vars = c("U", "V"))
\begin_inset Newline newline
\end_inset

head(UV)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The data frame is difficult to understand.
 It would be better to have a tabular display like Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:max-sum-joint-pmf"

\end_inset

.
 We can do that with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

xtabs
\end_layout

\end_inset

 function.

\color inherit
 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

xtabs(round(probs,3) ~ U + V, data = UV)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Compare these values to the ones shown in Table 
\begin_inset CommandInset ref
LatexCommand ref
reference "tab:max-sum-joint-pmf"

\end_inset

.
 We can repeat the process with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

marginal
\end_layout

\end_inset


\color inherit
 to get the univariate marginal distributions of 
\begin_inset Formula $U$
\end_inset

 and 
\begin_inset Formula $V$
\end_inset

 separately.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

marginal(UV, vars = "U")
\begin_inset Newline newline
\end_inset

head(marginal(UV, vars = "V"))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Another way to do the same thing is with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rowSums
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

colSums
\end_layout

\end_inset


\color inherit
 of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

xtabs
\end_layout

\end_inset


\color inherit
 object.
 Compare
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

temp <- xtabs(probs ~ U + V, data = UV)
\begin_inset Newline newline
\end_inset

rowSums(temp)
\begin_inset Newline newline
\end_inset

colSums(temp)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
You should check that the answers that we have obtained exactly match the
 same (somewhat laborious) calculations that we completed in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:max-sum-two-dice"

\end_inset

.
\end_layout

\begin_layout Section
Joint and Marginal Expectation
\begin_inset CommandInset label
LatexCommand label
name "sec:Joint-and-Marginal-Expectation"

\end_inset


\end_layout

\begin_layout Standard
Given a function 
\begin_inset Formula $g$
\end_inset

 with arguments 
\begin_inset Formula $(x,y)$
\end_inset

 we would like to know the long-run average behavior of 
\begin_inset Formula $g(X,Y)$
\end_inset

 and how to mathematically calculate it.
 Expectation in this context is computed in the pedestrian way.
 We simply integrate (sum) with respect to the joint probability density
 (mass) function.
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
\E\, g(X,Y)=\iintop_{S_{X,Y}}g(x,y)\, f_{X,Y}(x,y)\,\diff x\,\diff y,\end{equation}

\end_inset

or in the discrete case
\begin_inset Formula \begin{equation}
\E\, g(X,Y)=\mathop{\sum\sum}\limits _{(x,y)\in S_{X,Y}}g(x,y)\, f_{X,Y}(x,y).\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Covariance and Correlation
\end_layout

\begin_layout Standard
There are two very special cases of joint expectation: the 
\emph on
covariance
\emph default
 and the 
\emph on
correlation
\emph default
.
 These are measures which help us quantify the dependence between 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

.
 
\end_layout

\begin_layout Definition
The 
\emph on
covariance
\emph default
 of 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 is 
\begin_inset Formula \begin{equation}
\mbox{Cov}(X,Y)=\E(X-\E X)(Y-\E Y).\end{equation}

\end_inset


\end_layout

\begin_layout Standard
By the way, there is a shortcut formula for covariance which is almost as
 handy as the shortcut for the variance:
\begin_inset Formula \begin{equation}
\mbox{Cov}(X,Y)=\E(XY)-(\E X)(\E Y).\end{equation}

\end_inset

The proof is left to Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:Prove-cov-shortcut"

\end_inset

.
\end_layout

\begin_layout Standard
The Pearson product moment correlation between 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 is the covariance between 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 rescaled to fall in the interval 
\begin_inset Formula $[-1,1]$
\end_inset

.
 It is formally defined by 
\begin_inset Formula \begin{equation}
\mbox{Corr}(X,Y)=\frac{\mbox{Cov}(X,Y)}{\sigma_{X}\sigma_{Y}}\end{equation}

\end_inset

The correlation is usually denoted by 
\begin_inset Formula $\rho_{X,Y}$
\end_inset

 or simply 
\begin_inset Formula $\rho$
\end_inset

 if the random variables are clear from context.
 There are some important facts about the correlation coefficient:
\end_layout

\begin_layout Enumerate
The range of correlation is 
\begin_inset Formula $-1\leq\rho_{X,Y}\leq1$
\end_inset

.
\end_layout

\begin_layout Enumerate
Equality holds above (
\begin_inset Formula $\rho_{X,Y}=\pm1$
\end_inset

) if and only if 
\begin_inset Formula $Y$
\end_inset

 is a linear function of 
\begin_inset Formula $X$
\end_inset

 with probability one.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:max-sum-dice-covariance"

\end_inset

We will compute the covariance for the discrete distribution in Example
 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:max-sum-two-dice"

\end_inset

.
 The expected value of 
\begin_inset Formula $U$
\end_inset

 is
\begin_inset Formula \[
\E U=\sum_{u=1}^{6}u\, f_{U}(u)=\sum_{u=1}^{6}u\,\frac{2u-1}{36}=1\left(\frac{1}{36}\right)+2\left(\frac{3}{36}\right)+\cdots+6\left(\frac{11}{36}\right)=\frac{161}{36},\]

\end_inset

and the expected value of 
\begin_inset Formula $V$
\end_inset

 is
\begin_inset Formula \[
\E V=\sum_{v=2}^{12}v\,\frac{6-|7-v|}{36}=2\left(\frac{1}{36}\right)+3\left(\frac{2}{36}\right)+\cdots+12\left(\frac{1}{36}\right)=7,\]

\end_inset

and the expected value of 
\begin_inset Formula $UV$
\end_inset

 is
\begin_inset Formula \[
\E UV=\sum_{u=1}^{6}\sum_{v=2}^{12}uv\, f_{U,V}(u,v)=1\cdot2\left(\frac{1}{36}\right)+2\cdot3\left(\frac{2}{36}\right)+\cdots+6\cdot12\left(\frac{1}{36}\right)=\frac{308}{9}.\]

\end_inset

Therefore the covariance of 
\begin_inset Formula $(U,V)$
\end_inset

 is
\begin_inset Formula \[
\mbox{Cov}(U,V)=\E UV-\left(\E U\right)\left(\E V\right)=\frac{308}{9}-\frac{161}{36}\cdot7=\frac{35}{12}.\]

\end_inset

All we need now are the standard deviations of 
\begin_inset Formula $U$
\end_inset

 and 
\begin_inset Formula $V$
\end_inset

 to calculate the correlation coefficient (omitted).
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
We will do a continuous example so that you can see how it works.
\end_layout

\begin_layout Example
Let us find the covariance of the variables 
\begin_inset Formula $(X,Y)$
\end_inset

 from Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:joint-pdf"

\end_inset

.
 The expected value of 
\begin_inset Formula $X$
\end_inset

 is
\begin_inset Formula \[
\E X=\int_{0}^{1}x\cdot\frac{6}{5}\left(x+\frac{1}{3}\right)\diff x=\left.\frac{2}{5}x^{3}+\frac{1}{5}x^{2}\right|_{x=0}^{1}=\frac{3}{5},\]

\end_inset

and the expected value of 
\begin_inset Formula $Y$
\end_inset

 is
\begin_inset Formula \[
\E Y=\int_{0}^{1}y\cdot\frac{6}{5}\left(\frac{1}{2}+y^{2}\right)\diff x=\left.\frac{3}{10}y^{2}+\frac{3}{20}y^{4}\right|_{y=0}^{1}=\frac{9}{20}.\]

\end_inset

Finally, the expected value of 
\begin_inset Formula $XY$
\end_inset

 is
\begin_inset Formula \begin{eqnarray*}
\E XY & = & \int_{0}^{1}\int_{0}^{1}xy\,\frac{6}{5}\left(x+y^{2}\right)\diff x\,\diff y,\\
 & = & \int_{0}^{1}\left.\left(\frac{2}{5}x^{3}y+\frac{3}{10}xy^{4}\right)\right|_{x=0}^{1}\diff y,\\
 & = & \int_{0}^{1}\left(\frac{2}{5}y+\frac{3}{10}y^{4}\right)\diff y,\\
 & = & \frac{1}{5}+\frac{3}{50},\end{eqnarray*}

\end_inset

which is 13/50.
 Therefore the covariance of 
\begin_inset Formula $(X,Y)$
\end_inset

 is
\begin_inset Formula \[
\mbox{Cov}(X,Y)=\frac{13}{50}-\left(\frac{3}{5}\right)\left(\frac{9}{20}\right)=-\frac{1}{100}.\]

\end_inset


\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
There are not any specific functions in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prob
\end_layout

\end_inset


\color inherit
 package designed for multivariate expectation.
 This is not a problem, though, because it is easy enough to do expectation
 the long way -- with column operations.
 We just need to keep the definition in mind.
 For instance, we may compute the covariance of 
\begin_inset Formula $(U,V)$
\end_inset

 from Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:max-sum-dice-covariance"

\end_inset

.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

Eu <- sum(S$U*S$probs)
\begin_inset Newline newline
\end_inset

Ev <- sum(S$V*S$probs)
\begin_inset Newline newline
\end_inset

Euv <- sum(S$U*S$V*S$probs)
\begin_inset Newline newline
\end_inset

Euv - Eu * Ev
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Compare this answer to what we got in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:max-sum-dice-covariance"

\end_inset

.
\end_layout

\begin_layout Standard
To do the continuous case we could use the computer algebra utilities of
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Yacas
\end_layout

\end_inset

 and the associated 
\family sans
\color inherit
R
\family default
\color none
 package 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Ryacas
\end_layout

\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "ryacas"

\end_inset

.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:bivariate-transf-R"

\end_inset

 for another example where the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Ryacas
\end_layout

\end_inset

 package appears.
\end_layout

\begin_layout Section
Conditional Distributions
\begin_inset CommandInset label
LatexCommand label
name "sec:Conditional-Distributions"

\end_inset


\end_layout

\begin_layout Standard
If 
\begin_inset Formula $x\in S_{X}$
\end_inset

 is such that 
\begin_inset Formula $f_{X}(x)>0$
\end_inset

, then we define the 
\emph on
conditional density of
\emph default
 
\begin_inset Formula $Y|\, X=x$
\end_inset

, denoted 
\begin_inset Formula $f_{Y|x}$
\end_inset

, by 
\begin_inset Formula \begin{equation}
f_{Y|x}(y|x)=\frac{f_{X,Y}(x,y)}{f_{X}(x)},\quad y\in S_{Y}.\end{equation}

\end_inset

We define 
\begin_inset Formula $f_{X|y}$
\end_inset

 in a similar fashion.
\end_layout

\begin_layout Example
Let the joint PMF of 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 be given by
\begin_inset Formula \[
f_{X,Y}(x,y)=\]

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Let the joint PDF of 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 be given by
\end_layout

\begin_layout Subsection*
Bayesian Connection
\end_layout

\begin_layout Standard
Conditional distributions play a fundamental role in Bayesian probability
 and statistics.
 There is a parameter 
\begin_inset Formula $\theta$
\end_inset

 which is of primary interest, and about which we would like to learn.
 But rather than observing 
\begin_inset Formula $\theta$
\end_inset

 directly, we instead observe a random variable 
\begin_inset Formula $X$
\end_inset

 whose probability distribution depends on 
\begin_inset Formula $\theta$
\end_inset

.
 Using the information we provided by 
\begin_inset Formula $X,$
\end_inset

 we would like to update the information that we have about 
\begin_inset Formula $\theta$
\end_inset

.
\end_layout

\begin_layout Standard
Our initial beliefs about 
\begin_inset Formula $\theta$
\end_inset

 are represented by a probability distribution, called the 
\emph on
prior distribution
\emph default
, denoted by 
\begin_inset Formula $\pi$
\end_inset

.
 The PDF 
\begin_inset Formula $f_{X|\theta}$
\end_inset

 is called the 
\emph on
likelihood function
\emph default
, also called the 
\emph on
likelihood of
\emph default
 
\begin_inset Formula $X$
\end_inset

 
\emph on
conditional on
\emph default
 
\begin_inset Formula $\theta$
\end_inset

.
 Given an observation 
\begin_inset Formula $X=x$
\end_inset

, we would like to update our beliefs 
\begin_inset Formula $\pi$
\end_inset

 to a new distribution, called the 
\emph on
posterior distribution of
\emph default
 
\begin_inset Formula $\theta$
\end_inset

 
\emph on
given the observation
\emph default
 
\begin_inset Formula $X=x$
\end_inset

, denoted 
\begin_inset Formula $\pi_{\theta|x}$
\end_inset

.
 It may seem a mystery how to obtain 
\begin_inset Formula $\pi_{\theta|x}$
\end_inset

 based only on the information provided by 
\begin_inset Formula $\pi$
\end_inset

 and 
\begin_inset Formula $f_{X|\theta}$
\end_inset

, but it should not be.
 We have already studied this in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Bayes'-Rule"

\end_inset

 where it was called Bayes' Rule:
\begin_inset Formula \begin{equation}
\pi(\theta|x)=\frac{\pi(\theta)\, f(x|\theta)}{\int\pi(u)\, f(x|u)\diff u}.\end{equation}

\end_inset

Compare the above expression to Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:bayes-rule"

\end_inset

.
\end_layout

\begin_layout Example
Suppose the parameter 
\begin_inset Formula $\theta$
\end_inset

 is the 
\begin_inset Formula $\P(\mbox{Heads})$
\end_inset

 for a biased coin.
 It could be any value from 0 to 1.
 Perhaps we have some prior information about this coin, for example, maybe
 we have seen this coin before and we have reason to believe that it shows
 Heads less than half of the time.
 Suppose that we represent our beliefs about 
\begin_inset Formula $\theta$
\end_inset

 with a 
\begin_inset Formula $\mathsf{beta}(\mathtt{shape1}=1,\,\mathtt{shape2}=3)$
\end_inset

 prior distribution, that is, we assume 
\begin_inset Formula \[
\theta\sim\pi(\theta)=3(1-\theta)^{2},\quad0<\theta<1.\]

\end_inset

To learn more about 
\begin_inset Formula $\theta$
\end_inset

, we will do what is natural: flip the coin.
 We will observe a random variable 
\begin_inset Formula $X$
\end_inset

 which takes the value 
\begin_inset Formula $1$
\end_inset

 if the coin shows Heads, and 0 if the coin shows Tails.
 Under these circumstances, 
\begin_inset Formula $X$
\end_inset

 will have a Bernoulli distribution, and in particular, 
\begin_inset Formula $X|\theta\sim\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=\theta)$
\end_inset

:
\begin_inset Formula \[
f_{X|\theta}(x|\theta)=\theta^{x}(1-\theta)^{1-x},\quad x=0,1.\]

\end_inset

Based on the observation 
\begin_inset Formula $X=x$
\end_inset

, we will update the prior distribution to the posterior distribution, and
 we will do so with Bayes' Rule: it says
\begin_inset Formula \begin{eqnarray*}
\pi(\theta|x) & \propto & \pi(\theta)\, f(x|\theta),\\
 & = & \theta^{x}(1-\theta)^{1-x}\cdot3(1-\theta)^{2},\\
 & = & 3\,\theta^{x}(1-\theta)^{3-x},\quad0<\theta<1,\end{eqnarray*}

\end_inset

where the constant of proportionality is given by 
\begin_inset Formula \[
\int3\, u^{x}(1-u)^{3-x}\diff u=\int3\, u^{(1+x)-1}(1-u)^{(4-x)-1}\diff u=3\,\frac{\Gamma(1+x)\Gamma(4-x)}{\Gamma[(1+x)+(4-x)]},\]

\end_inset

the integral being calculated by inspection of the formula for a 
\begin_inset Formula $\mathsf{beta}(\mathtt{shape1}=1+x,\,\mathtt{shape2}=4-x)$
\end_inset

 distribution.
 That is to say, our posterior distribution is precisely
\begin_inset Formula \[
\theta|x\sim\mathsf{beta}(\mathtt{shape1}=1+x,\,\mathtt{shape2}=4-x).\]

\end_inset


\end_layout

\begin_layout Example
The Bayesian statistician uses the posterior distribution for all matters
 concerning inference about 
\begin_inset Formula $\theta$
\end_inset

.
\end_layout

\begin_layout Remark
We usually do not restrict ourselves to the observation of only one 
\begin_inset Formula $X$
\end_inset

 conditional on 
\begin_inset Formula $\theta$
\end_inset

.
 In fact, it is common to observe an entire sample 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

,\SpecialChar \ldots{}
,
\begin_inset Formula $X_{n}$
\end_inset

 conditional on 
\begin_inset Formula $\theta$
\end_inset

 (which itself is often multidimensional).
 Do not be frightened, however, because the intuition is the same.
 There is a prior distribution 
\begin_inset Formula $\pi(\theta)$
\end_inset

, a likelihood 
\begin_inset Formula $f(x_{1},x_{2},\ldots,x_{n}|\theta)$
\end_inset

, and a posterior distribution 
\begin_inset Formula $\pi(\theta|x_{1},x_{2},\ldots,x_{n})$
\end_inset

.
 Bayes' Rule states that the relationship between the three is
\begin_inset Formula \[
\pi(\theta|x_{1},x_{2},\ldots,x_{n})\propto\pi(\theta)\, f(x_{1},x_{2},\ldots,x_{n}|\theta),\]

\end_inset

where the constant of proportionality is 
\begin_inset Formula $\int\pi(u)\, f(x_{1},x_{2},\ldots,x_{n}|u)\,\diff u$
\end_inset

.
 Any good textbook on Bayesian Statistics will explain these notions in
 detail; to the interested reader I recommend Gelman 
\begin_inset CommandInset citation
LatexCommand cite
key "Gelman2004"

\end_inset

 or Lee 
\begin_inset CommandInset citation
LatexCommand cite
key "Lee1997"

\end_inset

.
 
\end_layout

\begin_layout Section
Independent Random Variables
\begin_inset CommandInset label
LatexCommand label
name "sec:Independent-Random-Variables"

\end_inset


\end_layout

\begin_layout Subsection
Independent Random Variables
\begin_inset CommandInset label
LatexCommand label
name "sub:Independent-Random-Variables"

\end_inset


\end_layout

\begin_layout Standard
We recall from Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Probability"

\end_inset

 that the events 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 are said to be independent when
\begin_inset Formula \begin{equation}
\P(A\cap B)=\P(A)\P(B).\end{equation}

\end_inset

If it happens that
\begin_inset Formula \begin{equation}
\P(X=x,Y=y)=\P(X=x)\P(Y=y),\quad\mbox{for every }x\in S_{X},\ y\in S_{Y},\end{equation}

\end_inset

then we say that 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are 
\emph on
independent random variables
\emph default
.
 Otherwise, we say that 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are 
\emph on
dependent
\emph default
.
 Using the PMF notation from above, we see that independent discrete random
 variables satisfy 
\begin_inset Formula \begin{equation}
f_{X,Y}(x,y)=f_{X}(x)f_{Y}(y)\quad\mbox{for every }x\in S_{X},\ y\in S_{Y}.\end{equation}

\end_inset

Continuing the reasoning, given two continuous random variables 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 with joint PDF 
\begin_inset Formula $f_{X,Y}$
\end_inset

 and respective marginal PDFs 
\begin_inset Formula $f_{X}$
\end_inset

 and 
\begin_inset Formula $f_{Y}$
\end_inset

 that are supported on the sets 
\begin_inset Formula $S_{X}$
\end_inset

 and 
\begin_inset Formula $S_{Y}$
\end_inset

, if it happens that 
\begin_inset Formula \begin{equation}
f_{X,Y}(x,y)=f_{X}(x)f_{Y}(y)\quad\mbox{for every }x\in S_{X},\ y\in S_{Y},\end{equation}

\end_inset

then we say that 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are independent.
\end_layout

\begin_layout Example
In Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:toss-two-dice-joint-pmf"

\end_inset

 we considered the random experiment of rolling a fair die twice.
 There we found the joint PMF to be
\begin_inset Formula \[
f_{X,Y}(x,y)=\frac{1}{36},\quad x=1,\ldots,6,\ y=1,\ldots,6,\]

\end_inset

and we found the marginal PMFs 
\begin_inset Formula $f_{X}(x)=1/6$
\end_inset

, 
\begin_inset Formula $x=1,2,\ldots,6$
\end_inset

, and 
\begin_inset Formula $f_{Y}(y)=1/6$
\end_inset

, 
\begin_inset Formula $y=1,2,\ldots,6$
\end_inset

.
 Therefore in this experiment 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are independent since for every 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 in the joint support the joint PMF satisfies 
\begin_inset Formula \[
f_{X,Y}(x,y)=\frac{1}{36}=\left(\frac{1}{6}\right)\left(\frac{1}{6}\right)=f_{X}(x)\, f_{Y}(y).\]

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
In Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:max-sum-two-dice"

\end_inset

 we considered the same experiment but different random variables 
\begin_inset Formula $U$
\end_inset

 and 
\begin_inset Formula $V$
\end_inset

.
 We can prove that 
\begin_inset Formula $U$
\end_inset

 and 
\begin_inset Formula $V$
\end_inset

 are not independent if we can find a single pair 
\begin_inset Formula $(u,v)$
\end_inset

 where the independence equality does not hold.
 There are many such pairs.
 One of them is 
\begin_inset Formula $(6,12)$
\end_inset

:
\begin_inset Formula \[
f_{U,V}(6,12)=\frac{1}{36}\neq\left(\frac{11}{36}\right)\left(\frac{1}{36}\right)=f_{U}(6)\, f_{V}(12).\]

\end_inset


\end_layout

\begin_layout Standard
Independent random variables are very useful to the mathematician.
 They have many, many, tractable properties.
 We mention some of the more important ones.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "pro:indep-implies-prodexpect"

\end_inset

If 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are independent, then for any functions 
\begin_inset Formula $u$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

, 
\begin_inset Formula \begin{equation}
\E\left(u(X)v(Y)\right)=\left(\E u(X)\right)\left(\E v(Y)\right).\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Branch proofs
status open

\begin_layout Proof
This is straightforward from the definition.
\begin_inset Formula \begin{eqnarray*}
\E\left(u(X)v(Y)\right) & = & \iint\, u(x)v(y)\, f_{X,Y}(x,y)\,\diff x\diff y\\
 & = & \iint\, u(x)v(y)\, f_{X}(x)\, f_{Y}(y)\,\diff x\diff y\\
 & = & \int u(x)\, f_{X}(x)\,\diff x\ \int v(y)\, f_{Y}(y)\,\diff y\end{eqnarray*}

\end_inset

and this last quantity is exactly 
\begin_inset Formula $\left(\E u(X)\right)\left(\E v(Y)\right)$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Now that we have Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:indep-implies-prodexpect"

\end_inset

 we mention a corollary that will help us later to quickly identify those
 random variables which are 
\emph on
not
\emph default
 independent.
\end_layout

\begin_layout Corollary
If 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are independent, then 
\begin_inset Formula $\mbox{Cov}(X,Y)=0$
\end_inset

, and consequently, 
\begin_inset Formula $\mbox{Corr}(X,Y)=0$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "cor:indep-implies-uncorr"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Branch proofs
status open

\begin_layout Proof
When 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are independent then 
\begin_inset Formula $\E XY=\E X\,\E Y$
\end_inset

.
 And when the covariance is zero the numerator of the correlation is 0.
 
\end_layout

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Remark
\begin_inset CommandInset label
LatexCommand label
name "rem:cov0-not-imply-indep"

\end_inset

Unfortunately, the converse of Corollary 
\begin_inset CommandInset ref
LatexCommand ref
reference "cor:indep-implies-uncorr"

\end_inset

 is not true.
 That is, there are many random variables which are dependent yet their
 covariance and correlation is zero.
 For more details, see Casella and Berger 
\begin_inset CommandInset citation
LatexCommand cite
key "Casella2002"

\end_inset

.
 
\end_layout

\begin_layout Standard
Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:indep-implies-prodexpect"

\end_inset

 is useful to us and we will receive mileage out of it, but there is another
 fact which will play an even more important role.
 Unfortunately, the proof is beyond the techniques presented here.
 The inquisitive reader should consult Casella and Berger 
\begin_inset CommandInset citation
LatexCommand cite
key "Casella2002"

\end_inset

, Resnick 
\begin_inset CommandInset citation
LatexCommand cite
key "Resnick1999"

\end_inset

, 
\emph on
etc
\emph default
.
\end_layout

\begin_layout Fact
\begin_inset CommandInset label
LatexCommand label
name "fac:indep-then-function-indep"

\end_inset

If 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are independent, then 
\begin_inset Formula $u(X)$
\end_inset

 and 
\begin_inset Formula $v(Y)$
\end_inset

 are independent for any functions 
\begin_inset Formula $u$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

.
\end_layout

\begin_layout Subsection
Combining Independent Random Variables
\begin_inset CommandInset label
LatexCommand label
name "sub:Combining-Independent-Random"

\end_inset


\end_layout

\begin_layout Standard
Another important corollary of Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:indep-implies-prodexpect"

\end_inset

 will allow us to find the distribution of sums of random variables.
\end_layout

\begin_layout Corollary
If 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are independent, then the moment generating function of 
\begin_inset Formula $X+Y$
\end_inset

 is 
\begin_inset Formula \begin{equation}
M_{X+Y}(t)=M_{X}(t)\cdot M_{Y}(t).\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Branch proofs
status open

\begin_layout Proof
Choose 
\begin_inset Formula $u(x)=\me^{x}$
\end_inset

 and 
\begin_inset Formula $v(y)=\me^{y}$
\end_inset

 in Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:indep-implies-prodexpect"

\end_inset

, and remember the identity 
\begin_inset Formula $\me^{t(x+y)}=\me^{tx}\,\me^{ty}$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Let us take a look at some examples of the corollary in action.
\end_layout

\begin_layout Example
Let 
\begin_inset Formula $X\sim\mathsf{binom}(\mathtt{size}=n_{1},\,\mathtt{prob}=p)$
\end_inset

 and 
\begin_inset Formula $Y\sim\mathsf{binom}(\mathtt{size}=n_{2},\,\mathtt{prob}=p)$
\end_inset

 be independent.
 Then 
\begin_inset Formula $X+Y$
\end_inset

 has MGF
\begin_inset Formula \[
M_{X+Y}(t)=M_{X}(t)\, M_{Y}(t)=\left(q+p\me^{t}\right)^{n_{1}}\left(q+p\me^{t}\right)^{n_{2}}=\left(q+p\me^{t}\right)^{n_{1}+n_{2}},\]

\end_inset

which is the MGF of a 
\begin_inset Formula $\mathsf{binom}(\mathtt{size}=n_{1}+n_{2},\,\mathtt{prob}=p)$
\end_inset

 distribution.
 Therefore, 
\begin_inset Formula $X+Y\sim\mathsf{binom}(\mathtt{size}=n_{1}+n_{2},\,\mathtt{prob}=p)$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Let 
\begin_inset Formula $X\sim\mathsf{norm}(\mathtt{mean}=\mu_{1},\,\mathtt{sd}=\sigma_{1})$
\end_inset

 and 
\begin_inset Formula $Y\sim\mathsf{norm}(\mathtt{mean}=\mu_{2},\,\mathtt{sd}=\sigma_{2})$
\end_inset

 be independent.
 Then 
\begin_inset Formula $X+Y$
\end_inset

 has MGF
\begin_inset Formula \[
M_{X}(t)\, M_{Y}(t)=\exp\left\{ \mu_{1}t+t^{2}\sigma_{1}^{2}/2\right\} \exp\left\{ \mu_{2}t+t^{2}\sigma_{2}^{2}/2\right\} =\exp\left\{ \left(\mu_{1}+\mu_{2}\right)t+t^{2}\left(\sigma_{1}^{2}+\sigma_{2}^{2}\right)/2\right\} ,\]

\end_inset

which is the MGF of a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu_{1}+\mu_{2},\,\mathtt{sd}=\sqrt{\sigma_{1}^{2}+\sigma_{2}^{2}})$
\end_inset

 distribution.
 
\end_layout

\begin_layout Standard
Even when we cannot use the MGF trick to identify the exact distribution
 of a linear combination of random variables, we can still say something
 about its mean and variance.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "pro:mean-sd-lin-comb-two"

\end_inset

Let 
\begin_inset Formula $X_{1}$
\end_inset

 and 
\begin_inset Formula $X_{2}$
\end_inset

 be independent with respective population means 
\begin_inset Formula $\mu_{1}$
\end_inset

 and 
\begin_inset Formula $\mu_{2}$
\end_inset

 and population standard deviations 
\begin_inset Formula $\sigma_{1}$
\end_inset

 and 
\begin_inset Formula $\sigma_{2}$
\end_inset

.
 For given constants 
\begin_inset Formula $a_{1}$
\end_inset

 and 
\begin_inset Formula $a_{2}$
\end_inset

, define 
\begin_inset Formula $Y=a_{1}X_{1}+a_{2}X_{2}$
\end_inset

.
 Then the mean and standard deviation of 
\begin_inset Formula $Y$
\end_inset

 are given by the formulas
\begin_inset Formula \begin{equation}
\mu_{Y}=a_{1}\mu_{1}+a_{2}\mu_{2},\quad\sigma_{Y}=\left(a_{1}^{2}\sigma_{1}^{2}+a_{2}^{2}\sigma_{2}^{2}\right)^{1/2}.\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Branch proofs
status open

\begin_layout Proof
We use Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:expectation-properties"

\end_inset

:
\begin_inset Formula \[
\E Y=\E\left(a_{1}X_{1}+a_{2}X_{2}\right)=a_{1}\E X_{1}+a_{2}\E X_{2}=a_{1}\mu_{1}+a_{2}\mu_{2}.\]

\end_inset

For the standard deviation, we will find the variance and take the square
 root at the end.
 And to calculate the variance we will first compute 
\begin_inset Formula $\E Y^{2}$
\end_inset

 with an eye toward using the identity 
\begin_inset Formula $\sigma_{Y}^{2}=\E Y^{2}-\left(\E Y\right)^{2}$
\end_inset

 as a final step.
 
\begin_inset Formula \[
\E Y^{2}=\E\left(a_{1}X_{1}+a_{2}X_{2}\right)^{2}=\E\left(a_{1}^{2}X_{1}^{2}+a_{2}^{2}X_{2}^{2}+2a_{1}a_{2}X_{1}X_{2}\right).\]

\end_inset

Using linearity of expectation the 
\begin_inset Formula $\E$
\end_inset

 distributes through the sum.
 Now 
\begin_inset Formula $\E X_{i}^{2}=\sigma_{i}^{2}+\mu_{i}^{2}$
\end_inset

, for 
\begin_inset Formula $i=1$
\end_inset

 and 2 and 
\begin_inset Formula $\E X_{1}X_{2}=\E X_{1}\E X_{2}=\mu_{1}\mu_{2}$
\end_inset

 because of independence.
 Thus
\begin_inset Formula \begin{eqnarray*}
\E Y^{2} & = & a_{1}^{2}(\sigma_{1}^{2}+\mu_{1}^{2})+a_{2}^{2}(\sigma_{2}^{2}+\mu_{2}^{2})+2a_{1}a_{2}\mu_{1}\mu_{2},\\
 & = & a_{1}^{2}\sigma_{1}^{2}+a_{2}^{2}\sigma_{2}^{2}+\left(a_{1}^{2}\mu_{1}^{2}+a_{2}^{2}\mu_{2}^{2}+2a_{1}a_{2}\mu_{1}\mu_{2}\right).\end{eqnarray*}

\end_inset

But notice that the expression in the parentheses is exactly 
\begin_inset Formula $\left(a_{1}\mu_{1}+a_{2}\mu_{2}\right)^{2}=\left(\E Y\right)^{2}$
\end_inset

, so the proof is complete..
 
\end_layout

\end_inset


\end_layout

\begin_layout Section
Exchangeable Random Variables
\begin_inset CommandInset label
LatexCommand label
name "sec:Exchangeable-Random-Variables"

\end_inset


\end_layout

\begin_layout Standard
Two random variables 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are said to be 
\emph on
exchangeable
\emph default
 if their joint CDF is a symmetric function of its arguments:
\begin_inset Formula \begin{equation}
F_{X,Y}(x,y)=F_{X,Y}(y,x),\quad\mbox{for all }(x,y)\in\R^{2}.\end{equation}

\end_inset

When the joint density 
\begin_inset Formula $f$
\end_inset

 exists, we may equivalently say that 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are exchangeable if 
\begin_inset Formula $f(x,y)=f(y,x)$
\end_inset

 for all 
\begin_inset Formula $(x,y)$
\end_inset

.
\end_layout

\begin_layout Standard
Exchangeable random variables exhibit symmetry in the sense that a person
 may exchange one variable for the other with no substantive changes to
 their joint random behavior.
 While independence speaks to a 
\emph on
lack of influence
\emph default
 between the two variables, exchangeability aims to capture the 
\emph on
symmetry
\emph default
 between them.
\end_layout

\begin_layout Example
Let 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 have joint PDF
\begin_inset Formula \begin{multline}
f_{X,Y}(x,y)=(1+\alpha)\lambda^{2}\me^{-\lambda(x+y)}+\alpha(2\lambda)^{2}\me^{-2\lambda(x+y)}-2\alpha\lambda^{2}\left(\me^{-\lambda(2x+y)}+\me^{-\lambda(x+2y)}\right).\end{multline}

\end_inset

It is straightforward and tedious to check that 
\begin_inset Formula $\iint f=1$
\end_inset

.
 We may see immediately that 
\begin_inset Formula $f_{X,Y}(x,y)=f_{X,Y}(y,x)$
\end_inset

 for all 
\begin_inset Formula $(x,y)$
\end_inset

, which confirms that 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are exchangeable.
 Here, 
\begin_inset Formula $\alpha$
\end_inset

 is said to be an association parameter.
 This particular example is one from the Farlie-Gumbel-Morgenstern family
 of distributions; see 
\begin_inset CommandInset citation
LatexCommand cite
key "Kotz2000"

\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:binom-exchangeable"

\end_inset

Suppose 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are i.i.d.
\begin_inset space ~
\end_inset


\begin_inset Formula $\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)$
\end_inset

.
 Then their joint PMF is
\begin_inset Formula \begin{eqnarray*}
f_{X,Y}(x,y) & = & f_{X}(x)f_{Y}(y)\\
 & = & {n \choose x}\, p^{x}(1-p)^{n-x}\,{n \choose y}\, p^{y}(1-p)^{n-y},\\
 & = & {n \choose x}{n \choose y}\, p^{x+y}(1-p)^{2n-(x+y)},\end{eqnarray*}

\end_inset

and the value is the same if we exchange 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

.
 Therefore 
\begin_inset Formula $(X,Y)$
\end_inset

 are exchangeable.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Looking at Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:binom-exchangeable"

\end_inset

 more closely we see that the fact that 
\begin_inset Formula $(X,Y)$
\end_inset

 are exchangeable has nothing to do with the 
\begin_inset Formula $\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)$
\end_inset

 distribution; it only matters that they are independent (so that the joint
 PDF factors) and they are identically distributed (in which case we may
 swap letters to no effect).
 We could just have easily used any other marginal distribution.
 We will take this as a proof of the following proposition.
\end_layout

\begin_layout Proposition
If 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are i.i.d.
\begin_inset space ~
\end_inset

(with common marginal distribution 
\begin_inset Formula $F$
\end_inset

) then 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are exchangeable.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Exchangeability thus contains i.i.d.
\begin_inset space ~
\end_inset

as a special case.
 
\end_layout

\begin_layout Section
The Bivariate Normal Distribution
\begin_inset CommandInset label
LatexCommand label
name "sec:The-Bivariate-Normal"

\end_inset


\end_layout

\begin_layout Standard
The bivariate normal PDF is given by the unwieldy formula
\begin_inset Formula \begin{multline}
f_{X,Y}(x,y)=\frac{1}{2\pi\,\sigma_{X}\sigma_{Y}\sqrt{1-\rho^{2}}}\exp\left\{ -\frac{1}{2(1-\rho^{2})}\left[\left(\frac{x-\mu_{X}}{\sigma_{X}}\right)^{2}+\cdots\right.\right.\\
\left.\left.\cdots+2\rho\left(\frac{x-\mu_{X}}{\sigma_{X}}\right)\left(\frac{y-\mu_{Y}}{\sigma_{Y}}\right)+\left(\frac{y-\mu_{Y}}{\sigma_{Y}}\right)^{2}\right]\right\} ,\end{multline}

\end_inset

for 
\begin_inset Formula $(x,y)\in\R^{2}$
\end_inset

.
 We write 
\begin_inset Formula $(X,Y)\sim\mathsf{mvnorm}(\mathtt{mean}=\upmu,\,\mathtt{sigma}=\Sigma)$
\end_inset

, where
\begin_inset Formula \begin{equation}
\upmu=(\mu_{X},\,\mu_{Y})^{T},\quad\sum=\left(\begin{array}{cc}
\sigma_{X}^{2} & \rho\sigma_{X}\sigma_{Y}\\
\rho\sigma_{X}\sigma_{Y} & \sigma_{Y}^{2}\end{array}\right).\end{equation}

\end_inset

See Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Mathematical-Machinery"

\end_inset

.
 The vector notation allows for a more compact rendering of the joint PDF:
\begin_inset Formula \begin{equation}
f_{X,Y}(\mathbf{x})=\frac{1}{2\pi\left|\Sigma\right|^{1/2}}\exp\left\{ -\frac{1}{2}\left(\mathbf{x}-\upmu\right)^{\top}\Sigma^{-1}\left(\mathbf{x}-\upmu\right)\right\} ,\end{equation}

\end_inset

where in an abuse of notation we have written 
\begin_inset Formula $\mathbf{x}$
\end_inset

 for 
\begin_inset Formula $(x,y)$
\end_inset

.
 Note that the formula only holds when 
\begin_inset Formula $\rho\neq\pm1$
\end_inset

.
\end_layout

\begin_layout Remark
In Remark 
\begin_inset CommandInset ref
LatexCommand ref
reference "rem:cov0-not-imply-indep"

\end_inset

 we noted that just because random variables are uncorrelated it does not
 necessarily mean that they are independent.
 However, there is an important exception to this rule: the bivariate normal
 distribution.
 Indeed, 
\begin_inset Formula $(X,Y)\sim\mathsf{mvnorm}(\mathtt{mean}=\upmu,\,\mathtt{sigma}=\Sigma)$
\end_inset

 are independent if and only if 
\begin_inset Formula $\rho=0$
\end_inset

.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Remark
Inspection of the joint PDF shows that if 
\begin_inset Formula $\mu_{X}=\mu_{Y}$
\end_inset

 and 
\begin_inset Formula $\sigma_{X}=\sigma_{Y}$
\end_inset

 then 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are exchangeable.
\end_layout

\begin_layout Standard
The bivariate normal MGF is
\begin_inset Formula \begin{equation}
M_{X,Y}(\mathbf{t})=\exp\left(\upmu^{\top}\mathbf{t}+\frac{1}{2}\mathbf{t}^{\top}\Sigma\mathbf{t}\right),\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{t}=(t_{1},t_{2})$
\end_inset

.
\end_layout

\begin_layout Standard
The bivariate normal distribution may be intimidating at first but it turns
 out to be very tractable compared to other multivariate distributions.
 An example of this is the following fact about the marginals.
\end_layout

\begin_layout Fact
If 
\begin_inset Formula $(X,Y)\sim\mathsf{mvnorm}(\mathtt{mean}=\upmu,\,\mathtt{sigma}=\Sigma)$
\end_inset

 then
\begin_inset Formula \begin{equation}
X\sim\mathsf{norm}(\mathtt{mean}=\mu_{X},\,\mathtt{sd}=\sigma_{X})\mbox{ and }Y\sim\mathsf{norm}(\mathtt{mean}=\mu_{Y},\,\mathtt{sd}=\sigma_{Y}).\end{equation}

\end_inset


\end_layout

\begin_layout Standard
From this we immediately get that 
\begin_inset Formula $\E X=\mu_{X}$
\end_inset

 and 
\begin_inset Formula $\mbox{Var}(X)=\sigma_{X}^{2}$
\end_inset

 (and the same is true for 
\begin_inset Formula $Y$
\end_inset

 with the letters switched).
 And it should be no surprise that the correlation between 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 is exactly 
\begin_inset Formula $\mbox{Corr}(X,Y)=\rho$
\end_inset

.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "pro:mvnorm-cond-dist"

\end_inset

The conditional distribution of 
\begin_inset Formula $Y|\, X=x$
\end_inset

 is 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu_{Y|x},\,\mathtt{sd}=\sigma_{Y|x})$
\end_inset

, where
\begin_inset Formula \begin{equation}
\mu_{Y|x}=\mu_{Y}+\rho\frac{\sigma_{Y}}{\sigma_{X}}\left(x-\mu_{X}\right),\mbox{ and }\sigma_{Y|x}=\sigma_{Y}\sqrt{1-\rho^{2}}.\end{equation}

\end_inset


\end_layout

\begin_layout Standard
There are a few things to note about Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:mvnorm-cond-dist"

\end_inset

 which will be important in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:simple-linear-regression"

\end_inset

.
 First, the conditional mean of 
\begin_inset Formula $Y|x$
\end_inset

 is linear in 
\begin_inset Formula $x$
\end_inset

, with slope
\begin_inset Formula \begin{equation}
\rho\,\frac{\sigma_{Y}}{\sigma_{X}}.\label{eq:population-slope-slr}\end{equation}

\end_inset

Second, the conditional variance of 
\begin_inset Formula $Y|x$
\end_inset

 is independent of 
\begin_inset Formula $x$
\end_inset

.
 
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The multivariate normal distribution is implemented in both the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

mvtnorm
\end_layout

\end_inset

 package 
\begin_inset CommandInset citation
LatexCommand cite
key "Genzmvtnorm"

\end_inset


\color inherit
 and the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

mnormt
\end_layout

\end_inset

 package 
\begin_inset CommandInset citation
LatexCommand cite
key "mnormt"

\end_inset

.
 We use the 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

mvtnorm
\end_layout

\end_inset

 package in this book simply because it is a dependency of another package
 used in the book.

\color inherit
 
\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

mvtnorm
\end_layout

\end_inset

 package has functions 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

dmvnorm
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

rmvnorm
\end_layout

\end_inset

 for the PDF and to generate random vectors, respectively.
 Let us get started with a graph of the bivariate normal PDF.
 We can make the plot with the following code
\color inherit

\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Another way to do this is with the 
\family typewriter
curve3d
\family default
 function in the 
\family typewriter
emdbook
\family default
 package 
\begin_inset CommandInset citation
LatexCommand cite
key "emdbook"

\end_inset

.
 It looks like this:
\end_layout

\begin_layout LyX-Code
library(emdbook); library(mvtnorm)   # note: the order matters
\end_layout

\begin_layout LyX-Code
mu <- c(0,0);  sigma <- diag(2)
\end_layout

\begin_layout LyX-Code
f <- function(x,y) dmvnorm(c(x,y), mean = mu, sigma = sigma)
\end_layout

\begin_layout LyX-Code
curve3d(f(x,y), from = c(-3,-3), to = c(3,3), theta = -30, phi = 30)
\end_layout

\begin_layout Plain Layout
The code above is slightly shorter than that using 
\family typewriter
persp
\family default
 and is easier to understand.
 One must be careful, however.
 If the 
\family typewriter
library
\family default
 calls are swapped then the code will not work because both packages 
\family typewriter
emdbook
\family default
 and 
\family typewriter
mvtnorm
\family default
 have a function called 
\begin_inset Quotes eld
\end_inset


\family typewriter
dmvnorm
\family default

\begin_inset Quotes erd
\end_inset

; one must load them to the search path in the correct order or 
\family sans
R
\family default
 will use the wrong one (the arguments are named differently and the underlying
 algorithms are different).
 
\end_layout

\end_inset

, where 
\color none
the workhorse is the 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

persp
\end_layout

\end_inset

 function in base 
\family sans
\color inherit
R
\family default
\color none
.
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

library(mvtnorm)
\begin_inset Newline newline
\end_inset

x <- y <- seq(from = -3, to = 3, length.out = 30)
\begin_inset Newline newline
\end_inset

f <- function(x,y) dmvnorm(cbind(x,y), mean = c(0,0), sigma = diag(2))
\begin_inset Newline newline
\end_inset

z <- outer(x, y, FUN = f)
\begin_inset Newline newline
\end_inset

persp(x, y, z, theta = -30, phi = 30, ticktype = "detailed")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We chose the standard bivariate normal, 
\begin_inset Formula $\mathsf{mvnorm}(\mathtt{mean}=\mathbf{0},\,\mathtt{sigma}=\mathbf{I})$
\end_inset

, to display.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 8, width = 6>>=
\begin_inset Newline newline
\end_inset

library(mvtnorm)
\begin_inset Newline newline
\end_inset

x <- y <- seq(from = -3, to = 3, length.out = 30)
\begin_inset Newline newline
\end_inset

f <- function(x,y) dmvnorm(cbind(x,y), mean = c(0,0), sigma = diag(2))
\begin_inset Newline newline
\end_inset

z <- outer(x, y, FUN = f)
\begin_inset Newline newline
\end_inset

persp(x, y, z, theta = -30, phi = 30, ticktype = "detailed")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Graph of a bivariate normal PDF
\begin_inset CommandInset label
LatexCommand label
name "fig:mvnorm-pdf"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Bivariate Transformations of Random Variables
\begin_inset CommandInset label
LatexCommand label
name "sec:Transformations-Multivariate"

\end_inset


\end_layout

\begin_layout Standard
We studied in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Functions-of-Continuous"

\end_inset

 how to find the PDF of 
\begin_inset Formula $Y=g(X)$
\end_inset

 given the PDF of 
\begin_inset Formula $X$
\end_inset

.
 But now we have two random variables 
\begin_inset Formula $X$
\end_inset

 and Y, with joint PDF 
\begin_inset Formula $f_{X,Y}$
\end_inset

, and we would like to consider the joint PDF of two new random variables
\begin_inset Formula \begin{equation}
U=g(X,Y)\quad\mbox{and}\quad V=h(X,Y),\end{equation}

\end_inset

where 
\begin_inset Formula $g$
\end_inset

 and 
\begin_inset Formula $h$
\end_inset

 are two given functions, typically 
\begin_inset Quotes eld
\end_inset

nice
\begin_inset Quotes erd
\end_inset

 in the sense of Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Multivariable-Calculus"

\end_inset

.
 
\end_layout

\begin_layout Standard
Suppose that the transformation 
\begin_inset Formula $(x,y)\longmapsto(u,v)$
\end_inset

 is one-to-one.
 Then an inverse transformation 
\begin_inset Formula $x=x(u,v)$
\end_inset

 and 
\begin_inset Formula $y=y(u,v)$
\end_inset

 exists, so let 
\begin_inset Formula $\partial(x,y)/\partial(u,v)$
\end_inset

 denote the Jacobian of the inverse transformation.
 Then the joint PDF of 
\begin_inset Formula $(U,V)$
\end_inset

 is given by
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
f_{U,V}(u,v)=f_{X,Y}\left[x(u,v),\, y(u,v)\right]\left|\frac{\partial(x,y)}{\partial(u,v)}\right|,\end{equation}

\end_inset

or we can rewrite more shortly as
\begin_inset Formula \begin{equation}
f_{U,V}(u,v)=f_{X,Y}(x,y)\left|\frac{\partial(x,y)}{\partial(u,v)}\right|.\label{eq:biv-trans-pdf-short}\end{equation}

\end_inset

Take a moment and compare Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:biv-trans-pdf-short"

\end_inset

 to Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:univ-trans-pdf-short"

\end_inset

.
 Do you see the connection?
\end_layout

\begin_layout Remark
It is sometimes easier to 
\emph on
postpone
\emph default
 solving for the inverse transformation 
\begin_inset Formula $x=x(u,v)$
\end_inset

 and 
\begin_inset Formula $y=y(u,v)$
\end_inset

.
 Instead, leave the transformation in the form 
\begin_inset Formula $u=u(x,y)$
\end_inset

 and 
\begin_inset Formula $v=v(x,y)$
\end_inset

 and calculate the Jacobian of the 
\emph on
original
\emph default
 transformation
\begin_inset Formula \begin{equation}
\frac{\partial(u,v)}{\partial(x,y)}=\left|\begin{array}{cc}
\frac{\partial u}{\partial x} & \frac{\partial u}{\partial y}\\
\frac{\partial v}{\partial x} & \frac{\partial v}{\partial y}\end{array}\right|=\frac{\partial u}{\partial x}\frac{\partial v}{\partial y}-\frac{\partial u}{\partial y}\frac{\partial v}{\partial x}.\end{equation}

\end_inset

Once this is known, we can get the PDF of 
\begin_inset Formula $(U,V)$
\end_inset

 by
\begin_inset Formula \begin{equation}
f_{U,V}(u,v)=f_{X,Y}(x,y)\left|\frac{1}{\frac{\partial(u,v)}{\partial(x,y)}}\right|.\end{equation}

\end_inset

In some cases there will be a cancellation and the work will be a lot shorter.
 Of course, it is not always true that
\begin_inset Formula \begin{equation}
\frac{\partial(x,y)}{\partial(u,v)}=\frac{1}{\frac{\partial(u,v)}{\partial(x,y)}},\label{eq:biv-jacob-recip}\end{equation}

\end_inset

but for the well-behaved examples that we will see in this book it works
 just fine\SpecialChar \ldots{}
 do you see the connection between Equations 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:biv-jacob-recip"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:univ-jacob-recip"

\end_inset

?
\end_layout

\begin_layout Example
Let 
\begin_inset Formula $(X,Y)\sim\mathsf{mvnorm}(\mathtt{mean}=\mathbf{0}_{2\times1},\,\mathtt{sigma}=\mathbf{I}_{2\times2})$
\end_inset

 and consider the transformation
\begin_inset Formula \begin{align*}
U= & \ 3X+4Y,\\
V= & \ 5X+6Y.\end{align*}

\end_inset

We can solve the system of equations to find the inverse transformations;
 they are
\begin_inset Formula \begin{align*}
X= & -3U+2V,\\
Y= & \ \frac{5}{2}U-\frac{3}{2}V,\end{align*}

\end_inset

in which case the Jacobian of the inverse transformation is
\begin_inset Formula \[
\begin{vmatrix}-3 & 2\\
\frac{5}{2} & -\frac{3}{2}\end{vmatrix}=3\left(-\frac{3}{2}\right)-2\left(\frac{5}{2}\right)=-\frac{1}{2}.\]

\end_inset

As 
\begin_inset Formula $(x,y)$
\end_inset

 traverses 
\begin_inset Formula $\R^{2}$
\end_inset

, so too does 
\begin_inset Formula $(u,v)$
\end_inset

.
 Since the joint PDF of 
\begin_inset Formula $(X,Y)$
\end_inset

 is
\begin_inset Formula \[
f_{X,Y}(x,y)=\frac{1}{2\pi}\exp\left\{ -\frac{1}{2}\left(x^{2}+y^{2}\right)\right\} ,\quad(x,y)\in\R^{2},\]

\end_inset

we get that the joint PDF of 
\begin_inset Formula $(U,V)$
\end_inset

 is
\end_layout

\begin_layout Example
\begin_inset Formula \begin{equation}
f_{U,V}(u,v)=\frac{1}{2\pi}\exp\left\{ -\frac{1}{2}\left[\left(-3u+2v\right)^{2}+\left(\frac{5u-3v}{2}\right)^{2}\right]\right\} \cdot\frac{1}{2},\quad(u,v)\in\R^{2}.\label{eq:biv-norm-hidden}\end{equation}

\end_inset


\end_layout

\begin_layout Remark
It may not be obvious, but Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:biv-norm-hidden"

\end_inset

 is the PDF of a 
\begin_inset Formula $\mathsf{mvnorm}$
\end_inset

 distribution.
 For a more general result see Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:mvnorm-dist-matrix-prod"

\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\begin_inset CommandInset label
LatexCommand label
name "sub:bivariate-transf-R"

\end_inset


\end_layout

\begin_layout Standard
It is possible to do the computations above in 
\family sans
R
\family default
 with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Ryacas
\end_layout

\end_inset

 package.
 The package is an interface to the open-source computer algebra system,
 
\begin_inset Quotes eld
\end_inset

Yacas
\begin_inset Quotes erd
\end_inset

.
 The user installs Yacas, then employs 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Ryacas
\end_layout

\end_inset

 to submit commands to Yacas, after which the output is displayed in the
 
\family sans
\color inherit
R
\family default
\color none
 console.
\end_layout

\begin_layout Standard

\color none
There are not yet any examples of Yacas in this book, but there are online
 materials to help the interested reader: see 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://code.google.com/p/ryacas/
\end_layout

\end_inset

 to get started.
\end_layout

\begin_layout Section
Remarks for the Multivariate Case
\begin_inset CommandInset label
LatexCommand label
name "sec:Remarks-for-the-Multivariate"

\end_inset


\end_layout

\begin_layout Standard
There is nothing spooky about 
\begin_inset Formula $n\geq3$
\end_inset

 random variables.
 We just have a whole bunch of them: 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

,\SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

, which we can shorten to 
\begin_inset Formula $\mathbf{X}=(X_{1},X_{2},\ldots,X_{n})^{\mathrm{T}}$
\end_inset

 to make the formulas prettier (now may be a good time to check out Appendix
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Linear-Algebra"

\end_inset

).
 For 
\begin_inset Formula $\mathbf{X}$
\end_inset

 supported on the set 
\begin_inset Formula $S_{\mathbf{X}}$
\end_inset

, the joint PDF 
\begin_inset Formula $f_{\mathbf{X}}$
\end_inset

 (if it exists) satisfies
\begin_inset Formula \begin{equation}
f_{\mathbf{X}}(\mathbf{x})>0,\quad\mbox{for }\mathbf{x}\in S_{\mathbf{X}},\end{equation}

\end_inset

and
\begin_inset Formula \begin{equation}
\int\!\!\!\int\cdots\int f_{\mathbf{X}}(\mathbf{x})\,\diff x_{1}\diff x_{2}\cdots\diff x_{n}=1,\end{equation}

\end_inset

or even shorter: 
\begin_inset Formula $\int f_{\mathbf{X}}(\mathbf{x})\,\diff\mathbf{x}=1$
\end_inset

.
 The joint CDF 
\begin_inset Formula $F_{\mathbf{X}}$
\end_inset

 is defined by 
\begin_inset Formula \begin{equation}
F_{\mathbf{X}}(\mathbf{x})=\P(X_{1}\leq x_{1},\, X_{2}\leq x_{2},\ldots,\, X_{n}\leq x_{n}),\end{equation}

\end_inset

for 
\begin_inset Formula $\mathbf{x}\in\R^{n}$
\end_inset

.
 The expectation of a function 
\begin_inset Formula $g(\mathbf{X})$
\end_inset

 is defined just as we would imagine:
\begin_inset Formula \begin{equation}
\E g(\mathbf{X})=\int g(\mathbf{x})\, f_{\mathbf{X}}(\mathbf{x})\,\diff\mathbf{x}.\end{equation}

\end_inset

provided the integral exists and is finite.
 And the moment generating function in the multivariate case is defined
 by
\begin_inset Formula \begin{eqnarray}
M_{\mathbf{X}}(\mathbf{t}) & = & \E\exp\left\{ \mathbf{t}^{\mathrm{T}}\mathbf{X}\right\} ,\end{eqnarray}

\end_inset

whenever the integral exists and is finite for all 
\begin_inset Formula $\mathbf{t}$
\end_inset

 in a neighborhood of 
\begin_inset Formula $\mathbf{0}_{\mathrm{n}\times1}$
\end_inset

 (note that 
\begin_inset Formula $\mathbf{t}^{\mathrm{T}}\mathbf{X}$
\end_inset

 is shorthand for 
\begin_inset Formula $t_{1}X_{1}+t_{2}X_{2}+\cdots+t_{n}X_{n}$
\end_inset

).
 The only difference in any of the above for the discrete case is that integrals
 are replaced by sums.
 
\end_layout

\begin_layout Standard
Marginal distributions are obtained by integrating out remaining variables
 from the joint distribution.
 And even if we are given all of the univariate marginals it is not enough
 to determine the joint distribution uniquely.
\end_layout

\begin_layout Standard
We say that 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 are 
\emph on
mutually independent
\emph default
 if their joint PDF factors into the product of the marginals
\begin_inset Formula \begin{equation}
f_{\mathbf{X}}(\mathbf{x})=f_{X_{1}}(x_{1})\, f_{X_{2}}(x_{2})\,\cdots\, f_{X_{n}}(x_{n}),\end{equation}

\end_inset

for every 
\begin_inset Formula $\mathbf{x}$
\end_inset

 in their joint support 
\begin_inset Formula $S_{\mathbf{X}}$
\end_inset

, and we say that 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 are 
\emph on
exchangeable
\emph default
 if their joint PDF (or CDF) is a symmetric function of its 
\begin_inset Formula $n$
\end_inset

 arguments, that is, if 
\begin_inset Formula \begin{equation}
f_{\mathbf{X}}(\mathbf{x^{\ast}})=f_{\mathbf{X}}(\mathbf{x}),\end{equation}

\end_inset

for any reordering 
\begin_inset Formula $\mathbf{x^{\ast}}$
\end_inset

 of the elements of 
\begin_inset Formula $\mathbf{x}=(x_{1},x_{2},\ldots,x_{n})$
\end_inset

 in the joint support.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "pro:mean-sd-lin-comb"

\end_inset

Let 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 be independent with respective population means 
\begin_inset Formula $\mu_{1}$
\end_inset

, 
\begin_inset Formula $\mu_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $\mu_{n}$
\end_inset

 and standard deviations 
\begin_inset Formula $\sigma_{1}$
\end_inset

, 
\begin_inset Formula $\sigma_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $\sigma_{n}$
\end_inset

.
 For given constants 
\begin_inset Formula $a_{1}$
\end_inset

, 
\begin_inset Formula $a_{2}$
\end_inset

, \SpecialChar \ldots{}
,
\begin_inset Formula $a_{n}$
\end_inset

 define 
\begin_inset Formula $Y=\sum_{i=1}^{n}a_{i}X_{i}$
\end_inset

.
 Then the mean and standard deviation of 
\begin_inset Formula $Y$
\end_inset

 are given by the formulas
\begin_inset Formula \begin{equation}
\mu_{Y}=\sum_{i=1}^{n}a_{i}\mu_{i},\quad\sigma_{Y}=\left(\sum_{i=1}^{n}a_{i}^{2}\sigma_{i}^{2}\right)^{1/2}.\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Branch proofs
status open

\begin_layout Proof
The mean is easy:
\begin_inset Formula \[
\E Y=\E\left(\sum_{i=1}^{n}a_{i}X_{i}\right)=\sum_{i=1}^{n}a_{i}\E X_{i}=\sum_{i=1}^{n}a_{i}\mu_{i}.\]

\end_inset

The variance is not too difficult to compute either.
 As an intermediate step, we calculate 
\begin_inset Formula $\E Y^{2}$
\end_inset

.
 
\begin_inset Formula \[
\E Y^{2}=\E\left(\sum_{i=1}^{n}a_{i}X_{i}\right)^{2}=\E\left(\sum_{i=1}^{n}a_{i}^{2}X_{i}^{2}+2\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}a_{i}a_{j}X_{i}X_{j}\right).\]

\end_inset

Using linearity of expectation the 
\begin_inset Formula $\E$
\end_inset

 distributes through the sums.
 Now 
\begin_inset Formula $\E X_{i}^{2}=\sigma_{i}^{2}+\mu_{i}^{2}$
\end_inset

 and 
\begin_inset Formula $\E X_{i}X_{j}=\E X_{i}\E X_{j}=\mu_{i}\mu_{j}$
\end_inset

 when 
\begin_inset Formula $i\neq j$
\end_inset

 because of independence.
 Thus
\begin_inset Formula \begin{eqnarray*}
\E Y^{2} & = & \sum_{i=1}^{n}a_{i}^{2}(\sigma_{i}^{2}+\mu_{i}^{2})+2\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}a_{i}a_{j}\mu_{i}\mu_{j}\\
 & = & \sum_{i=1}^{n}a_{i}^{2}\sigma_{i}^{2}+\left(\sum_{i=1}^{n}a_{i}^{2}\mu_{i}^{2}+2\sum_{i=1}^{n-1}\sum_{j=i+1}^{n}a_{i}a_{j}\mu_{i}\mu_{j}\right)\end{eqnarray*}

\end_inset

To complete the proof, note that the expression in the parentheses is exactly
 
\begin_inset Formula $\left(\E Y\right)^{2}$
\end_inset

, and recall the identity 
\begin_inset Formula $\sigma_{Y}^{2}=\E Y^{2}-\left(\E Y\right)^{2}$
\end_inset

.
 
\end_layout

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
There is a corresponding statement of Fact 
\begin_inset CommandInset ref
LatexCommand ref
reference "fac:indep-then-function-indep"

\end_inset

 for the multivariate case.
 The proof is also omitted here.
\end_layout

\begin_layout Fact
If 
\begin_inset Formula $\mathbf{X}$
\end_inset

 and 
\begin_inset Formula $\mathbf{Y}$
\end_inset

 are mutually independent random vectors, then 
\begin_inset Formula $u(\mathbf{X})$
\end_inset

 and 
\begin_inset Formula $v(\mathbf{Y})$
\end_inset

 are independent for any functions 
\begin_inset Formula $u$
\end_inset

 and 
\begin_inset Formula $v$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
Bruno de Finetti was a strong proponent of the subjective approach to probabilit
y.
 He proved an important theorem in 1931 which illuminates the link between
 exchangeable random variables and independent random variables.
 Here it is in one of its simplest forms.
\end_layout

\begin_layout Theorem
De Finetti's Theorem.
 Let 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
 be a sequence of 
\begin_inset Formula $\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)$
\end_inset

 random variables such that 
\begin_inset Formula $(X_{1},\ldots,X_{k})$
\end_inset

 are exchangeable for every 
\begin_inset Formula $k$
\end_inset

.
 Then there exists a random variable 
\begin_inset Formula $\Theta$
\end_inset

 with support 
\begin_inset Formula $[0,1]$
\end_inset

 and PDF 
\begin_inset Formula $f_{\Theta}(\theta)$
\end_inset

 such that
\begin_inset Formula \begin{equation}
\P(X_{1}=x_{1},\ldots,\, X_{k}=x_{k})=\int_{0}^{1}\theta^{\sum x_{i}}(1-\theta)^{k-\sum x_{i}}\, f_{\Theta}(\theta)\,\diff\theta,\label{eq:definetti-binary}\end{equation}

\end_inset

for all 
\begin_inset Formula $x_{i}=0,\,1$
\end_inset

, 
\begin_inset Formula $i=1,\,2,\ldots,k$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
To get a handle on the intuitive content de Finetti's theorem, imagine that
 we have a 
\emph on
bunch
\emph default
 of coins in our pocket with each having its own unique value of 
\begin_inset Formula $\theta=\P(\mbox{Heads})$
\end_inset

.
 We reach into our pocket and select a coin at random according to some
 probability -- say, 
\begin_inset Formula $f_{\Theta}(\theta)$
\end_inset

.
 We take the randomly selected coin and flip it 
\begin_inset Formula $k$
\end_inset

 times.
 
\end_layout

\begin_layout Standard
Think carefully: the conditional probability of observing a sequence 
\begin_inset Formula $X_{1}=x_{1},\ldots,\, X_{k}=x_{k}$
\end_inset

, given a specific coin 
\begin_inset Formula $\theta$
\end_inset

 would just be 
\begin_inset Formula $\theta^{\sum x_{i}}(1-\theta)^{k-\sum x_{i}}$
\end_inset

, because the coin flips are an independent sequence of Bernoulli trials.
 But the coin is random, so the Theorem of Total Probability says we can
 get the 
\emph on
unconditional
\emph default
 probability 
\begin_inset Formula $\P(X_{1}=x_{1},\ldots,\, X_{k}=x_{k})$
\end_inset

 by adding up terms that look like
\begin_inset Formula \begin{equation}
\theta^{\sum x_{i}}(1-\theta)^{k-\sum x_{i}}\, f_{\Theta}(\theta),\end{equation}

\end_inset

where we sum over all possible coins.
 The right-hand side of Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:definetti-binary"

\end_inset

 is a sophisticated way to denote this process.
\end_layout

\begin_layout Standard
Of course, the integral's value does not change if we jumble the 
\begin_inset Formula $x_{i}$
\end_inset

's, so 
\begin_inset Formula $(X_{1},\ldots,X_{k})$
\end_inset

 are clearly exchangeable.
 The power of de Finetti's Theorem is that 
\emph on
every
\emph default
 infinite binary exchangeable sequence can be written in the above form.
\end_layout

\begin_layout Standard
The connection to subjective probability: our prior information about 
\begin_inset Formula $\theta$
\end_inset

 corresponds to 
\begin_inset Formula $f_{\Theta}(\theta)$
\end_inset

 and the likelihood of the sequence 
\begin_inset Formula $X_{1}=x_{1},\ldots,\, X_{k}=x_{k}$
\end_inset

 (conditional on 
\begin_inset Formula $\theta$
\end_inset

) corresponds to 
\begin_inset Formula $\theta^{\sum x_{i}}(1-\theta)^{k-\sum x_{i}}$
\end_inset

.
 Compare Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:definetti-binary"

\end_inset

 to Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Bayes'-Rule"

\end_inset

 and Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Conditional-Distributions"

\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
The multivariate normal distribution immediately generalizes from the bivariate
 case.
 If the matrix 
\begin_inset Formula $\Sigma$
\end_inset

 is nonsingular then the joint PDF of 
\begin_inset Formula $\mathbf{X}\sim\mathsf{mvnorm}(\mathtt{mean}=\upmu,\,\mathtt{sigma}=\Sigma)$
\end_inset

 is
\begin_inset Formula \begin{equation}
f_{\mathbf{X}}(\mathbf{x})=\frac{1}{(2\pi)^{n/2}\left|\Sigma\right|^{1/2}}\exp\left\{ -\frac{1}{2}\left(\mathbf{x}-\upmu\right)^{\top}\Sigma^{-1}\left(\mathbf{x}-\upmu\right)\right\} ,\end{equation}

\end_inset

and the MGF is
\begin_inset Formula \begin{equation}
M_{\mathbf{X}}(\mathbf{t})=\exp\left\{ \upmu^{\top}\mathbf{t}+\frac{1}{2}\mathbf{t}^{\top}\Sigma\mathbf{t}\right\} .\end{equation}

\end_inset

We will need the following in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:multiple-linear-regression"

\end_inset

.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:mvnorm-dist-matrix-prod"

\end_inset

If 
\begin_inset Formula $\mathbf{X}\sim\mathsf{mvnorm}(\mathtt{mean}=\upmu,\,\mathtt{sigma}=\Sigma)$
\end_inset

 and 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is any matrix, then the random vector 
\begin_inset Formula $\mathbf{Y}=\mathbf{AX}$
\end_inset

 is distributed
\begin_inset Formula \begin{equation}
\mathbf{Y}\sim\mathsf{mvnorm}(\mathtt{mean}=\mathbf{A}\upmu,\,\mathtt{sigma}=\mathbf{A}\Sigma\mathbf{A}^{\mathrm{T}}).\end{equation}

\end_inset


\end_layout

\begin_layout Proof
Look at the MGF of 
\begin_inset Formula $\mathbf{Y}$
\end_inset

:
\begin_inset Formula \begin{eqnarray*}
M_{\mathbf{Y}}(\mathbf{t}) & = & \E\,\exp\left\{ \mathbf{t}^{\mathrm{T}}(\mathbf{AX})\right\} ,\\
 & = & \E\,\exp\left\{ (\mathbf{A}^{\mathrm{T}}\mathbf{t})^{\mathrm{T}}\mathbf{X}\right\} ,\\
 & = & \exp\left\{ \upmu^{\mathrm{T}}(\mathbf{A}^{\top}\mathbf{t})+\frac{1}{2}(\mathbf{A}^{\mathrm{T}}\mathbf{t})^{\mathrm{T}}\Sigma(\mathbf{A}^{\mathrm{T}}\mathbf{t})\right\} ,\\
 & = & \exp\left\{ \left(\mathbf{A}\upmu\right)^{\mathrm{T}}\mathbf{t}+\frac{1}{2}\mathbf{t}^{\mathrm{T}}\left(\mathbf{A}\Sigma\mathbf{A}^{\mathrm{T}}\right)\mathbf{t}\right\} ,\end{eqnarray*}

\end_inset

and the last expression is the MGF of an 
\begin_inset Formula $\mathsf{mvnorm}(\mathtt{mean}=\mathbf{A}\upmu,\,\mathtt{sigma}=\mathbf{A}\Sigma\mathbf{A}^{\mathrm{T}})$
\end_inset

 distribution.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Section
The Multinomial Distribution
\begin_inset CommandInset label
LatexCommand label
name "sec:Multinomial"

\end_inset


\end_layout

\begin_layout Standard
We sample 
\begin_inset Formula $n$
\end_inset

 times, with replacement, from an urn that contains balls of 
\begin_inset Formula $k$
\end_inset

 different types.
 Let 
\begin_inset Formula $X_{1}$
\end_inset

 denote the number of balls in our sample of type 1, let 
\begin_inset Formula $X_{2}$
\end_inset

 denote the number of balls of type 2, \SpecialChar \ldots{}
 , and let 
\begin_inset Formula $X_{k}$
\end_inset

 denote the number of balls of type 
\begin_inset Formula $k$
\end_inset

.
 Suppose the urn has proportion 
\begin_inset Formula $p_{1}$
\end_inset

 of balls of type 1, proportion 
\begin_inset Formula $p_{2}$
\end_inset

 of balls of type 2, \SpecialChar \ldots{}
, and proportion 
\begin_inset Formula $p_{k}$
\end_inset

 of balls of type 
\begin_inset Formula $k$
\end_inset

.
 Then the joint PMF of 
\begin_inset Formula $(X_{1},\ldots,X_{k})$
\end_inset

 is
\begin_inset Formula \begin{eqnarray}
f_{X_{1},\ldots,X_{k}}(x_{1},\ldots,x_{k}) & = & {n \choose x_{1}\, x_{2}\,\cdots\, x_{k}}\, p_{1}^{x_{1}}p_{2}^{x_{2}}\cdots p_{k}^{x_{k}},\end{eqnarray}

\end_inset

for 
\begin_inset Formula $(x_{1},\ldots,x_{k})$
\end_inset

 in the joint support 
\begin_inset Formula $S_{X_{1},\ldots X_{K}}$
\end_inset

.
 We write
\begin_inset Formula \begin{equation}
(X_{1},\ldots,X_{k})\sim\mathsf{multinom}(\mathtt{size}=n,\,\mathtt{prob}=\mathbf{p}_{\mathrm{k}\times1}).\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Several comments are in order.
 First, the joint support set 
\begin_inset Formula $S_{X_{1},\ldots X_{K}}$
\end_inset

 contains all nonnegative integer 
\begin_inset Formula $k$
\end_inset

-tuples 
\begin_inset Formula $(x_{1},\ldots,x_{k})$
\end_inset

 such that 
\begin_inset Formula $x_{1}+x_{2}+\cdots+x_{k}=n$
\end_inset

.
 A support set like this is called a 
\emph on
simplex
\emph default
.
 Second, the proportions 
\begin_inset Formula $p_{1}$
\end_inset

, 
\begin_inset Formula $p_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $p_{k}$
\end_inset

 satisfy 
\begin_inset Formula $p_{i}\geq0$
\end_inset

 for all 
\begin_inset Formula $i$
\end_inset

 and 
\begin_inset Formula $p_{1}+p_{2}+\cdots+p_{k}=1$
\end_inset

.
 Finally, the symbol
\begin_inset Formula \begin{equation}
{n \choose x_{1}\, x_{2}\,\cdots\, x_{k}}=\frac{n!}{x_{1}!\, x_{2}!\,\cdots x_{k}!}\end{equation}

\end_inset

is called a 
\emph on
multinomial coefficient
\emph default
 which generalizes the notion of a binomial coefficient we saw in Equation
 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:binomial-coefficient"

\end_inset

.
 
\end_layout

\begin_layout Standard
The form and notation we have just described matches the 
\family sans
R
\family default
 usage but is not standard among other texts.
 Most other books use the above for a 
\begin_inset Formula $k-1$
\end_inset

 dimension multinomial distribution, because the linear constraint 
\begin_inset Formula $x_{1}+x_{2}+\cdots+x_{k}=n$
\end_inset

 means that once the values of 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{k-1}$
\end_inset

 are known the final value 
\begin_inset Formula $X_{k}$
\end_inset

 is determined, not random.
 Another term used for this is a 
\emph on
singular
\emph default
 distribution.
\end_layout

\begin_layout Standard
For the most part we will ignore these difficulties, but the careful reader
 should keep them in mind.
 There is not much of a difference in practice, except that below we will
 use a two-dimensional support set for a three-dimension multinomial distributio
n.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:multinom-pmf2"

\end_inset

.
 
\end_layout

\begin_layout Standard
When 
\begin_inset Formula $k=2$
\end_inset

, we have 
\begin_inset Formula $x_{1}=x$
\end_inset

 and 
\begin_inset Formula $x_{2}=n-x$
\end_inset

, we have 
\begin_inset Formula $p_{1}=p$
\end_inset

 and 
\begin_inset Formula $p_{2}=1-p$
\end_inset

, and the multinomial coefficient is literally a binomial coefficient.
 In the previous notation we have thus shown that the 
\begin_inset Formula $\mathsf{multinom}(\mathtt{size}=n,\,\mathtt{prob}=\mathbf{p}_{2\times1})$
\end_inset

 distribution is the same as a 
\begin_inset Formula $\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)$
\end_inset

 distribution.
\end_layout

\begin_layout Example
Dinner with Barack Obama.
 During the 2008 U.S.
\begin_inset space ~
\end_inset

presidential primary, Barack Obama offered to have dinner with three randomly
 selected monetary contributors to his campaign.
 Imagine the thousands of people in the contributor database.
 For the sake of argument, Suppose that the database was approximately represent
ative of the U.S.
\begin_inset space ~
\end_inset

population as a whole, Suppose Barack Obama wants to have dinner 
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://pewresearch.org/pubs/773/fewer-voters-identify-as-republicans
\end_layout

\end_inset

 36 democrat, 27 republican , 37 independent.
\end_layout

\begin_layout Remark
Here are some facts about the multinomial distribution.
\end_layout

\begin_deeper
\begin_layout Enumerate
The expected value of 
\begin_inset Formula $(X_{1},\, X_{2},\,\ldots,\, X_{k})$
\end_inset

 is 
\begin_inset Formula $n\mathbf{p}_{k\times1}$
\end_inset

.
\end_layout

\begin_layout Enumerate
The variance-covariance matrix 
\begin_inset Formula $\Sigma$
\end_inset

 is symmetric with diagonal entries 
\begin_inset Formula $\sigma_{i}^{2}=np_{i}(1-p_{i})$
\end_inset

, 
\begin_inset Formula $i=1,\,2,\,\ldots,\, k$
\end_inset

 and off-diagonal entries 
\begin_inset Formula $\mbox{Cov}(X_{i},\, X_{j})=-np_{i}p_{j}$
\end_inset

, for 
\begin_inset Formula $i\neq j$
\end_inset

.
 The correlation between 
\begin_inset Formula $X_{i}$
\end_inset

 and 
\begin_inset Formula $X_{j}$
\end_inset

 is therefore 
\begin_inset Formula $\mbox{Corr}(X_{i},\, X_{j})=-\sqrt{p_{i}p_{j}/(1-p_{i})(1-p_{j})}$
\end_inset

.
\end_layout

\begin_layout Enumerate
The marginal distribution of 
\begin_inset Formula $(X_{1},\, X_{2},\,\ldots,\, X_{k-1})$
\end_inset

 is 
\begin_inset Formula $\mathsf{multinom}(\mathtt{size}=n,\,\mathtt{prob}=\mathbf{p}_{(k-1)\times1})$
\end_inset

 with
\begin_inset Formula \begin{equation}
\mathbf{p}_{(k-1)\times1}=\left(p_{1},\, p_{2},\,\ldots,\, p_{k-2},\, p_{k-1}+p_{k}\right),\end{equation}

\end_inset

 and in particular, 
\begin_inset Formula $X_{i}\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p_{i})$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
There is support for the multinomial distribution in base 
\family sans
R
\family default
, namely in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stats
\end_layout

\end_inset


\color inherit
 package.
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dmultinom
\end_layout

\end_inset


\color inherit
 function represents the PMF and the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rmultinom
\end_layout

\end_inset

 function generates random variates.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(combinat)
\begin_inset Newline newline
\end_inset

tmp <- t(xsimplex(3, 6))
\begin_inset Newline newline
\end_inset

p <- apply(tmp, MARGIN = 1, FUN = dmultinom, prob = c(36,27,37))
\begin_inset Newline newline
\end_inset

library(prob)
\begin_inset Newline newline
\end_inset

S <- probspace(tmp, probs = p)
\begin_inset Newline newline
\end_inset

ProbTable <- xtabs(probs ~ X1 + X2, data = S)
\begin_inset Newline newline
\end_inset

round(ProbTable, 3)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Do some examples of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rmultinom
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
Here is another way to do it
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Another way to do the plot is with the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

scatterplot3d
\end_layout

\end_inset


\color inherit
 function in the 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

scatterplot3d
\end_layout

\end_inset


\color inherit
 package 
\begin_inset CommandInset citation
LatexCommand cite
key "Liggesscatterplot3d"

\end_inset

.
 It looks like this:
\end_layout

\begin_layout LyX-Code
library(scatterplot3d)
\end_layout

\begin_layout LyX-Code
X <- t(as.matrix(expand.grid(0:6, 0:6)))
\end_layout

\begin_layout LyX-Code
X <- X[ , colSums(X) <= 6]; X <- rbind(X, 6 - colSums(X))
\end_layout

\begin_layout LyX-Code
Z <- round(apply(X, 2, function(x) dmultinom(x, prob = 1:3)), 3)
\end_layout

\begin_layout LyX-Code
A <- data.frame(x = X[1, ], y = X[2, ], probability = Z)
\end_layout

\begin_layout LyX-Code
scatterplot3d(A, type = 
\begin_inset Quotes eld
\end_inset

h
\begin_inset Quotes erd
\end_inset

, lwd = 3, box = FALSE)
\end_layout

\begin_layout Plain Layout
The 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

scatterplot3d
\end_layout

\end_inset


\color inherit
 graph looks better in this example, but the code is clearly more difficult
 to understand.
 And with 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

cloud
\end_layout

\end_inset


\color inherit
 one can easily do conditional plots of the form 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

cloud(z ~ x + y|f)
\end_layout

\end_inset


\color inherit
, where 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

f
\end_layout

\end_inset


\color inherit
 is a factor.
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

library(lattice)
\begin_inset Newline newline
\end_inset

print(cloud(probs ~ X1 + X2, data = S, type = c("p","h"), lwd = 2, pch =
 16, cex = 1.5), screen = list(z = 15, x = -70))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Plot of a multinomial PMF
\begin_inset CommandInset label
LatexCommand label
name "fig:multinom-pmf2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Chapter Exercises
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{section}{Chapter Exercises}
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{thm}{0}
\end_layout

\end_inset


\end_layout

\begin_layout Scrap

\end_layout

\begin_layout Exercise
Prove that 
\begin_inset Formula $\mbox{Cov}(X,Y)=\E(XY)-(\E X)(\E Y).$
\end_inset


\begin_inset CommandInset label
LatexCommand label
name "xca:Prove-cov-shortcut"

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Exercise
\begin_inset CommandInset label
LatexCommand label
name "xca:sum-indep-chisq"

\end_inset

Suppose 
\begin_inset Formula $X\sim\mathsf{chisq}(\mathtt{df}=p_{1})$
\end_inset

 and 
\begin_inset Formula $Y\sim\mathsf{chisq}(\mathtt{df}=p_{2})$
\end_inset

 are independent.
 Find the distribution of 
\begin_inset Formula $X+Y$
\end_inset

 (you may want to refer to Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:mgf-chisq"

\end_inset

).
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Exercise
\begin_inset CommandInset label
LatexCommand label
name "xca:diff-indep-norm"

\end_inset

Show that when 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are independent the MGF of 
\begin_inset Formula $X-Y$
\end_inset

 is 
\begin_inset Formula $M_{X}(t)M_{Y}(-t)$
\end_inset

.
 Use this to find the distribution of 
\begin_inset Formula $X-Y$
\end_inset

 when 
\begin_inset Formula $X\sim\mathsf{norm}(\mathtt{mean}=\mu_{1},\,\mathtt{sd}=\sigma_{1})$
\end_inset

 and 
\begin_inset Formula $Y\sim\mathsf{norm}(\mathtt{mean}=\mu_{2},\,\mathtt{sd}=\sigma_{2})$
\end_inset

 are independent.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Chapter
Sampling Distributions
\begin_inset CommandInset label
LatexCommand label
name "cha:Sampling-Distributions"

\end_inset


\end_layout

\begin_layout Standard
\noindent
This is an important chapter; it is the bridge from probability and descriptive
 statistics that we studied in Chapters 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Describing-Data-Distributions"

\end_inset

 through 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Multivariable-Distributions"

\end_inset

 to inferential statistics which forms the latter part of this book.
\end_layout

\begin_layout Standard
Here is the link: we are presented with a 
\emph on
population
\emph default
 about which we would like to learn.
 And while it would be desirable to examine every single member of the populatio
n, we find that it is either impossible or infeasible to for us to do so,
 thus, we resort to collecting a 
\emph on
sample
\emph default
 instead.
 We do not lose heart.
 Our method will suffice, provided the sample is 
\emph on
representative
\emph default
 of the population.
 A good way to achieve this is to sample 
\emph on
randomly
\emph default
 from the population.
\end_layout

\begin_layout Standard
Supposing for the sake of argument that we have collected a random sample,
 the next task is to make some 
\emph on
sense
\emph default
 out of the data because the complete list of sample information is usually
 cumbersome, unwieldy.
 We summarize the data set with a descriptive 
\emph on
statistic
\emph default
, a quantity calculated from the data (we saw many examples of these in
 Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Describing-Data-Distributions"

\end_inset

).
 But our sample was random\SpecialChar \ldots{}
 therefore, it stands to reason that our statistic
 will be random, too.
 How is the statistic distributed?
\end_layout

\begin_layout Standard
The probability distribution associated with the population (from which
 we sample) is called the 
\emph on
population distribution
\emph default
, and the probability distribution associated with our statistic is called
 its 
\emph on
sampling distribution
\emph default
; clearly, the two are interrelated.
 To learn about the population distribution, it is imperative to know everything
 we can about the sampling distribution.
 Such is the goal of this chapter.
\end_layout

\begin_layout Standard
We begin by introducing the notion of simple random samples and cataloguing
 some of their more convenient mathematical properties.
 Next we focus on what happens in the special case of sampling from the
 normal distribution (which, again, has several convenient mathematical
 properties), and in particular, we meet the sampling distribution of 
\begin_inset Formula $\Xbar$
\end_inset

 and 
\begin_inset Formula $S^{2}$
\end_inset

.
 Then we explore what happens to 
\begin_inset Formula $\Xbar$
\end_inset

's sampling distribution when the population is not normal and prove one
 of the most remarkable theorems in statistics, the Central Limit Theorem
 (CLT).
\end_layout

\begin_layout Standard
With the CLT in hand, we then investigate the sampling distributions of
 several other popular statistics, taking full advantage of those with a
 tractable form.
 We finish the chapter with an exploration of statistics whose sampling
 distributions are not quite so tractable, and to accomplish this goal we
 will use simulation methods that are grounded in all of our work in the
 previous four chapters.
\end_layout

\begin_layout Paragraph*
What do I want them to know?
\end_layout

\begin_layout Itemize
the notion of population versus simple random sample, parameter versus statistic
, and population distribution versus sampling distribution
\end_layout

\begin_layout Itemize
the classical sampling distributions of the standard one and two sample
 statistics
\end_layout

\begin_layout Itemize
how to generate a simulated sampling distribution when the statistic is
 crazy
\end_layout

\begin_layout Itemize
the Central Limit Theorem, period.
\end_layout

\begin_layout Itemize
some basic concepts related to sampling distribution utility, such as bias
 and variance
\end_layout

\begin_layout Section
Simple Random Samples
\begin_inset CommandInset label
LatexCommand label
name "sec:simple-random-samples"

\end_inset


\end_layout

\begin_layout Subsection
Simple Random Samples
\begin_inset CommandInset label
LatexCommand label
name "sub:simple-random-samples"

\end_inset


\end_layout

\begin_layout Definition
If 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 are independent with 
\begin_inset Formula $X_{i}\sim f$
\end_inset

 for 
\begin_inset Formula $i=1,2,\ldots,n$
\end_inset

, then we say that 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 are 
\emph on
independent and identically distributed
\emph default
 (i.i.d.) from the population 
\begin_inset Formula $f$
\end_inset

 or alternatively we say that 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 are a 
\emph on
simple random sample of size
\emph default
 
\begin_inset Formula $n$
\end_inset

, denoted 
\begin_inset Formula $SRS(n)$
\end_inset

, from the population 
\begin_inset Formula $f$
\end_inset

.
 
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "pro:mean-sd-xbar"

\end_inset

Let 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 be a 
\begin_inset Formula $SRS(n)$
\end_inset

 from a population distribution with mean 
\begin_inset Formula $\mu$
\end_inset

 and finite standard deviation 
\begin_inset Formula $\sigma$
\end_inset

.
 Then the mean and standard deviation of 
\begin_inset Formula $\Xbar$
\end_inset

 are given by the formulas 
\begin_inset Formula $\mu_{\Xbar}=\mu$
\end_inset

 and 
\begin_inset Formula $\sigma_{\Xbar}=\sigma/\sqrt{n}$
\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Branch proofs
status open

\begin_layout Proof
Plug in 
\begin_inset Formula $a_{1}=a_{2}=\cdots=a_{n}=1/n$
\end_inset

 in Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:mean-sd-lin-comb"

\end_inset

.
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The next fact will be useful to us when it comes time to prove the Central
 Limit Theorem in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Central-Limit-Theorem"

\end_inset

.
\end_layout

\begin_layout Proposition
\begin_inset CommandInset label
LatexCommand label
name "pro:mgf-xbar"

\end_inset

Let 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 be a 
\begin_inset Formula $SRS(n)$
\end_inset

 from a population distribution with MGF 
\begin_inset Formula $M(t)$
\end_inset

.
 Then the MGF of 
\begin_inset Formula $\Xbar$
\end_inset

 is given by
\begin_inset Formula \begin{equation}
M_{\Xbar}(t)=\left[M\left(\frac{t}{n}\right)\right]^{n}.\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Branch proofs
status open

\begin_layout Proof
Go from the definition:
\begin_inset Formula \begin{eqnarray*}
M_{\Xbar}(t) & = & \E\,\me^{t\Xbar},\\
 & = & \E\,\me^{t(X_{1}+\cdots+X_{n})/n},\\
 & = & \E\,\me^{tX_{1}/n}\me^{tX_{2}/n}\cdots\me^{tX_{n}/n}.\end{eqnarray*}

\end_inset

And because 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 are independent, Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:indep-implies-prodexpect"

\end_inset

 allows us to distribute the expectation among each term in the product,
 which is
\begin_inset Formula \[
\E\me^{tX_{1}/n}\,\E\me^{tX_{2}/n}\cdots\E\me^{tX_{n}/n}.\]

\end_inset

The last step is to recognize that each term in last product above is exactly
 
\begin_inset Formula $M(t/n)$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Section
Sampling from a Normal Distribution
\begin_inset CommandInset label
LatexCommand label
name "sec:sampling-from-normal-dist"

\end_inset


\end_layout

\begin_layout Subsection
The Distribution of the Sample Mean
\begin_inset CommandInset label
LatexCommand label
name "sub:samp-mean-dist-of"

\end_inset


\end_layout

\begin_layout Proposition
Let 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 be a 
\begin_inset Formula $SRS(n)$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 distribution.
 Then the sample mean 
\begin_inset Formula $\Xbar$
\end_inset

 has a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma/\sqrt{n})$
\end_inset

 sampling distribution.
\end_layout

\begin_layout Standard
\begin_inset Branch proofs
status open

\begin_layout Proof
The mean and standard deviation of 
\begin_inset Formula $\Xbar$
\end_inset

 follow directly from Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:mean-sd-xbar"

\end_inset

.
 To address the shape, first remember from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:The-Normal-Distribution"

\end_inset

 that the 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 MGF is of the form
\begin_inset Formula \[
M(t)=\exp\left\{ \mu t+\sigma^{2}t^{2}/2\right\} .\]

\end_inset

Now use Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:mgf-xbar"

\end_inset

 to find
\begin_inset Formula \begin{eqnarray*}
M_{\Xbar}(t) & = & \left[M\left(\frac{t}{n}\right)\right]^{n},\\
 & = & \left[\exp\left\{ \mu(t/n)+\sigma^{2}(t/n)^{2}/2\right\} \right]^{n},\\
 & = & \exp\left\{ \, n\cdot\left[\mu(t/n)+\sigma^{2}(t/n)^{2}/2\right]\right\} ,\\
 & = & \exp\left\{ \mu t+(\sigma/\sqrt{n})^{2}t^{2}/2\right\} ,\end{eqnarray*}

\end_inset

and we recognize this last quantity as the MGF of a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma/\sqrt{n})$
\end_inset

 distribution.
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
The Distribution of the Sample Variance
\begin_inset CommandInset label
LatexCommand label
name "sub:Samp-Var-Dist"

\end_inset


\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:Xbar-andS"

\end_inset

Let 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 be a 
\begin_inset Formula $SRS(n)$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 distribution, and let
\begin_inset Formula \begin{equation}
\Xbar=\sum_{i=1}^{n}X_{i}\quad\mbox{and}\quad S^{2}=\frac{1}{n-1}\sum_{i=1}^{n}(X_{i}-\Xbar)^{2}.\end{equation}

\end_inset

Then
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\Xbar$
\end_inset

 and 
\begin_inset Formula $S^{2}$
\end_inset

 are independent, and
\end_layout

\begin_layout Enumerate
The rescaled sample variance 
\begin_inset Formula \begin{equation}
\frac{(n-1)}{\sigma^{2}}S^{2}=\frac{\sum_{i=1}^{n}(X_{i}-\Xbar)^{2}}{\sigma^{2}}\end{equation}

\end_inset

has 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none
a 
\begin_inset Formula $\mathsf{chisq}(\mathtt{df}=n-1)$
\end_inset

 sampling distribution.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Branch proofs
status open

\begin_layout Proof
The proof is beyond the scope of the present book, but the theorem is simply
 too important to be omitted.
 The interested reader could consult Casella and Berger 
\begin_inset CommandInset citation
LatexCommand cite
key "Casella2002"

\end_inset

, or Hogg 
\emph on
et al
\emph default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Hogg2005"

\end_inset

.
 
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
The Distribution of Student's 
\begin_inset Formula $T$
\end_inset

 Statistic
\begin_inset CommandInset label
LatexCommand label
name "sub:Student's-t-Distribution"

\end_inset


\end_layout

\begin_layout Proposition
Let 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 be a 
\begin_inset Formula $SRS(n)$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 distribution.
 Then the quantity 
\begin_inset Formula \begin{equation}
T=\frac{\Xbar-\mu}{S/\sqrt{n}}\end{equation}

\end_inset

 has a 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=n-1)$
\end_inset

 sampling distribution.
\end_layout

\begin_layout Standard
\begin_inset Branch proofs
status open

\begin_layout Proof
Divide the numerator and denominator by 
\begin_inset Formula $\sigma$
\end_inset

 and rewrite
\begin_inset Formula \[
T=\frac{\frac{\Xbar-\mu}{\sigma/\sqrt{n}}}{S/\sigma}=\frac{\frac{\Xbar-\mu}{\sigma/\sqrt{n}}}{\sqrt{\left.\frac{(n-1)S^{2}}{\sigma^{2}}\right\slash (n-1)}}.\]

\end_inset

Now let 
\begin_inset Formula \[
Z=\frac{\Xbar-\mu}{\sigma/\sqrt{n}}\quad\mbox{and}\quad V=\frac{(n-1)S^{2}}{\sigma^{2}},\]

\end_inset

so that
\begin_inset Formula \begin{equation}
T=\frac{Z}{\sqrt{V/r}},\end{equation}

\end_inset

where 
\begin_inset Formula $r=n-1$
\end_inset

.
\end_layout

\begin_layout Proof
We know from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:samp-mean-dist-of"

\end_inset

 that 
\begin_inset Formula $Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

 and we know from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Samp-Var-Dist"

\end_inset

 that 
\begin_inset Formula $V\sim\mathsf{chisq}(\mathtt{df}=n-1)$
\end_inset

.
 Further, since we are sampling from a normal distribution, Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Xbar-andS"

\end_inset

 gives that 
\begin_inset Formula $\Xbar$
\end_inset

 and 
\begin_inset Formula $S^{2}$
\end_inset

 are independent and by Fact 
\begin_inset CommandInset ref
LatexCommand ref
reference "fac:indep-then-function-indep"

\end_inset

 so are 
\begin_inset Formula $Z$
\end_inset

 and 
\begin_inset Formula $V$
\end_inset

.
 In summary, the distribution of 
\begin_inset Formula $T$
\end_inset

 is the same as the distribution of the quantity 
\begin_inset Formula $Z/\sqrt{V/r}$
\end_inset

, where 
\begin_inset Formula $Z\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

 and 
\begin_inset Formula $V\sim\mathsf{chisq}(\mathtt{df}=r)$
\end_inset

 are independent.
 This is in fact the definition of Student's 
\begin_inset Formula $t$
\end_inset

 distribution.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
This distribution was first published by W.
\begin_inset space ~
\end_inset

S.
\begin_inset space ~
\end_inset

Gosset (1900) under the pseudonym Student, and the distribution has consequently
 come to be known as Student's 
\begin_inset Formula $t$
\end_inset

 distribution.
 The PDF of 
\begin_inset Formula $T$
\end_inset

 can be derived explicitly using the techniques of Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Functions-of-Continuous"

\end_inset

; it takes the form 
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
f_{X}(x)=\frac{\Gamma[(r+1)/2]}{\sqrt{r\pi}\ \Gamma(r/2)}\left(1+\frac{x^{2}}{r}\right)^{-(r+1)/2},\quad-\infty<x<\infty\end{equation}

\end_inset


\end_layout

\begin_layout Standard
Any random variable 
\begin_inset Formula $X$
\end_inset

 with the preceding PDF is said to have Student's 
\begin_inset Formula $t$
\end_inset

 distribution with 
\begin_inset Formula $r$
\end_inset

 
\emph on
degrees of freedom
\emph default
, and we write 
\begin_inset Formula $X\sim\mathsf{t}(\mathtt{df}=r)$
\end_inset

.
 The shape of the PDF is similar to the normal, but the tails are considerably
 heavier.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Student's-t-dist-vary-df"

\end_inset

.
 As with the normal distribution, there are four functions in 
\family sans
R
\family default
 associated with the 
\begin_inset Formula $t$
\end_inset

 distribution, namely 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dt
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

pt
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

qt
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rt
\end_layout

\end_inset

, 
\color inherit
which compute the PDF, CDF, quantile function, and generate random variates,
 respectively.
\end_layout

\begin_layout Standard
The code to produce Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Student's-t-dist-vary-df"

\end_inset

 is
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

curve(dt(x, df = 30), from = -3, to = 3, lwd = 3, ylab = "y")
\begin_inset Newline newline
\end_inset

ind <- c(1, 2, 3, 5, 10)
\begin_inset Newline newline
\end_inset

for (i in ind) curve(dt(x, df = i), -3, 3, add = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

curve(dt(x, df = 30), from = -3, to = 3, lwd = 3, ylab = "y")
\begin_inset Newline newline
\end_inset

ind <- c(1, 2, 3, 5, 10)
\begin_inset Newline newline
\end_inset

for (i in ind) curve(dt(x, df = i), -3, 3, add = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Student's 
\begin_inset Formula $t$
\end_inset

 distribution for various degrees of freedom
\begin_inset CommandInset label
LatexCommand label
name "fig:Student's-t-dist-vary-df"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Similar to that done for the normal we may define 
\begin_inset Formula $\mathsf{t}_{\alpha}(\mathtt{df}=n-1)$
\end_inset

 as the number on the 
\begin_inset Formula $x$
\end_inset

-axis such that there is exactly 
\begin_inset Formula $\alpha$
\end_inset

 area under the 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=n-1)$
\end_inset

 curve to its right.
\end_layout

\begin_layout Example
Find 
\begin_inset Formula $\mathsf{t}{}_{0.01}(\mathtt{df}=23)$
\end_inset

 with the quantile function.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

qt(0.01, df = 23, lower.tail = FALSE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Remark
There are a few things to note about the 
\begin_inset Formula $\mathtt{t}(\mathtt{df}=r)$
\end_inset

 distribution.
\end_layout

\begin_deeper
\begin_layout Enumerate
The 
\begin_inset Formula $\mathtt{t}(\mathtt{df}=1)$
\end_inset

 distribution is the same as the 
\begin_inset Formula $\mathsf{cauchy}(\mathtt{location}=0,\,\mathtt{scale}=1)$
\end_inset

 distribution.
 
\color none
The Cauchy distribution is rather pathological and is a counterexample to
 many famous results.

\color inherit
 
\end_layout

\begin_layout Enumerate
The standard deviation of 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=r)$
\end_inset

 is undefined (that is, infinite) unless 
\begin_inset Formula $r>2$
\end_inset

.
 When 
\begin_inset Formula $r$
\end_inset

 is more than 2, the standard deviation is always bigger than one, but decreases
 to 1 as 
\begin_inset Formula $r\to\infty$
\end_inset

.
\end_layout

\begin_layout Enumerate
As 
\begin_inset Formula $r\to\infty$
\end_inset

, the 
\begin_inset Formula $\mathtt{t}(\mathtt{df}=r)$
\end_inset

 distribution approaches the 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

 distribution.
\end_layout

\end_deeper
\begin_layout Section
The Central Limit Theorem
\begin_inset CommandInset label
LatexCommand label
name "sec:Central-Limit-Theorem"

\end_inset


\end_layout

\begin_layout Standard
In this section we study the distribution of the sample mean when the underlying
 distribution is 
\emph on
not
\emph default
 normal.
 We saw in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:sampling-from-normal-dist"

\end_inset

 that when 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 is a 
\begin_inset Formula $SRS(n)$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 distribution then 
\begin_inset Formula $\Xbar\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma/\sqrt{n})$
\end_inset

.
 In other words, we may say (owing to Fact 
\begin_inset CommandInset ref
LatexCommand ref
reference "fac:lin-trans-norm-is-norm"

\end_inset

) when the underlying population is normal that the sampling distribution
 of 
\begin_inset Formula $Z$
\end_inset

 defined by 
\begin_inset Formula \begin{equation}
Z=\frac{\Xbar-\mu}{\sigma/\sqrt{n}}\end{equation}

\end_inset

is 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

.
 
\end_layout

\begin_layout Standard
However, there are many populations that are 
\emph on
not
\emph default
 normal\SpecialChar \ldots{}
 and the statistician often finds herself sampling from such populations.
 What can be said in this case? The surprising answer is contained in the
 following theorem.
\end_layout

\begin_layout Theorem

\series bold
\begin_inset CommandInset label
LatexCommand label
name "thm:central-limit-thrm"

\end_inset

The Central Limit Theorem.

\series default
 Let 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 be a 
\begin_inset Formula $SRS(n)$
\end_inset

 from a population distribution with mean 
\begin_inset Formula $\mu$
\end_inset

 and finite standard deviation 
\begin_inset Formula $\sigma$
\end_inset

.
 Then the sampling distribution of 
\begin_inset Formula \begin{equation}
Z=\frac{\Xbar-\mu}{\sigma/\sqrt{n}}\end{equation}

\end_inset

approaches a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

 distribution as 
\begin_inset Formula $n\to\infty$
\end_inset

.
 
\end_layout

\begin_layout Remark
We suppose that 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 are i.i.d., and we learned in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:simple-random-samples"

\end_inset

 that 
\begin_inset Formula $\Xbar$
\end_inset

 has mean 
\begin_inset Formula $\mu$
\end_inset

 and standard deviation 
\begin_inset Formula $\sigma/\sqrt{n}$
\end_inset

, so we already knew that 
\begin_inset Formula $Z$
\end_inset

 has mean 0 and standard deviation 1.
 The beauty of the CLT is that it addresses the 
\emph on
shape
\emph default
 of 
\begin_inset Formula $Z$
\end_inset

's distribution when the sample size is large.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Remark
Notice that the shape of the underlying population's distribution is not
 mentioned in Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:central-limit-thrm"

\end_inset

; indeed, the result is true for any population that is well-behaved enough
 to have a finite standard deviation.
 In particular, if the population is normally distributed then we know from
 Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:samp-mean-dist-of"

\end_inset

 that the distribution of 
\begin_inset Formula $\Xbar$
\end_inset

 (and 
\begin_inset Formula $Z$
\end_inset

 by extension) is 
\emph on
exactly
\emph default
 normal, for 
\emph on
every
\emph default
 
\begin_inset Formula $n$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Remark
How large is 
\begin_inset Quotes eld
\end_inset

sufficiently large
\begin_inset Quotes erd
\end_inset

? It is here that the shape of the underlying population distribution plays
 a role.
 For populations with distributions that are approximately symmetric and
 mound-shaped, the samples may need to be only of size four or five, while
 for highly skewed or heavy-tailed populations the samples may need to be
 much larger for the distribution of the sample means to begin to show a
 bell-shape.
 Regardless, for a given population distribution (with finite standard deviation
) the approximation tends to be better for larger sample sizes.
 
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

TeachingDemos
\end_layout

\end_inset

 package 
\begin_inset CommandInset citation
LatexCommand cite
key "Snowteachingdemos"

\end_inset

 has 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

clt.examp
\end_layout

\end_inset

 and the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

distrTeach
\end_layout

\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "Ruckdescheldistr"

\end_inset

 package has 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

illustrateCLT
\end_layout

\end_inset

.
 Try the following at the command line (output omitted):
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

library(TeachingDemos)
\begin_inset Newline newline
\end_inset

example(clt.examp)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
and
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

library(distrTeach)
\begin_inset Newline newline
\end_inset

example(illustrateCLT)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR
\end_layout

\end_inset

 package has the functions 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

clt1
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

clt2
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

clt3
\end_layout

\end_inset

 (see Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:clt123"

\end_inset

 at the end of this chapter).
 Its purpose is to investigate what happens to the sampling distribution
 of 
\begin_inset Formula $\Xbar$
\end_inset

 when the population distribution is mound shaped, finite support, and skewed,
 namely 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=3)$
\end_inset

, 
\begin_inset Formula $\mathsf{unif}(\mathtt{a}=0,\,\mathtt{b}=10)$
\end_inset

 and 
\begin_inset Formula $\mathsf{gamma}(\mathtt{shape}=1.21,\,\mathtt{scale}=1/2.37)$
\end_inset

, respectively.
 
\end_layout

\begin_layout Standard
For example, when the command 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

clt1()
\end_layout

\end_inset

 is issued a plot window opens to show a graph of the PDF of a 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=3)$
\end_inset

 distribution.
 On the display are shown numerical values of the population mean and variance.
 While the students examine the graph the computer is simulating random
 samples of size 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

sample.size = 2
\end_layout

\end_inset

 from the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

population = "rt"
\end_layout

\end_inset

 distribution a total of 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

N.iter = 100000
\end_layout

\end_inset

 times, and sample means are calculated of each sample.
 Next follows a histogram of the simulated sample means, which closely approxima
tes the sampling distribution of 
\begin_inset Formula $\Xbar$
\end_inset

, see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Simulated-Sampling-Distributions"

\end_inset

.
 Also show are the sample mean and sample variance of all of the simulated
 
\begin_inset Formula $\Xbar$
\end_inset

s.
 As a final step, when the student clicks the second plot, a normal curve
 with the same mean and variance as the simulated 
\begin_inset Formula $\Xbar$
\end_inset

s is superimposed over the histogram.
 Students should compare the population theoretical mean and variance to
 the simulated mean and variance of the sampling distribution.
 They should also compare the shape of the simulated sampling distribution
 to the shape of the normal distribution.
\end_layout

\begin_layout Standard
The three separate 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

clt1
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

clt2
\end_layout

\end_inset

, and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

clt3
\end_layout

\end_inset

 functions were written so that students could compare what happens overall
 when the shape of the population distribution changes.
 It would be possible to combine all three into one big function, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

clt
\end_layout

\end_inset

 which covers all three cases (and more).
 
\end_layout

\begin_layout Section
Sampling Distributions of Two-Sample Statistics
\begin_inset CommandInset label
LatexCommand label
name "sec:Samp-Dist-Two-Samp"

\end_inset


\end_layout

\begin_layout Standard
There are often two populations under consideration, and it sometimes of
 interest to compare properties between groups.
 To do so we take independent samples from each population and calculate
 respective sample statistics for comparison.
 In some simple cases the sampling distribution of the comparison is known
 and easy to derive; such cases are the subject of the present section.
\end_layout

\begin_layout Subsection
Difference of Independent Sample Means
\end_layout

\begin_layout Proposition
Let 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n_{1}}$
\end_inset

 be an 
\begin_inset Formula $SRS(n_{1})$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu_{X},\,\mathtt{sd}=\sigma_{X})$
\end_inset

 distribution and let 
\begin_inset Formula $Y_{1}$
\end_inset

, 
\begin_inset Formula $Y_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $Y_{n_{2}}$
\end_inset

 be an 
\begin_inset Formula $SRS(n_{2})$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu_{Y},\,\mathtt{sd}=\sigma_{Y})$
\end_inset

 distribution.
 Suppose that 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n_{1}}$
\end_inset

 and 
\begin_inset Formula $Y_{1}$
\end_inset

, 
\begin_inset Formula $Y_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $Y_{n_{2}}$
\end_inset

 are independent samples.
 Then the quantity 
\begin_inset Formula \begin{equation}
\frac{\Xbar-\Ybar-(\mu_{X}-\mu_{Y})}{\sqrt{\left.\sigma_{X}^{2}\right\slash n_{1}+\left.\sigma_{Y}^{2}\right\slash n_{2}}}\label{eq:diff-indep-sample-means}\end{equation}

\end_inset

has a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

 sampling distribution.
 Equivalently, 
\begin_inset Formula $\Xbar-\Ybar$
\end_inset

 has a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu_{X}-\mu_{Y},\,\mathtt{sd}=\sqrt{\left.\sigma_{X}^{2}\right\slash n_{1}+\left.\sigma_{Y}^{2}\right\slash n_{2}})$
\end_inset

 sampling distribution.
 
\end_layout

\begin_layout Proof
We know that 
\begin_inset Formula $\Xbar$
\end_inset

 is 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu_{X},\,\mathtt{sd}=\sigma_{X}/\sqrt{n_{1}})$
\end_inset

 and we also know that 
\begin_inset Formula $\Ybar$
\end_inset

 is 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu_{Y},\,\mathtt{sd}=\sigma_{Y}/\sqrt{n_{2}})$
\end_inset

.
 And since the samples 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n_{1}}$
\end_inset

 and 
\begin_inset Formula $Y_{1}$
\end_inset

, 
\begin_inset Formula $Y_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $Y_{n_{2}}$
\end_inset

 are independent, so too are 
\begin_inset Formula $\Xbar$
\end_inset

 and 
\begin_inset Formula $\Ybar$
\end_inset

.
 The distribution of their difference is thus normal as well, and the mean
 and standard deviation are given by Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:mean-sd-lin-comb-two"

\end_inset

.
\end_layout

\begin_layout Remark
Even if the distribution of one or both of the samples is not normal, the
 quantity in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:diff-indep-sample-means"

\end_inset

 will be approximately normal provided both sample sizes are large.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Remark
For the special case of 
\begin_inset Formula $\mu_{X}=\mu_{Y}$
\end_inset

 we have shown that 
\begin_inset Formula \begin{equation}
\frac{\Xbar-\Ybar}{\sqrt{\sigma_{X}^{2}/n_{1}+\sigma_{Y}^{2}/n_{2}}}\end{equation}

\end_inset

has a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

 sampling distribution, or in other words, 
\begin_inset Formula $\Xbar-\Ybar$
\end_inset

 has a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=\sqrt{\sigma_{X}^{2}/n_{1}+\sigma_{Y}^{2}/n_{2}})$
\end_inset

 sampling distribution.
 This will be important when it comes time to do hypothesis tests; see Section
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Conf-Interv-for-Diff-Means"

\end_inset

.
\end_layout

\begin_layout Subsection
Difference of Independent Sample Proportions
\end_layout

\begin_layout Proposition
Let 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n_{1}}$
\end_inset

 be an 
\begin_inset Formula $SRS(n_{1})$
\end_inset

 from a 
\begin_inset Formula $\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p_{1})$
\end_inset

 distribution and let 
\begin_inset Formula $Y_{1}$
\end_inset

, 
\begin_inset Formula $Y_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $Y_{n_{2}}$
\end_inset

 be an 
\begin_inset Formula $SRS(n_{2})$
\end_inset

 from a 
\begin_inset Formula $\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p_{2})$
\end_inset

 distribution.
 Suppose that 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n_{1}}$
\end_inset

 and 
\begin_inset Formula $Y_{1}$
\end_inset

, 
\begin_inset Formula $Y_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $Y_{n_{2}}$
\end_inset

 are independent samples.
 Define 
\begin_inset Formula \begin{equation}
\hat{p}_{1}=\frac{1}{n_{1}}\sum_{i=1}^{n_{1}}X_{i}\quad\mbox{and}\quad\hat{p}_{2}=\frac{1}{n_{2}}\sum_{j=1}^{n_{2}}Y_{j}.\end{equation}

\end_inset

Then the sampling distribution of
\begin_inset Formula \begin{equation}
\frac{\hat{p}_{1}-\hat{p}_{2}-(p_{1}-p_{2})}{\sqrt{\frac{p_{1}(1-p_{1})}{n_{1}}+\frac{p_{2}(1-p_{2})}{n_{2}}}}\end{equation}

\end_inset

approaches a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

 distribution as both 
\begin_inset Formula $n_{1},\, n_{2}\to\infty$
\end_inset

.
 In other words, the sampling distribution of 
\begin_inset Formula $\hat{p}_{1}-\hat{p}_{2}$
\end_inset

 is approximately
\begin_inset Formula \begin{equation}
\mathsf{norm}\left(\mathtt{mean}=p_{1}-p_{2},\,\mathtt{sd}=\sqrt{\frac{p_{1}(1-p_{1})}{n_{1}}+\frac{p_{2}(1-p_{2})}{n_{2}}}\right),\end{equation}

\end_inset

provided both 
\begin_inset Formula $n_{1}$
\end_inset

 and 
\begin_inset Formula $n_{2}$
\end_inset

 are sufficiently large.
\end_layout

\begin_layout Standard
\begin_inset Branch proofs
status open

\begin_layout Proof
We know that 
\begin_inset Formula $\hat{p}_{1}$
\end_inset

 is approximately normal for 
\begin_inset Formula $n_{1}$
\end_inset

 sufficiently large by the CLT, and we know that 
\begin_inset Formula $\hat{p}_{2}$
\end_inset

 is approximately normal for 
\begin_inset Formula $n_{2}$
\end_inset

 sufficiently large, also by the CLT.
 Further, 
\begin_inset Formula $\hat{p}_{1}$
\end_inset

 and 
\begin_inset Formula $\hat{p}_{2}$
\end_inset

 are independent since they are derived from independent samples.
 And a difference of independent (approximately) normal distributions is
 (approximately) normal, by Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:diff-indep-norm"

\end_inset


\begin_inset Foot
status collapsed

\begin_layout Remark
This does not explicitly follow, because of our cavalier use of 
\begin_inset Quotes eld
\end_inset

approximately
\begin_inset Quotes erd
\end_inset

 in too many places.
 To be more thorough, however, would require more concepts than we can afford
 at the moment.
 The interested reader may consult a more advanced text, specifically the
 topic of weak convergence, that is, convergence in distribution.
\end_layout

\end_inset

.
 The expressions for the mean and standard deviation follow immediately
 from Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:mean-sd-lin-comb-two"

\end_inset

 combined with the formulas for the 
\begin_inset Formula $\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)$
\end_inset

 distribution from Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Discrete-Distributions"

\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Ratio of Independent Sample Variances
\end_layout

\begin_layout Proposition
Let 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n_{1}}$
\end_inset

 be an 
\begin_inset Formula $SRS(n_{1})$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu_{X},\,\mathtt{sd}=\sigma_{X})$
\end_inset

 distribution and let 
\begin_inset Formula $Y_{1}$
\end_inset

, 
\begin_inset Formula $Y_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $Y_{n_{2}}$
\end_inset

 be an 
\begin_inset Formula $SRS(n_{2})$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu_{Y},\,\mathtt{sd}=\sigma_{Y})$
\end_inset

 distribution.
 Suppose that 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n_{1}}$
\end_inset

 and 
\begin_inset Formula $Y_{1}$
\end_inset

, 
\begin_inset Formula $Y_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $Y_{n_{2}}$
\end_inset

 are independent samples.
 Then the ratio 
\begin_inset Formula \begin{equation}
F=\frac{\sigma_{Y}^{2}S_{X}^{2}}{\sigma_{X}^{2}S_{Y}^{2}}\end{equation}

\end_inset

has an 
\begin_inset Formula $\mathsf{f}(\mathtt{df1}=n_{1}-1,\,\mathtt{df2}=n_{2}-1)$
\end_inset

 sampling distribution.
\end_layout

\begin_layout Standard
\begin_inset Branch proofs
status open

\begin_layout Proof
We know from Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:Xbar-andS"

\end_inset

 that 
\begin_inset Formula $(n_{1}-1)S_{X}^{2}/\sigma_{X}^{2}$
\end_inset

 is distributed 
\begin_inset Formula $\mathsf{chisq}(\mathtt{df}=n_{1}-1)$
\end_inset

 and 
\begin_inset Formula $(n_{2}-1)S_{Y}^{2}/\sigma_{Y}^{2}$
\end_inset

 is distributed 
\begin_inset Formula $\mathsf{chisq}(\mathtt{df}=n_{2}-1)$
\end_inset

.
 Now write 
\begin_inset Formula \[
F=\frac{\sigma_{Y}^{2}S_{X}^{2}}{\sigma_{X}^{2}S_{Y}^{2}}=\frac{\left.(n_{1}-1)S_{Y}^{2}\right\slash (n_{1}-1)}{\left.(n_{2}-1)S_{Y}^{2}\right\slash (n_{2}-1)}\cdot\frac{\left.1\right\slash \sigma_{X}^{2}}{\left.1\right\slash \sigma_{Y}^{2}},\]

\end_inset

by multiplying and dividing the numerator with 
\begin_inset Formula $n_{1}-1$
\end_inset

 and doing likewise for the denominator with 
\begin_inset Formula $n_{2}-1$
\end_inset

.
 Now we may regroup the terms into 
\begin_inset Formula \[
F=\frac{\left.\frac{(n_{1}-1)S_{X}^{2}}{\sigma_{X}^{2}}\right\slash (n_{1}-1)}{\left.\frac{(n_{2}-1)S_{Y}^{2}}{\sigma_{Y}^{2}}\right\slash (n_{2}-1)},\]

\end_inset

and we recognize 
\begin_inset Formula $F$
\end_inset

 to be the ratio of independent 
\begin_inset Formula $\mathsf{chisq}$
\end_inset

 distributions, each divided by its respective numerator 
\begin_inset Formula $\mathtt{df}=n_{1}-1$
\end_inset

 and denominator 
\begin_inset Formula $\mathtt{df}=n_{1}-1$
\end_inset

 degrees of freedom.
 This is, indeed, the definition of Snedecor's 
\begin_inset Formula $F$
\end_inset

 distribution.
 
\end_layout

\end_inset


\end_layout

\begin_layout Remark
For the special case of 
\begin_inset Formula $\sigma_{X}=\sigma_{Y}$
\end_inset

 we have shown that 
\begin_inset Formula \begin{equation}
F=\frac{S_{X}^{2}}{S_{Y}^{2}}\end{equation}

\end_inset

has an 
\begin_inset Formula $\mathsf{f}(\mathtt{df1}=n_{1}-1,\,\mathtt{df2}=n_{2}-1)$
\end_inset

 sampling distribution.
 This will be important in Chapters 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Estimation"

\end_inset

 onward.
\end_layout

\begin_layout Section
Simulated Sampling Distributions
\begin_inset CommandInset label
LatexCommand label
name "sec:Simulated-Sampling-Distributions"

\end_inset


\end_layout

\begin_layout Standard
Some comparisons are meaningful, but their sampling distribution is not
 quite so tidy to describe analytically.
 What do we do then?
\end_layout

\begin_layout Standard
As it turns out, we do not need to know the exact analytical form of the
 sampling distribution; sometimes it is enough to approximate it with a
 simulated distribution.
 In this section we will show you how.
 Note that 
\family sans
R
\family default
 is particularly well suited to compute simulated sampling distributions,
 much more so than, say, SPSS or SAS.
\end_layout

\begin_layout Subsection
The Interquartile Range
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

iqrs <- replicate(100, IQR(rnorm(100)))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We can look at the mean of the simulated values
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

mean(iqrs)    # close to 1
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
and we can see the standard deviation
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

sd(iqrs)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Now let's take a look at a plot of the simulated values
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 6>>=
\begin_inset Newline newline
\end_inset

hist(iqrs, breaks = 20)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Plot of simulated IQRs
\begin_inset CommandInset label
LatexCommand label
name "fig:simulated-IQR"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
The Median Absolute Deviation
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

mads <- replicate(100, mad(rnorm(100)))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We can look at the mean of the simulated values
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

mean(mads)    # close to 1.349
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
and we can see the standard deviation
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

sd(mads)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Now let's take a look at a plot of the simulated values
\end_layout

\begin_layout Standard
\begin_inset Float figure
placement H
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=TRUE, height = 4, width = 6>>=
\begin_inset Newline newline
\end_inset

hist(mads, breaks = 20)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Plot of simulated MADs
\begin_inset CommandInset label
LatexCommand label
name "fig:simulated-MAD"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Chapter Exercises
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{section}{Chapter Exercises}
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{thm}{0}
\end_layout

\end_inset


\end_layout

\begin_layout Scrap
<<echo = FALSE, results = hide>>=
\begin_inset Newline newline
\end_inset

k = 1
\begin_inset Newline newline
\end_inset

n = sample(10:30, size=10, replace = TRUE)
\begin_inset Newline newline
\end_inset

mu = round(rnorm(10, mean = 20))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Exercise
Suppose that we observe a random sample 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 of size 
\begin_inset Formula $SRS(n=$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{n[k]}
\end_layout

\end_inset

) from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{mu[k]}
\end_layout

\end_inset

) distribution.
 
\end_layout

\begin_layout Enumerate
What is the mean of 
\begin_inset Formula $\Xbar$
\end_inset

?
\end_layout

\begin_layout Enumerate
What is the standard deviation of 
\begin_inset Formula $\Xbar$
\end_inset

?
\end_layout

\begin_layout Enumerate
What is the distribution of 
\begin_inset Formula $\Xbar$
\end_inset

? (approximately)
\end_layout

\begin_layout Enumerate
Find 
\begin_inset Formula $\P(a<\Xbar\leq b)$
\end_inset


\end_layout

\begin_layout Enumerate
Find 
\begin_inset Formula $\P(\Xbar>c)$
\end_inset

.
\end_layout

\begin_layout Exercise
\begin_inset CommandInset label
LatexCommand label
name "xca:clt123"

\end_inset

In this exercise we will investigate how the shape of the population distributio
n affects the time until the distribution of 
\begin_inset Formula $\Xbar$
\end_inset

 is acceptably normal.
\end_layout

\begin_layout Standard
Answer the questions and write a report about what you have learned.
 Use plots and histograms to support your conclusions.
 See Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Writing-Reports-with"

\end_inset

 for instructions about writing reports with 
\family sans
R
\family default
.
 For these problems, the discussion/interpretation parts are the most important,
 so be sure to ANSWER THE WHOLE QUESTION.
 
\begin_inset VSpace 0.02in
\end_inset


\end_layout

\begin_layout Subsection*
The Central Limit Theorem
\end_layout

\begin_layout Standard
For Questions 1-3, we assume that we have observed random variables 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
,
\begin_inset Formula $X_{n}$
\end_inset

 that are an 
\begin_inset Formula $SRS(n)$
\end_inset

 from a given population (depending on the problem) and we want to investigate
 the distribution of 
\begin_inset Formula $\Xbar$
\end_inset

 as the sample size 
\begin_inset Formula $n$
\end_inset

 increases.
 
\end_layout

\begin_layout Enumerate
The population of interest in this problem has a Student's 
\begin_inset Formula $t$
\end_inset

 distribution with 
\begin_inset Formula $r=3$
\end_inset

 degrees of freedom.
 We begin our investigation with a sample size of 
\begin_inset Formula $n=2$
\end_inset

.
 Open an 
\family sans
R
\family default
 session, make sure to type 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

library(IPSUR)
\end_layout

\end_inset

 and then follow that with 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

clt1()
\end_layout

\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Enumerate
Look closely and thoughtfully at the first graph.
 How would you describe the population distribution? Think back to the different
 properties of distributions in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Describing-Data-Distributions"

\end_inset

.
 Is the graph symmetric? Skewed? Does it have heavy tails or thin tails?
 What else can you say?
\end_layout

\begin_layout Enumerate
What is the population mean 
\begin_inset Formula $\mu$
\end_inset

 and the population variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

? (Read these from the first graph.)
\end_layout

\begin_layout Enumerate
The second graph shows (after a few seconds) a relative frequency histogram
 which closely approximates the distribution of 
\begin_inset Formula $\Xbar$
\end_inset

.
 Record the values of 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mean(xbar)
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

var(xbar)
\end_layout

\end_inset

, where 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

xbar
\end_layout

\end_inset

 denotes the vector that contains the simulated sample means.
 Use the answers from part (b) to calculate what these estimates 
\emph on
should
\emph default
 be, based on what you know about the theoretical mean and variance of 
\begin_inset Formula $\Xbar$
\end_inset

.
 How well do your answers to parts (b) and (c) agree?
\end_layout

\begin_layout Enumerate
Click on the histogram to superimpose a red normal curve, which is the theoretic
al limit of the distribution of 
\begin_inset Formula $\Xbar$
\end_inset

 as 
\begin_inset Formula $n\to\infty$
\end_inset

.
 How well do the histogram and the normal curve match? Describe the differences
 between the two distributions.
 When judging between the two, do not worry so much about the scale (the
 graphs are being rescaled automatically, anyway).
 Rather, look at the peak: does the histogram poke through the top of the
 normal curve? How about on the sides: are there patches of white space
 between the histogram and line on either side (or both)? How do the curvature
 of the histogram and the line compare? Check down by the tails: does the
 red line drop off visibly below the level of the histogram, or do they
 taper off at the same height? 
\end_layout

\begin_layout Enumerate
We can increase our sample size from 2 to 11 with the command 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

clt1(sample.size = 11)
\end_layout

\end_inset

.
 Return to the command prompt to do this.
 Answer parts (b) and (c) for this new sample size.
\end_layout

\begin_layout Enumerate
Go back to 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

clt1
\end_layout

\end_inset

 and increase the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

sample.size
\end_layout

\end_inset

 from 11 to 31.
 Answer parts (b) and (c) for this new sample size.
\end_layout

\begin_layout Enumerate
Comment on whether it appears that the histogram and the red curve are 
\begin_inset Quotes eld
\end_inset

noticeably different
\begin_inset Quotes erd
\end_inset

 or whether they are 
\begin_inset Quotes eld
\end_inset

essentially the same
\begin_inset Quotes erd
\end_inset

 for the largest sample size 
\begin_inset Formula $n=31$
\end_inset

.
 If they are still 
\begin_inset Quotes eld
\end_inset

noticeably different
\begin_inset Quotes erd
\end_inset

 at 
\begin_inset Formula $n=31$
\end_inset

, how large does 
\begin_inset Formula $n$
\end_inset

 need to be until they are 
\begin_inset Quotes eld
\end_inset

essentially the same
\begin_inset Quotes erd
\end_inset

? (Experiment with different values of 
\begin_inset Formula $n$
\end_inset

).
\end_layout

\end_deeper
\begin_layout Enumerate
Repeat Question 1 for the function 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

clt2
\end_layout

\end_inset

.
 In this problem, the population of interest has a 
\begin_inset Formula $\mathsf{unif}(\mathtt{min}=0,\,\mathtt{max}=10)$
\end_inset

 distribution.
\end_layout

\begin_layout Enumerate
Repeat Question 1 for the function 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

clt3
\end_layout

\end_inset

.
 In this problem, the population of interest has a 
\begin_inset Formula $\mathsf{gamma}(\mathtt{shape}=1.21,\,\mathtt{rate}=1/2.37)$
\end_inset

 distribution.
\end_layout

\begin_layout Enumerate
Summarize what you have learned.
 In your own words, what is the general trend that is being displayed in
 these histograms, as the sample size 
\begin_inset Formula $n$
\end_inset

 increases from 2 to 11, on to 31, and onward?
\end_layout

\begin_layout Enumerate
How would you describe the relationship between the 
\series bold
\emph on
shape
\series default
\emph default
 of the population distribution and the 
\series bold
\emph on
speed
\series default
\emph default
 at which 
\begin_inset Formula $\Xbar$
\end_inset

's distribution converges to normal? In particular, consider a population
 which is highly 
\series bold
skewed
\series default
.
 Will we need a relatively 
\emph on
large
\emph default
 sample size or a relatively 
\emph on
small
\emph default
 sample size in order for 
\begin_inset Formula $\Xbar$
\end_inset

's distribution to be approximately bell shaped?
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Exercise
Let 
\begin_inset Formula $X_{1}$
\end_inset

,\SpecialChar \ldots{}
, 
\begin_inset Formula $X_{25}$
\end_inset

 be a random sample from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=37,\,\mathtt{sd}=45)$
\end_inset

 distribution, and let 
\begin_inset Formula $\Xbar$
\end_inset

 be the sample mean of these 
\begin_inset Formula $n=25$
\end_inset

 observations.
 Find the following probabilities.
\end_layout

\begin_deeper
\begin_layout Enumerate
How is 
\begin_inset Formula $\Xbar$
\end_inset

 distributed? 
\end_layout

\begin_deeper
\begin_layout Standard
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=37,\,\mathtt{sd}=45/\sqrt{25})$
\end_inset

 
\end_layout

\end_deeper
\begin_layout Enumerate
Find 
\begin_inset Formula $\P(\Xbar>43.1)$
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

pnorm(43.1, mean = 37, sd = 9, lower.tail = FALSE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Chapter
Estimation
\begin_inset CommandInset label
LatexCommand label
name "cha:Estimation"

\end_inset


\end_layout

\begin_layout Standard
\noindent
We will discuss two branches of estimation procedures: point estimation
 and interval estimation.
 We briefly discuss point estimation first and then spend the rest of the
 chapter on interval estimation.
\end_layout

\begin_layout Standard
We find an estimator with the methods of Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Point-Estimation-1"

\end_inset

.
 We make some assumptions about the underlying population distribution and
 use what we know from Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Sampling-Distributions"

\end_inset

 about sampling distributions both to study how the estimator will perform,
 and to find intervals of confidence for underlying parameters associated
 with the population distribution.
 Once we have confidence intervals we can do inference in the form of hypothesis
 tests in the next chapter.
\end_layout

\begin_layout Paragraph*
What do I want them to know?
\end_layout

\begin_layout Itemize
how to look at a problem, identify a reasonable model, and estimate a parameter
 associated with the model
\end_layout

\begin_layout Itemize
about maximum likelihood, and in particular, how to
\end_layout

\begin_deeper
\begin_layout Itemize
eyeball a likelihood to get a maximum
\end_layout

\begin_layout Itemize
use calculus to find an MLE for one-parameter families
\end_layout

\end_deeper
\begin_layout Itemize
about properties of the estimators they find, such as bias, minimum variance,
 MSE
\end_layout

\begin_layout Itemize
point versus interval estimation, and how to find and interpret confidence
 intervals for basic experimental designs
\end_layout

\begin_layout Itemize
the concept of margin of error and its relationship to sample size
\end_layout

\begin_layout Section
Point Estimation
\begin_inset CommandInset label
LatexCommand label
name "sec:Point-Estimation-1"

\end_inset


\end_layout

\begin_layout Standard
The following example is how I was introduced to maximum likelihood.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:how-many-fish"

\end_inset

Suppose we have a small pond in our backyard, and in the pond there live
 some fish.
 We would like to know how many fish live in the pond.
 How can we estimate this? One procedure developed by researchers is the
 capture-recapture method.
 Here is how it works.
\end_layout

\begin_layout Example
We will fish from the pond and suppose that we capture 
\begin_inset Formula $M=7$
\end_inset

 fish.
 On each caught fish we attach an unobtrusive tag to the fish's tail, and
 release it back into the water.
 
\end_layout

\begin_layout Example
Next, we wait a few days for the fish to remix and become accustomed to
 their new tag.
 Then we go fishing again.
 On the second trip some of the fish we catch may be tagged; some may not
 be.
 Let 
\begin_inset Formula $X$
\end_inset

 denote the number of caught fish which are tagged
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
It is theoretically possible that we could catch the same tagged fish more
 than once, which would inflate our count of tagged fish.
 To avoid this difficulty, suppose that on the second trip we use a tank
 on the boat to hold the caught fish until data collection is completed.
\end_layout

\end_inset

, and suppose for the sake of argument that we catch 
\begin_inset Formula $K=4$
\end_inset

 fish and we find that 3 of them are tagged.
\end_layout

\begin_layout Example
Now let 
\begin_inset Formula $F$
\end_inset

 denote the (unknown) total number of fish in the pond.
 We know that 
\begin_inset Formula $F\geq7$
\end_inset

, because we tagged that many on the first trip.
 In fact, if we let 
\begin_inset Formula $N$
\end_inset

 denote the number of untagged fish in the pond, then 
\begin_inset Formula $F=M+N$
\end_inset

.
 We have sampled 
\begin_inset Formula $K=4$
\end_inset

 times, without replacement, from an urn which has 
\begin_inset Formula $M=7$
\end_inset

 white balls and 
\begin_inset Formula $N=F-M$
\end_inset

 black balls, and we have observed 
\begin_inset Formula $x=3$
\end_inset

 of them to be white.
 What is the probability of this?
\end_layout

\begin_layout Example
Looking back to Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:other-discrete-distributions"

\end_inset

, we see that the random variable 
\begin_inset Formula $X$
\end_inset

 has a 
\begin_inset Formula $\mathsf{hyper}(\mathtt{m}=M,\,\mathtt{n}=F-M,\,\mathtt{k}=K)$
\end_inset

 distribution.
 Therefore, for an observed value 
\begin_inset Formula $X=x$
\end_inset

 the probability would be
\begin_inset Formula \[
\P(X=x)=\frac{{M \choose x}{F-M \choose K-x}}{{F \choose K}}.\]

\end_inset


\end_layout

\begin_layout Example
First we notice that 
\begin_inset Formula $F$
\end_inset

 must be at least 7.
 Could 
\begin_inset Formula $F$
\end_inset

 be equal to seven? If 
\begin_inset Formula $F=7$
\end_inset

 then all of the fish would have been tagged on the first run, and there
 would be no untagged fish in the pond, thus, 
\begin_inset Formula $\P(\mbox{3 successes in 4 trials})=0$
\end_inset

.
\end_layout

\begin_layout Example
What about 
\begin_inset Formula $F=8$
\end_inset

; what would be the probability of observing 
\begin_inset Formula $X=3$
\end_inset

 tagged fish?
\begin_inset Formula \[
\P(\mbox{3 successes in 4 trials})=\frac{{7 \choose 3}{1 \choose 1}}{{8 \choose 4}}=\frac{35}{70}=0.5.\]

\end_inset


\end_layout

\begin_layout Example
Similarly, if 
\begin_inset Formula $F=9$
\end_inset

 then the probability of observing 
\begin_inset Formula $X=3$
\end_inset

 tagged fish would be
\begin_inset Formula \[
\P(\mbox{3 successes in 4 trials})=\frac{{7 \choose 3}{2 \choose 1}}{{9 \choose 4}}=\frac{70}{126}\approx0.556.\]

\end_inset

We can see already that the observed data 
\begin_inset Formula $X=3$
\end_inset

 is more likely when 
\begin_inset Formula $F=9$
\end_inset

 than it is when 
\begin_inset Formula $F=8$
\end_inset

.
 And here lies the genius of Sir Ronald Aylmer Fisher: he asks, 
\begin_inset Quotes eld
\end_inset

What is the value of 
\begin_inset Formula $F$
\end_inset

 which has the highest likelihood?
\begin_inset Quotes erd
\end_inset

 In other words, for all of the different possible values of 
\begin_inset Formula $F$
\end_inset

, which one makes the above probability the biggest? We can answer this
 question with a plot of 
\begin_inset Formula $\P(X=x)$
\end_inset

 versus 
\begin_inset Formula $F$
\end_inset

.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:capture-recapture"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

heights = rep(0, 16)
\begin_inset Newline newline
\end_inset

for (j in 7:15) heights[j] <- dhyper(3, m = 7, n = j - 7, k = 4)
\begin_inset Newline newline
\end_inset

plot(6:15, heights[6:15], pch = 16, cex = 1.5, xlab = "number of fish in
 pond", ylab = "Likelihood")
\begin_inset Newline newline
\end_inset

abline(h = 0)
\begin_inset Newline newline
\end_inset

lines(6:15, heights[6:15], type = "h", lwd = 2, lty = 3)
\begin_inset Newline newline
\end_inset

text(9, heights[9]/6, bquote(hat(F)==.(9)), cex = 2, pos = 4)
\begin_inset Newline newline
\end_inset

lines(9, heights[9], type = "h", lwd = 2)
\begin_inset Newline newline
\end_inset

points(9, 0, pch = 4, lwd = 3, cex = 2) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Capture-recapture experiment
\begin_inset CommandInset label
LatexCommand label
name "fig:capture-recapture"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:bass-bluegill"

\end_inset

In the last example we were only concerned with how many fish were in the
 pond, but now, we will ask a different question.
 Suppose it is known that there are only two species of fish in the pond:
 smallmouth bass (
\emph on
Micropterus dolomieu
\emph default
) and bluegill (
\emph on
Lepomis macrochirus
\emph default
); perhaps we built the pond some years ago and stocked it with only these
 two species.
 We would like to estimate the proportion of fish in the pond which are
 bass.
\end_layout

\begin_layout Example
Let 
\begin_inset Formula $p=\mbox{the proportion of bass}$
\end_inset

.
 Without any other information, it is conceivable for 
\begin_inset Formula $p$
\end_inset

 to be any value in the interval 
\begin_inset Formula $[0,1]$
\end_inset

, but for the sake of argument we will suppose that 
\begin_inset Formula $p$
\end_inset

 falls strictly between 0 and 1.
 How can we learn about the true value of 
\begin_inset Formula $p$
\end_inset

? Go fishing! As before, we will use catch-and-release, but unlike before,
 we will not tag the fish.
 We will simply note the species of any caught fish before returning it
 to the pond.
\end_layout

\begin_layout Example
Suppose we catch 
\begin_inset Formula $n$
\end_inset

 fish.
 Let
\begin_inset Formula \[
X_{i}=\begin{cases}
1, & \mbox{if the \mbox{i}\mbox{th} fish is a bass,}\\
0, & \mbox{if the \mbox{i}\mbox{th} fish is a bluegill.}\end{cases}\]

\end_inset


\end_layout

\begin_layout Example
Since we are returning the fish to the pond once caught, we may think of
 this as a sampling scheme with replacement where the proportion of bass
 
\begin_inset Formula $p$
\end_inset

 does not change.
 Given that we allow the fish sufficient time to 
\begin_inset Quotes eld
\end_inset

mix
\begin_inset Quotes erd
\end_inset

 once returned, it is not completely unreasonable to model our fishing experimen
t as a sequence of Bernoulli trials, so that the 
\begin_inset Formula $X_{i}$
\end_inset

's would be i.i.d.
\begin_inset space ~
\end_inset


\begin_inset Formula $\mathsf{binom(\mathtt{size}}=1,\,\mathtt{prob}=p)$
\end_inset

.
 Under those assumptions we would have 
\begin_inset Formula \begin{eqnarray*}
\P(X_{1}=x_{1},\, X_{2}=x_{2},\,\ldots,\, X_{n}=x_{n}) & = & \P(X_{1}=x_{1})\,\P(X_{2}=x_{2})\,\cdots\P(X_{n}=x_{n}),\\
 & = & p^{x_{1}}(1-p)^{x_{1}}\, p^{x_{2}}(1-p)^{x_{2}}\cdots\, p^{x_{n}}(1-p)^{x_{n}},\\
 & = & p^{\sum x_{i}}(1-p)^{n-\sum x_{i}}.\end{eqnarray*}

\end_inset

That is, 
\begin_inset Formula \[
\P(X_{1}=x_{1},\, X_{2}=x_{2},\,\ldots,\, X_{n}=x_{n})=p^{\sum x_{i}}(1-p)^{n-\sum x_{i}}.\]

\end_inset

This last quantity is a function of 
\begin_inset Formula $p$
\end_inset

, called the 
\emph on
likelihood function
\emph default
 
\begin_inset Formula $L(p)$
\end_inset

:
\begin_inset Formula \[
L(p)=p^{\sum x_{i}}(1-p)^{n-\sum x_{i}}.\]

\end_inset

A graph of 
\begin_inset Formula $L$
\end_inset

 for values of 
\begin_inset Formula $\sum x_{i}=3,\ 4$
\end_inset

, and 5 when 
\begin_inset Formula $n=7$
\end_inset

 is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:fishing-part-two"

\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

curve(x^5*(1-x)^2, from = 0, to = 1, xlab = "p", ylab = "L(p)")
\begin_inset Newline newline
\end_inset

curve(x^4*(1-x)^3, from = 0, to = 1, add = TRUE)
\begin_inset Newline newline
\end_inset

curve(x^3*(1-x)^4, 0, 1, add = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

curve(x^5*(1-x)^2, 0, 1, xlab = "p", ylab = "L(p)")
\begin_inset Newline newline
\end_inset

curve(x^4*(1-x)^3, 0, 1, add = TRUE)
\begin_inset Newline newline
\end_inset

curve(x^3*(1-x)^4, 0, 1, add = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Assorted likelihood functions for fishing, part two
\begin_inset CommandInset label
LatexCommand label
name "fig:fishing-part-two"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\size small
Three graphs are shown of 
\begin_inset Formula $L$
\end_inset

 when 
\begin_inset Formula $\sum x_{i}$
\end_inset

 equals 3, 4, and 5, respectively, from left to right.
 We pick an 
\begin_inset Formula $L$
\end_inset

 that matches the observed data and then maximize 
\begin_inset Formula $L$
\end_inset

 as a function of 
\begin_inset Formula $p$
\end_inset

.
 If 
\begin_inset Formula $\sum x_{i}=4$
\end_inset

, then the maximum appears to occur somewhere around 
\begin_inset Formula $p\approx0.6$
\end_inset

.
\end_layout

\end_inset


\end_layout

\end_deeper
\begin_layout Example
We want the value of 
\begin_inset Formula $p$
\end_inset

 which has the highest likelihood, that is, we again wish to maximize the
 likelihood.
 We know from calculus (see Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Differential-and-Integral"

\end_inset

) to differentiate 
\begin_inset Formula $L$
\end_inset

 and set 
\begin_inset Formula $L'=0$
\end_inset

 to find a maximum.
\begin_inset Formula \[
L'(p)=\left(\sum x_{i}\right)p^{\sum x_{i}-1}(1-p)^{n-\sum x_{i}}+p^{\sum x_{i}}\left(n-\sum x_{i}\right)(1-p)^{n-\sum x_{i}-1}(-1).\]

\end_inset

 The derivative vanishes (
\begin_inset Formula $L'=0$
\end_inset

) when
\begin_inset Formula \begin{eqnarray*}
\left(\sum x_{i}\right)p^{\sum x_{i}-1}(1-p)^{n-\sum x_{i}} & = & p^{\sum x_{i}}\left(n-\sum x_{i}\right)(1-p)^{n-\sum x_{i}-1},\\
\sum x_{i}(1-p) & = & \left(n-\sum x_{i}\right)p,\\
\sum x_{i}-p\sum x_{i} & = & np-p\sum x_{i},\\
\frac{1}{n}\sum_{i=1}^{n}x_{i} & = & p.\end{eqnarray*}

\end_inset

This 
\begin_inset Quotes eld
\end_inset

best
\begin_inset Quotes erd
\end_inset

 
\begin_inset Formula $p$
\end_inset

, the one which maximizes the likelihood, is called the maximum likelihood
 estimator (MLE) of 
\begin_inset Formula $p$
\end_inset

 and is denoted 
\begin_inset Formula $\hat{p}$
\end_inset

.
 That is, 
\begin_inset Formula \begin{equation}
\hat{p}=\frac{\sum_{i=1}^{n}x_{i}}{n}=\xbar.\end{equation}

\end_inset


\end_layout

\begin_deeper
\begin_layout Remark
Strictly speaking we have only shown that the derivative equals zero at
 
\begin_inset Formula $\hat{p}$
\end_inset

, so it is theoretically possible that the critical value 
\begin_inset Formula $\hat{p}=\xbar$
\end_inset

 is located at a minimum
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
We can tell from the graph that our value of 
\begin_inset Formula $\hat{p}$
\end_inset

 is a maximum instead of a minimum so we do not really need to worry for
 this example.
 Other examples are not so easy, however, and we should be careful to be
 cognizant of this extra step.
\end_layout

\end_inset

 instead of a maximum! We should be thorough and check that 
\begin_inset Formula $L'>0$
\end_inset

 when 
\begin_inset Formula $p<\xbar$
\end_inset

 and 
\begin_inset Formula $L'<0$
\end_inset

 when 
\begin_inset Formula $p>\xbar$
\end_inset

.
 Then by the First Derivative Test (Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:First-Derivative-Test"

\end_inset

) we could be certain that 
\begin_inset Formula $\hat{p}=\xbar$
\end_inset

 is indeed a maximum likelihood estimator, and not a minimum likelihood
 estimator.
\end_layout

\end_deeper
\begin_layout Example
The result is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:species-mle"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

dat <- rbinom(27, size = 1, prob = 0.3)
\begin_inset Newline newline
\end_inset

like <- function(x){
\begin_inset Newline newline
\end_inset

r <- 1
\begin_inset Newline newline
\end_inset

for (k in 1:27){ r <- r*dbinom(dat[k], size = 1, prob = x)}
\begin_inset Newline newline
\end_inset

return(r)
\begin_inset Newline newline
\end_inset

}
\begin_inset Newline newline
\end_inset

curve(like, from = 0, to = 1, xlab = "parameter space", ylab = "Likelihood",
 lwd = 3, col = "blue")
\begin_inset Newline newline
\end_inset

abline(h = 0, lwd = 1, lty = 3, col = "grey")
\begin_inset Newline newline
\end_inset

mle <- mean(dat)
\begin_inset Newline newline
\end_inset

mleobj <- like(mle)
\begin_inset Newline newline
\end_inset

lines(mle, mleobj, type = "h", lwd = 2, lty = 3, col = "red")
\begin_inset Newline newline
\end_inset

points(mle, 0, pch = 4, lwd = 2, cex = 2, col = "red")
\begin_inset Newline newline
\end_inset

text(mle, mleobj/6, substitute(hat(theta)==a, list(a=round(mle, 4))), cex
 = 2, pos = 4)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Species maximum likelihood
\begin_inset CommandInset label
LatexCommand label
name "fig:species-mle"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
In general, we have a family of PDFs 
\begin_inset Formula $f(x|\theta)$
\end_inset

 indexed by a parameter 
\begin_inset Formula $\theta$
\end_inset

 in some parameter space 
\begin_inset Formula $\Theta$
\end_inset

.
 We want to learn about 
\begin_inset Formula $\theta$
\end_inset

.
 We take a 
\begin_inset Formula $SRS(n)$
\end_inset

:
\begin_inset Formula \begin{equation}
X_{1},\, X_{2},\,\ldots,X_{n}\mbox{ which are i.i.d.\,\mbox{f(x|\theta)}.}\end{equation}

\end_inset


\end_layout

\begin_layout Definition
Given the observed data 
\begin_inset Formula $x_{1}$
\end_inset

, 
\begin_inset Formula $x_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $x_{n}$
\end_inset

, the 
\emph on
likelihood function
\emph default
 
\begin_inset Formula $L$
\end_inset

 is defined by 
\begin_inset Formula \[
L(\theta)=\prod_{i=1}^{n}f(x_{i}|\theta),\quad\theta\in\Theta.\]

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
The next step is to maximize 
\begin_inset Formula $L$
\end_inset

.
 The method we will use in this book is to find the derivative 
\begin_inset Formula $L'$
\end_inset

 and solve the equation 
\begin_inset Formula $L'(\theta)=0$
\end_inset

.
 Call a solution 
\begin_inset Formula $\hat{\theta}$
\end_inset

.
 We will check that 
\begin_inset Formula $L$
\end_inset

 is maximized at 
\begin_inset Formula $\hat{\theta}$
\end_inset

 using the First Derivative Test or the Second Derivative Test 
\begin_inset Formula $\left(L''(\hat{\theta})<0\right)$
\end_inset

.
\end_layout

\begin_layout Definition
A value 
\begin_inset Formula $\theta$
\end_inset

 that maximizes 
\begin_inset Formula $L$
\end_inset

 is called a 
\emph on
maximum likelihood estimator
\emph default
 (MLE) and is denoted 
\begin_inset Formula $\hat{\theta}$
\end_inset

.
 It is a function of the sample, 
\begin_inset Formula $\hat{\theta}=\hat{\theta}\left(X_{1},\, X_{2},\,\ldots,X_{n}\right)$
\end_inset

, and is called a 
\emph on
point estimator
\emph default
 of 
\begin_inset Formula $\theta$
\end_inset

.
\end_layout

\begin_layout Remark
Some comments about maximum likelihood estimators:
\end_layout

\begin_deeper
\begin_layout Itemize
Often it is easier to maximize the 
\emph on
log-likelihood
\emph default
 
\begin_inset Formula $l(\theta)=\ln L(\theta)$
\end_inset

 instead of the likelihood 
\begin_inset Formula $L$
\end_inset

.
 Since the logarithmic function 
\begin_inset Formula $y=\ln x$
\end_inset

 is a monotone transformation, the solutions to both problems are the same.
\end_layout

\begin_layout Itemize
MLEs do not always exist (for instance, sometimes the likelihood has a vertical
 asymptote), and even when they do exist, they are not always unique (imagine
 a function with a bunch of humps of equal height).
 For any given problem, there could be zero, one, or any number of values
 of 
\begin_inset Formula $\theta$
\end_inset

 for which 
\begin_inset Formula $L(\theta)$
\end_inset

 is a maximum.
\end_layout

\begin_layout Itemize
The problems we encounter in this book are all very nice with likelihood
 functions that have closed form representations and which are optimized
 by some calculus acrobatics.
 In practice, however, likelihood functions are sometimes nasty in which
 case we are obliged to use numerical methods to find maxima (if there are
 any).
\end_layout

\begin_layout Itemize
MLEs are just one of 
\bar under
many
\bar default
 possible estimators.
 One of the more popular alternatives are the 
\emph on
method of moments estimators
\emph default
; see Casella and Berger 
\begin_inset CommandInset citation
LatexCommand cite
key "Casella2002"

\end_inset

 for more.
\end_layout

\end_deeper
\begin_layout Standard
Notice, in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:bass-bluegill"

\end_inset

 we had 
\begin_inset Formula $X_{i}$
\end_inset

 i.i.d.
\begin_inset space ~
\end_inset


\begin_inset Formula $\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)$
\end_inset

, and we saw that the MLE was 
\begin_inset Formula $\hat{p}=\Xbar$
\end_inset

.
 But further
\begin_inset Formula \begin{eqnarray*}
\E\Xbar & = & \E\frac{X_{1}+X_{2}+\cdots+X_{n}}{n},\\
 & = & \frac{1}{n}\left(\E X_{1}+\E X_{2}+\cdots+\E X_{n}\right),\\
 & = & \frac{1}{n}\left(np\right),\\
 & = & p,\end{eqnarray*}

\end_inset

which is exactly the same as the parameter which we estimated.
 More concisely, 
\begin_inset Formula $\E\hat{p}=p$
\end_inset

, that is, on the average, the estimator is exactly right.
\end_layout

\begin_layout Definition
Let 
\begin_inset Formula $s(X_{1},X_{2},\ldots,X_{n})$
\end_inset

 be a statistic which estimates 
\begin_inset Formula $\theta$
\end_inset

.
 If 
\begin_inset Formula \[
\E s(X_{1},X_{2},\ldots,X_{n})=\theta,\]

\end_inset

then the statistic 
\begin_inset Formula $s(X_{1},X_{2},\ldots,X_{n})$
\end_inset

 is said to be an 
\emph on
unbiased estimator
\emph default
 of 
\begin_inset Formula $\theta$
\end_inset

.
 Otherwise, it is 
\emph on
biased
\emph default
.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:normal-MLE-both"

\end_inset

Let 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 be an 
\begin_inset Formula $SRS(n)$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 distribution.
 It can be shown (in Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:norm-mu-sig-MLE"

\end_inset

) that if 
\begin_inset Formula $\mbox{\theta}=(\mu,\sigma^{2})$
\end_inset

 then the MLE of 
\begin_inset Formula $\theta$
\end_inset

 is
\begin_inset Formula \begin{equation}
\hat{\theta}=(\hat{\mu},\hat{\sigma}^{2}),\end{equation}

\end_inset

 where 
\begin_inset Formula $\hat{\mu}=\Xbar$
\end_inset

 and 
\begin_inset Formula \begin{equation}
\hat{\sigma^{2}}=\frac{1}{n}\sum_{i=1}^{n}\left(X_{i}-\Xbar\right)^{2}=\frac{n-1}{n}S^{2}.\end{equation}

\end_inset

We of course know from 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:mean-sd-xbar"

\end_inset

 that 
\begin_inset Formula $\hat{\mu}$
\end_inset

 is unbiased.
 What about 
\begin_inset Formula $\hat{\sigma^{2}}$
\end_inset

? Let us check: 
\begin_inset Formula \begin{eqnarray*}
\E\,\hat{\sigma^{2}} & = & \E\,\frac{n-1}{n}S^{2}\\
 & = & \E\left(\frac{\sigma^{2}}{n}\frac{(n-1)S^{2}}{\sigma^{2}}\right)\\
 & = & \frac{\sigma^{2}}{n}\E\ \mathsf{chisq}(\mathtt{df}=n-1)\\
 & = & \frac{\sigma^{2}}{n}(n-1),\end{eqnarray*}

\end_inset

from which we may conclude two things:
\end_layout

\begin_deeper
\begin_layout Enumerate
\begin_inset Formula $\hat{\sigma^{2}}$
\end_inset

 is a biased estimator of 
\begin_inset Formula $\sigma^{2}$
\end_inset

, and 
\end_layout

\begin_layout Enumerate
\begin_inset Formula $S^{2}=n\hat{\sigma^{2}}/(n-1)$
\end_inset

 is an unbiased estimator of 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Standard
One of the most common questions in an introductory statistics class is,
 
\begin_inset Quotes eld
\end_inset

Why do we divide by 
\begin_inset Formula $n-1$
\end_inset

 when we compute the sample variance? Why do we not divide by 
\begin_inset Formula $n$
\end_inset

?
\begin_inset Quotes erd
\end_inset

 We see now that division by 
\begin_inset Formula $n$
\end_inset

 amounts to the use of a 
\emph on
biased
\emph default
 estimator for 
\begin_inset Formula $\sigma^{2}$
\end_inset

, that is, if we divided by 
\begin_inset Formula $n$
\end_inset

 then on the average we would 
\emph on
underestimate
\emph default
 the true value of 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
 We use 
\begin_inset Formula $n-1$
\end_inset

 so that, on the average, our estimator of 
\begin_inset Formula $\sigma^{2}$
\end_inset

 will be exactly right.
 
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard

\family sans
R
\family default
 can be used to find maximum likelihood estimators in a lot of diverse settings.
 We will discuss only the most basic here and will leave the rest to more
 sophisticated texts.
\end_layout

\begin_layout Standard
For one parameter estimation problems we may use the 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

optimize
\end_layout

\end_inset

 function to find MLEs.
 The arguments are the function to be maximized (the likelihood function),
 the range over which the optimization is to take place, and optionally
 any other arguments to be passed to the likelihood if needed.
\end_layout

\begin_layout Standard
Let us see how to do Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:bass-bluegill"

\end_inset

.
 Recall that our likelihood function was given by
\begin_inset Formula \begin{equation}
L(p)=p^{\sum x_{i}}(1-p)^{n-\sum x_{i}}.\end{equation}

\end_inset

Notice that the likelihood is just a product of 
\begin_inset Formula $\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)$
\end_inset

 PMFs.
 We first give some sample data (in the vector 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

datavals
\end_layout

\end_inset

), next we define the likelihood function 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

L
\end_layout

\end_inset

, and finally we 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

optimize
\end_layout

\end_inset

 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

L
\end_layout

\end_inset

 over the range 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

c(0,1)
\end_layout

\end_inset

.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x <- mtcars$am
\begin_inset Newline newline
\end_inset

L <- function(p,x) prod(dbinom(x, size = 1, prob = p))
\begin_inset Newline newline
\end_inset

optimize(L, interval = c(0,1), x = x, maximum = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<echo = FALSE>>=
\begin_inset Newline newline
\end_inset

A <- optimize(L, interval = c(0,1), x = x, maximum = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Note that the 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

optimize
\end_layout

\end_inset

 function by default minimizes the function 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

L
\end_layout

\end_inset

, so we have to set 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

maximum = TRUE
\end_layout

\end_inset

 to get an MLE.
 The returned value of 
\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

$maximum
\end_layout

\end_inset

 gives an approximate value of the MLE to be 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(A$maximum, 3)}
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

$objective
\end_layout

\end_inset

 gives 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

L
\end_layout

\end_inset

 evaluated at the MLE which is approximately 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(A$objective, 3)}
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
We previously remarked that it is usually more numerically convenient to
 maximize the log-likelihood (or minimize the negative log-likelihood),
 and we can just as easily do this with 
\family sans
R
\family default
.
 We just need to calculate the log-likelihood beforehand which (for this
 example) is
\begin_inset Formula \[
-l(p)=-\sum x_{i}\ln\, p-\left(n-\sum x_{i}\right)\ln(1-p).\]

\end_inset

It is done in 
\family sans
R
\family default
 with
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

minuslogL <- function(p,x) -sum(dbinom(x, size = 1, prob = p, log = TRUE))
\begin_inset Newline newline
\end_inset

optimize(minuslogL, interval = c(0,1), x = x)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Note that we did not need 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

maximum = TRUE
\end_layout

\end_inset

 because we minimized the negative log-likelihood.
 The answer for the MLE is essentially the same as before, but the 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

$objective
\end_layout

\end_inset

 value was different, of course.
\end_layout

\begin_layout Standard
For multiparameter problems we may use a similar approach by way of the
 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mle
\end_layout

\end_inset

 function in the 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stats4
\end_layout

\end_inset

 package.
 
\end_layout

\begin_layout Example

\series bold
Plant Growth.

\series default
 We will investigate the 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

weight
\end_layout

\end_inset

 variable of the 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

PlantGrowth
\end_layout

\end_inset

 data.
 We will suppose that the weights constitute a random observations 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

,\SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 that are i.i.d.
\begin_inset space ~
\end_inset


\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 which is not unreasonable based on a histogram and other exploratory measures.
 We will find the MLE of 
\begin_inset Formula $\theta=(\mu,\sigma^{2})$
\end_inset

.
 We claimed in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:normal-MLE-both"

\end_inset

 that 
\begin_inset Formula $\hat{\theta}=(\hat{\mu},\hat{\sigma}^{2})$
\end_inset

 had the form given above.
 Let us check whether this is plausible numerically.
 The negative log-likelihood function is
\end_layout

\begin_deeper
\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

minuslogL <- function(mu, sigma2){
\begin_inset Newline newline
\end_inset

  -sum(dnorm(x, mean = mu, sd = sqrt(sigma2), log = TRUE))
\begin_inset Newline newline
\end_inset

}
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Note that we omitted the data as an argument to the log-likelihood function;
 the only arguments were the parameters over which the maximization is to
 take place.
 Now we will simulate some data and find the MLE.
 The optimization algorithm requires starting values (intelligent guesses)
 for the parameters.
 We choose values close to the sample mean and variance (which turn out
 to be approximately 5 and 0.5, respectively) to illustrate the procedure.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x <- PlantGrowth$weight
\begin_inset Newline newline
\end_inset

library(stats4)
\begin_inset Newline newline
\end_inset

MaxLikeEst <- mle(minuslogL, start = list(mu = 5, sigma2 = 0.5))
\begin_inset Newline newline
\end_inset

summary(MaxLikeEst)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The outputted MLEs are shown above, and 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

mle
\end_layout

\end_inset

 even gives us estimates for the standard errors of 
\begin_inset Formula $\hat{\mu}$
\end_inset

 and 
\begin_inset Formula $\hat{\sigma}^{2}$
\end_inset

 (which were obtained by inverting the numerical Hessian matrix at the optima;
 see Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Multivariable-Calculus"

\end_inset

).
 Let us check how close the numerical MLEs came to the theoretical MLEs:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

mean(x)
\begin_inset Newline newline
\end_inset

var(x)*29/30
\begin_inset Newline newline
\end_inset

sd(x)/sqrt(30)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The numerical MLEs were very close to the theoretical MLEs.
 We already knew that the standard error of 
\begin_inset Formula $\hat{\mu}=\Xbar$
\end_inset

 is 
\begin_inset Formula $\sigma/\sqrt{n}$
\end_inset

, and the numerical estimate of this was very close too.
\end_layout

\end_deeper
\begin_layout Standard
There is functionality in the 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

distrTest
\end_layout

\end_inset

 package 
\begin_inset CommandInset citation
LatexCommand cite
key "Ruckdescheldistr"

\end_inset

 to calculate theoretical MLEs; we will skip examples of these for the time
 being.
\end_layout

\begin_layout Section
Confidence Intervals for Means
\begin_inset CommandInset label
LatexCommand label
name "sec:Confidence-Intervals-for-Means"

\end_inset


\end_layout

\begin_layout Standard
We are given 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 that are an 
\begin_inset Formula $SRS(n)$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 distribution, where 
\begin_inset Formula $\mu$
\end_inset

 is unknown.
 We know that we may estimate 
\begin_inset Formula $\mu$
\end_inset

 with 
\begin_inset Formula $\Xbar$
\end_inset

, and we have seen that this estimator is the MLE.
 But how good is our estimate? We know that 
\begin_inset Formula \begin{equation}
\frac{\Xbar-\mu}{\sigma/\sqrt{n}}\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1).\end{equation}

\end_inset

For a big probability 
\begin_inset Formula $1-\alpha$
\end_inset

, for instance, 95%, we can calculate the quantile 
\begin_inset Formula $z_{\alpha/2}$
\end_inset

.
 Then 
\begin_inset Formula \begin{equation}
\P\left(-z_{\alpha/2}\leq\frac{\Xbar-\mu}{\sigma/\sqrt{n}}\leq z_{\alpha/2}\right)=1-\alpha.\end{equation}

\end_inset

But now consider the following string of equivalent inequalities:
\begin_inset Formula \[
-z_{\alpha/2}\leq\frac{\Xbar-\mu}{\sigma/\sqrt{n}}\leq z_{\alpha/2},\]

\end_inset


\begin_inset Formula \[
-z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right)\leq\Xbar-\mu\leq z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right),\]

\end_inset


\begin_inset Formula \[
-\Xbar-z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right)\leq-\mu\leq-\Xbar+z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right),\]

\end_inset


\begin_inset Formula \[
\Xbar-z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right)\leq\mu\leq\Xbar+z_{\alpha/2}\left(\frac{\sigma}{\sqrt{n}}\right).\]

\end_inset

That is, 
\begin_inset Formula \begin{equation}
\P\left(\Xbar-z_{\alpha/2}\frac{\sigma}{\sqrt{n}}\leq\mu\leq\Xbar+z_{\alpha/2}\frac{\sigma}{\sqrt{n}}\right)=1-\alpha.\end{equation}

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Definition
The interval
\begin_inset Formula \begin{equation}
\left[\Xbar-z_{\alpha/2}\frac{\sigma}{\sqrt{n}},\ \Xbar+z_{\alpha/2}\frac{\sigma}{\sqrt{n}}\right]\end{equation}

\end_inset

 is a 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 
\emph on
confidence interval for
\emph default
 
\begin_inset Formula $\mu$
\end_inset

.
 The quantity 
\begin_inset Formula $1-\alpha$
\end_inset

 is called the 
\emph on
confidence coefficient
\emph default
.
\end_layout

\begin_layout Remark
The interval is also sometimes written more compactly as
\begin_inset Formula \begin{equation}
\Xbar\pm z_{\alpha/2}\frac{\sigma}{\sqrt{n}}.\label{eq:z-interval}\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The interpretation of confidence intervals is tricky and often mistaken
 by novices.
 When I am teaching the concept 
\begin_inset Quotes eld
\end_inset

live
\begin_inset Quotes erd
\end_inset

 during class, I usually ask the students to imagine that my piece of chalk
 represents the 
\begin_inset Quotes eld
\end_inset

unknown
\begin_inset Quotes erd
\end_inset

 parameter, and I lay it down on the desk in front of me.
 Once the chalk has been lain, it is 
\emph on
fixed
\emph default
; it does not move.
 Our goal is to estimate the parameter.
 For the estimator I pick up a sheet of loose paper lying nearby.
 The estimation procedure is to randomly drop the piece of paper from above,
 and observe where it lands.
 If the piece of paper covers the piece of chalk, then we are successful
 -- our estimator covers the parameter.
 If it falls off to one side or the other, then we are unsuccessful; our
 interval fails to cover the parameter.
\end_layout

\begin_layout Standard
Then I ask them: suppose we were to repeat this procedure hundreds, thousands,
 millions of times.
 Suppose we kept track of how many times we covered and how many times we
 did not.
 What percentage of the time would we be successful?
\end_layout

\begin_layout Standard
In the demonstration, the parameter corresponds to the chalk, the sheet
 of paper corresponds to the confidence interval, and the random experiment
 corresponds to dropping the sheet of paper.
 The percentage of the time that we are successful 
\emph on
exactly
\emph default
 corresponds to the 
\emph on
confidence coefficient
\emph default
.
 That is, if we use a 95% confidence interval, then we can say that, in
 the long run, approximately 95% of our intervals will cover the true parameter
 (which is fixed, but unknown).
 
\end_layout

\begin_layout Standard
See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:ci-examp"

\end_inset

, which is a graphical display of these ideas.
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 6, width = 6>>=
\begin_inset Newline newline
\end_inset

set.seed(seed + 1)
\begin_inset Newline newline
\end_inset

library(TeachingDemos)
\begin_inset Newline newline
\end_inset

ci.examp()
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Simulated confidence intervals
\begin_inset CommandInset label
LatexCommand label
name "fig:ci-examp"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Plain Layout

\size small
The graph was generated by the 
\family typewriter
ci.examp
\family default
 function from the 
\family typewriter
TeachingDemos
\family default
 package.
 Fifty (50) samples of size twenty five (25) were generated from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=100,\,\mathtt{sd}=10)$
\end_inset

 distribution, and each sample was used to find a 95% confidence interval
 for the population mean using Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:z-interval"

\end_inset

.
 The 50 confidence intervals are represented above by horizontal lines,
 and the respective sample means are denoted by vertical slashes.
 Confidence intervals that 
\begin_inset Quotes eld
\end_inset

cover
\begin_inset Quotes erd
\end_inset

 the true mean value of 100 are plotted in black; those that fail to cover
 are plotted in a lighter color.
 In the plot we see that only one (1) of the simulated intervals out of
 the 50 failed to cover 
\begin_inset Formula $\mu=100$
\end_inset

, which is a success rate of 98%.
 If the number of generated samples were to increase from 50 to 500 to 50000,
 \SpecialChar \ldots{}
, then we would expect our success rate to approach the exact value of
 95%.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Under the above framework, we can reason that an 
\begin_inset Quotes eld
\end_inset

interval
\begin_inset Quotes erd
\end_inset

 with a 
\emph on
larger
\emph default
 confidence coefficient corresponds to a 
\emph on
wider
\emph default
 sheet of paper.
 Furthermore, the width of the confidence interval (sheet of paper) should
 be 
\emph on
somehow
\emph default
 related to the amount of information contained in the random sample, 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

.
 The following remarks makes these notions precise.
 
\end_layout

\begin_layout Remark
For a fixed confidence coefficient 
\begin_inset Formula $1-\alpha$
\end_inset

,
\begin_inset Formula \begin{equation}
\mbox{if }n\mbox{ increases, then the confidence interval gets \emph{SHORTER}.}\end{equation}

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Remark
For a fixed sample size 
\begin_inset Formula $n$
\end_inset

,
\begin_inset Formula \begin{equation}
\mbox{if }1-\alpha\mbox{ increases, then the confidence interval gets \emph{WIDER}.}\end{equation}

\end_inset


\end_layout

\begin_layout Example

\series bold
Results from an Experiment on Plant Growth.
\begin_inset CommandInset label
LatexCommand label
name "exa:plant-one-samp-z-int"

\end_inset


\series default
 The 
\begin_inset listings
lstparams "basicstyle={\ttfamily},showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

PlantGrowth
\end_layout

\end_inset

 data frame gives the results of an experiment to measure plant yield (as
 measured by the weight of the plant).
 We would like to a 95% confidence interval for the mean weight of the plants.
 Suppose that we know from prior research that the true population standard
 deviation of the plant weights is 
\begin_inset Formula $0.7$
\end_inset


\begin_inset space ~
\end_inset

g.
\end_layout

\begin_layout Example
The parameter of interest is 
\begin_inset Formula $\mu$
\end_inset

, which represents the true mean weight of the population of all plants
 of the particular species in the study.
 We will first take a look at a stemplot of the data:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(aplpack)
\begin_inset Newline newline
\end_inset

with(PlantGrowth, stem.leaf(weight))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The data appear to be approximately normal with no extreme values.
 The data come from a designed experiment, so it is reasonable to suppose
 that the observations constitute a simple random sample of weights
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Actually we will see later that there is reason to believe that the observations
 are simple random samples from three distinct populations.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Analysis-of-Variance"

\end_inset

.
\end_layout

\end_inset

.
 We know the population standard deviation 
\begin_inset Formula $\sigma=0.70$
\end_inset

 from prior research.
 We are going to use the one-sample 
\begin_inset Formula $z$
\end_inset

-interval.
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

dim(PlantGrowth)   # sample size is first entry
\begin_inset Newline newline
\end_inset

with(PlantGrowth, mean(weight))
\begin_inset Newline newline
\end_inset

qnorm(0.975)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We find the sample mean of the data to be 
\begin_inset Formula $\xbar=5.073$
\end_inset

 and 
\begin_inset Formula $z_{\alpha/2}=z_{0.025}\approx1.96$
\end_inset

.
 Our interval is therefore
\begin_inset Formula \[
\xbar\pm z_{\alpha/2}\frac{\sigma}{\sqrt{n}}=5.073\pm1.96\cdot\frac{0.70}{\sqrt{30}},\]

\end_inset

which comes out to approximately 
\begin_inset Formula $[4.823,\,5.323]$
\end_inset

.
 In conclusion, we are 95% confident that the true mean weight 
\begin_inset Formula $\mu$
\end_inset

 of all plants of this species lies somewhere between 4.823
\begin_inset space ~
\end_inset

g and 5.323
\begin_inset space ~
\end_inset

g, that is, we are 95% confident that the interval 
\begin_inset Formula $[4.823,\,5.323]$
\end_inset

 covers 
\begin_inset Formula $\mu$
\end_inset

.
 See Figure 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 6.5, width = 6.5>>=
\begin_inset Newline newline
\end_inset

library(TeachingDemos)
\begin_inset Newline newline
\end_inset

plot(z.test(PlantGrowth$weight, stdev = 0.70), "Conf")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Confidence interval plot for the 
\family typewriter
PlantGrowth
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:plant-z-int-plot"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Plain Layout

\size small
The shaded portion represents 95% of the total area under the curve, and
 the upper and lower bounds are the limits of the one-sample 95% confidence
 interval.
 The graph is centered at the observed sample mean.
 It was generated by computing a 
\family typewriter
z.test
\family default
 from the 
\family typewriter
TeachingDemos
\family default
 package, storing the resulting 
\family typewriter
htest
\family default
 object, and plotting it with the 
\family typewriter
normal.and.t.dist
\family default
 function from the 
\family typewriter
HH
\family default
 package.
 See the remarks in the 
\begin_inset Quotes eld
\end_inset

How to do it with 
\family sans
R
\family default

\begin_inset Quotes erd
\end_inset

 discussion later in this section.
\end_layout

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Example
Give some data with 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 an 
\begin_inset Formula $SRS(n)$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 distribution.
 Maybe small sample?
\end_layout

\begin_layout Enumerate
What is the parameter of interest? in the context of the problem.
 Give a point estimate for 
\begin_inset Formula $\mu$
\end_inset

.
\end_layout

\begin_layout Enumerate
What are the assumptions being made in the problem? Do they meet the conditions
 of the interval?
\end_layout

\begin_layout Enumerate
Calculate the interval.
\end_layout

\begin_layout Enumerate
Draw the conclusion.
\end_layout

\begin_layout Remark
What if 
\begin_inset Formula $\sigma$
\end_inset

 is unknown? We instead use the interval
\begin_inset Formula \begin{equation}
\Xbar\pm z_{\alpha/2}\frac{S}{\sqrt{n}},\end{equation}

\end_inset

where 
\begin_inset Formula $S$
\end_inset

 is the sample standard deviation.
\end_layout

\begin_deeper
\begin_layout Itemize
If 
\begin_inset Formula $n$
\end_inset

 is large, then 
\begin_inset Formula $\Xbar$
\end_inset

 will have an approximately normal distribution regardless of the underlying
 population (by the CLT) and 
\begin_inset Formula $S$
\end_inset

 will be very close to the parameter 
\begin_inset Formula $\sigma$
\end_inset

 (by the SLLN); thus the above interval will have approximately 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence of covering 
\begin_inset Formula $\mu$
\end_inset

.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $n$
\end_inset

 is small, then 
\end_layout

\begin_deeper
\begin_layout Itemize
If the underlying population is normal then we may replace 
\begin_inset Formula $z_{\alpha/2}$
\end_inset

 with 
\begin_inset Formula $t_{\alpha/2}(\mathtt{df}=n-1)$
\end_inset

.
 The resulting 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence interval is
\begin_inset Formula \begin{equation}
\Xbar\pm t_{\alpha/2}(\mathtt{df}=n-1)\frac{S}{\sqrt{n}}\label{eq:one-samp-t-int}\end{equation}

\end_inset


\end_layout

\begin_layout Itemize
if the underlying population is not normal, but approximately normal, then
 we may use the 
\begin_inset Formula $t$
\end_inset

 interval, Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:one-samp-t-int"

\end_inset

.
 The interval will have approximately 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence of covering 
\begin_inset Formula $\mu$
\end_inset

.
 However, if the population is highly skewed or the data have outliers,
 then we should ask a professional statistician for advice.
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard
The author learned of a handy acronym from AP Statistics Exam graders that
 summarizes the important parts of confidence interval estimation, which
 is PANIC: 
\emph on
P
\emph default
arameter, 
\emph on
A
\emph default
ssumptions, 
\emph on
N
\emph default
ame, 
\emph on
I
\emph default
nterval, and 
\emph on
C
\emph default
onclusion.
\end_layout

\begin_layout Description
Parameter: identify the parameter of interest with the proper symbols.
 Write down what the parameter means in the context of the problem.
 
\end_layout

\begin_layout Description
Assumptions: list any assumptions made in the experiment.
 If there are any other assumptions needed or that were not checked, state
 what they are and why they are important.
\end_layout

\begin_layout Description
Name: choose a statistical procedure from your bag of tricks based on the
 answers to the previous two parts.
 The assumptions of the procedure you choose should match those of the problem;
 if they do not match then either pick a different procedure or openly admit
 that the results may not be reliable.
 Write down any underlying formulas used.
\end_layout

\begin_layout Description
Interval: calculate the interval from the sample data.
 This can be done by hand but will more often be done with the aid of a
 computer.
 Regardless of the method, all calculations or code should be shown so that
 the entire process is repeatable by a subsequent reader.
\end_layout

\begin_layout Description
Conclusion: state the final results, using language in the context of the
 problem.
 Include the appropriate interpretation of the interval, making reference
 to the confidence coefficient.
\end_layout

\begin_layout Remark
All of the above intervals for 
\begin_inset Formula $\mu$
\end_inset

 were two-sided, but there are also one-sided intervals for 
\begin_inset Formula $\mu$
\end_inset

.
 They look like 
\begin_inset Formula \begin{equation}
\left[\Xbar-z_{\alpha}\frac{\sigma}{\sqrt{n}},\ \infty\right)\quad\mbox{or}\quad\left(-\infty,\ \Xbar+z_{\alpha}\frac{\sigma}{\sqrt{n}}\right]\end{equation}

\end_inset

and satisfy
\begin_inset Formula \begin{equation}
\P\left(\Xbar-z_{\alpha}\frac{\sigma}{\sqrt{n}}\leq\mu\right)=1-\alpha\quad\mbox{and}\quad\P\left(\Xbar+z_{\alpha}\frac{\sigma}{\sqrt{n}}\geq\mu\right)=1-\alpha.\end{equation}

\end_inset


\end_layout

\begin_layout Example
Small sample, some data with 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 an 
\begin_inset Formula $SRS(n)$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 distribution.
\end_layout

\begin_deeper
\begin_layout Enumerate
PANIC
\end_layout

\end_deeper
\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
We can do Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:plant-one-samp-z-int"

\end_inset

 with the following code.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(TeachingDemos)
\begin_inset Newline newline
\end_inset

temp <- with(PlantGrowth, z.test(weight, stdev = 0.7))
\begin_inset Newline newline
\end_inset

temp
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The confidence interval bounds are shown in the sixth line down of the output
 (please disregard all of the additional output information for now -- we
 will use it in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Hypothesis-Testing"

\end_inset

).
 We can make the plot for Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:plant-z-int-plot"

\end_inset

 with
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

library(IPSUR)
\begin_inset Newline newline
\end_inset

plot(temp, "Conf")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Section
Confidence Intervals for Differences of Means
\begin_inset CommandInset label
LatexCommand label
name "sec:Conf-Interv-for-Diff-Means"

\end_inset


\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 be a 
\begin_inset Formula $SRS(n)$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu_{X},\,\mathtt{sd}=\sigma_{X})$
\end_inset

 distribution and let 
\begin_inset Formula $Y_{1}$
\end_inset

, 
\begin_inset Formula $Y_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $Y_{m}$
\end_inset

 be a 
\begin_inset Formula $SRS(m)$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu_{Y},\,\mathtt{sd}=\sigma_{Y})$
\end_inset

 distribution.
 Further, assume that the 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 sample is independent of the 
\begin_inset Formula $Y_{1}$
\end_inset

, 
\begin_inset Formula $Y_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $Y_{m}$
\end_inset

 sample.
\end_layout

\begin_layout Standard
Suppose that 
\begin_inset Formula $\sigma_{X}$
\end_inset

 and 
\begin_inset Formula $\sigma_{Y}$
\end_inset

 are known.
 We would like a confidence interval for 
\begin_inset Formula $\mu_{X}-\mu_{Y}$
\end_inset

.
 We know that 
\begin_inset Formula \begin{equation}
\Xbar-\Ybar\sim\mathsf{norm}\left(\mathtt{mean}=\mu_{X}-\mu_{Y},\,\mathtt{sd}=\sqrt{\frac{\sigma_{X}^{2}}{n}+\frac{\sigma_{Y}^{2}}{m}}\right).\end{equation}

\end_inset

Therefore, a 
\begin_inset Formula $100(1-\alpha)$
\end_inset

% confidence interval for 
\begin_inset Formula $\mu_{X}-\mu_{Y}$
\end_inset

 is given by
\begin_inset Formula \begin{equation}
\left(\Xbar-\Ybar\right)\pm z_{\alpha/2}\sqrt{\frac{\sigma_{X}^{2}}{n}+\frac{\sigma_{Y}^{2}}{m}}.\label{eq:two-samp-mean-CI}\end{equation}

\end_inset

Unfortunately, most of the time the values of 
\begin_inset Formula $\sigma_{X}$
\end_inset

 and 
\begin_inset Formula $\sigma_{Y}$
\end_inset

 are unknown.
 This leads us to the following:
\end_layout

\begin_layout Itemize
If both sample sizes are large, then we may appeal to the CLT/SLLN (see
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Central-Limit-Theorem"

\end_inset

) and substitute 
\begin_inset Formula $S_{X}^{2}$
\end_inset

 and 
\begin_inset Formula $S_{Y}^{2}$
\end_inset

 for 
\begin_inset Formula $\sigma_{X}^{2}$
\end_inset

 and 
\begin_inset Formula $\sigma_{Y}^{2}$
\end_inset

 in the interval 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:two-samp-mean-CI"

\end_inset

.
 The resulting confidence interval will have approximately 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence.
\end_layout

\begin_layout Itemize
If one or more of the sample sizes is small then we are in trouble, unless
\end_layout

\begin_deeper
\begin_layout Itemize
the underlying populations are both normal and 
\begin_inset Formula $\sigma_{X}=\sigma_{Y}$
\end_inset

.
 In this case (setting 
\begin_inset Formula $\sigma=\sigma_{X}=\sigma_{Y}$
\end_inset

), 
\begin_inset Formula \begin{equation}
\Xbar-\Ybar\sim\mathsf{norm}\left(\mathtt{mean}=\mu_{X}-\mu_{Y},\,\mathtt{sd}=\sigma\sqrt{\frac{1}{n}+\frac{1}{m}}\right).\end{equation}

\end_inset

Now let 
\begin_inset Formula \begin{equation}
U=\frac{n-1}{\sigma^{2}}S_{X}^{2}+\frac{m-1}{\sigma^{2}}S_{Y}^{2}.\end{equation}

\end_inset

Then by Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:sum-indep-chisq"

\end_inset

 we know that 
\begin_inset Formula $U\sim\mathsf{chisq}(\mathtt{df}=n+m-2)$
\end_inset

 and is not a large leap to believe that 
\begin_inset Formula $U$
\end_inset

 is independent of 
\begin_inset Formula $\Xbar-\Ybar$
\end_inset

; thus 
\begin_inset Formula \begin{equation}
T=\frac{Z}{\sqrt{\left.U\right\slash (n+m-2)}}\sim\mathsf{t}(\mathtt{df}=n+m-2).\end{equation}

\end_inset

But
\begin_inset Formula \begin{align*}
T & =\frac{\frac{\Xbar-\Ybar-(\mu_{X}-\mu_{Y})}{\sigma\sqrt{\frac{1}{n}+\frac{1}{m}}}}{\sqrt{\left.\frac{n-1}{\sigma^{2}}S_{X}^{2}+\frac{m-1}{\sigma^{2}}S_{Y}^{2}\right\slash (n+m-2)}},\\
 & =\frac{\Xbar-\Ybar-(\mu_{X}-\mu_{Y})}{\sqrt{\left(\frac{1}{n}+\frac{1}{m}\right)\left(\frac{(n-1)S_{X}^{2}+(m-1)S_{Y}^{2}}{n+m-2}\right)}},\\
 & \sim\mathsf{t}(\mathtt{df}=n+m-2).\end{align*}

\end_inset

Therefore a 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence interval for 
\begin_inset Formula $\mu_{X}-\mu_{Y}$
\end_inset

 is given by
\begin_inset Formula \begin{equation}
\left(\Xbar-\Ybar\right)\pm t_{\alpha/2}(\mathtt{df}=n+m-2)\, S_{p}\sqrt{\frac{1}{n}+\frac{1}{m}},\end{equation}

\end_inset

where 
\begin_inset Formula \begin{equation}
S_{p}=\sqrt{\frac{(n-1)S_{X}^{2}+(m-1)S_{Y}^{2}}{n+m-2}}\end{equation}

\end_inset

is called the 
\begin_inset Quotes eld
\end_inset

pooled
\begin_inset Quotes erd
\end_inset

 estimator of 
\begin_inset Formula $\sigma$
\end_inset

.
\end_layout

\begin_layout Itemize
if one of the samples is small, and both underlying populations are normal,
 but 
\begin_inset Formula $\sigma_{X}\neq\sigma_{Y}$
\end_inset

, then we may use a Welch (or Satterthwaite) approximation to the degrees
 of freedom.
 See Welch 
\begin_inset CommandInset citation
LatexCommand cite
key "Welch1947"

\end_inset

, Satterthwaite 
\begin_inset CommandInset citation
LatexCommand cite
key "Satterthwaite1946"

\end_inset

, or Neter 
\emph on
et al
\emph default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Neter1996"

\end_inset

.
 The idea is to use an interval of the form
\begin_inset Formula \begin{equation}
\left(\Xbar-\Ybar\right)\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=r)\,\sqrt{\frac{S_{X}^{2}}{n}+\frac{S_{Y}^{2}}{m}},\end{equation}

\end_inset

where the degrees of freedom 
\begin_inset Formula $r$
\end_inset

 is chosen so that the interval has nice statistical properties.
 It turns out that a good choice for 
\begin_inset Formula $r$
\end_inset

 is given by
\begin_inset Formula \begin{equation}
r=\frac{\left(S_{X}^{2}/n+S_{Y}^{2}/m\right)^{2}}{\frac{1}{n-1}\left(S_{X}^{2}/n\right)^{2}+\frac{1}{m-1}\left(S_{Y}^{2}/m\right)^{2}},\end{equation}

\end_inset

where we understand that 
\begin_inset Formula $r$
\end_inset

 is rounded down to the nearest integer.
 The resulting interval has approximately 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence.
\end_layout

\end_deeper
\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The basic function is 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

t.test
\end_layout

\end_inset

 which has a 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

var.equal
\end_layout

\end_inset

 argument that may be set to 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

TRUE
\end_layout

\end_inset

 or 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

FALSE
\end_layout

\end_inset

.
 The confidence interval is shown as part of the output, although there
 is a lot of additional information that is not needed until Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Hypothesis-Testing"

\end_inset

.
\end_layout

\begin_layout Standard
There is not any specific functionality to handle the 
\begin_inset Formula $z$
\end_inset

-interval for small samples, but if the samples are large then 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

t.test
\end_layout

\end_inset

 with 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

var.equal = FALSE
\end_layout

\end_inset

 will be essentially the same thing.
 The standard deviations are never (?) known in advance anyway so it does
 not really matter in practice.
 
\end_layout

\begin_layout Section
Confidence Intervals for Proportions
\begin_inset CommandInset label
LatexCommand label
name "sec:Confidence-Intervals-Proportions"

\end_inset


\end_layout

\begin_layout Standard
We would like to know 
\begin_inset Formula $p$
\end_inset

 which is the 
\begin_inset Quotes eld
\end_inset

proportion of successes
\begin_inset Quotes erd
\end_inset

.
 For instance, 
\begin_inset Formula $p$
\end_inset

 could be:
\end_layout

\begin_layout Itemize
the proportion of U.S.
\begin_inset space ~
\end_inset

citizens that support Obama,
\end_layout

\begin_layout Itemize
the proportion of smokers among adults age 18 or over,
\end_layout

\begin_layout Itemize
the proportion of people worldwide infected by the H1N1 virus.
\end_layout

\begin_layout Standard
We are given an 
\begin_inset Formula $SRS(n)$
\end_inset

 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 distributed 
\begin_inset Formula $\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)$
\end_inset

.
 Recall from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:binom-dist"

\end_inset

 that the common mean of these variables is 
\begin_inset Formula $\E X=p$
\end_inset

 and the variance is 
\begin_inset Formula $\E(X-p)^{2}=p(1-p)$
\end_inset

.
 If we let 
\begin_inset Formula $Y=\sum X_{i}$
\end_inset

, then from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:binom-dist"

\end_inset

 we know that 
\begin_inset Formula $Y\sim\mathsf{binom}(\mathtt{size}=n,\,\mathtt{prob}=p)$
\end_inset

 and that 
\begin_inset Formula \[
\Xbar=\frac{Y}{n}\mbox{ has }\E\Xbar=p\mbox{ and }\mathrm{Var}(\Xbar)=\frac{p(1-p)}{n}.\]

\end_inset

Thus if 
\begin_inset Formula $n$
\end_inset

 is large (here is the CLT) then an approximate 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence interval for 
\begin_inset Formula $p$
\end_inset

 would be given by
\begin_inset Formula \begin{equation}
\Xbar\pm z_{\alpha/2}\sqrt{\frac{p(1-p)}{n}}.\label{eq:ci-p-no-good}\end{equation}

\end_inset

OOPS\SpecialChar \ldots{}
! Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:ci-p-no-good"

\end_inset

 is of no use to us because the 
\bar under
unknown
\bar default
 parameter 
\begin_inset Formula $p$
\end_inset

 is in the formula! (If we knew what 
\begin_inset Formula $p$
\end_inset

 was to plug in the formula then we would not need a confidence interval
 in the first place.) There are two solutions to this problem.
\end_layout

\begin_layout Enumerate
Replace 
\begin_inset Formula $p$
\end_inset

 with 
\begin_inset Formula $\hat{p}=\Xbar$
\end_inset

.
 Then an approximate 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence interval for 
\begin_inset Formula $p$
\end_inset

 is given by 
\begin_inset Formula \begin{equation}
\hat{p}\pm z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}.\end{equation}

\end_inset

This approach is called the 
\emph on
Wald interval
\emph default
 and is also known as the 
\emph on
asymptotic interval
\emph default
 because it appeals to the CLT for large sample sizes.
\end_layout

\begin_layout Enumerate
Go back to first principles.
 Note that
\begin_inset Formula \[
-z_{\alpha/2}\leq\frac{Y/n-p}{\sqrt{p(1-p)/n}}\leq z_{\alpha/2}\]

\end_inset

exactly when the function 
\begin_inset Formula $f$
\end_inset

 defined by
\begin_inset Formula \[
f(p)=\left(Y/n-p\right)^{2}-z_{\alpha/2}^{2}\frac{p(1-p)}{n}\]

\end_inset

satisfies 
\begin_inset Formula $f(p)\leq0$
\end_inset

.
 But 
\begin_inset Formula $f$
\end_inset

 is quadratic in 
\begin_inset Formula $p$
\end_inset

 so its graph is a parabola; it has two roots, and these roots form the
 limits of the confidence interval.
 We can find them with the quadratic formula (see Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:CI-quad-form"

\end_inset

):
\begin_inset Formula \begin{equation}
\left.\left[\left(\hat{p}+\frac{z_{\alpha/2}^{2}}{2n}\right)\pm z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}+\frac{z_{\alpha/2}^{2}}{(2n)^{2}}}\right]\right\slash \left(1+\frac{z_{\alpha/2}^{2}}{n}\right)\end{equation}

\end_inset

 This approach is called the 
\emph on
score interval
\emph default
 because it is based on the inversion of the 
\begin_inset Quotes eld
\end_inset

Score test
\begin_inset Quotes erd
\end_inset

.
 See Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Categorical-Data-Analysis"

\end_inset

.
 It is also known as the 
\emph on
Wilson interval
\emph default
; see Agresti 
\begin_inset CommandInset citation
LatexCommand cite
key "Agresti2002"

\end_inset

.
\end_layout

\begin_layout Standard
For two proportions 
\begin_inset Formula $p_{1}$
\end_inset

 and 
\begin_inset Formula $p_{2}$
\end_inset

, we may collect independent 
\begin_inset Formula $\mathsf{binom}(\mathtt{size}=1,\,\mathtt{prob}=p)$
\end_inset

 samples of size 
\begin_inset Formula $n_{1}$
\end_inset

 and 
\begin_inset Formula $n_{2}$
\end_inset

, respectively.
 Let 
\begin_inset Formula $Y_{1}$
\end_inset

 and 
\begin_inset Formula $Y_{2}$
\end_inset

 denote the number of successes in the respective samples.
 
\end_layout

\begin_layout Standard
We know that 
\begin_inset Formula \[
\frac{Y_{1}}{n_{1}}\approx\mathsf{norm}\left(\mathtt{mean}=p_{1},\,\mathtt{sd}=\sqrt{\frac{p_{1}(1-p_{1})}{n_{1}}}\right)\]

\end_inset

and
\begin_inset Formula \[
\frac{Y_{2}}{n_{2}}\approx\mathsf{norm}\left(\mathtt{mean}=p_{2},\,\mathtt{sd}=\sqrt{\frac{p_{2}(1-p_{2})}{n_{2}}}\right)\]

\end_inset

so it stands to reason that an approximate 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence interval for 
\begin_inset Formula $p_{1}-p_{2}$
\end_inset

 is given by
\begin_inset Formula \begin{equation}
\left(\hat{p}_{1}-\hat{p}_{2}\right)\pm z_{\alpha/2}\sqrt{\frac{\hat{p}_{1}(1-\hat{p}_{1})}{n_{1}}+\frac{\hat{p}_{2}(1-\hat{p}_{2})}{n_{2}}},\end{equation}

\end_inset

where 
\begin_inset Formula $\hat{p}_{1}=Y_{1}/n_{1}$
\end_inset

 and 
\begin_inset Formula $\hat{p}_{2}=Y_{2}/n_{2}$
\end_inset

.
\end_layout

\begin_layout Remark
When estimating a single proportion, one-sided intervals are sometimes needed.
 They take the form
\begin_inset Formula \begin{equation}
\left[0,\ \hat{p}+z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}\right]\end{equation}

\end_inset

or 
\begin_inset Formula \begin{equation}
\left[\hat{p}-z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}},\ 1\right]\end{equation}

\end_inset

or in other words, we know in advance that the true proportion is restricted
 to the interval 
\begin_inset Formula $[0,1]$
\end_inset

, so we can truncate our confidence interval to those values on either side.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(Hmisc)
\begin_inset Newline newline
\end_inset

binconf(x = 7, n = 25, method = "asymptotic")
\begin_inset Newline newline
\end_inset

binconf(x = 7, n = 25, method = "wilson")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The default value of the 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

method
\end_layout

\end_inset

 argument is 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

\begin_inset Quotes eld
\end_inset

wilson
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
An alternate way is 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

tab <- xtabs(~gender, data = RcmdrTestDrive)
\begin_inset Newline newline
\end_inset

prop.test(rbind(tab), conf.level = 0.95, correct = FALSE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

A <- as.data.frame(Titanic)
\begin_inset Newline newline
\end_inset

library(reshape)
\begin_inset Newline newline
\end_inset

B <- with(A, untable(A, Freq))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Section
Confidence Intervals for Variances
\begin_inset CommandInset label
LatexCommand label
name "sec:Confidence-Intervals-for-Variances"

\end_inset


\end_layout

\begin_layout Standard
I am thinking one and two sample problems here.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
I am thinking about sigma.test in the TeachingDemos package and var.test in
 base R here.
\end_layout

\begin_layout Section
Fitting Distributions
\begin_inset CommandInset label
LatexCommand label
name "sec:Fitting-Distributions"

\end_inset


\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
I am thinking about fitdistr from the MASS package 
\begin_inset CommandInset citation
LatexCommand cite
key "Venables2002"

\end_inset

.
\end_layout

\begin_layout Section
Sample Size and Margin of Error
\begin_inset CommandInset label
LatexCommand label
name "sec:Sample-Size-and-MOE"

\end_inset


\end_layout

\begin_layout Standard
Sections 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Confidence-Intervals-for-Means"

\end_inset

 through 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Confidence-Intervals-for-Variances"

\end_inset

 all began the same way: we were given the sample size 
\begin_inset Formula $n$
\end_inset

 and the confidence coefficient 
\begin_inset Formula $1-\alpha$
\end_inset

, and our task was to find a margin of error 
\begin_inset Formula $E$
\end_inset

 so that 
\begin_inset Formula \[
\hat{\theta}\pm E\mbox{ is a }100(1-\alpha)\%\mbox{ confidence interval for }\theta.\]

\end_inset

Some examples we saw were:
\end_layout

\begin_layout Itemize
\begin_inset Formula $E=z_{\alpha/2}\sigma/\sqrt{n}$
\end_inset

, in the one-sample 
\begin_inset Formula $z$
\end_inset

-interval,
\end_layout

\begin_layout Itemize
\begin_inset Formula $E=t_{\alpha/2}(\mathtt{df}=n+m-2)S_{p}\sqrt{n^{-1}+m^{-1}}$
\end_inset

, in the two-sample pooled 
\begin_inset Formula $t$
\end_inset

-interval.
 
\end_layout

\begin_layout Standard
We already know (we can see in the formulas above) that 
\begin_inset Formula $E$
\end_inset

 decreases as 
\begin_inset Formula $n$
\end_inset

 increases.
 Now we would like to use this information to our advantage: suppose that
 we have a fixed margin of error 
\begin_inset Formula $E,$
\end_inset

 say 
\begin_inset Formula $E=3$
\end_inset

, and we want a 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence interval for 
\begin_inset Formula $\mu$
\end_inset

.
 The question is: how big does 
\begin_inset Formula $n$
\end_inset

 have to be?
\end_layout

\begin_layout Standard
For the case of a population mean the answer is easy: we set up an equation
 and solve for 
\begin_inset Formula $n$
\end_inset

.
\end_layout

\begin_layout Example
Given a situation, given 
\begin_inset Formula $\sigma$
\end_inset

, given 
\begin_inset Formula $E$
\end_inset

, we would like to know how big 
\begin_inset Formula $n$
\end_inset

 has to be to ensure that 
\begin_inset Formula $\Xbar\pm5$
\end_inset

 is a 95% confidence interval for 
\begin_inset Formula $\mu$
\end_inset

.
 
\end_layout

\begin_layout Remark
\begin_inset space ~
\end_inset


\end_layout

\begin_deeper
\begin_layout Enumerate
Always round up any decimal values of 
\begin_inset Formula $n$
\end_inset

, no matter how small the decimal is.
\end_layout

\begin_layout Enumerate
Another name for 
\begin_inset Formula $E$
\end_inset

 is the 
\begin_inset Quotes eld
\end_inset

maximum error of the estimate
\begin_inset Quotes erd
\end_inset

.
\end_layout

\end_deeper
\begin_layout Standard
For proportions, recall that the asymptotic formula to estimate 
\begin_inset Formula $p$
\end_inset

 was
\begin_inset Formula \[
\hat{p}\pm z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}.\]

\end_inset

Reasoning as above we would want
\begin_inset Formula \begin{align}
E & =z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}},\mbox{ or}\\
n & =z_{\alpha/2}^{2}\frac{\hat{p}(1-\hat{p})}{E^{2}}.\label{eq:samp-size-prop-ME}\end{align}

\end_inset

OOPS! Recall that 
\begin_inset Formula $\hat{p}=Y/n$
\end_inset

, which would put the variable 
\begin_inset Formula $n$
\end_inset

 on both sides of Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:samp-size-prop-ME"

\end_inset

.
 Again, there are two solutions to the problem.
\end_layout

\begin_layout Enumerate
If we have a good idea of what 
\begin_inset Formula $p$
\end_inset

 is, say 
\begin_inset Formula $p^{\ast}$
\end_inset

 then we can plug it in to get
\begin_inset Formula \begin{equation}
n=z_{\alpha/2}^{2}\frac{p^{\ast}(1-p^{\ast})}{E^{2}}.\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
Even if we have no idea what 
\begin_inset Formula $p$
\end_inset

 is, we do know from calculus that 
\begin_inset Formula $p(1-p)\leq1/4$
\end_inset

 because the function 
\begin_inset Formula $f(x)=x(1-x)$
\end_inset

 is quadratic (so its graph is a parabola which opens downward) with maximum
 value attained at 
\begin_inset Formula $x=1/2$
\end_inset

.
 Therefore, regardless of our choice for 
\begin_inset Formula $p^{\ast}$
\end_inset

 the sample size must satisfy
\begin_inset Formula \begin{equation}
n=z_{\alpha/2}^{2}\frac{p^{\ast}(1-p^{\ast})}{E^{2}}\leq\frac{z_{\alpha/2}^{2}}{4E^{2}}.\end{equation}

\end_inset

The quantity 
\begin_inset Formula $z_{\alpha/2}^{2}/4E^{2}$
\end_inset

 is large enough to guarantee 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence.
\end_layout

\begin_layout Example
Proportion example
\end_layout

\begin_layout Remark
For very small populations sometimes the value of 
\begin_inset Formula $n$
\end_inset

 obtained from the formula is too big.
 In this case we should use the hypergeometric distribution for a sampling
 model rather than the binomial model.
 With this modification the formulas change to the following: if 
\begin_inset Formula $N$
\end_inset

 denotes the population size then let
\begin_inset Formula \begin{equation}
m=z_{\alpha/2}^{2}\frac{p^{\ast}(1-p^{\ast})}{E^{2}}\end{equation}

\end_inset

 and the sample size needed to ensure 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence is achieved is
\begin_inset Formula \begin{equation}
n=\frac{m}{1+\frac{m-1}{N}}.\end{equation}

\end_inset

If we do not have a good value for the estimate 
\begin_inset Formula $p^{\ast}$
\end_inset

 then we may use 
\begin_inset Formula $p^{\ast}=1/2$
\end_inset

.
 
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
I am thinking about power.t.test, power.prop.test, power.anova.test, and I am
 also thinking about replicate.
\end_layout

\begin_layout Section
Other Topics
\begin_inset CommandInset label
LatexCommand label
name "sec:Other-Topics"

\end_inset


\end_layout

\begin_layout Standard
Mention mle from the stats4 package.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Chapter Exercises
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{section}{Chapter Exercises}
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{thm}{0}
\end_layout

\end_inset


\end_layout

\begin_layout Exercise
Let 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 be an 
\begin_inset Formula $SRS(n)$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 distribution.
 Find a two-dimensional MLE for 
\begin_inset Formula $\theta=(\mu,\sigma)$
\end_inset

.
\begin_inset CommandInset label
LatexCommand label
name "xca:norm-mu-sig-MLE"

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Exercise
\begin_inset CommandInset label
LatexCommand label
name "xca:CI-quad-form"

\end_inset

Find the upper and lower limits for the confidence interval procedure by
 finding the roots of 
\begin_inset Formula $f$
\end_inset

 defined by 
\begin_inset Formula \[
f(p)=\left(Y/n-p\right)^{2}-z_{\alpha/2}^{2}\frac{p(1-p)}{n}.\]

\end_inset

You are going to need the quadratic formula.
\end_layout

\begin_layout Chapter
Hypothesis Testing
\begin_inset CommandInset label
LatexCommand label
name "cha:Hypothesis-Testing"

\end_inset


\end_layout

\begin_layout Paragraph*
What do I want them to know?
\end_layout

\begin_layout Itemize
basic terminology and philosophy of the Neyman-Pearson paradigm
\end_layout

\begin_layout Itemize
classical hypothesis tests for the standard one and two sample problems
 with means, variances, and proportions
\end_layout

\begin_layout Itemize
the notion of between versus within group variation and how it plays out
 with one-way ANOVA
\end_layout

\begin_layout Itemize
the concept of statistical power and its relation to sample size
\end_layout

\begin_layout Section
Introduction
\begin_inset CommandInset label
LatexCommand label
name "sec:Introduction-Hypothesis"

\end_inset


\end_layout

\begin_layout Standard
I spent a week during the summer of 2005 at the University of Nebraska at
 Lincoln grading Advanced Placement Statistics exams, and while I was there
 I attended a presentation by Dr.
\begin_inset space ~
\end_inset

Roxy Peck.
 At the end of her talk she described an activity she had used with students
 to introduce the basic concepts of hypothesis testing.
 I was impressed by the activity and have used it in my own classes several
 times since.
\end_layout

\begin_layout Standard
The instructor (with a box of cookies in hand) enters a class of fifteen
 or more students and produces a brand-new, sealed deck of ordinary playing
 cards.
 The instructor asks for a student volunteer to break the seal, and then
 the instructor prominently shuffles the deck
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
The jokers are removed before shuffling.
\end_layout

\end_inset

 several times in front of the class, after which time the students are
 asked to line up in a row.
 They are going to play a game.
 Each student will draw a card from the top of the deck, in turn.
 If the card is black, then the lucky student will get a cookie.
 If the card is red, then the unlucky student will sit down empty-handed.
 Let the game begin.
\end_layout

\begin_layout Standard
The first student draws a card: red.
 There are jeers and outbursts, and the student slinks off to his/her chair.
 (S)he is disappointed, of course, but not really.
 After all, (s)he had a 50-50 chance of getting black, and it did not happen.
 Oh well.
\end_layout

\begin_layout Standard
The second student draws a card: red, again.
 There are more jeers, and the second student slips away.
 This student is also disappointed, but again, not so much, because it is
 probably his/her unlucky day.
 On to the next student.
\end_layout

\begin_layout Standard
The student draws: red again! There are a few wiseguys who yell (happy to
 make noise, more than anything else), but there are a few other students
 who are not yelling any more -- they are thinking.
 This is the third red in a row, which is possible, of course, but what
 is going on, here? They are not quite sure.
 They are now concentrating on the next card\SpecialChar \ldots{}
 it is bound to be black, right?
\end_layout

\begin_layout Standard
The fourth student draws: red.
 Hmmm\SpecialChar \ldots{}
 now there are groans instead of outbursts.
 A few of the students at the end of the line shrug their shoulders and
 start to make their way back to their desk, complaining that the teacher
 does not want to give away any cookies.
 There are still some students in line though, salivating, waiting for the
 inevitable black to appear.
\end_layout

\begin_layout Standard
The fifth student draws red.
 Now it isn't funny any more.
 As the remaining students make their way back to their seats an uproar
 ensues, from an entire classroom demanding cookies.
\end_layout

\begin_layout Standard
\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Standard
Keep the preceding experiment in the back of your mind as you read the following
 sections.
 When you have finished the entire chapter, come back and read this introduction
 again.
 All of the mathematical jargon that follows is connected to the above paragraph
s.
 In the meantime, I will get you started:
\end_layout

\begin_layout Description
Null
\begin_inset space ~
\end_inset

hypothesis: it is an ordinary deck of playing cards, shuffled thoroughly.
\end_layout

\begin_layout Description
Alternative
\begin_inset space ~
\end_inset

hypothesis: either it is a trick deck of cards, or the instructor did some
 fancy shufflework.
\end_layout

\begin_layout Description
Observed
\begin_inset space ~
\end_inset

data: a sequence of draws from the deck, five reds in a row.
\end_layout

\begin_layout Standard
If it were truly an ordinary, well-shuffled deck of cards, the probability
 of observing zero blacks out of a sample of size five (without replacement)
 from a deck with 26 black cards and 26 red cards would be
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

dhyper(0, m = 26, n = 26, k = 5)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
There are two very important final thoughts.
 First, everybody gets a cookie in the end.
 Second, the students invariably (and aggressively) attempt to get me to
 open up the deck and reveal the true nature of the cards.
 I never do.
\end_layout

\begin_layout Section
Tests for Proportions
\begin_inset CommandInset label
LatexCommand label
name "sec:Tests-for-Proportions"

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:widget-machine"

\end_inset

We have a machine that makes widgets.
 
\end_layout

\begin_deeper
\begin_layout Itemize
Under normal operation, about 0.10 of the widgets produced are defective.
\end_layout

\begin_layout Itemize
Go out and purchase a torque converter.
\end_layout

\begin_layout Itemize
Install the torque converter, and observe 
\begin_inset Formula $n=100$
\end_inset

 widgets from the machine.
\end_layout

\begin_layout Itemize
Let 
\begin_inset Formula $Y=\mbox{number of defective widgets observed}$
\end_inset

.
\end_layout

\begin_layout Standard
If
\end_layout

\begin_layout Itemize
\begin_inset Formula $Y=0$
\end_inset

, then the torque converter is great!
\end_layout

\begin_layout Itemize
\begin_inset Formula $Y=4$
\end_inset

, then the torque converter seems to be helping.
 
\end_layout

\begin_layout Itemize
\begin_inset Formula $Y=9$
\end_inset

, then there is not much evidence that the torque converter helps.
\end_layout

\begin_layout Itemize
\begin_inset Formula $Y=17$
\end_inset

, then throw away the torque converter.
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $p$
\end_inset

 denote the proportion of defectives produced by the machine.
 Before the installation of the torque converter 
\begin_inset Formula $p$
\end_inset

 was 
\begin_inset Formula $0.10$
\end_inset

.
 Then we installed the torque converter.
 Did 
\begin_inset Formula $p$
\end_inset

 change? Did it go up or down? We use statistics to decide.
 Our method is to observe data and construct a 95% confidence interval for
 
\begin_inset Formula $p$
\end_inset

,
\begin_inset Formula \begin{equation}
\hat{p}\pm z_{\alpha/2}\sqrt{\frac{\hat{p}(1-\hat{p})}{n}}.\end{equation}

\end_inset

If the confidence interval is
\end_layout

\begin_layout Itemize
\begin_inset Formula $[0.01,\,0.05]$
\end_inset

, then we are 95% confident that 
\begin_inset Formula $0.01\leq p\leq0.05$
\end_inset

, so there is evidence that the torque converter is helping.
\end_layout

\begin_layout Itemize
\begin_inset Formula $[0.15,\,0.19]$
\end_inset

, then we are 95% confident that 
\begin_inset Formula $0.15\leq p\leq0.19$
\end_inset

, so there is evidence that the torque converter is hurting.
\end_layout

\begin_layout Itemize
\begin_inset Formula $[0.07,\,0.11]$
\end_inset

, then there is not enough evidence to conclude that the torque converter
 is doing anything at all, positive or negative.
\end_layout

\end_deeper
\begin_layout Subsection
Terminology
\end_layout

\begin_layout Standard
The 
\emph on
null hypothesis
\emph default
 
\begin_inset Formula $H_{0}$
\end_inset

 is a 
\begin_inset Quotes eld
\end_inset

nothing
\begin_inset Quotes erd
\end_inset

 hypothesis, whose interpretation could be that nothing has changed, there
 is no difference, there is nothing special taking place, 
\emph on
etc
\emph default
..
 In Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:widget-machine"

\end_inset

 the null hypothesis would be 
\begin_inset Formula $H_{0}:\ p=0.10.$
\end_inset

 The 
\emph on
alternative hypothesis
\emph default
 
\begin_inset Formula $H_{1}$
\end_inset

 is the hypothesis that something has changed, in this case, 
\begin_inset Formula $H_{1}:\ p\neq0.10$
\end_inset

.
 Our goal is to statistically 
\emph on
test
\emph default
 the hypothesis 
\begin_inset Formula $H_{0}:\ p=0.10$
\end_inset

 versus the alternative 
\begin_inset Formula $H_{1}:\ p\neq0.10$
\end_inset

.
 Our procedure will be:
\end_layout

\begin_layout Enumerate
Go out and collect some data, in particular, a simple random sample of observati
ons from the machine.
\end_layout

\begin_layout Enumerate
Suppose that 
\begin_inset Formula $H_{0}$
\end_inset

 is true and construct a 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence interval for 
\begin_inset Formula $p$
\end_inset

.
\end_layout

\begin_layout Enumerate
If the confidence interval does not cover 
\begin_inset Formula $p=0.10$
\end_inset

, then we 
\emph on
reject
\emph default

\begin_inset Formula $H_{0}$
\end_inset

.
 Otherwise, we 
\emph on
fail to reject
\emph default

\begin_inset Formula $H_{0}$
\end_inset

.
\end_layout

\begin_layout Remark
Every time we make a decision it is possible to be wrong, and there are
 two possible mistakes that we could make.
 We have committed a
\end_layout

\begin_deeper
\begin_layout Description
Type
\begin_inset space ~
\end_inset

I
\begin_inset space ~
\end_inset

Error if we reject 
\begin_inset Formula $H_{0}$
\end_inset

 when in fact 
\begin_inset Formula $H_{0}$
\end_inset

 is true.
 This would be akin to convicting an innocent person for a crime (s)he did
 not commit.
\end_layout

\begin_layout Description
Type
\begin_inset space ~
\end_inset

II
\begin_inset space ~
\end_inset

Error if we fail to reject 
\begin_inset Formula $H_{0}$
\end_inset

 when in fact 
\begin_inset Formula $H_{1}$
\end_inset

 is true.
 This is analogous to a guilty person escaping conviction.
\end_layout

\end_deeper
\begin_layout Standard
Type I Errors are usually considered worse
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
There is no mathematical difference between the errors, however.
 The bottom line is that we choose one type of error to control with an
 iron fist, and we try to minimize the probability of making the other type.
 That being said, null hypotheses are often by design to correspond to the
 
\begin_inset Quotes eld
\end_inset

simpler
\begin_inset Quotes erd
\end_inset

 model, so it is often easier to analyze (and thereby control) the probabilities
 associated with Type I Errors.
\end_layout

\end_inset

, and we design our statistical procedures to control the probability of
 making such a mistake.
 We define the
\begin_inset Formula \begin{equation}
\mbox{significance level of the test}=\P(\mbox{Type I Error})=\alpha.\end{equation}

\end_inset

We want 
\begin_inset Formula $\alpha$
\end_inset

 to be small which conventionally means, say, 
\begin_inset Formula $\alpha=0.05$
\end_inset

, 
\begin_inset Formula $\alpha=0.01$
\end_inset

, or 
\begin_inset Formula $\alpha=0.005$
\end_inset

 (but could mean anything, in principle).
 
\end_layout

\begin_layout Itemize
The 
\emph on
rejection region
\emph default
 (also known as the 
\emph on
critical region
\emph default
) for the test is the set of sample values which would result in the rejection
 of 
\begin_inset Formula $H_{0}$
\end_inset

.
 For Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:widget-machine"

\end_inset

, the rejection region would be all possible samples that result in a 95%
 confidence interval that does not cover 
\begin_inset Formula $p=0.10$
\end_inset

.
\end_layout

\begin_layout Itemize
The above example with 
\begin_inset Formula $H_{1}:p\neq0.10$
\end_inset

 is called a 
\emph on
two-sided
\emph default
 test.
 Many times we are interested in a 
\emph on
one-sided
\emph default
 test, which would look like 
\begin_inset Formula $H_{1}:p<0.10$
\end_inset

 or 
\begin_inset Formula $H_{1}:p>0.10$
\end_inset

.
\end_layout

\begin_layout Standard
We are ready for tests of hypotheses for one proportion.
\end_layout

\begin_layout Standard
Table here.
\end_layout

\begin_layout Standard
Don't forget the assumptions.
\end_layout

\begin_layout Example
Find
\end_layout

\begin_deeper
\begin_layout Enumerate
The null and alternative hypotheses
\end_layout

\begin_layout Enumerate
Check your assumptions.
\end_layout

\begin_layout Enumerate
Define a critical region with an 
\begin_inset Formula $\alpha=0.05$
\end_inset

 significance level.
\end_layout

\begin_layout Enumerate
Calculate the value of the test statistic and state your conclusion.
\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:prop-test-pvalue-A"

\end_inset

Suppose 
\begin_inset Formula $p=\mbox{the proportion of students}$
\end_inset

 who are admitted to the graduate school of the University of California
 at Berkeley, and suppose that a public relations officer boasts that UCB
 has historically had a 40% acceptance rate for its graduate school.
 Consider the data stored in the table 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

UCBAdmissions
\end_layout

\end_inset

 from 1973.
 Assuming these observations constituted a simple random sample, are they
 consistent with the officer's claim, or do they provide evidence that the
 acceptance rate was significantly less than 40%? Use an 
\begin_inset Formula $\alpha=0.01$
\end_inset

 significance level.
\end_layout

\begin_layout Example
Our null hypothesis in this problem is 
\begin_inset Formula $H_{0}:\, p=0.4$
\end_inset

 and the alternative hypothesis is 
\begin_inset Formula $H_{1}:\, p<0.4$
\end_inset

.
 We reject the null hypothesis if 
\begin_inset Formula $\hat{p}$
\end_inset

 is too small, that is, if
\begin_inset Formula \begin{equation}
\frac{\hat{p}-0.4}{\sqrt{0.4(1-0.4)/n}}<-z_{\alpha},\end{equation}

\end_inset

where 
\begin_inset Formula $\alpha=0.01$
\end_inset

 and 
\begin_inset Formula $-z_{0.01}$
\end_inset

 is 
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

- qnorm(0.99)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Our only remaining task is to find the value of the test statistic and see
 where it falls relative to the critical value.
 We can find the number of people admitted and not admitted to the UCB graduate
 school with the following.
 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

A <- as.data.frame(UCBAdmissions)
\begin_inset Newline newline
\end_inset

head(A)
\begin_inset Newline newline
\end_inset

xtabs(Freq ~ Admit, data = A)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Now we calculate the value of the test statistic.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

phat <- 1755/(1755 + 2771)
\begin_inset Newline newline
\end_inset

(phat - 0.4)/sqrt(0.4 * 0.6/(1755 + 2771)) 
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Our test statistic is not less than 
\begin_inset Formula $-2.32$
\end_inset

, so it does not fall into the critical region.
 Therefore, we 
\emph on
fail
\emph default
 to reject the null hypothesis that the true proportion of students admitted
 to graduate school is less than 40% and say that the observed data are
 consistent with the officer's claim at the 
\begin_inset Formula $\alpha=0.01$
\end_inset

 significance level.
 
\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:prop-test-pvalue-B"

\end_inset

We are going to do Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:prop-test-pvalue-A"

\end_inset

 all over again.
 Everything will be exactly the same except for one change.
 Suppose we choose significance level 
\begin_inset Formula $\alpha=0.05$
\end_inset

 instead of 
\begin_inset Formula $\alpha=0.01$
\end_inset

.
 Are the 1973 data consistent with the officer's claim?
\end_layout

\begin_layout Example
Our null and alternative hypotheses are the same.
 Our observed test statistic is the same: it was approximately 
\begin_inset Formula $-1.68$
\end_inset

.
 But notice that our critical value has changed: 
\begin_inset Formula $\alpha=0.05$
\end_inset

 and 
\begin_inset Formula $-z_{0.05}$
\end_inset

 is
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

-qnorm(0.95)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Our test statistic is less than 
\begin_inset Formula $-1.64$
\end_inset

 so it now falls into the critical region! We now 
\emph on
reject
\emph default
 the null hypothesis and conclude that the 1973 data provide evidence that
 the true proportion of students admitted to the graduate school of UCB
 in 1973 was significantly less than 40%.
 The data are 
\emph on
not
\emph default
 consistent with the officer's claim at the 
\begin_inset Formula $\alpha=0.05$
\end_inset

 significance level.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Standard
What is going on, here? If we choose 
\begin_inset Formula $\alpha=0.05$
\end_inset

 then we reject the null hypothesis, but if we choose 
\begin_inset Formula $\alpha=0.01$
\end_inset

 then we fail to reject the null hypothesis.
 Our final conclusion seems to depend on our selection of the significance
 level.
 This is bad; for a particular test, we never know whether our conclusion
 would have been different if we had chosen a different significance level.
 
\end_layout

\begin_layout Standard
Or do we?
\end_layout

\begin_layout Standard
Clearly, for some significance levels we reject, and for some significance
 levels we do not.
 Where is the boundary? That is, what is the significance level for which
 we would 
\emph on
reject
\emph default
 at any significance level 
\emph on
bigger
\emph default
, and we would 
\emph on
fail to reject
\emph default
 at any significance level 
\emph on
smaller
\emph default
? This boundary value has a special name: it is called the 
\begin_inset Formula $p$
\end_inset


\emph on
-value
\emph default
 of the test.
\end_layout

\begin_layout Definition
The 
\begin_inset Formula $p$
\end_inset

-
\emph on
value
\emph default
, or 
\emph on
observed significance level
\emph default
, of a hypothesis test is the probability when the null hypothesis is true
 of obtaining the observed value of the test statistic (such as 
\begin_inset Formula $\hat{p}$
\end_inset

) or values more extreme -- meaning, in the direction of the alternative
 hypothesis
\begin_inset Foot
status open

\begin_layout Plain Layout
Bickel and Doksum 
\begin_inset CommandInset citation
LatexCommand cite
key "Bickel2001"

\end_inset

 state the definition particularly well: the 
\begin_inset Formula $p$
\end_inset

-value is 
\begin_inset Quotes eld
\end_inset

the smallest level of significance 
\begin_inset Formula $\alpha$
\end_inset

 at which an experimenter using [the test statistic] 
\begin_inset Formula $T$
\end_inset

 would reject [
\begin_inset Formula $H_{0}$
\end_inset

] on the basis of the observed [sample] outcome 
\begin_inset Formula $x$
\end_inset


\begin_inset Quotes erd
\end_inset

.
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Example
Calculate the 
\begin_inset Formula $p$
\end_inset

-value for the test in Examples 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:prop-test-pvalue-A"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:prop-test-pvalue-B"

\end_inset

.
\end_layout

\begin_layout Example
The 
\begin_inset Formula $p$
\end_inset

-value for this test is the probability of obtaining a 
\begin_inset Formula $z$
\end_inset

-score equal to our observed test statistic (which had 
\begin_inset Formula $z$
\end_inset

-score 
\begin_inset Formula $\approx-1.680919$
\end_inset

) or more extreme, which in this example is less than the observed test
 statistic.
 In other words, we want to know the area under a standard normal curve
 on the interval 
\begin_inset Formula $(-\infty,\,-1.680919]$
\end_inset

.
 We can get this easily with
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

pnorm(-1.680919)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We see that the 
\begin_inset Formula $p$
\end_inset

-value is strictly between the significance levels 
\begin_inset Formula $\alpha=0.01$
\end_inset

 and 
\begin_inset Formula $\alpha=0.05$
\end_inset

.
 This makes sense: it has to be bigger than 
\begin_inset Formula $\alpha=0.01$
\end_inset

 (otherwise we would have rejected 
\begin_inset Formula $H_{0}$
\end_inset

 in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:prop-test-pvalue-A"

\end_inset

) and it must also be smaller than 
\begin_inset Formula $\alpha=0.05$
\end_inset

 (otherwise we would not have rejected 
\begin_inset Formula $H_{0}$
\end_inset

 in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:prop-test-pvalue-B"

\end_inset

).
 Indeed, 
\begin_inset Formula $p$
\end_inset

-values are a characteristic indicator of whether or not we would have rejected
 at assorted significance levels, and for this reason a statistician will
 often skip the calculation of critical regions and critical values entirely.
 If (s)he knows the 
\begin_inset Formula $p$
\end_inset

-value, then (s)he knows immediately whether or not (s)he would have rejected
 at 
\emph on
any
\emph default
 given significance level.
\end_layout

\begin_layout Standard
Thus, another way to phrase our significance test procedure is: we will
 reject 
\begin_inset Formula $H_{0}$
\end_inset

 at the 
\begin_inset Formula $\alpha$
\end_inset

-level of significance if the 
\begin_inset Formula $p$
\end_inset

-value is less than 
\begin_inset Formula $\alpha$
\end_inset

.
\end_layout

\begin_layout Remark
If we have two populations with proportions 
\begin_inset Formula $p_{1}$
\end_inset

 and 
\begin_inset Formula $p_{2}$
\end_inset

 then we can test the null hypothesis 
\begin_inset Formula $H_{0}:p_{1}=p_{2}$
\end_inset

.
\end_layout

\begin_layout Standard
Table Here.
\end_layout

\begin_layout Example
Example.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The following does the test.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

prop.test(1755, 1755 + 2771, p = 0.4, alternative = "less", conf.level = 0.99,
 correct = FALSE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Do the following to make the plot.
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

library(IPSUR)
\begin_inset Newline newline
\end_inset

library(HH)
\begin_inset Newline newline
\end_inset

temp <- prop.test(1755, 1755 + 2771, p = 0.4, alternative = "less", conf.level
 = 0.99, correct = FALSE)
\begin_inset Newline newline
\end_inset

plot(temp, 'Hypoth')
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 6, width = 6.5>>=
\begin_inset Newline newline
\end_inset

library(HH)
\begin_inset Newline newline
\end_inset

plot(prop.test(1755, 1755 + 2771, p = 0.4, alternative = "less", conf.level
 = 0.99, correct = FALSE), 'Hypoth')
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Hypothesis test plot based on 
\family typewriter
normal.and.t.dist
\family default
 from the 
\family typewriter
HH
\family default
 package
\begin_inset CommandInset label
LatexCommand label
name "fig:Hypothesis-test-plot-1"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\size small
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Plain Layout

\size small
This plot shows all of the important features of hypothesis tests in one
 magnificent display.
 The (asymptotic) distribution of the test statistic (under the null hypothesis)
 is standard normal, represented by the bell curve, above.
 We see the critical region to the left, and the blue shaded area is the
 significance level, which for this example is 
\begin_inset Formula $\alpha=0.05$
\end_inset

.
 The area outlined in green is the 
\begin_inset Formula $p$
\end_inset

-value, and the observed test statistic determines the upper bound of this
 region.
 We can see clearly that the 
\begin_inset Formula $p$
\end_inset

-value is larger than the significance level, thus, we would not reject
 the null hypothesis.
 There are all sorts of tick marks shown below the graph which detail how
 the different pieces are measured on different scales (the original data
 scale, the standardized scale, 
\emph on
etc
\emph default
.).
 The workhorse behind the plot is the 
\family typewriter
\size default
normal.and.t.dist 
\family default
\size small
function from the 
\family typewriter
\size default
HH
\family default
\size small
 package.
 See the discussion in 
\begin_inset Quotes eld
\end_inset

How to do it with 
\family sans
R
\family default

\begin_inset Quotes erd
\end_inset

 for the exact sequence of commands to generate the plot.

\size default
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Use Yates' continuity correction when the expected frequency of successes
 is less than 10.
 You can use it all of the time, but you will have a decrease in power.
 For large samples the correction does not matter.
\end_layout

\begin_layout Paragraph*
With the 
\family sans
R
\family default
 Commander
\end_layout

\begin_layout Standard
If you already know the number of successes and failures, then you can use
 the menu 
\family sans
Statistics 
\begin_inset Formula $\triangleright$
\end_inset

 Proportions 
\begin_inset Formula $\triangleright$
\end_inset

 IPSUR Enter table for single sample\SpecialChar \ldots{}

\end_layout

\begin_layout Standard
Otherwise, your data -- the raw successes and failures -- should be in a
 column of the Active Data Set.
 Furthermore, the data must be stored as a 
\begin_inset Quotes eld
\end_inset

factor
\begin_inset Quotes erd
\end_inset

 internally.
 If the data are not a factor but are numeric then you can use the menu
 
\family sans
Data 
\begin_inset Formula $\triangleright$
\end_inset

 Manage variables in active data set 
\begin_inset Formula $\triangleright$
\end_inset

 Convert numeric variables to factors\SpecialChar \ldots{}

\family default
 to convert the variable to a factor.
 Or, you can always use the 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

factor
\end_layout

\end_inset

 function.
\end_layout

\begin_layout Standard
Once your unsummarized data is a column, then you can use the menu 
\family sans
Statistics 
\begin_inset Formula $\triangleright$
\end_inset

 Proportions 
\begin_inset Formula $\triangleright$
\end_inset

 Single-sample proportion test\SpecialChar \ldots{}

\end_layout

\begin_layout Section
One Sample Tests for Means and Variances
\begin_inset CommandInset label
LatexCommand label
name "sec:One-Sample-Tests"

\end_inset


\end_layout

\begin_layout Subsection
For Means
\end_layout

\begin_layout Standard
Here, 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 are a 
\begin_inset Formula $SRS(n)$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 distribution.
 We would like to test 
\begin_inset Formula $H_{0}:\mu=\mu_{0}$
\end_inset

.
\end_layout

\begin_layout Description
Case
\begin_inset space ~
\end_inset

A: Suppose 
\begin_inset Formula $\sigma$
\end_inset

 is known.
 Then under 
\begin_inset Formula $H_{0}$
\end_inset

,
\begin_inset Formula \[
Z=\frac{\Xbar-\mu_{0}}{\sigma/\sqrt{n}}\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1).\]

\end_inset

Table here.
\end_layout

\begin_layout Description
Case
\begin_inset space ~
\end_inset

B: When 
\begin_inset Formula $\sigma$
\end_inset

 is unknown, under 
\begin_inset Formula $H_{0}$
\end_inset


\begin_inset Formula \[
T=\frac{\Xbar-\mu_{0}}{S/\sqrt{n}}\sim\mathsf{t}(\mathtt{df}=n-1).\]

\end_inset

Table here.
 
\end_layout

\begin_layout Remark
If 
\begin_inset Formula $\sigma$
\end_inset

 is unknown but 
\begin_inset Formula $n$
\end_inset

 is large then we can use the 
\begin_inset Formula $z$
\end_inset

-test.
\end_layout

\begin_layout Example
In this example we
\end_layout

\begin_deeper
\begin_layout Enumerate
Find the null and alternative hypotheses.
\end_layout

\begin_layout Enumerate
Choose a test and find the critical region.
\end_layout

\begin_layout Enumerate
Calculate the value of the test statistic and state the conclusion.
\end_layout

\begin_layout Enumerate
Find the 
\begin_inset Formula $p$
\end_inset

-value.
\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Remark
Remarks
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $p$
\end_inset

-values are also known as tail end probabilities.
 We reject 
\begin_inset Formula $H_{0}$
\end_inset

 when the 
\begin_inset Formula $p$
\end_inset

-value is small.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\sigma/\sqrt{n}$
\end_inset

 when 
\begin_inset Formula $\sigma$
\end_inset

 is known, is called the standard error of the sample mean.
 In general, if we have an estimator 
\begin_inset Formula $\hat{\theta}$
\end_inset

 then 
\begin_inset Formula $\sigma_{\hat{\theta}}$
\end_inset

 is called the standard error of 
\begin_inset Formula $\hat{\theta}$
\end_inset

.
 We usually need to estimate 
\begin_inset Formula $\sigma_{\hat{\theta}}$
\end_inset

 with 
\begin_inset Formula $\hat{\sigma_{\hat{\theta}}}$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
I am thinking 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

z.test
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
z.test
\end_layout

\end_inset

 in 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

TeachingDemos
\end_layout

\end_inset

, 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

t.test
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
t.test
\end_layout

\end_inset

 in base 
\family sans
\size small
R
\family default
\size default
.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x <- rnorm(37, mean = 2, sd = 3)
\begin_inset Newline newline
\end_inset

library(TeachingDemos)
\begin_inset Newline newline
\end_inset

z.test(x, mu = 1, sd = 3, conf.level = 0.90)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 6, width = 6.5>>=
\begin_inset Newline newline
\end_inset

library(HH)
\begin_inset Newline newline
\end_inset

plot(prop.test(1755, 1755 + 2771, p = 0.4, alternative = "less", conf.level
 = 0.99, correct = FALSE), 'Hypoth')
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Hypothesis test plot based on 
\family typewriter
normal.and.t.dist
\family default
 from the 
\family typewriter
HH
\family default
 package
\begin_inset CommandInset label
LatexCommand label
name "fig:Hypothesis-test-plot-2"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\size small
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Plain Layout

\size small
This plot shows the important features of hypothesis tests.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

RcmdrPlugin.IPSUR
\end_layout

\end_inset

 package does not have a menu for 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

z.test
\end_layout

\end_inset

 yet.
 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x <- rnorm(13, mean = 2, sd = 3)
\begin_inset Newline newline
\end_inset

t.test(x, mu = 0, conf.level = 0.90, alternative = "greater")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Paragraph*
With the 
\family sans
R
\family default
 Commander
\end_layout

\begin_layout Standard
Your data should be in a single numeric column (a variable) of the Active
 Data Set.
 Use the menu 
\family sans
Statistics 
\begin_inset Formula $\triangleright$
\end_inset

 Means 
\begin_inset Formula $\triangleright$
\end_inset

 Single-sample t-test\SpecialChar \ldots{}

\end_layout

\begin_layout Subsection
Tests for a Variance
\end_layout

\begin_layout Standard
Here, 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 are a 
\begin_inset Formula $SRS(n)$
\end_inset

 from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

 distribution.
 We would like to test 
\begin_inset Formula $H_{0}:\sigma^{2}=\sigma_{0}$
\end_inset

.
 We know that under 
\begin_inset Formula $H_{0}$
\end_inset

,
\begin_inset Formula \[
X^{2}=\frac{(n-1)S^{2}}{\sigma^{2}}\sim\mathsf{chisq}(\mathtt{df}=n-1).\]

\end_inset

Table here.
\end_layout

\begin_layout Example
Give some data and a hypothesis.
\end_layout

\begin_deeper
\begin_layout Enumerate
Give an 
\begin_inset Formula $\alpha$
\end_inset

-level and test the critical region way.
\end_layout

\begin_layout Enumerate
Find the 
\begin_inset Formula $p$
\end_inset

-value for the test.
\end_layout

\end_deeper
\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
I am thinking about 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

sigma.test
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
sigma.test
\end_layout

\end_inset

 in the 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

TeachingDemos
\end_layout

\end_inset

 package.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(TeachingDemos)
\begin_inset Newline newline
\end_inset

sigma.test(women$height, sigma = 8)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Section
Two-Sample Tests for Means and Variances
\begin_inset CommandInset label
LatexCommand label
name "sec:Two-Sample-Tests-for-Means"

\end_inset


\end_layout

\begin_layout Standard
The basic idea for this section is the following.
 We have 
\begin_inset Formula $X\sim\mathsf{norm}(\mathtt{mean}=\mu_{X},\,\mathtt{sd}=\sigma_{X})$
\end_inset

 and 
\begin_inset Formula $Y\sim\mathsf{norm}(\mathtt{mean}=\mu_{Y},\,\mathtt{sd}=\sigma_{Y})$
\end_inset

.
 distributed independently.
 We would like to know whether 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 come from the same population distribution, that is, we would like to know:
\begin_inset Formula \begin{equation}
\mbox{Does }X\overset{\mathrm{d}}{=}Y?\end{equation}

\end_inset

where the symbol 
\begin_inset Formula $\overset{\mathrm{d}}{=}$
\end_inset

 means equality of probability distributions.
\end_layout

\begin_layout Standard
Since both 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are normal, we may rephrase the question:
\begin_inset Formula \begin{equation}
\mbox{Does }\mu_{X}=\mu_{Y}\mbox{ and }\sigma_{X}=\sigma_{Y}?\end{equation}

\end_inset

Suppose first that we do not know the values of 
\begin_inset Formula $\sigma_{X}$
\end_inset

 and 
\begin_inset Formula $\sigma_{Y}$
\end_inset

, but we know that they are equal, 
\begin_inset Formula $\sigma_{X}=\sigma_{Y}$
\end_inset

.
 Our test would then simplify to 
\begin_inset Formula $H_{0}:\mu_{X}=\mu_{Y}$
\end_inset

.
 We collect data 
\begin_inset Formula $X_{1}$
\end_inset

, 
\begin_inset Formula $X_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $X_{n}$
\end_inset

 and 
\begin_inset Formula $Y_{1}$
\end_inset

, 
\begin_inset Formula $Y_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $Y_{m}$
\end_inset

, both simple random samples of size 
\begin_inset Formula $n$
\end_inset

 and 
\begin_inset Formula $m$
\end_inset

 from their respective normal distributions.
 Then under 
\begin_inset Formula $H_{0}$
\end_inset

 (that is, assuming 
\begin_inset Formula $H_{0}$
\end_inset

 is true) we have 
\begin_inset Formula $\mu_{X}=\mu_{Y}$
\end_inset

 or rewriting, 
\begin_inset Formula $\mu_{X}-\mu_{Y}=0$
\end_inset

, so 
\begin_inset Formula \begin{equation}
T=\frac{\Xbar-\Ybar}{S_{p}\sqrt{\frac{1}{n}+\frac{1}{m}}}=\frac{\Xbar-\Ybar-(\mu_{X}-\mu_{Y})}{S_{p}\sqrt{\frac{1}{n}+\frac{1}{m}}}\sim\mathsf{t}(\mathtt{df}=n+m-2).\end{equation}

\end_inset


\end_layout

\begin_layout Subsection
Independent Samples
\end_layout

\begin_layout Remark
If the values of 
\begin_inset Formula $\sigma_{X}$
\end_inset

 and 
\begin_inset Formula $\sigma_{Y}$
\end_inset

 are known, then we can plug them in to our statistic:
\begin_inset Formula \begin{equation}
Z=\frac{\Xbar-\Ybar}{\sqrt{\sigma_{X}^{2}/n+\sigma_{Y}^{2}/m}};\end{equation}

\end_inset

the result will have a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

 distribution when 
\begin_inset Formula $H_{0}:\mu_{X}=\mu_{Y}$
\end_inset

 is true.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Remark
Even if the values of 
\begin_inset Formula $\sigma_{X}$
\end_inset

 and 
\begin_inset Formula $\sigma_{Y}$
\end_inset

 are not known, if both 
\begin_inset Formula $n$
\end_inset

 and 
\begin_inset Formula $m$
\end_inset

 are large then we can plug in the sample estimates and the result will
 have approximately a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

 distribution when 
\begin_inset Formula $H_{0}:\mu_{X}=\mu_{Y}$
\end_inset

 is true.
\begin_inset Formula \begin{equation}
Z=\frac{\Xbar-\Ybar}{\sqrt{S_{X}^{2}/n+S_{Y}^{2}/m}}.\end{equation}

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Remark
It is usually important to construct side-by-side boxplots and other visual
 displays in concert with the hypothesis test.
 This gives a visual comparison of the samples and helps to identify departures
 from the test's assumptions -- such as outliers.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Remark
WATCH YOUR ASSUMPTIONS.
\end_layout

\begin_deeper
\begin_layout Itemize
The normality assumption can be relaxed as long as the population distributions
 are not highly skewed.
\end_layout

\begin_layout Itemize
The equal variance assumption can be relaxed as long as both sample sizes
 
\begin_inset Formula $n$
\end_inset

 and 
\begin_inset Formula $m$
\end_inset

 are large.
 However, if one (or both) samples is small, then the test does not perform
 well; we should instead use the methods of Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:resampling-methods"

\end_inset

.
\end_layout

\end_deeper
\begin_layout Standard
For a nonparametric alternative to the two-sample 
\begin_inset Formula $F$
\end_inset

 test see Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Nonparametric-Statistics"

\end_inset

.
\end_layout

\begin_layout Subsection
Paired Samples
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

t.test(extra ~ group, data = sleep, paired = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Section
Other Hypothesis Tests
\begin_inset CommandInset label
LatexCommand label
name "sec:Other-Hypothesis-Tests"

\end_inset


\end_layout

\begin_layout Subsection
Kolmogorov-Smirnov Goodness-of-Fit Test
\begin_inset CommandInset label
LatexCommand label
name "sub:Kolmogorov-Smirnov-Goodness-of-Fit-Test"

\end_inset


\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

ks.test(randu$x, "punif")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Subsection
Shapiro-Wilk Normality Test
\begin_inset CommandInset label
LatexCommand label
name "sub:Shapiro-Wilk-Normality-Test"

\end_inset


\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

shapiro.test(women$height)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Section
Analysis of Variance
\begin_inset CommandInset label
LatexCommand label
name "sec:Analysis-of-Variance"

\end_inset


\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
I am thinking 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

with(chickwts, by(weight, feed, shapiro.test))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
and
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

temp <- lm(weight ~ feed, data = chickwts)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
and 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

anova(temp)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Plot for the intuition of between versus within group variation.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig = true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

y1 <- rnorm(300, mean = c(2,8,22))
\begin_inset Newline newline
\end_inset

plot(y1, xlim = c(-1,25), ylim = c(0,0.45) , type = "n")
\begin_inset Newline newline
\end_inset

f <- function(x){dnorm(x, mean = 2)}
\begin_inset Newline newline
\end_inset

curve(f, from = -1, to = 5, add = TRUE, lwd = 2)
\begin_inset Newline newline
\end_inset

f <- function(x){dnorm(x, mean = 8)}
\begin_inset Newline newline
\end_inset

curve(f, from = 5, to = 11, add = TRUE, lwd = 2)
\begin_inset Newline newline
\end_inset

f <- function(x){dnorm(x, mean = 22)}
\begin_inset Newline newline
\end_inset

curve(f, from = 19, to = 25, add = TRUE, lwd = 2)
\begin_inset Newline newline
\end_inset

rug(y1)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Between group versus within group variation
\begin_inset CommandInset label
LatexCommand label
name "fig:Between-versus-within"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Scrap

\end_layout

\begin_layout Standard
Plots for the hypothesis tests:
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig = true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

y2 <- rnorm(300, mean = c(4,4.1,4.3))
\begin_inset Newline newline
\end_inset

hist(y2, 30, prob = TRUE)
\begin_inset Newline newline
\end_inset

f <- function(x){dnorm(x, mean = 4)/3}
\begin_inset Newline newline
\end_inset

curve(f, add = TRUE, lwd = 2)
\begin_inset Newline newline
\end_inset

f <- function(x){dnorm(x, mean = 4.1)/3}
\begin_inset Newline newline
\end_inset

curve(f, add = TRUE, lwd = 2)
\begin_inset Newline newline
\end_inset

f <- function(x){dnorm(x, mean = 4.3)/3}
\begin_inset Newline newline
\end_inset

curve(f, add = TRUE, lwd = 2)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Between group versus within group variation
\begin_inset CommandInset label
LatexCommand label
name "fig:Between-versus-within-2"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig = true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

library(HH)
\begin_inset Newline newline
\end_inset

old.omd <- par(omd = c(.05,.88, .05,1))
\begin_inset Newline newline
\end_inset

F.setup(df1 = 5, df2 = 30)
\begin_inset Newline newline
\end_inset

F.curve(df1 = 5, df2 = 30, col='blue')
\begin_inset Newline newline
\end_inset

F.observed(3, df1 = 5, df2 = 30)
\begin_inset Newline newline
\end_inset

par(old.omd)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Some 
\emph on
F
\emph default
 plots from the 
\family typewriter
HH
\family default
 package
\begin_inset CommandInset label
LatexCommand label
name "fig:Some-F-plots-HH"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Section
Sample Size and Power
\begin_inset CommandInset label
LatexCommand label
name "sec:Sample-Size-and-Power"

\end_inset


\end_layout

\begin_layout Standard
The power function of a test for a parameter 
\begin_inset Formula $\theta$
\end_inset

 is
\begin_inset Formula \[
\beta(\theta)=\P_{\theta}(\mbox{Reject }H_{0}),\quad-\infty<\theta<\infty.\]

\end_inset

Here are some properties of power functions:
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\beta(\theta)\leq\alpha$
\end_inset

 for any 
\begin_inset Formula $\theta\in\Theta_{0}$
\end_inset

, and 
\begin_inset Formula $\beta(\theta_{0})=\alpha$
\end_inset

.
 We interpret this by saying that no matter what value 
\begin_inset Formula $\theta$
\end_inset

 takes inside the null parameter space, there is never more than a chance
 of 
\begin_inset Formula $\alpha$
\end_inset

 of rejecting the null hypothesis.
 We have controlled the Type I error rate to be no greater than 
\begin_inset Formula $\alpha$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\lim_{n\to\infty}\beta(\theta)=1$
\end_inset

 for any fixed 
\begin_inset Formula $\theta\in\Theta_{1}$
\end_inset

.
 In other words, as the sample size grows without bound we are able to detect
 a nonnull value of 
\begin_inset Formula $\theta$
\end_inset

 with increasing accuracy, no matter how close it lies to the null parameter
 space.
 This may appear to be a good thing at first glance, but it often turns
 out to be a curse.
 For another interpretation is that our Type II error rate grows as the
 sample size increases.
 
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
I am thinking about 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

replicate
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
replicate
\end_layout

\end_inset

 here, and also 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

power.examp
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
power.examp
\end_layout

\end_inset

 from the 
\begin_inset listings
inline true
status open

\begin_layout Plain Layout

TeachingDemos
\end_layout

\end_inset

 package.
 There is an even better plot in upcoming work from the HH package.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 6, width = 6>>=
\begin_inset Newline newline
\end_inset

library(TeachingDemos)
\begin_inset Newline newline
\end_inset

power.examp()
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Plot of significance level and power
\begin_inset CommandInset label
LatexCommand label
name "fig:power-examp"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Plain Layout

\size small
This graph was generated by the 
\family typewriter
power.examp
\family default
 function from the 
\family typewriter
TeachingDemos
\family default
 package.
 The plot corresponds to the hypothesis test 
\begin_inset Formula $H_{0}:\,\mu=\mu_{0}$
\end_inset

 versus 
\begin_inset Formula $H_{1}:\,\mu=\mu_{1}$
\end_inset

 (where 
\begin_inset Formula $\mu_{0}=0$
\end_inset

 and 
\begin_inset Formula $\mu_{1}=1$
\end_inset

, by default) based on a single observation 
\begin_inset Formula $X\sim\mathsf{norm}(\mathtt{mean}=\mu,\,\mathtt{sd}=\sigma)$
\end_inset

.
 The top graph is of the 
\begin_inset Formula $H_{0}$
\end_inset

 density while the bottom is of the 
\begin_inset Formula $H_{1}$
\end_inset

 density.
 The significance level is set at 
\begin_inset Formula $\alpha=0.05$
\end_inset

, the sample size is 
\begin_inset Formula $n=1$
\end_inset

, and the standard deviation is 
\begin_inset Formula $\sigma=1$
\end_inset

.
 The pink area is the significance level, and the critical value 
\begin_inset Formula $z_{0.05}\approx1.645$
\end_inset

 is marked at the left boundary -- this defines the rejection region.
 When 
\begin_inset Formula $H_{0}$
\end_inset

 is true, the probability of falling in the rejection region is exactly
 
\begin_inset Formula $\alpha=0.05$
\end_inset

.
 The same rejection region is marked on the bottom graph, and the probability
 of falling in it (when 
\begin_inset Formula $H_{1}$
\end_inset

 is true) is the blue area shown at the top of the display to be approximately
 
\begin_inset Formula $0.26$
\end_inset

.
 This probability represents the 
\emph on
power
\emph default
 to detect a non-null mean value of 
\begin_inset Formula $\mu=1$
\end_inset

.
 With the command the 
\family typewriter
run.power.examp()
\family default
 at the command line the same plot opens, but in addition, there are sliders
 available that allow the user to interactively change the sample size 
\begin_inset Formula $n$
\end_inset

, the standard deviation 
\begin_inset Formula $\sigma$
\end_inset

, the true difference between the means 
\begin_inset Formula $\mu_{1}-\mu_{0}$
\end_inset

, and the significance level 
\begin_inset Formula $\alpha$
\end_inset

.
 By playing around the student can investigate the effect each of the aforementi
oned parameters has on the statistical power.
 Note that you need the 
\family typewriter
tkrplot
\family default
 package for 
\family typewriter
run.power.examp
\family default
.
 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Chapter Exercises
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{section}{Chapter Exercises}
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{thm}{0}
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Simple Linear Regression
\begin_inset CommandInset label
LatexCommand label
name "cha:simple-linear-regression"

\end_inset


\end_layout

\begin_layout Paragraph*
What do I want them to know?
\end_layout

\begin_layout Itemize
basic philosophy of SLR and the regression assumptions
\end_layout

\begin_layout Itemize
point and interval estimation of the model parameters, and how to use it
 to make predictions
\end_layout

\begin_layout Itemize
point and interval estimation of future observations from the model
\end_layout

\begin_layout Itemize
regression diagnostics, including 
\begin_inset Formula $R^{2}$
\end_inset

 and basic residual analysis
\end_layout

\begin_layout Itemize
the concept of influential versus outlying observations, and how to tell
 the difference
\end_layout

\begin_layout Section
Basic Philosophy
\begin_inset CommandInset label
LatexCommand label
name "sec:Basic-Philosophy"

\end_inset


\end_layout

\begin_layout Standard
Here we have two variables 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

.
 For our purposes, 
\begin_inset Formula $X$
\end_inset

 is not random (so we will write 
\begin_inset Formula $x$
\end_inset

), but 
\begin_inset Formula $Y$
\end_inset

 is random.
 We believe that 
\begin_inset Formula $Y$
\end_inset

 depends in 
\emph on
some
\emph default
 way on 
\begin_inset Formula $x$
\end_inset

.
 Some typical examples of 
\begin_inset Formula $(x,Y)$
\end_inset

 pairs are
\end_layout

\begin_layout Itemize
\begin_inset Formula $x=$
\end_inset

 study time and 
\begin_inset Formula $Y=$
\end_inset

 score on a test.
\end_layout

\begin_layout Itemize
\begin_inset Formula $x=$
\end_inset

 height and 
\begin_inset Formula $Y=$
\end_inset

 weight.
\end_layout

\begin_layout Itemize
\begin_inset Formula $x=$
\end_inset

 smoking frequency and 
\begin_inset Formula $Y=$
\end_inset

 age of first heart attack.
\end_layout

\begin_layout Standard
Given information about the relationship between 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

, we would like to 
\emph on
predict
\emph default
 future values of 
\begin_inset Formula $Y$
\end_inset

 for particular values of 
\begin_inset Formula $x$
\end_inset

.
 This turns out to be a difficult problem
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Yogi Berra once said, 
\begin_inset Quotes eld
\end_inset

It is always difficult to make predictions, especially about the future.
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset

, so instead we first tackle an easier problem: we estimate 
\begin_inset Formula $\E Y$
\end_inset

.
 How can we accomplish this? Well, we know that 
\begin_inset Formula $Y$
\end_inset

 depends somehow on 
\begin_inset Formula $x,$
\end_inset

 so it stands to reason that
\begin_inset Formula \begin{equation}
\E Y=\mu(x),\ \mbox{a function of }x.\end{equation}

\end_inset

But we should be able to say more than that.
 To focus our efforts we impose some structure on the functional form of
 
\begin_inset Formula $\mu$
\end_inset

.
 For instance,
\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\mu(x)=\beta_{0}+\beta_{1}x$
\end_inset

, we try to estimate 
\begin_inset Formula $\beta_{0}$
\end_inset

 and 
\begin_inset Formula $\beta_{1}$
\end_inset

.
\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\mu(x)=\beta_{0}+\beta_{1}x+\beta_{2}x^{2}$
\end_inset

 , we try to estimate 
\begin_inset Formula $\beta_{0}$
\end_inset

, 
\begin_inset Formula $\beta_{1}$
\end_inset

, and 
\begin_inset Formula $\beta_{2}$
\end_inset

.
\end_layout

\begin_layout Itemize
if 
\begin_inset Formula $\mu(x)=\beta_{0}\me^{\beta_{1}x}$
\end_inset

, we try to estimate 
\begin_inset Formula $\beta_{0}$
\end_inset

 and 
\begin_inset Formula $\beta_{1}$
\end_inset

.
\end_layout

\begin_layout Standard
This helps us in the sense that we concentrate on the estimation of just
 a few parameters, 
\begin_inset Formula $\beta_{0}$
\end_inset

 and 
\begin_inset Formula $\beta_{1}$
\end_inset

, say, rather than some nebulous function.
 Our 
\emph on
modus operandi
\emph default
 is simply to perform the random experiment 
\begin_inset Formula $n$
\end_inset

 times and observe the 
\begin_inset Formula $n$
\end_inset

 ordered pairs of data 
\begin_inset Formula $(x_{1},Y_{1}),\ (x_{2},Y_{2}),\ \ldots,(x_{n},Y_{n})$
\end_inset

.
 We use these 
\begin_inset Formula $n$
\end_inset

 data points to estimate the parameters.
\end_layout

\begin_layout Standard
More to the point, there are 
\emph on
three simple linear regression (SLR) assumptions
\emph default

\begin_inset Index
status open

\begin_layout Plain Layout
regression assumptions
\end_layout

\end_inset

 that will form the basis for the rest of this chapter:
\end_layout

\begin_layout Assumption
We assume that 
\begin_inset Formula $\mu$
\end_inset

 is a linear function of 
\begin_inset Formula $x$
\end_inset

, that is, 
\begin_inset Formula \begin{equation}
\mu(x)=\beta_{0}+\beta_{1}x,\end{equation}

\end_inset


\shape up
\emph on
where 
\begin_inset Formula $\beta_{0}$
\end_inset

 and 
\begin_inset Formula $\beta_{1}$
\end_inset

 are unknown constants to be estimated
\family roman
\series medium
\size normal
\emph off
\bar no
\noun off
\color none
.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Assumption
We further assume that 
\begin_inset Formula $Y_{i}$
\end_inset

 is 
\begin_inset Formula $\mu(x_{i})$
\end_inset

 -- the 
\begin_inset Quotes eld
\end_inset

signal
\begin_inset Quotes erd
\end_inset

 -- plus some 
\begin_inset Quotes eld
\end_inset

error
\begin_inset Quotes erd
\end_inset

 (represented by the symbol 
\begin_inset Formula $\epsilon_{i}$
\end_inset

):
\begin_inset Formula \begin{equation}
Y_{i}=\beta_{0}+\beta_{1}x_{i}+\epsilon_{i},\quad i=1,2,\ldots,n.\end{equation}

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Assumption
We lastly assume that the errors are i.i.d.
\begin_inset space ~
\end_inset

normal with mean 0 and variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

:
\begin_inset Formula \begin{equation}
\epsilon_{1},\epsilon_{2},\ldots,\epsilon_{n}\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=\sigma).\end{equation}

\end_inset


\end_layout

\begin_layout Remark
We assume both the normality of the errors 
\begin_inset Formula $\epsilon$
\end_inset

 and the linearity of the mean function 
\begin_inset Formula $\mu$
\end_inset

.
 Recall from Proposition 
\begin_inset CommandInset ref
LatexCommand ref
reference "pro:mvnorm-cond-dist"

\end_inset

 of Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Multivariable-Distributions"

\end_inset

 that if 
\begin_inset Formula $(X,Y)\sim\mathsf{mvnorm}$
\end_inset

 then the mean of 
\begin_inset Formula $Y|x$
\end_inset

 is a linear function of 
\begin_inset Formula $x$
\end_inset

.
 This is not a coincidence.
 In more advanced classes we study the case that both 
\begin_inset Formula $X$
\end_inset

 and 
\begin_inset Formula $Y$
\end_inset

 are random, and in particular, when they are jointly normally distributed.
\end_layout

\begin_layout Subsection*
What does it all mean?
\end_layout

\begin_layout Standard
See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:philosophy"

\end_inset

.
 Shown in the figure is a solid line, the regression line
\begin_inset Index
status open

\begin_layout Plain Layout
regression line
\end_layout

\end_inset

 
\begin_inset Formula $\mu$
\end_inset

, which in this display has slope 
\begin_inset Formula $0.5$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

-intercept 2.5, that is, 
\begin_inset Formula $\mu(x)=2.5+0.5x$
\end_inset

.
 The intuition is that for each given value of 
\begin_inset Formula $x$
\end_inset

, we observe a random value of 
\begin_inset Formula $Y$
\end_inset

 which is normally distributed with a mean equal to the height of the regression
 line at that 
\begin_inset Formula $x$
\end_inset

 value.
 Normal densities are superimposed on the plot to drive this point home;
 in principle, the densities stand outside of the page, perpendicular to
 the plane of the paper.
 The figure shows three such values of 
\begin_inset Formula $x$
\end_inset

, namely, 
\begin_inset Formula $x=1$
\end_inset

, 
\begin_inset Formula $x=2.5$
\end_inset

, and 
\begin_inset Formula $x=4$
\end_inset

.
 Not only do we assume that the observations at the three locations are
 independent, but we also assume that their distributions have the same
 spread.
 In mathematical terms this means that the normal densities all along the
 line have identical standard deviations -- there is no 
\begin_inset Quotes eld
\end_inset

fanning out
\begin_inset Quotes erd
\end_inset

 or 
\begin_inset Quotes eld
\end_inset

scrunching in
\begin_inset Quotes erd
\end_inset

 of the normal densities as 
\begin_inset Formula $x$
\end_inset

 increases
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
In practical terms, this constant variance assumption is often violated,
 in that we often observe scatterplots that fan out from the line as 
\begin_inset Formula $x$
\end_inset

 gets large or small.
 We say under those circumstances that the data show 
\emph on
heteroscedasticity
\emph default
.
 There are methods to address it, but they fall outside the realm of SLR.
 
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Quotation
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 5, width = 6>>=
\begin_inset Newline newline
\end_inset

 # open window
\begin_inset Newline newline
\end_inset

plot(c(0,5), c(0,6.5), type = "n", xlab="x", ylab="y")
\begin_inset Newline newline
\end_inset

## the x- and y-axes
\begin_inset Newline newline
\end_inset

abline(h=0, v=0, col = "gray60")
\begin_inset Newline newline
\end_inset

# regression line
\begin_inset Newline newline
\end_inset

abline(a = 2.5, b = 0.5, lwd = 2)
\begin_inset Newline newline
\end_inset

# normal curves
\begin_inset Newline newline
\end_inset

x <- 600:3000/600
\begin_inset Newline newline
\end_inset

y <- dnorm(x, mean = 3, sd = 0.5)
\begin_inset Newline newline
\end_inset

lines(y + 1.0, x)
\begin_inset Newline newline
\end_inset

lines(y + 2.5, x + 0.75)
\begin_inset Newline newline
\end_inset

lines(y + 4.0, x + 1.5)
\begin_inset Newline newline
\end_inset

# pretty it up
\begin_inset Newline newline
\end_inset

abline(v = c(1, 2.5, 4), lty = 2, col = "grey")
\begin_inset Newline newline
\end_inset

segments(1,3, 1+dnorm(0,0,0.5),3, lty = 2, col = "gray")
\begin_inset Newline newline
\end_inset

segments(2.5, 3.75, 2.5+dnorm(0,0,0.5), 3.75, lty = 2, col = "gray")
\begin_inset Newline newline
\end_inset

segments(4,4.5, 4+dnorm(0,0,0.5),4.5, lty = 2, col = "gray")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Philosophical foundations of SLR
\begin_inset CommandInset label
LatexCommand label
name "fig:philosophy"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:Speed-and-Stopping"

\end_inset


\series bold
Speed and stopping distance of cars.

\series default
 We will use the data frame
\color none
 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\color none
Data sets ! 
\family typewriter
\color inherit
cars
\end_layout

\end_inset


\color inherit
 from the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

datasets
\end_layout

\end_inset


\color inherit
 package.
 It has two variables: 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

speed
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dist
\end_layout

\end_inset


\color inherit
.
 We can take a look at some of the values in the data frame: 
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

head(cars)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

speed
\end_layout

\end_inset


\color inherit
 represents how fast the car was going (
\begin_inset Formula $x$
\end_inset

) in miles per hour and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dist
\end_layout

\end_inset


\color inherit
 (
\begin_inset Formula $Y$
\end_inset

) measures how far it took the car to stop, in feet.
 We can make a simple scatterplot of the data with the command 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Verse

plot(dist ~ speed, data = cars)
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Quotation
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

plot(dist ~ speed, data = cars)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Scatterplot of 
\family typewriter
dist
\family default
 versus 
\family typewriter
speed
\family default
 for the 
\family typewriter
cars
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:Scatter-cars"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
You can see the output in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Scatter-cars"

\end_inset

, which was produced by the following code.
\end_layout

\end_deeper
\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

plot(dist ~ speed, data = cars)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
There is a pronounced upward trend to the data points, and the pattern looks
 approximately linear.
 There does not appear to be substantial fanning out of the points or extreme
 values.
 
\end_layout

\begin_layout Section
Estimation
\begin_inset CommandInset label
LatexCommand label
name "sec:SLR-Estimation"

\end_inset


\end_layout

\begin_layout Subsection
\begin_inset CommandInset label
LatexCommand label
name "sub:point-estimate-mle-slr"

\end_inset

Point Estimates of the Parameters
\end_layout

\begin_layout Standard
Where is 
\begin_inset Formula $\mu(x)$
\end_inset

? In essence, we would like to 
\begin_inset Quotes eld
\end_inset

fit
\begin_inset Quotes erd
\end_inset

 a line to the points.
 But how do we determine a 
\begin_inset Quotes eld
\end_inset

good
\begin_inset Quotes erd
\end_inset

 line? Is there a 
\emph on
best
\emph default
 line? We will use maximum likelihood
\begin_inset Index
status open

\begin_layout Plain Layout
maximum likelihood
\end_layout

\end_inset

 to find it.
 We know:
\begin_inset Formula \begin{equation}
Y_{i}=\beta_{0}+\beta_{1}x_{i}+\epsilon_{i},\quad i=1,\ldots,n,\end{equation}

\end_inset

where the 
\begin_inset Formula $\epsilon_{i}$
\end_inset

's are i.i.d.
\begin_inset space ~
\end_inset


\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=\sigma)$
\end_inset

.
 Thus 
\begin_inset Formula $Y_{i}\sim\mathsf{norm}(\mathtt{mean}=\beta_{0}+\beta_{1}x_{i},\,\mathtt{sd}=\sigma),\ i=1,\ldots,n$
\end_inset

.
 Furthermore, 
\begin_inset Formula $Y_{1},\ldots,Y_{n}$
\end_inset

 are independent -- but not identically distributed.
 The likelihood function
\begin_inset Index
status open

\begin_layout Plain Layout
likelihood function
\end_layout

\end_inset

 is:
\begin_inset Formula \begin{alignat}{1}
L(\beta_{0},\beta_{1},\sigma)= & \prod_{i=1}^{n}f_{Y_{i}}(y_{i}),\\
= & \prod_{i=1}^{n}(2\pi\sigma^{2})^{-1/2}\exp\left\{ \frac{-(y_{i}-\beta_{0}-\beta_{1}x_{i})^{2}}{2\sigma^{2}}\right\} ,\\
= & (2\pi\sigma^{2})^{-n/2}\exp\left\{ \frac{-\sum_{i=1}^{n}(y_{i}-\beta_{0}-\beta_{1}x_{i})^{2}}{2\sigma^{2}}\right\} .\end{alignat}

\end_inset

We take the natural logarithm to get
\begin_inset Formula \begin{equation}
\ln L(\beta_{0},\beta_{1},\sigma)=-\frac{n}{2}\ln(2\pi\sigma^{2})-\frac{\sum_{i=1}^{n}(y_{i}-\beta_{0}-\beta_{1}x_{i})^{2}}{2\sigma^{2}}.\label{eq:regML-lnL}\end{equation}

\end_inset

 We would like to maximize this function of 
\begin_inset Formula $\beta_{0}$
\end_inset

 and 
\begin_inset Formula $\beta_{1}$
\end_inset

.
 See Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Multivariable-Calculus"

\end_inset

 which tells us that we should find critical points by means of the partial
 derivatives.
 Let us start by differentiating with respect to 
\begin_inset Formula $\beta_{0}$
\end_inset

: 
\begin_inset Formula \begin{equation}
\frac{\partial}{\partial\beta_{0}}\ln L=0-\frac{1}{2\sigma^{2}}\sum_{i=1}^{n}2(y_{i}-\beta_{0}-\beta_{1}x_{i})(-1),\end{equation}

\end_inset

and the partial derivative equals zero when 
\begin_inset Formula $\sum_{i=1}^{n}(y_{i}-\beta_{0}-\beta_{1}x_{i})=0$
\end_inset

, that is, when
\begin_inset Formula \begin{equation}
n\beta_{0}+\beta_{1}\sum_{i=1}^{n}x_{i}=\sum_{i=1}^{n}y_{i}.\label{eq:regML-a}\end{equation}

\end_inset

Moving on, we next take the partial derivative of 
\begin_inset Formula $\ln L$
\end_inset

 (Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:regML-lnL"

\end_inset

) with respect to 
\begin_inset Formula $\beta_{1}$
\end_inset

 to get 
\begin_inset Formula \begin{alignat}{1}
\frac{\partial}{\partial\beta_{1}}\ln L=\  & 0-\frac{1}{2\sigma^{2}}\sum_{i=1}^{n}2(y_{i}-\beta_{0}-\beta_{1}x_{i})(-x_{i}),\\
= & \frac{1}{\sigma^{2}}\sum_{i=1}^{n}\left(x_{i}y_{i}-\beta_{0}x_{i}-\beta_{1}x_{i}^{2}\right),\end{alignat}

\end_inset

and this equals zero when the last sum equals zero, that is, when 
\begin_inset Formula \begin{equation}
\beta_{0}\sum_{i=1}^{n}x_{i}+\beta_{1}\sum_{i=1}^{n}x_{i}^{2}=\sum_{i=1}^{n}x_{i}y_{i}.\label{eq:regML-b}\end{equation}

\end_inset

Solving the system of equations 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:regML-a"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:regML-b"

\end_inset

 
\begin_inset Formula \begin{eqnarray}
n\beta_{0}+\beta_{1}\sum_{i=1}^{n}x_{i} & = & \sum_{i=1}^{n}y_{i}\\
\beta_{0}\sum_{i=1}^{n}x_{i}+\beta_{1}\sum_{i=1}^{n}x_{i}^{2} & = & \sum_{i=1}^{n}x_{i}y_{i}\end{eqnarray}

\end_inset

for 
\begin_inset Formula $\beta_{0}$
\end_inset

 and 
\begin_inset Formula $\beta_{1}$
\end_inset

 (in Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:find-mles-SLR"

\end_inset

) gives 
\begin_inset Formula \begin{equation}
\hat{\beta}_{1}=\frac{\sum_{i=1}^{n}x_{i}y_{i}-\left.\left(\sum_{i=1}^{n}x_{i}\right)\left(\sum_{i=1}^{n}y_{i}\right)\right\slash n}{\sum_{i=1}^{n}x_{i}^{2}-\left.\left(\sum_{i=1}^{n}x_{i}\right)^{2}\right\slash n}\label{eq:regline-slope-formula}\end{equation}

\end_inset

and
\begin_inset Formula \begin{equation}
\hat{\beta}_{0}=\ybar-\hat{\beta}_{1}\xbar.\end{equation}

\end_inset

The conclusion? To estimate the mean line 
\begin_inset Formula \begin{equation}
\mu(x)=\beta_{0}+\beta_{1}x,\end{equation}

\end_inset

 we use the 
\begin_inset Quotes eld
\end_inset

line of best fit
\begin_inset Quotes erd
\end_inset


\begin_inset Formula \begin{equation}
\hat{\mu}(x)=\hat{\beta}_{0}+\hat{\beta}_{1}x,\end{equation}

\end_inset

where 
\begin_inset Formula $\hat{\beta}_{0}$
\end_inset

 and 
\begin_inset Formula $\hat{\beta}_{1}$
\end_inset

 are given as above.
 For notation we will usually write 
\begin_inset Formula $b_{0}=\hat{\beta_{0}}$
\end_inset

 and 
\begin_inset Formula $b_{1}=\hat{\beta_{1}}$
\end_inset

 so that 
\begin_inset Formula $\hat{\mu}(x)=b_{0}+b_{1}x$
\end_inset

.
\end_layout

\begin_layout Remark
The formula for 
\begin_inset Formula $b_{1}$
\end_inset

 in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:regline-slope-formula"

\end_inset

 gets the job done but does not really make any sense.
 There are many equivalent formulas for 
\begin_inset Formula $b_{1}$
\end_inset

 that are more intuitive, or at the least are easier to remember.
 One of the author's favorites is
\begin_inset Formula \begin{equation}
b_{1}=r\frac{s_{y}}{s_{x}},\label{eq:sample-correlation-formula}\end{equation}

\end_inset

where 
\begin_inset Formula $r$
\end_inset

, 
\begin_inset Formula $s_{y}$
\end_inset

, and 
\begin_inset Formula $s_{x}$
\end_inset

 are the sample correlation coefficient and the sample standard deviations
 of the 
\begin_inset Formula $Y$
\end_inset

 and 
\begin_inset Formula $x$
\end_inset

 data, respectively.
 See Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:show-alternate-slope-formula"

\end_inset

.
 Also, notice the similarity between Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:sample-correlation-formula"

\end_inset

 and Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:population-slope-slr"

\end_inset

.
\end_layout

\begin_layout Subsection*
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
Here we go.
 
\family sans
R
\family default
 will calculate the linear regression line with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lm
\end_layout

\end_inset


\color inherit
 function.
 We will store the result in an object which we will call 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars.lm
\end_layout

\end_inset


\color inherit
.
 Here is how it works:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

cars.lm <- lm(dist ~ speed, data = cars)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The first part of the input to the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lm
\end_layout

\end_inset


\color inherit
 function, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dist~speed
\end_layout

\end_inset

,
\color inherit
 is a 
\emph on
model formula
\emph default
, read as 
\begin_inset Quotes eld
\end_inset


\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dist
\end_layout

\end_inset


\color inherit
 is described by 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

speed
\end_layout

\end_inset


\color inherit

\begin_inset Quotes erd
\end_inset

.
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

data = cars
\end_layout

\end_inset


\color inherit
 argument tells 
\family sans
R
\family default
 where to look for the variables quoted in the model formula.
 The output object 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars.lm
\end_layout

\end_inset


\color inherit
 contains a multitude of information.
 Let's first take a look at the coefficients of the fitted regression line,
 which are extracted by the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

coef
\end_layout

\end_inset


\color inherit
 function
\begin_inset Foot
status open

\begin_layout Plain Layout
Alternatively, we could just type 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars.lm
\end_layout

\end_inset

 to see the same thing.
\end_layout

\end_inset

:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

coef(cars.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The parameter estimates 
\begin_inset Formula $b_{0}$
\end_inset

 and 
\begin_inset Formula $b_{1}$
\end_inset

 for the intercept and slope, respectively, are shown above.
 The regression line is thus given by 
\begin_inset Formula $\hat{\mu}(\mathtt{speed})=$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(coef(cars.lm)[1],2)}
\end_layout

\end_inset

 
\begin_inset Formula $+$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(coef(cars.lm)[2],2)}
\end_layout

\end_inset


\begin_inset Formula $\mathtt{speed}$
\end_inset

.
\end_layout

\begin_layout Standard
It is good practice to visually inspect the data with the regression line
 added to the plot.
 To do this we first scatterplot the original data and then follow with
 a call to the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

abline
\end_layout

\end_inset


\color inherit
 function.
 The inputs to 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

abline
\end_layout

\end_inset

 are the coefficients of 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars.lm
\end_layout

\end_inset

 (see Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Scatter-cars-regline"

\end_inset

):
\color inherit
 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

plot(dist ~ speed, data = cars, pch = 16)
\begin_inset Newline newline
\end_inset

abline(coef(cars.lm))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Scatterplot with added regression line for the 
\family typewriter
cars
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:Scatter-cars-regline"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

plot(dist ~ speed, data = cars, pch = 16)
\begin_inset Newline newline
\end_inset

abline(coef(cars))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
To calculate points on the regression line we may simply plug the desired
 
\begin_inset Formula $x$
\end_inset

 value(s) into 
\begin_inset Formula $\hat{\mu}$
\end_inset

, either by hand, or with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

predict
\end_layout

\end_inset


\color inherit
 function.
 The inputs to 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

predict
\end_layout

\end_inset


\color inherit
 are the fitted linear model object, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars.lm
\end_layout

\end_inset

,
\color inherit
 and the desired 
\begin_inset Formula $x$
\end_inset

 value(s) represented by a data frame.
 See the example below.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:regline-cars-interpret"

\end_inset

Using the regression line for the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars
\end_layout

\end_inset


\color inherit
 data:
\end_layout

\begin_deeper
\begin_layout Enumerate
What is the meaning of 
\begin_inset Formula $\mu(60)=\beta_{0}+\beta_{1}(8$
\end_inset

)? 
\end_layout

\begin_deeper
\begin_layout Standard
This represents the average stopping distance (in feet) for a car going
 8
\begin_inset space \thinspace{}
\end_inset

mph.
 
\end_layout

\end_deeper
\begin_layout Enumerate
Interpret the slope 
\begin_inset Formula $\beta_{1}$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Standard
The true slope 
\begin_inset Formula $\beta_{1}$
\end_inset

 represents the increase in average stopping distance for each mile per
 hour faster that the car drives.
 In this case, we estimate the car to take approximately 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(coef(cars.lm)[2],2)}
\end_layout

\end_inset

 additional feet to stop for each additional mph increase in speed.
\end_layout

\end_deeper
\begin_layout Enumerate
Interpret the intercept 
\begin_inset Formula $\beta_{0}$
\end_inset

.
 
\end_layout

\begin_deeper
\begin_layout Standard
This would represent the mean stopping distance for a car traveling 0
\begin_inset space \thinspace{}
\end_inset

mph (which our regression line estimates to be 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(coef(cars.lm)[1],2)}
\end_layout

\end_inset

).
 Of course, this interpretation does not make any sense for this example,
 because a car travelling 0
\begin_inset space \thinspace{}
\end_inset

mph takes 0
\color none

\begin_inset space \thinspace{}
\end_inset


\color inherit
ft to stop (it was not moving in the first place)! What went wrong? Looking
 at the data, we notice that the smallest speed for which we have measured
 data is 4
\begin_inset space \thinspace{}
\end_inset

mph.
 Therefore, if we predict what would happen for slower speeds then we would
 be 
\emph on
extrapolating
\emph default
, a dangerous practice which often gives nonsensical results.
\end_layout

\end_deeper
\end_deeper
\begin_layout Subsection
Point Estimates of the Regression Line
\begin_inset CommandInset label
LatexCommand label
name "sub:slr-point-est-regline"

\end_inset


\end_layout

\begin_layout Standard
We said at the beginning of the chapter that our goal was to estimate 
\begin_inset Formula $\mu=\E Y$
\end_inset

, and the arguments in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:point-estimate-mle-slr"

\end_inset

 showed how to obtain an estimate 
\begin_inset Formula $\hat{\mu}$
\end_inset

 of 
\begin_inset Formula $\mu$
\end_inset

 when the regression assumptions hold.
 Now we will reap the benefits of our work in more ways than we previously
 disclosed.
 Given a particular value 
\begin_inset Formula $x_{0}$
\end_inset

, there are two values we would like to estimate:
\end_layout

\begin_layout Enumerate
the mean value of 
\begin_inset Formula $Y$
\end_inset

 at 
\begin_inset Formula $x_{0}$
\end_inset

, and
\end_layout

\begin_layout Enumerate
a future value of 
\begin_inset Formula $Y$
\end_inset

 at 
\begin_inset Formula $x_{0}$
\end_inset

.
\end_layout

\begin_layout Standard
The first is a number, 
\begin_inset Formula $\mu(x_{0})$
\end_inset

, and the second is a random variable, 
\begin_inset Formula $Y(x_{0})$
\end_inset

, but our point estimate is the same for both: 
\begin_inset Formula $\hat{\mu}(x_{0})$
\end_inset

.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:regline-cars-pe-8mph"

\end_inset

We may use the regression line to obtain a point estimate of the mean stopping
 distance for a car traveling 8
\begin_inset space \thinspace{}
\end_inset

mph: 
\begin_inset Formula $\hat{\mu}(15)=b_{0}+8b_{1}\approx$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(coef(cars.lm)[1],2)}
\end_layout

\end_inset

 
\begin_inset Formula $+(8)$
\end_inset

 (
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(coef(cars.lm)[2],2)}
\end_layout

\end_inset

)
\begin_inset Formula $\approx13.88$
\end_inset

.
 We would also use 13.88 as a point estimate for the stopping distance of
 a future car traveling 8
\begin_inset space \thinspace{}
\end_inset

mph.
\end_layout

\begin_layout Standard
Note that we actually have observed data for a car traveling 8
\begin_inset space \thinspace{}
\end_inset

mph; its stopping distance was 16
\begin_inset space \thinspace{}
\end_inset

ft as listed in the fifth row of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars
\end_layout

\end_inset


\color inherit
 data:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

cars[5, ]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
There is a special name for estimates 
\begin_inset Formula $\hat{\mu}(x_{0})$
\end_inset

 when 
\begin_inset Formula $x_{0}$
\end_inset

 matches an observed value 
\begin_inset Formula $x_{i}$
\end_inset

 from the data set.
 They are called 
\emph on
fitted values
\emph default
, they are denoted by 
\begin_inset Formula $\hat{Y}_{1}$
\end_inset

, 
\begin_inset Formula $\hat{Y}_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $\hat{Y}_{n}$
\end_inset

 (ignoring repetition), and they play an important role in the sections
 that follow.
 
\end_layout

\begin_layout Standard
In an abuse of notation we will sometimes write 
\begin_inset Formula $\hat{Y}$
\end_inset

 or 
\begin_inset Formula $\hat{Y}(x_{0})$
\end_inset

 to denote a point on the regression line even when 
\begin_inset Formula $x_{0}$
\end_inset

 does not belong to the original data if the context of the statement obviates
 any danger of confusion.
\end_layout

\begin_layout Standard
We saw in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:regline-cars-interpret"

\end_inset

 that spooky things can happen when we are cavalier about point estimation.
 While it is usually acceptable to predict/estimate at values of 
\begin_inset Formula $x_{0}$
\end_inset

 that fall within the range of the original 
\begin_inset Formula $x$
\end_inset

 data, it is reckless to use 
\begin_inset Formula $\hat{\mu}$
\end_inset

 for point estimates at locations outside that range.
 Such estimates are usually worthless.
 
\emph on
Do not extrapolate
\emph default
 unless there are compelling external reasons, and even then, temper it
 with a good deal of caution.
\end_layout

\begin_layout Subsection*
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The fitted values are automatically computed as a byproduct of the model
 fitting procedure and are already stored as a component of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars.lm
\end_layout

\end_inset

 object.
 We may access them with the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

fitted
\end_layout

\end_inset

 function (we only show the first five entries):
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

fitted(cars.lm)[1:5]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Predictions at 
\begin_inset Formula $x$
\end_inset

 values that are not necessarily part of the original data are done with
 the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

predict
\end_layout

\end_inset

 function
\color inherit
.
 The first argument is the original 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars.lm
\end_layout

\end_inset

 object
\color inherit
 and the second argument 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

newdata
\end_layout

\end_inset


\color inherit
 accepts a dataframe (in the same form that was used to fit 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars.lm
\end_layout

\end_inset


\color inherit
) that contains the locations at which we are seeking predictions.
\end_layout

\begin_layout Standard
Let us predict the average stopping distances of cars traveling 6
\begin_inset space \thinspace{}
\end_inset

mph, 8
\begin_inset space \thinspace{}
\end_inset

mph, and 21
\begin_inset space \thinspace{}
\end_inset

mph:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

predict(cars.lm, newdata = data.frame(speed = c(6, 8, 21)))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Note that there were no observed cars that traveled 6
\begin_inset space \thinspace{}
\end_inset

mph or 21
\begin_inset space \thinspace{}
\end_inset

mph.
 Also note that our estimate for a car traveling 8
\begin_inset space \thinspace{}
\end_inset

mph matches the value we computed by hand in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:regline-cars-pe-8mph"

\end_inset

.
\end_layout

\begin_layout Subsection
Mean Square Error and Standard Error
\end_layout

\begin_layout Standard
To find the MLE of 
\begin_inset Formula $\sigma^{2}$
\end_inset

 we consider the partial derivative
\begin_inset Formula \begin{equation}
\frac{\partial}{\partial\sigma^{2}}\ln L=\frac{n}{2\sigma^{2}}-\frac{1}{2(\sigma^{2})^{2}}\sum_{i=1}^{n}(y_{i}-\beta_{0}-\beta_{1}x_{i})^{2},\end{equation}

\end_inset

and after plugging in 
\begin_inset Formula $\hat{\beta}_{0}$
\end_inset

 and 
\begin_inset Formula $\hat{\beta}_{1}$
\end_inset

 and setting equal to zero we get
\begin_inset Formula \begin{equation}
\hat{\sigma^{2}}=\frac{1}{n}\sum_{i=1}^{n}(y_{i}-\hat{\beta}_{0}-\hat{\beta}_{1}x_{i})^{2}=\frac{1}{n}\sum_{i=1}^{n}[y_{i}-\hat{\mu}(x_{i})]^{2}.\end{equation}

\end_inset

We write 
\begin_inset Formula $\hat{Yi}=\hat{\mu}(x_{i})$
\end_inset

, and we let 
\begin_inset Formula $E_{i}=Y_{i}-\hat{Y_{i}}$
\end_inset

 be the 
\begin_inset Formula $i^{\mathrm{th}}$
\end_inset

 
\emph on
residual
\emph default
.
 We see 
\begin_inset Formula \begin{equation}
n\hat{\sigma^{2}}=\sum_{i=1}^{n}E_{i}^{2}=SSE=\mbox{ the sum of squared errors.}\end{equation}

\end_inset

For a point estimate of 
\begin_inset Formula $\sigma^{2}$
\end_inset

 we use the 
\emph on
mean square error
\emph default
 
\begin_inset Formula $S^{2}$
\end_inset

 defined by 
\begin_inset Formula \begin{equation}
S^{2}=\frac{SSE}{n-2},\end{equation}

\end_inset

and we estimate 
\begin_inset Formula $\sigma$
\end_inset

 with the 
\emph on
standard error
\emph default
 
\begin_inset Formula $S=\sqrt{S^{2}}$
\end_inset

.
 
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
Be careful not to confuse the mean square error 
\begin_inset Formula $S^{2}$
\end_inset

 with the sample variance 
\begin_inset Formula $S^{2}$
\end_inset

 in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Describing-Data-Distributions"

\end_inset

.
 Other notation the reader may encounter is the lowercase 
\begin_inset Formula $s^{2}$
\end_inset

 or the bulky 
\begin_inset Formula $MSE$
\end_inset

.
\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The residuals for the model may be obtained with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

residuals
\end_layout

\end_inset

 function; we only show the first few entries in the interest of space:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

residuals(cars.lm)[1:5]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
In the last section, we calculated the fitted value for 
\begin_inset Formula $x=8$
\end_inset

 and found it to be approximately 
\begin_inset Formula $\hat{\mu}(8)\approx$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(predict(cars.lm, newdata = data.frame(speed = 8)), 2)}
\end_layout

\end_inset

.
 Now, it turns out that there was only one recorded observation at 
\begin_inset Formula $x=8$
\end_inset

, and we have seen this value in the output of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

head(cars)
\end_layout

\end_inset

 in Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Speed-and-Stopping"

\end_inset

; it was 
\begin_inset Formula $\mathtt{dist}=16$
\end_inset


\begin_inset space \thinspace{}
\end_inset

ft for a car with 
\begin_inset Formula $\mathtt{speed}=8$
\end_inset


\begin_inset space \thinspace{}
\end_inset

mph.
 Therefore, the residual should be 
\begin_inset Formula $E=Y-\hat{Y}$
\end_inset

 which is 
\begin_inset Formula $E\approx16-$
\end_inset


\color inherit

\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(predict(cars.lm, newdata = data.frame(speed = 8)), 2)}
\end_layout

\end_inset

.
 Now take a look at the last entry of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

residuals(cars.lm)
\end_layout

\end_inset

, above.
 It is not a coincidence.
\end_layout

\begin_layout Standard
The estimate 
\begin_inset Formula $S$
\end_inset

 for 
\begin_inset Formula $\sigma$
\end_inset

 is called the 
\color none

\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Residual standard error
\end_layout

\end_inset


\color inherit
 and for the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars
\end_layout

\end_inset

 data
\color inherit
 is shown a few lines up on the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary(cars.lm)
\end_layout

\end_inset


\color inherit
 output (see How to do it with 
\family sans
R
\family default
 in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:slr-interval-est-params"

\end_inset

).
 We may read it from there to be 
\begin_inset Formula $S\approx\,$
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(summary(cars.lm)$sigma, 2)}
\end_layout

\end_inset

, or we can access it directly from the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary
\end_layout

\end_inset


\color inherit
 object.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

carsumry <- summary(cars.lm)
\begin_inset Newline newline
\end_inset

carsumry$sigma
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Subsection
Interval Estimates of the Parameters
\begin_inset CommandInset label
LatexCommand label
name "sub:slr-interval-est-params"

\end_inset


\end_layout

\begin_layout Standard
We discussed general interval estimation in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Estimation"

\end_inset

.
 There we found that we could use what we know about the sampling distribution
 of certain statistics to construct confidence intervals for the parameter
 being estimated.
 We will continue in that vein, and to get started we will determine the
 sampling distributions of the parameter estimates, 
\begin_inset Formula $b_{1}$
\end_inset

 and 
\begin_inset Formula $b_{0}$
\end_inset

.
\end_layout

\begin_layout Standard
To that end, we can see from Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:regline-slope-formula"

\end_inset

 (and it is made clear in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:multiple-linear-regression"

\end_inset

) that 
\begin_inset Formula $b_{1}$
\end_inset

 is just a linear combination of normally distributed random variables,
 so 
\begin_inset Formula $b_{1}$
\end_inset

 is normally distributed too.
 Further, it can be shown that
\begin_inset Formula \begin{equation}
b_{1}\sim\mathsf{norm}\left(\mathtt{mean}=\beta_{1},\,\mathtt{sd}=\sigma_{b_{1}}\right)\end{equation}

\end_inset

 where 
\begin_inset Formula \begin{equation}
\sigma_{b_{1}}=\frac{\sigma}{\sqrt{\sum_{i=1}^{n}(x_{i}-\xbar)^{2}}}\end{equation}

\end_inset

is called 
\emph on
the standard error of
\emph default
 
\begin_inset Formula $b_{1}$
\end_inset

 which unfortunately depends on the unknown value of 
\begin_inset Formula $\sigma$
\end_inset

.
 We do not lose heart, though, because we can estimate 
\begin_inset Formula $\sigma$
\end_inset

 with the standard error 
\begin_inset Formula $S$
\end_inset

 from the last section.
 This gives us an estimate 
\begin_inset Formula $S_{b_{1}}$
\end_inset

 for 
\begin_inset Formula $\sigma_{b_{1}}$
\end_inset

 defined by
\begin_inset Formula \begin{equation}
S_{b_{1}}=\frac{S}{\sqrt{\sum_{i=1}^{n}(x_{i}-\xbar)^{2}}}.\end{equation}

\end_inset

Now, it turns out that 
\begin_inset Formula $b_{0}$
\end_inset

, 
\begin_inset Formula $b_{1}$
\end_inset

, and 
\begin_inset Formula $S$
\end_inset

 are mutually independent (see the footnote in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:mlr-interval-est-params"

\end_inset

).
 Therefore, the quantity
\begin_inset Formula \begin{equation}
T=\frac{b_{1}-\beta_{1}}{S_{b_{1}}}\end{equation}

\end_inset

has a 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=n-2)$
\end_inset

 distribution.
 Therefore, a 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence interval for 
\begin_inset Formula $\beta_{1}$
\end_inset

 is given by 
\begin_inset Formula \begin{equation}
b_{1}\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-1)\, S_{b_{1}}\end{equation}

\end_inset


\end_layout

\begin_layout Standard
It is also sometimes of interest to construct a confidence interval for
 
\begin_inset Formula $\beta_{0}$
\end_inset

 in which case we will need the sampling distribution of 
\begin_inset Formula $b_{0}$
\end_inset

.
 It is shown in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:multiple-linear-regression"

\end_inset

 that
\begin_inset Formula \begin{equation}
b_{0}\sim\mathsf{norm}\left(\mathtt{mean}=\beta_{0},\,\mathtt{sd}=\sigma_{b_{0}}\right),\end{equation}

\end_inset

where 
\begin_inset Formula $\sigma_{b_{0}}$
\end_inset

 is given by
\begin_inset Formula \begin{equation}
\sigma_{b_{0}}=\sigma\sqrt{\frac{1}{n}+\frac{\xbar^{2}}{\sum_{i=1}^{n}(x_{i}-\xbar)^{2}}},\end{equation}

\end_inset

and which we estimate with the 
\begin_inset Formula $S_{b_{0}}$
\end_inset

 defined by
\begin_inset Formula \begin{equation}
S_{b_{0}}=S\sqrt{\frac{1}{n}+\frac{\xbar^{2}}{\sum_{i=1}^{n}(x_{i}-\xbar)^{2}}}.\end{equation}

\end_inset

Thus the quantity
\begin_inset Formula \begin{equation}
T=\frac{b_{0}-\beta_{0}}{S_{b_{0}}}\end{equation}

\end_inset

has a 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=n-2)$
\end_inset

 distribution and a 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence interval for 
\begin_inset Formula $\beta_{0}$
\end_inset

 is given by
\begin_inset Formula \begin{equation}
b_{0}\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-1)\, S_{b_{0}}\end{equation}

\end_inset


\end_layout

\begin_layout Subsection*
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
Let us take a look at the output from 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary(cars.lm)
\end_layout

\end_inset


\color inherit
:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

summary(cars.lm)
\begin_inset Newline newline
\end_inset

@
\begin_inset Newline newline
\end_inset

<<echo = FALSE>>=
\begin_inset Newline newline
\end_inset

A <- round(summary(cars.lm)$coef, 3)
\begin_inset Newline newline
\end_inset

B <- round(confint(cars.lm), 3)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
In the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Coefficients
\end_layout

\end_inset


\color inherit
 section we find the parameter estimates and their respective standard errors
 in the second and third columns; the other columns are discussed in Section
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Model-Utility-SLR"

\end_inset

.
 If we wanted, say, a 95% confidence interval for 
\begin_inset Formula $\beta_{1}$
\end_inset

 we could use 
\begin_inset Formula $b_{1}=\ $
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{A[2,1]}
\end_layout

\end_inset

 and 
\begin_inset Formula $S_{b_{1}}=\ $
\end_inset


\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{A[2,2]}
\end_layout

\end_inset

 together with a 
\begin_inset Formula $\mathsf{t}_{0.025}(\mathtt{df}=23)$
\end_inset

 critical value to calculate 
\begin_inset Formula $b_{1}\pm\mathsf{t}_{0.025}(\mathtt{df}=23)S_{b_{1}}$
\end_inset

.
\end_layout

\begin_layout Standard
Or, we could use the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

confint
\end_layout

\end_inset


\color inherit
 function.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

confint(cars.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
With 95% confidence, the random interval [
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{B[2,1]}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{B[2,2]}
\end_layout

\end_inset

] covers the parameter 
\begin_inset Formula $\beta_{1}$
\end_inset

.
\end_layout

\begin_layout Subsection
Interval Estimates of the Regression Line
\begin_inset CommandInset label
LatexCommand label
name "sub:slr-interval-est-regline"

\end_inset


\end_layout

\begin_layout Standard
We have seen how to estimate the coefficients of regression line with both
 point estimates and confidence intervals.
 We even saw how to estimate a value 
\begin_inset Formula $\hat{\mu}(x)$
\end_inset

 on the regression line for a given value of 
\begin_inset Formula $x$
\end_inset

, such as 
\begin_inset Formula $x=15$
\end_inset

.
 
\end_layout

\begin_layout Standard
But how good is our estimate 
\begin_inset Formula $\hat{\mu}(15)$
\end_inset

? How much confidence do we have in 
\emph on
this
\emph default
 estimate? Furthermore, suppose we were going to observe another value of
 
\begin_inset Formula $Y$
\end_inset

 at 
\begin_inset Formula $x=15$
\end_inset

.
 What could we say?
\end_layout

\begin_layout Standard
Intuitively, it should be easier to get bounds on the mean (average) value
 of 
\begin_inset Formula $Y$
\end_inset

 at 
\begin_inset Formula $x_{0}$
\end_inset

 (called a 
\emph on
confidence interval for the mean value of 
\begin_inset Formula $Y$
\end_inset

 at 
\begin_inset Formula $x_{0}$
\end_inset


\emph default
) than it is to get bounds on a future observation of 
\begin_inset Formula $Y$
\end_inset

 (called a 
\emph on
prediction interval for 
\begin_inset Formula $Y$
\end_inset

 at 
\begin_inset Formula $x_{0}$
\end_inset


\emph default
).
 As we shall see, the intuition serves us well and confidence intervals
 are shorter for the mean value, longer for the individual value.
\end_layout

\begin_layout Standard
Our point estimate of 
\begin_inset Formula $\mu(x_{0})$
\end_inset

 is of course 
\begin_inset Formula $\hat{Y}=\hat{Y}(x_{0})$
\end_inset

, so for a confidence interval we will need to know 
\begin_inset Formula $\hat{Y}$
\end_inset

's sampling distribution.
 It turns out (see Section ) that 
\begin_inset Formula $\hat{Y}=\hat{\mu}(x_{0})$
\end_inset

 is distributed
\begin_inset Formula \begin{equation}
\hat{Y}\sim\mathsf{norm}\left(\mathtt{mean}=\mu(x_{0}),\:\mathtt{sd}=\sigma\sqrt{\frac{1}{n}+\frac{(x_{0}-\xbar)^{2}}{\sum_{i=1}^{n}(x_{i}-\xbar)^{2}}}\right).\end{equation}

\end_inset

Since 
\begin_inset Formula $\sigma$
\end_inset

 is unknown we estimate it with 
\begin_inset Formula $S$
\end_inset

 (we should expect the appearance of a 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=n-2)$
\end_inset

 distribution in the near future).
 
\end_layout

\begin_layout Standard
A 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 
\emph on
confidence interval (CI) for
\emph default
 
\begin_inset Formula $\mu(x_{0})$
\end_inset

 is given by
\begin_inset Formula \begin{equation}
\hat{Y}\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-2)\, S\sqrt{\frac{1}{n}+\frac{(x_{0}-\xbar^{2})}{\sum_{i=1}^{n}(x_{i}-\xbar)^{2}}}.\label{eq:SLR-conf-int-formula}\end{equation}

\end_inset


\end_layout

\begin_layout Standard
It is time for prediction intervals, which are slightly different.
 In order to find confidence bounds for a new observation of 
\begin_inset Formula $Y$
\end_inset

 (we will denote it 
\begin_inset Formula $Y_{\mbox{new}}$
\end_inset

) we use the fact that
\begin_inset Formula \begin{equation}
Y_{\mbox{new}}\sim\mathtt{norm}\left(\mathtt{mean}=\mu(x_{0}),\,\mathtt{sd}=\sigma\sqrt{1+\frac{1}{n}+\frac{(x_{0}-\xbar)^{2}}{\sum_{i=1}^{n}(x_{i}-\xbar)^{2}}}\right).\end{equation}

\end_inset

Of course 
\begin_inset Formula $\sigma$
\end_inset

 is unknown and we estimate it with 
\begin_inset Formula $S$
\end_inset

.
 Thus, a 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 prediction interval (PI) for a future value of 
\begin_inset Formula $Y$
\end_inset

 at 
\begin_inset Formula $x_{0}$
\end_inset

 is given by 
\begin_inset Formula \begin{equation}
\hat{Y}(x_{0})\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-1)\: S\,\sqrt{1+\frac{1}{n}+\frac{(x_{0}-\xbar)^{2}}{\sum_{i=1}^{n}(x_{i}-\xbar)^{2}}}.\label{eq:SLR-pred-int-formula}\end{equation}

\end_inset

We notice that the prediction interval in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:SLR-pred-int-formula"

\end_inset

 is wider than the confidence interval in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:SLR-conf-int-formula"

\end_inset

, as we expected at the beginning of the section.
\end_layout

\begin_layout Subsection*
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
Confidence and prediction intervals are calculated in 
\family sans
R
\family default
 with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

predict
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
predict
\end_layout

\end_inset


\color inherit
 function, which we encountered in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:slr-point-est-regline"

\end_inset

.
 There we neglected to take advantage of its additional 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

interval
\end_layout

\end_inset


\color inherit
 argument.
 The general syntax follows.
\end_layout

\begin_layout Example
We will find confidence and prediction intervals for the stopping distance
 of a car travelling 5, 6, and 21
\begin_inset space \thinspace{}
\end_inset

mph (note from the graph that there are no collected data for these speeds).
 We have computed 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars.lm
\end_layout

\end_inset


\color inherit
 earlier, and we will use this for input to the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

predict
\end_layout

\end_inset


\color inherit
 function.
 Also, we need to tell 
\family sans
R
\family default
 the values of 
\begin_inset Formula $x_{0}$
\end_inset

 at which we want the predictions made, and store the 
\begin_inset Formula $x_{0}$
\end_inset

 values in a data frame whose variable is labeled with the correct name.
 
\emph on
This is important
\emph default
.
 
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

new <- data.frame(speed = c(5, 6, 21))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Next we instruct 
\family sans
R
\family default
 to calculate the intervals.
 Confidence intervals are given by
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

predict(cars.lm, newdata = new, interval = "confidence")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<echo = FALSE, results = hide>>=
\begin_inset Newline newline
\end_inset

carsCI <- round(predict(cars.lm, newdata = new, interval = "confidence"),
 2)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Prediction intervals are given by
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

predict(cars.lm, newdata = new, interval = "prediction")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<echo = FALSE, results = hide>>=
\begin_inset Newline newline
\end_inset

carsPI <- round(predict(cars.lm, newdata = new, interval = "prediction"),
 2)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Standard
The type of interval is dictated by the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

interval
\end_layout

\end_inset


\color inherit
 argument (which is 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

\begin_inset Quotes eld
\end_inset

none
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset


\color inherit
 by default), and the default confidence level is 95% (which can be changed
 with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

level
\end_layout

\end_inset


\color inherit
 argument).
 
\end_layout

\begin_layout Example
Using the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars
\end_layout

\end_inset

 data,
\end_layout

\begin_deeper
\begin_layout Enumerate
Report a point estimate of and a 95% confidence interval for the mean stopping
 distance for a car travelling 5
\begin_inset space \thinspace{}
\end_inset

mph.
\end_layout

\begin_deeper
\begin_layout Standard
The fitted value for 
\begin_inset Formula $x=5$
\end_inset

 is 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{carsCI[1, 1]}
\end_layout

\end_inset

, so a point estimate would be 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{carsCI[1, 1]}
\end_layout

\end_inset


\begin_inset space \thinspace{}
\end_inset

ft.
 The 95% CI is given by [
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{carsCI[1, 2]}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{carsCI[1, 3]}
\end_layout

\end_inset

], so with 95% confidence the mean stopping distance lies somewhere between
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{carsCI[1, 2]}
\end_layout

\end_inset


\begin_inset space \thinspace{}
\end_inset

ft and 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{carsCI[1, 3]}
\end_layout

\end_inset


\begin_inset space \thinspace{}
\end_inset

ft.
\end_layout

\end_deeper
\begin_layout Enumerate
Report a point prediction for and a 95% prediction interval for the stopping
 distance of a hypothetical car travelling 21
\begin_inset space \thinspace{}
\end_inset

mph.
\end_layout

\begin_deeper
\begin_layout Standard
The fitted value for 
\begin_inset Formula $x=21$
\end_inset

 is 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{carsPI[3, 1]}
\end_layout

\end_inset

, so a point prediction for the stopping distance is 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{carsPI[3, 1]}
\end_layout

\end_inset


\begin_inset space \thinspace{}
\end_inset

ft.
 The 95% PI is given by [
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{carsPI[3, 2]}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{carsPI[3, 3]}
\end_layout

\end_inset

], so with 95% confidence we may assert that the hypothetical stopping distance
 for a car travelling 21
\begin_inset space \thinspace{}
\end_inset

mph would lie somewhere between 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{carsPI[3, 2]}
\end_layout

\end_inset


\begin_inset space \thinspace{}
\end_inset

ft and 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{carsPI[3, 3]}
\end_layout

\end_inset


\begin_inset space \thinspace{}
\end_inset

ft.
\end_layout

\end_deeper
\end_deeper
\begin_layout Subsection*
Graphing the Confidence and Prediction Bands
\end_layout

\begin_layout Standard
We earlier guessed that a bound on the value of a single new observation
 would be inherently less certain than a bound for an average (mean) value;
 therefore, we expect the CIs for the mean to be tighter than the PIs for
 a new observation.
 A close look at the standard deviations in Equations 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:SLR-conf-int-formula"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:SLR-pred-int-formula"

\end_inset

 confirms our guess, but we would like to see a picture to drive the point
 home.
\end_layout

\begin_layout Standard
We may plot the confidence and prediction intervals with one fell swoop
 using the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ci.plot
\end_layout

\end_inset


\color inherit
 function from the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

HH
\end_layout

\end_inset

 package 
\begin_inset CommandInset citation
LatexCommand cite
key "Heibergerhh"

\end_inset

.
 The gr
\color inherit
aph is displayed in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Scatter-cars-CIPI"

\end_inset

.
 
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

library(HH)
\begin_inset Newline newline
\end_inset

print(ci.plot(cars.lm))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Scatterplot with confidence/prediction bands for the 
\family typewriter
cars
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:Scatter-cars-CIPI"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

library(HH)
\begin_inset Newline newline
\end_inset

ci.plot(cars.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Notice that the bands curve outward away from the regression line as the
 
\begin_inset Formula $x$
\end_inset

 values move away from the center.
 This is expected once we notice the 
\begin_inset Formula $(x_{0}-\xbar)^{2}$
\end_inset

 term in the standard deviation formulas in Equations 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:SLR-conf-int-formula"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:SLR-pred-int-formula"

\end_inset

.
\end_layout

\begin_layout Section
Model Utility and Inference
\begin_inset CommandInset label
LatexCommand label
name "sec:Model-Utility-SLR"

\end_inset


\end_layout

\begin_layout Subsection
Hypothesis Tests for the Parameters
\begin_inset CommandInset label
LatexCommand label
name "sub:slr-hypoth-test-params"

\end_inset


\end_layout

\begin_layout Standard
Much of the attention of SLR is directed toward 
\begin_inset Formula $\beta_{1}$
\end_inset

 because when 
\begin_inset Formula $\beta_{1}\neq0$
\end_inset

 the mean value of 
\begin_inset Formula $Y$
\end_inset

 increases (or decreases) as 
\begin_inset Formula $x$
\end_inset

 increases.
 Further, if 
\begin_inset Formula $\beta_{1}=0$
\end_inset

 then the mean value of 
\begin_inset Formula $Y$
\end_inset

 remains the same, regardless of the value of 
\begin_inset Formula $x$
\end_inset

 (when the regression assumptions hold, of course).
 It is thus very important to decide whether or not 
\begin_inset Formula $\beta_{1}=0$
\end_inset

.
 We address the question with a statistical test of the null hypothesis
 
\begin_inset Formula $H_{0}:\beta_{1}=0$
\end_inset

 versus the alternative hypothesis 
\begin_inset Formula $H_{1}:\beta_{1}\neq0$
\end_inset

, and to do that we need to know the sampling distribution of 
\begin_inset Formula $b_{1}$
\end_inset

 when the null hypothesis is true.
\end_layout

\begin_layout Standard
To this end we already know from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:slr-interval-est-params"

\end_inset

 that the quantity
\begin_inset Formula \begin{equation}
T=\frac{b_{1}-\beta_{1}}{S_{b_{1}}}\end{equation}

\end_inset

has a 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=n-2)$
\end_inset

 distribution; therefore, when 
\begin_inset Formula $\beta_{1}=0$
\end_inset

 the quantity 
\begin_inset Formula $b_{1}/S_{b_{1}}$
\end_inset

 has a 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=n-2)$
\end_inset

 distribution and we can compute a 
\begin_inset Formula $p$
\end_inset

-value by comparing the observed value of 
\begin_inset Formula $b_{1}/S{}_{b_{1}}$
\end_inset

 with values under a 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=n-2)$
\end_inset

 curve.
 
\end_layout

\begin_layout Standard
Similarly, we may test the hypothesis 
\begin_inset Formula $H_{0}:\beta_{0}=0$
\end_inset

 versus the alternative 
\begin_inset Formula $H_{1}:\beta_{0}\neq0$
\end_inset

 with the statistic 
\begin_inset Formula $T=b_{0}/S_{b_{0}}$
\end_inset

, where 
\begin_inset Formula $S_{b_{0}}$
\end_inset

 is given in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:slr-interval-est-params"

\end_inset

.
 The test is conducted the same way as for 
\begin_inset Formula $\beta_{1}$
\end_inset

.
 
\end_layout

\begin_layout Subsection*
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
Let us take another look at the output from 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary(cars.lm)
\end_layout

\end_inset


\color inherit
:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

summary(cars.lm)
\begin_inset Newline newline
\end_inset

@
\begin_inset Newline newline
\end_inset

<<echo = FALSE>>=
\begin_inset Newline newline
\end_inset

A <- round(summary(cars.lm)$coef, 3)
\begin_inset Newline newline
\end_inset

B <- round(confint(cars.lm), 3)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
In the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Coefficients
\end_layout

\end_inset


\color inherit
 section we find the 
\begin_inset Formula $t$
\end_inset

 statistics and the 
\begin_inset Formula $p$
\end_inset

-values associated with the tests that the respective parameters are zero
 in the fourth and fifth columns.
 Since the 
\begin_inset Formula $p$
\end_inset

-values are (much) less than 0.05, we conclude that there is strong evidence
 that the parameters 
\begin_inset Formula $\beta_{1}\neq0$
\end_inset

 and 
\begin_inset Formula $\beta_{0}\neq0$
\end_inset

, and as such, we say that there is a statistically significant linear relations
hip between 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dist
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

speed
\end_layout

\end_inset


\color inherit
.
 
\end_layout

\begin_layout Subsection
Simple Coefficient of Determination
\end_layout

\begin_layout Standard
It would be nice to have a single number that indicates how well our linear
 regression model is doing, and the 
\emph on
simple coefficient of determination
\emph default
 is designed for that purpose.
 In what follows, we observe the values 
\begin_inset Formula $Y_{1}$
\end_inset

, 
\begin_inset Formula $Y_{2}$
\end_inset

, \SpecialChar \ldots{}
,
\begin_inset Formula $Y_{n}$
\end_inset

, and the goal is to estimate 
\begin_inset Formula $\mu(x_{0})$
\end_inset

, the mean value of 
\begin_inset Formula $Y$
\end_inset

 at the location 
\begin_inset Formula $x_{0}$
\end_inset

.
 
\end_layout

\begin_layout Standard
If we disregard the dependence of 
\begin_inset Formula $Y$
\end_inset

 and 
\begin_inset Formula $x$
\end_inset

 and base our estimate only on the 
\begin_inset Formula $Y$
\end_inset

 values then a reasonable choice for an estimator is just the MLE of 
\begin_inset Formula $\mu$
\end_inset

, which is 
\begin_inset Formula $\Ybar$
\end_inset

.
 Then the errors incurred by the estimate are just 
\begin_inset Formula $Y_{i}-\Ybar$
\end_inset

 and the variation about the estimate as measured by the sample variance
 is proportional to 
\begin_inset Formula \begin{equation}
SSTO=\sum_{i=1}^{n}(Y_{i}-\Ybar)^{2}.\end{equation}

\end_inset

Here, 
\begin_inset Formula $SSTO$
\end_inset

 is an acronym for the 
\emph on
total sum of squares
\emph default
.
\end_layout

\begin_layout Standard
But we do have additional information, namely, we have values 
\begin_inset Formula $x_{i}$
\end_inset

 associated with each value of 
\begin_inset Formula $Y_{i}$
\end_inset

.
 We have seen that this information leads us to the estimate 
\begin_inset Formula $\hat{Y_{i}}$
\end_inset

 and the errors incurred are just the residuals, 
\begin_inset Formula $E_{i}=Y_{i}-\hat{Y_{i}}$
\end_inset

.
 The variation associated with these errors can be measured with 
\begin_inset Formula \begin{equation}
SSE=\sum_{i=1}^{n}(Y_{i}-\hat{Y_{i}})^{2}.\end{equation}

\end_inset

We have seen the 
\begin_inset Formula $SSE$
\end_inset

 before, which stands for the 
\emph on
sum of squared errors
\emph default
 or 
\emph on
error sum of squares
\emph default
.
 Of course, we would expect the error to be less in the latter case, since
 we have used more information.
 The improvement in our estimation as a result of the linear regression
 model can be measured with the difference
\begin_inset Formula \[
(Y_{i}-\Ybar)-(Y_{i}-\hat{Y_{i}})=\hat{Y_{i}}-\Ybar,\]

\end_inset

and we measure the variation in these errors with
\begin_inset Formula \begin{equation}
SSR=\sum_{i=1}^{n}(\hat{Y_{i}}-\Ybar)^{2},\end{equation}

\end_inset

also known as the 
\emph on
regression sum of squares
\emph default
.
 It is not obvious, but some algebra proved a famous result known as the
 
\series bold
ANOVA Equality
\series default
:
\begin_inset Formula \begin{equation}
\sum_{i=1}^{n}(Y_{i}-\Ybar)^{2}=\sum_{i=1}^{n}(\hat{Y_{i}}-\Ybar)^{2}+\sum_{i=1}^{n}(Y_{i}-\hat{Y_{i}})^{2}\label{eq:anovaeq}\end{equation}

\end_inset

or in other words,
\begin_inset Formula \begin{equation}
SSTO=SSR+SSE.\end{equation}

\end_inset

This equality has a nice interpretation.
 Consider 
\begin_inset Formula $SSTO$
\end_inset

 to be the 
\emph on
total variation
\emph default
 of the errors.
 Think of a decomposition of the total variation into pieces: one piece
 measuring the reduction of error from using the linear regression model,
 or 
\emph on
explained variation
\emph default
 (
\begin_inset Formula $SSR$
\end_inset

), while the other represents what is left over, that is, the errors that
 the linear regression model doesn't explain, or 
\emph on
unexplained variation
\emph default
 (
\begin_inset Formula $SSE$
\end_inset

).
 In this way we see that the ANOVA equality merely partitions the variation
 into 
\begin_inset Formula \[
\mbox{total variation}=\mbox{explained variation}+\mbox{unexplained variation}.\]

\end_inset

For a single number to summarize how well our model is doing we use the
 simple coefficient of determination 
\begin_inset Formula $r^{2}$
\end_inset

, defined by
\begin_inset Formula \begin{equation}
r^{2}=1-\frac{SSE}{SSTO}.\end{equation}

\end_inset

We interpret 
\begin_inset Formula $r^{2}$
\end_inset

 as the proportion of total variation that is explained by the simple linear
 regression model.
 When 
\begin_inset Formula $r^{2}$
\end_inset

 is large, the model is doing a good job; when 
\begin_inset Formula $r^{2}$
\end_inset

 is small, the model is not doing a good job.
\end_layout

\begin_layout Standard
Related to the simple coefficient of determination is the sample correlation
 coefficient, 
\begin_inset Formula $r$
\end_inset

.
 As you can guess, the way we get 
\begin_inset Formula $r$
\end_inset

 is by the formula 
\begin_inset Formula $|r|=\sqrt{r^{2}}$
\end_inset

.
 But how do we get the sign? It is equal the sign of the slope estimate
 
\begin_inset Formula $b_{1}$
\end_inset

.
 That is, if the regression line 
\begin_inset Formula $\hat{\mu}(x)$
\end_inset

 has positive slope, then 
\begin_inset Formula $r=\sqrt{r^{2}}$
\end_inset

.
 Likewise, if the slope of 
\begin_inset Formula $\hat{\mu}(x)$
\end_inset

 is negative, then 
\begin_inset Formula $r=-\sqrt{r^{2}}$
\end_inset

.
\end_layout

\begin_layout Subsection*
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The primary method to display partitioned sums of squared errors is with
 an 
\emph on
ANOVA table
\emph default
.
 The command in 
\family sans
R
\family default
 to produce such a table is 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

anova
\end_layout

\end_inset


\color inherit
.
 The input to 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

anova
\end_layout

\end_inset


\color inherit
 is the result of an 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lm
\end_layout

\end_inset


\color inherit
 call which for the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars
\end_layout

\end_inset

 data is
\color inherit
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars.lm
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

anova(cars.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The output gives
\begin_inset Formula \[
r^{2}=1-\frac{SSE}{SSR+SSE}=1-\frac{11353.5}{21185.5+11353.5}\approx0.65.\]

\end_inset

 The interpretation should be: 
\begin_inset Quotes eld
\end_inset

The linear regression line accounts for approximately 65% of the variation
 of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dist
\end_layout

\end_inset

 as explained by 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

speed
\end_layout

\end_inset


\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
The value of 
\begin_inset Formula $r^{2}$
\end_inset

 is stored in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

r.squared
\end_layout

\end_inset


\color inherit
 component of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary(cars.lm)
\end_layout

\end_inset


\color inherit
, which we called 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

carsumry
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

carsumry$r.squared
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We already knew this.
 We saw it in the next to the last line of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary(cars.lm)
\end_layout

\end_inset


\color inherit
 output where it was called 
\begin_inset Quotes eld
\end_inset


\color none

\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Multiple R-squared
\end_layout

\end_inset


\begin_inset Quotes erd
\end_inset


\color inherit
.
 Listed right beside it is the 
\color none

\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Adjusted R-squared
\end_layout

\end_inset


\color inherit
 which we will discuss in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:multiple-linear-regression"

\end_inset

.
\end_layout

\begin_layout Standard
For the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars
\end_layout

\end_inset


\color inherit
 data, we find 
\begin_inset Formula $r$
\end_inset

 to be
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

sqrt(carsumry$r.squared)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We choose the principal square root because the slope of the regression
 line is positive.
\end_layout

\begin_layout Subsection
Overall 
\emph on
F
\emph default
 statistic
\begin_inset CommandInset label
LatexCommand label
name "sub:slr-overall-F-statistic"

\end_inset


\end_layout

\begin_layout Standard
There is another way to test the significance of the linear regression model.
 In SLR, the new way also tests the hypothesis 
\begin_inset Formula $H_{0}:\beta_{1}=0$
\end_inset

 versus 
\begin_inset Formula $H_{1}:\beta_{1}\neq0$
\end_inset

, but it is done with a new test statistic called the 
\emph on
overall
\emph default
 
\begin_inset Formula $F$
\end_inset

 
\emph on
statistic
\emph default
.
 It is defined by 
\begin_inset Formula \begin{equation}
F=\frac{SSR}{SSE/(n-2)}.\label{eq:slr-overall-F-statistic}\end{equation}

\end_inset

Under the regression assumptions and when 
\begin_inset Formula $H_{0}$
\end_inset

 is true, the 
\begin_inset Formula $F$
\end_inset

 statistic has an 
\begin_inset Formula $\mathtt{f}(\mathtt{df1}=1,\,\mathtt{df2}=n-2)$
\end_inset

 distribution.
 We reject 
\begin_inset Formula $H_{0}$
\end_inset

 when 
\begin_inset Formula $F$
\end_inset

 is large -- that is, when the explained variation is large relative to
 the unexplained variation.
\end_layout

\begin_layout Standard
All this being said, we have not yet gained much from the overall 
\begin_inset Formula $F$
\end_inset

 statistic because we already knew from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:slr-hypoth-test-params"

\end_inset

 how to test 
\begin_inset Formula $H_{0}:\beta_{1}=0$
\end_inset

\SpecialChar \ldots{}
 we use the Student's 
\begin_inset Formula $t$
\end_inset

 statistic.
 What is worse is that (in the simple linear regression model) it can be
 proved that the 
\begin_inset Formula $F$
\end_inset

 in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:slr-overall-F-statistic"

\end_inset

 is exactly the Student's 
\begin_inset Formula $t$
\end_inset

 statistic for 
\begin_inset Formula $\beta_{1}$
\end_inset

 squared,
\begin_inset Formula \begin{equation}
F=\left(\frac{b_{1}}{S_{b_{1}}}\right)^{2}.\end{equation}

\end_inset

So why bother to define the 
\begin_inset Formula $F$
\end_inset

 statistic? Why not just square the 
\begin_inset Formula $t$
\end_inset

 statistic and be done with it? The answer is that the 
\begin_inset Formula $F$
\end_inset

 statistic has a more complicated interpretation and plays a more important
 role in the multiple linear regression model which we will study in Chapter
 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:multiple-linear-regression"

\end_inset

.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:mlr-Overall-F-Test"

\end_inset

 for details.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The overall 
\begin_inset Formula $F$
\end_inset

 statistic and 
\begin_inset Formula $p$
\end_inset

-value are displayed in the bottom line of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary(cars.lm)
\end_layout

\end_inset


\color inherit
 output.
 It is also shown in the final columns of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

anova(cars.lm)
\end_layout

\end_inset


\color inherit
:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

anova(cars.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Here we see that the 
\begin_inset Formula $F$
\end_inset

 statistic is 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(carsumry$fstatistic, 2)}
\end_layout

\end_inset

 with a 
\begin_inset Formula $p$
\end_inset

-value very close to zero.
 The conclusion: there is very strong evidence that 
\begin_inset Formula $H_{0}:\beta_{1}=0$
\end_inset

 is false, that is, there is strong evidence that 
\begin_inset Formula $\beta_{1}\neq0$
\end_inset

.
 Moreover, we conclude that the regression relationship between 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dist
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

speed
\end_layout

\end_inset


\color inherit
 is significant.
\end_layout

\begin_layout Standard
Note that the value of the 
\begin_inset Formula $F$
\end_inset

 statistic is the same as the Student's 
\begin_inset Formula $t$
\end_inset

 statistic for 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

speed
\end_layout

\end_inset

 squared.
\end_layout

\begin_layout Section
Residual Analysis
\begin_inset CommandInset label
LatexCommand label
name "sec:Residual-Analysis-SLR"

\end_inset


\end_layout

\begin_layout Standard
We know from our model that 
\begin_inset Formula $Y=\mu(x)+\epsilon$
\end_inset

, or in other words, 
\begin_inset Formula $\epsilon=Y-\mu(x)$
\end_inset

.
 Further, we know that 
\begin_inset Formula $\epsilon\sim\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=\sigma)$
\end_inset

.
 We may estimate 
\begin_inset Formula $\epsilon_{i}$
\end_inset

 with the 
\emph on
residual
\emph default
 
\begin_inset Formula $E_{i}=Y_{i}-\hat{Y_{i}}$
\end_inset

, where 
\begin_inset Formula $\hat{Y_{i}}=\hat{\mu}(x_{i})$
\end_inset

.
 If the regression assumptions hold, then 
\begin_inset Formula $ $
\end_inset

the residuals should be normally distributed.
 We check this in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Normality-Assumption"

\end_inset

.
 Further, the residuals should have mean zero with constant variance 
\begin_inset Formula $\sigma^{2}$
\end_inset

, and we check this in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Constant-Variance-Assumption"

\end_inset

.
 Last, the residuals should be independent, and we check this in Section
 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Independence-Assumption"

\end_inset

.
\end_layout

\begin_layout Standard
In every case, we will begin by looking at residual plots -- that is, scatterplo
ts of the residuals 
\begin_inset Formula $E_{i}$
\end_inset

 versus index or predicted values 
\begin_inset Formula $\hat{Y_{i}}$
\end_inset

 -- and follow up with hypothesis tests.
\end_layout

\begin_layout Subsection
Normality Assumption
\begin_inset CommandInset label
LatexCommand label
name "sub:Normality-Assumption"

\end_inset


\end_layout

\begin_layout Standard
We can assess the normality of the residuals with graphical methods and
 hypothesis tests.
 To check graphically whether the residuals are normally distributed we
 may look at histograms or 
\emph on
q
\emph default
-
\emph on
q
\emph default
 plots.
 We first examine a histogram in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Normal-q-q-plot-cars"

\end_inset

.
 There we see that the distribution of the residuals appears to be mound
 shaped, for the most part.
 We can plot the order statistics of the sample versus quantiles from a
 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=1)$
\end_inset

 distribution with the command 
\color none

\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

plot(cars.lm, which = 2)
\end_layout

\end_inset

, and the results are in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Normal-q-q-plot-cars"

\end_inset

.
 If the assumption of normality were true, then we would expect points randomly
 scattered about the dotted straight line displayed in the figure.
 In this case, we see a slight departure from normality in that the dots
 show systematic clustering on one side or the other of the line.
 The points on the upper end of the plot also appear begin to stray from
 the line.
 We would say there is some evidence that the residuals are not perfectly
 normal.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

plot(cars.lm, which = 2)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Normal q-q plot of the residuals for the 
\family typewriter
cars
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:Normal-q-q-plot-cars"

\end_inset


\end_layout

\end_inset

 
\size small
Used for checking the normality assumption.
 Look out for any curvature or substantial departures from the straight
 line; hopefully the dots hug the line closely.
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Testing the Normality Assumption
\end_layout

\begin_layout Standard
Even though we may be concerned about the plots, we can use tests to determine
 if the evidence present is statistically significant, or if it could have
 happened merely by chance.
 There are many statistical tests of normality.
 We will use the Shapiro-Wilk test, since it is known to be a good test
 and to be quite powerful.
 However, there are many other fine tests of normality including the Anderson-Da
rling test and the Lillefors test, just to mention two of them.
 
\end_layout

\begin_layout Standard
The Shapiro-Wilk test is based on the statistic
\begin_inset Formula \begin{equation}
W=\frac{\left(\sum_{i=1}^{n}a_{i}E_{(i)}\right)^{2}}{\sum_{j=1}^{n}E_{j}^{2}},\end{equation}

\end_inset

where the 
\begin_inset Formula $E_{(i)}$
\end_inset

 are the ordered residuals and the 
\begin_inset Formula $a_{i}$
\end_inset

 are constants derived from the order statistics of a sample of size 
\begin_inset Formula $n$
\end_inset

 from a normal distribution.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Shapiro-Wilk-Normality-Test"

\end_inset

.
\end_layout

\begin_layout Standard
We perform the Shapiro-Wilk test below, using the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

shapiro.test
\end_layout

\end_inset


\color inherit
 function from the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

stats
\end_layout

\end_inset


\color inherit
 package.
 The hypotheses are
\begin_inset Formula \[
H_{0}:\mbox{ the residuals are normally distributed }\]

\end_inset

versus
\begin_inset Formula \[
H_{1}:\mbox{ the residuals are not normally distributed.}\]

\end_inset

The results from 
\family sans
R
\family default
 are
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

shapiro.test(residuals(cars.lm))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
For these data we would reject the assumption of normality of the residuals
 at the 
\begin_inset Formula $\alpha=0.05$
\end_inset

 significance level, but do not lose heart, because the regression model
 is reasonably robust to departures from the normality assumption.
 As long as the residual distribution is not highly skewed, then the regression
 estimators will perform reasonably well.
 Moreover, departures from constant variance and independence will sometimes
 affect the quantile plots and histograms, therefore it is wise to delay
 final decisions regarding normality until all diagnostic measures have
 been investigated.
\end_layout

\begin_layout Subsection
Constant Variance Assumption
\begin_inset CommandInset label
LatexCommand label
name "sub:Constant-Variance-Assumption"

\end_inset


\end_layout

\begin_layout Standard
We will again go to residual plots to try and determine if the spread of
 the residuals is changing over time (or index).
 However, it is unfortunately not that easy because the residuals do not
 have constant variance! In fact, it can be shown that the variance of the
 residual 
\begin_inset Formula $E_{i}$
\end_inset

 is 
\begin_inset Formula \begin{equation}
\mbox{Var\ensuremath{(E_{i})}}=\sigma^{2}(1-h_{ii}),\quad i=1,2,\ldots,n,\end{equation}

\end_inset

where 
\begin_inset Formula $h_{ii}$
\end_inset

 is a quantity called the 
\emph on
leverage
\emph default
 which is defined below.
 Consequently, in order to check the constant variance assumption we must
 standardize the residuals before plotting.
 We estimate the standard error of 
\begin_inset Formula $E_{i}$
\end_inset

 with 
\begin_inset Formula $s_{E_{i}}=s\sqrt{(1-h_{ii})}$
\end_inset

 and define the 
\emph on
standardized residuals
\emph default
 
\begin_inset Formula $R_{i}$
\end_inset

, 
\begin_inset Formula $i=1,2,\ldots,n$
\end_inset

, by 
\begin_inset Formula \begin{equation}
R_{i}=\frac{E_{i}}{s\,\sqrt{1-h_{ii}}},\quad i=1,2,\ldots,n.\end{equation}

\end_inset


\end_layout

\begin_layout Standard
For the constant variance assumption we do not need the sign of the residual
 so we will plot 
\begin_inset Formula $\sqrt{|R_{i}|}$
\end_inset

 versus the fitted values.
 As we look at a scatterplot of 
\begin_inset Formula $\sqrt{|R_{i}|}$
\end_inset

 versus 
\begin_inset Formula $\hat{Y}_{i}$
\end_inset

 we would expect under the regression assumptions to see a constant band
 of observations, indicating no change in the magnitude of the observed
 distance from the line.
 We want to watch out for a fanning-out of the residuals, or a less common
 funneling-in of the residuals.
 Both patterns indicate a change in the residual variance and a consequent
 departure from the regression assumptions, the first an increase, the second
 a decrease.
\end_layout

\begin_layout Standard
In this case, we plot the standardized residuals versus the fitted values.
 The graph may be seen in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:std-resids-fitted-cars"

\end_inset

.
 For these data there does appear to be somewhat of a slight fanning-out
 of the residuals.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

plot(cars.lm, which = 3)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Plot of standardized residuals against the fitted values for the 
\family typewriter
cars
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:std-resids-fitted-cars"

\end_inset


\end_layout

\end_inset

 
\size small
Used for checking the constant variance assumption.
 Watch out for any fanning out (or in) of the dots; hopefully they fall
 in a constant band.
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Testing the Constant Variance Assumption
\end_layout

\begin_layout Standard
We will use the Breusch-Pagan test to decide whether the variance of the
 residuals is nonconstant.
 The null hypothesis is that the variance is the same for all observations,
 and the alternative hypothesis is that the variance is not the same for
 all observations.
 The test statistic is found by fitting a linear model to the centered squared
 residuals
\begin_inset Formula \begin{equation}
W_{i}=E_{i}^{2}-\frac{SSE}{n},\quad i=1,2,\ldots,n.\end{equation}

\end_inset

By default the same explanatory variables are used in the new model which
 produces fitted values 
\begin_inset Formula $\hat{W}_{i}$
\end_inset

, 
\begin_inset Formula $i=1,2,\ldots,n$
\end_inset

.
 The Breusch-Pagan test statistic in 
\family sans
R
\family default
 is then calculated with 
\begin_inset Formula \begin{equation}
BP=n\sum_{i=1}^{n}\hat{W}_{i}^{2}\div\sum_{i=1}^{n}W_{i}^{2}.\end{equation}

\end_inset

We reject the null hypothesis if 
\begin_inset Formula $BP$
\end_inset

 is too large, which happens when the explained variation in the new model
 is large relative to the unexplained variation in the original model.
\end_layout

\begin_layout Standard
We do it in 
\family sans
R
\family default
 with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

bptest
\end_layout

\end_inset


\color inherit
 function from the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lmtest
\end_layout

\end_inset


\color inherit
 package 
\begin_inset CommandInset citation
LatexCommand cite
key "Zeileislmtest"

\end_inset

.
 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(lmtest)
\begin_inset Newline newline
\end_inset

bptest(cars.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
For these data we would not reject the null hypothesis at the 
\begin_inset Formula $\alpha=0.05$
\end_inset

 level.
 There is relatively weak evidence against the assumption of constant variance.
 
\end_layout

\begin_layout Subsection
Independence Assumption
\begin_inset CommandInset label
LatexCommand label
name "sub:Independence-Assumption"

\end_inset


\end_layout

\begin_layout Standard
One of the strongest of the regression assumptions is the one regarding
 independence.
 Departures from the independence assumption are often exhibited by correlation
 (or autocorrelation, literally, self-correlation) present in the residuals.
 There can be positive or negative correlation.
\end_layout

\begin_layout Standard
Positive correlation is displayed by positive residuals followed by positive
 residuals, and negative residuals followed by negative residuals.
 Looking from left to right, this is exhibited by a cyclical feature in
 the residual plots, with long sequences of positive residuals being followed
 by long sequences of negative ones.
\end_layout

\begin_layout Standard
On the other hand, negative correlation implies positive residuals followed
 by negative residuals, which are then followed by positive residuals, 
\emph on
etc
\emph default
.
 Consequently, negatively correlated residuals are often associated with
 an alternating pattern in the residual plots.
 We examine the residual plot in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:resids-fitted-cars"

\end_inset

.
 There is no obvious cyclical wave pattern or structure to the residual
 plot.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

plot(cars.lm, which = 1)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Plot of the residuals versus the fitted values for the 
\family typewriter
cars
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:resids-fitted-cars"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\size small
Used for checking the independence assumption.
 Watch out for any patterns or structure; hopefully the points are randomly
 scattered on the plot.
\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Testing the Independence Assumption
\end_layout

\begin_layout Standard
We may statistically test whether there is evidence of autocorrelation in
 the residuals with the Durbin-Watson test.
 The test is based on the statistic
\begin_inset Formula \begin{equation}
D=\frac{\sum_{i=2}^{n}(E_{i}-E_{i-1})^{2}}{\sum_{j=1}^{n}E_{j}^{2}}.\end{equation}

\end_inset

Exact critical values are difficult to obtain, but 
\family sans
R
\family default
 will calculate the 
\emph on
p-
\emph default
value to great accuracy.
 It is performed with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dwtest
\end_layout

\end_inset


\color inherit
 function from the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lmtest
\end_layout

\end_inset


\color inherit
 package.
 We will conduct a two sided test that the correlation is not zero, which
 is not the default (the default is to test that the autocorrelation is
 positive).
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(lmtest)
\begin_inset Newline newline
\end_inset

dwtest(cars.lm, alternative = "two.sided")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
In this case we do not reject the null hypothesis at the 
\begin_inset Formula $\alpha=0.05$
\end_inset

 significance level; there is very little evidence of nonzero autocorrelation
 in the residuals.
\end_layout

\begin_layout Subsection
Remedial Measures
\end_layout

\begin_layout Standard
We often find problems with our model that suggest that at least one of
 the three regression assumptions is violated.
 What do we do then? There are many measures at the statistician's disposal,
 and we mention specific steps one can take to improve the model under certain
 types of violation.
\end_layout

\begin_layout Description
Mean
\begin_inset space ~
\end_inset

response
\begin_inset space ~
\end_inset

is
\begin_inset space ~
\end_inset

not
\begin_inset space ~
\end_inset

linear.
 We can directly modify the model to better approximate the mean response.
 In particular, perhaps a polynomial regression function of the form 
\begin_inset Formula \[
\mu(x)=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{1}^{2}\]

\end_inset

would be appropriate.
 Alternatively, we could have a function of the form
\begin_inset Formula \[
\mu(x)=\beta_{0}\me^{\beta_{1}x}.\]

\end_inset

Models like these are studied in nonlinear regression courses.
\end_layout

\begin_layout Description
Error
\begin_inset space ~
\end_inset

variance
\begin_inset space ~
\end_inset

is
\begin_inset space ~
\end_inset

not
\begin_inset space ~
\end_inset

constant.
 Sometimes a transformation of the dependent variable will take care of
 the problem.
 There is a large class of them called 
\emph on
Box-Cox transformations
\emph default
.
 They take the form 
\begin_inset Formula \begin{equation}
Y^{\ast}=Y^{\lambda},\end{equation}

\end_inset

 where 
\begin_inset Formula $\lambda$
\end_inset

 is a constant.
 (The method proposed by Box and Cox will determine a suitable value of
 
\begin_inset Formula $\lambda$
\end_inset

 automatically by maximum likelihood).
 The class contains the transformations 
\begin_inset Formula \begin{alignat*}{1}
\lambda=2,\quad & Y^{\ast}=Y^{2}\\
\lambda=0.5,\quad & Y^{\ast}=\sqrt{Y}\\
\lambda=0,\quad & Y^{\ast}=\ln\: Y\\
\lambda=-1,\quad & Y^{\ast}=1/Y\end{alignat*}

\end_inset

Alternatively, we can use the method of 
\emph on
weighted least squares
\emph default
.
 This is studied in more detail in later classes.
 
\end_layout

\begin_layout Description
Error
\begin_inset space ~
\end_inset

distribution
\begin_inset space ~
\end_inset

is
\begin_inset space ~
\end_inset

not
\begin_inset space ~
\end_inset

normal.
 The same transformations for stabilizing the variance are equally appropriate
 for smoothing the residuals to a more Gaussian form.
 In fact, often we will kill two birds with one stone.
\end_layout

\begin_layout Description
Errors
\begin_inset space ~
\end_inset

are
\begin_inset space ~
\end_inset

not
\begin_inset space ~
\end_inset

independent.
 There is a large class of autoregressive models to be used in this situation
 which occupy the latter part of Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Time-Series"

\end_inset

.
\end_layout

\begin_layout Section
Other Diagnostic Tools
\begin_inset CommandInset label
LatexCommand label
name "sec:Other-Diagnostic-Tools-SLR"

\end_inset


\end_layout

\begin_layout Standard
There are two types of observations with which we must be especially careful:
\end_layout

\begin_layout Description

\emph on
Influential
\begin_inset space ~
\end_inset

observations
\emph default
 are those that have a substantial effect on our estimates, predictions,
 or inferences.
 A small change in an influential observation is followed by a large change
 in the parameter estimates or inferences.
 
\end_layout

\begin_layout Description

\emph on
Outlying
\begin_inset space ~
\end_inset

observations
\emph default
 are those that fall fall far from the rest of the data.
 They may be indicating a lack of fit for our regression model, or they
 may just be a mistake or typographical error that should be corrected.
 Regardless, special attention should be given to these observations.
 An outlying observation may or may not be influential.
\end_layout

\begin_layout Standard
We will discuss outliers first because the notation builds sequentially
 in that order.
\end_layout

\begin_layout Subsection
Outliers
\end_layout

\begin_layout Standard
There are three ways that an observation 
\begin_inset Formula $(x_{i},y_{i})$
\end_inset

 may be an outlier: it can have an 
\begin_inset Formula $x_{i}$
\end_inset

 value which falls far from the other 
\begin_inset Formula $x$
\end_inset

 values, it can have a 
\begin_inset Formula $y_{i}$
\end_inset

 value which falls far from the other 
\begin_inset Formula $y$
\end_inset

 values, or it can have both its 
\begin_inset Formula $x_{i}$
\end_inset

 and 
\begin_inset Formula $y_{i}$
\end_inset

 values falling far from the other 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 values.
\end_layout

\begin_layout Subsection*
Leverage
\end_layout

\begin_layout Standard
Leverage statistics are designed to identify observations which have 
\begin_inset Formula $x$
\end_inset

 values that are far away from the rest of the data.
 In the simple linear regression model the leverage of 
\begin_inset Formula $x_{i}$
\end_inset

 is denoted by 
\begin_inset Formula $h_{ii}$
\end_inset

 and defined by 
\begin_inset Formula \begin{equation}
h_{ii}=\frac{1}{n}+\frac{(x_{i}-\xbar)^{2}}{\sum_{k=1}^{n}(x_{k}-\xbar)^{2}},\quad i=1,2,\ldots,n.\end{equation}

\end_inset

The formula has a nice interpretation in the SLR model: if the distance
 from 
\begin_inset Formula $x_{i}$
\end_inset

 to 
\begin_inset Formula $\xbar$
\end_inset

 is large relative to the other 
\begin_inset Formula $x$
\end_inset

's then 
\begin_inset Formula $h_{ii}$
\end_inset

 will be close to 1.
 
\end_layout

\begin_layout Standard
Leverages have nice mathematical properties; for example, they satisfy
\begin_inset Formula \begin{equation}
0\leq h_{ii}\leq1,\label{eq:slr-leverage-between}\end{equation}

\end_inset

and their sum is 
\begin_inset Formula \begin{eqnarray}
\sum_{i=1}^{n}h_{ii} & = & \sum_{i=1}^{n}\left[\frac{1}{n}+\frac{(x_{i}-\xbar)^{2}}{\sum_{k=1}^{n}(x_{k}-\xbar)^{2}}\right],\\
 & = & \frac{n}{n}+\frac{\sum_{i}(x_{i}-\xbar)^{2}}{\sum_{k}(x_{k}-\xbar)^{2}},\\
 & = & 2.\label{eq:slr-average-leverage}\end{eqnarray}

\end_inset

A rule of thumb is to consider leverage values to be large if they are more
 than double their average size (which is 
\begin_inset Formula $2/n$
\end_inset

 according to Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:slr-average-leverage"

\end_inset

).
 So leverages larger than 
\begin_inset Formula $4/n$
\end_inset

 are suspect.
 Another rule of thumb is to say that values bigger than 0.5 indicate high
 leverage, while values between 0.3 and 0.5 indicate moderate leverage.
\end_layout

\begin_layout Subsection*
Standardized and Studentized Deleted Residuals 
\end_layout

\begin_layout Standard
We have already encountered the 
\emph on
standardized residuals
\emph default
 
\begin_inset Formula $r_{i}$
\end_inset

 in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Constant-Variance-Assumption"

\end_inset

; they are merely residuals that have been divided by their respective standard
 deviations: 
\begin_inset Formula \begin{equation}
R_{i}=\frac{E_{i}}{S\sqrt{1-h_{ii}}},\quad i=1,2,\ldots,n.\end{equation}

\end_inset

Values of 
\begin_inset Formula $|R_{i}|>2$
\end_inset

 are extreme and suggest that the observation has an outlying 
\begin_inset Formula $y$
\end_inset

-value.
 
\end_layout

\begin_layout Standard
Now delete the 
\begin_inset Formula $i$
\end_inset


\begin_inset Formula $^{\textrm{th}}$
\end_inset

 case and fit the regression function to the remaining 
\begin_inset Formula $n-1$
\end_inset

 cases, producing a fitted value 
\begin_inset Formula $\hat{Y}_{(i)}$
\end_inset

 with 
\emph on
deleted residual
\emph default
 
\begin_inset Formula $D_{i}=Y_{i}-\hat{Y}_{(i)}$
\end_inset

.
 It is shown in later classes that 
\begin_inset Formula \begin{equation}
\mbox{Var\ensuremath{(D_{i})}}=\frac{S_{(i)}^{2}}{1-h_{ii}},\quad i=1,2,\ldots,n,\end{equation}

\end_inset

so that the 
\emph on
studentized deleted residuals
\emph default
 
\begin_inset Formula $t_{i}$
\end_inset

 defined by
\begin_inset Formula \begin{equation}
t_{i}=\frac{D_{i}}{S_{(i)}/(1-h_{ii})},\quad i=1,2,\ldots,n,\label{eq:slr-studentized-deleted-resids}\end{equation}

\end_inset

have a 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=n-3)$
\end_inset

 distribution and we compare observed values of 
\begin_inset Formula $t_{i}$
\end_inset

 to this distribution to decide whether or not an observation is extreme.
 
\end_layout

\begin_layout Standard
The folklore in regression classes is that a test based on the statistic
 in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:slr-studentized-deleted-resids"

\end_inset

 can be too liberal.
 A rule of thumb is if we suspect an observation to be an outlier 
\emph on
before
\emph default
 seeing the data then we say it is significantly outlying if its two-tailed
 
\begin_inset Formula $p$
\end_inset

-value is less than 
\begin_inset Formula $\alpha$
\end_inset

, but if we suspect an observation to be an outlier 
\emph on
after
\emph default
 seeing the data then we should only say it is significantly outlying if
 its two-tailed 
\begin_inset Formula $p$
\end_inset

-value is less than 
\begin_inset Formula $\alpha/n$
\end_inset

.
 The latter rule of thumb is called the 
\emph on
Bonferroni approach
\emph default
 and can be overly conservative for large data sets.
 The responsible statistician should look at the data and use his/her best
 judgement, in every case.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
We can calculate the standardized residuals with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rstandard
\end_layout

\end_inset


\color inherit
 function.
 The input is the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lm
\end_layout

\end_inset


\color inherit
 object, which is 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars.lm
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

sres <- rstandard(cars.lm)
\begin_inset Newline newline
\end_inset

sres[1:5]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Verse
We can find out which observations have studentized residuals larger than
 two with the command
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

sres[which(abs(sres) > 2)]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
In this case, we see that observations 23, 35, and 49 are potential outliers
 with respect to their 
\begin_inset Formula $y$
\end_inset

-value.
\end_layout

\begin_layout Standard
We can compute the studentized deleted residuals with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rstudent
\end_layout

\end_inset


\color inherit
:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

sdelres <- rstudent(cars.lm)
\begin_inset Newline newline
\end_inset

sdelres[1:5]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We should compare these values with critical values from a 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=n-3)$
\end_inset

 distribution, which in this case is 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=50-3=47)$
\end_inset

.
 We can calculate a 0.005 quantile and check with
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

t0.005 <- qt(0.005, df = 47, lower.tail = FALSE)
\begin_inset Newline newline
\end_inset

sdelres[which(abs(sdelres) > t0.005)]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
This means that observations 23 and 49 have a large studentized deleted
 residual.
 The leverages can be found with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

hatvalues
\end_layout

\end_inset


\color inherit
 function:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

leverage <- hatvalues(cars.lm)
\begin_inset Newline newline
\end_inset

leverage[1:5]
\begin_inset Newline newline
\end_inset

leverage[which(leverage > 4/50)]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Here we see that observations 1, 2, and 50 have leverages bigger than double
 their mean value.
 These observations would be considered outlying with respect to their 
\begin_inset Formula $x$
\end_inset

 value (although they may or may not be influential).
\end_layout

\begin_layout Subsection
Influential Observations
\end_layout

\begin_layout Subsection*
\begin_inset Formula $DFBETAS$
\end_inset

 and 
\begin_inset Formula $DFFITS$
\end_inset


\end_layout

\begin_layout Standard
Anytime we do a statistical analysis, we are confronted with the variability
 of data.
 It is always a concern when an observation plays too large a role in our
 regression model, and we would not like or procedures to be overly influenced
 by the value of a single observation.
 Hence, it becomes desirable to check to see how much our estimates and
 predictions would change if one of the observations were not included in
 the analysis.
 If an observation changes the estimates/predictions a large amount, then
 the observation is influential and should be subjected to a higher level
 of scrutiny.
\end_layout

\begin_layout Standard
We measure the change in the parameter estimates as a result of deleting
 an observation with 
\begin_inset Formula $DFBETAS$
\end_inset

.
 The 
\begin_inset Formula $DFBETAS$
\end_inset

 for the intercept 
\begin_inset Formula $b_{0}$
\end_inset

 are given by
\begin_inset Formula \begin{equation}
(DFBETAS)_{0(i)}=\frac{b_{0}-b_{0(i)}}{S_{(i)}\sqrt{\frac{1}{n}+\frac{\xbar^{2}}{\sum_{i=1}^{n}(x_{i}-\xbar)^{2}}}},\quad i=1,2,\ldots,n.\end{equation}

\end_inset

and the 
\begin_inset Formula $DFBETAS$
\end_inset

 for the slope 
\begin_inset Formula $b_{1}$
\end_inset

 are given by
\begin_inset Formula \begin{equation}
(DFBETAS)_{1(i)}=\frac{b_{1}-b_{1(i)}}{S_{(i)}\left[\sum_{i=1}^{n}(x_{i}-\xbar)^{2}\right]^{-1/2}},\quad i=1,2,\ldots,n.\end{equation}

\end_inset

See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Residual-Analysis-MLR"

\end_inset

 for a better way to write these.
 The signs of the 
\begin_inset Formula $DFBETAS$
\end_inset

 indicate whether the coefficients would increase or decrease as a result
 of including the observation.
 If the 
\begin_inset Formula $DFBETAS$
\end_inset

 are large, then the observation has a large impact on those regression
 coefficients.
 We label observations as suspicious if their 
\begin_inset Formula $DFBETAS$
\end_inset

 have magnitude greater 1 for small data or 
\begin_inset Formula $2/\sqrt{n}$
\end_inset

 for large data sets.
\end_layout

\begin_layout Standard
We can calculate the 
\begin_inset Formula $DFBETAS$
\end_inset

 with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dfbetas
\end_layout

\end_inset


\color inherit
 function (some output has been omitted):
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

dfb <- dfbetas(cars.lm)
\begin_inset Newline newline
\end_inset

head(dfb)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We see that the inclusion of the first observation slightly increases the
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Intercept
\end_layout

\end_inset


\color inherit
 and slightly decreases the coefficient on 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

speed
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Standard
We can measure the influence that an observation has on its fitted value
 with 
\begin_inset Formula $DFFITS$
\end_inset

.
 These are calculated by deleting an observation, refitting the model, recalcula
ting the fit, then standardizing.
 The formula is 
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
(DFFITS)_{i}=\frac{\hat{Y_{i}}-\hat{Y}_{(i)}}{S_{(i)}\sqrt{h_{ii}}},\quad i=1,2,\ldots,n.\end{equation}

\end_inset

The value represents the number of standard deviations of 
\begin_inset Formula $\hat{Y_{i}}$
\end_inset

 that the fitted value 
\begin_inset Formula $\hat{Y_{i}}$
\end_inset

 increases or decreases with the inclusion of the 
\begin_inset Formula $i$
\end_inset


\begin_inset Formula $^{\textrm{th}}$
\end_inset

 observation.
 We can compute them with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dffits
\end_layout

\end_inset


\color inherit
 function.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

dff <- dffits(cars.lm)
\begin_inset Newline newline
\end_inset

dff[1:5]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
A rule of thumb is to flag observations whose 
\begin_inset Formula $DFFIT$
\end_inset

 exceeds one in absolute value, but there are none of those in this data
 set.
\end_layout

\begin_layout Subsection*
Cook's Distance
\end_layout

\begin_layout Standard
The 
\begin_inset Formula $DFFITS$
\end_inset

 are good for measuring the influence on a single fitted value, but we may
 want to measure the influence an observation has on all of the fitted values
 simultaneously.
 The statistics used for measuring this are Cook's distances which may be
 calculated
\begin_inset Foot
status open

\begin_layout Plain Layout
Cook's distances are actually defined by a different formula than the one
 shown.
 The formula in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:slr-cooks-distance"

\end_inset

 is algebraically equivalent to the defining formula and is, in the author's
 opinion, more transparent.
\end_layout

\end_inset

 by the formula
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
D_{i}=\frac{E_{i}^{2}}{(p+1)S^{2}}\cdot\frac{h_{ii}}{(1-h_{ii})^{2}},\quad i=1,2,\ldots,n.\label{eq:slr-cooks-distance}\end{equation}

\end_inset

It shows that Cook's distance depends both on the residual 
\begin_inset Formula $E_{i}$
\end_inset

 and the leverage 
\begin_inset Formula $h_{ii}$
\end_inset

 and in this way 
\begin_inset Formula $D_{i}$
\end_inset

 contains information about outlying 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 values.
 
\end_layout

\begin_layout Standard
To assess the significance of 
\begin_inset Formula $D$
\end_inset

, we compare to quantiles of an 
\begin_inset Formula $\mathsf{f}(\mathtt{df1}=2,\,\mathtt{df2}=n-2)$
\end_inset

 distribution.
 A rule of thumb is to classify observations falling higher than the 50
\begin_inset Formula $^{\textrm{th}}$
\end_inset

 percentile as being extreme.
 
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
We can calculate the Cook's Distances with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cooks.distance
\end_layout

\end_inset


\color inherit
 function.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

cooksD <- cooks.distance(cars.lm)
\begin_inset Newline newline
\end_inset

cooksD[1:5]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We can look at a plot of the Cook's distances with the command 
\color none

\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

plot(cars.lm, which = 4)
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4.5, width = 6>>=
\begin_inset Newline newline
\end_inset

plot(cars.lm, which = 4)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Cook's distances for the 
\family typewriter
cars
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:Cooks-distance-cars"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\size small
Used for checking for influential and/our outlying observations.
 Values with large Cook's distance merit further investigation.
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Observations with the largest Cook's D values are labeled, hence we see
 that observations 23, 39, and 49 are suspicious.
 However, we need to compare to the quantiles of an 
\begin_inset Formula $\mathsf{f}(\mathtt{df1}=2,\,\mathtt{df2}=48)$
\end_inset

 distribution:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

F0.50 <- qf(0.5, df1 = 2, df2 = 48)
\begin_inset Newline newline
\end_inset

cooksD[which(cooksD > F0.50)]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We see that with this data set there are no observations with extreme Cook's
 distance, after all.
\end_layout

\begin_layout Subsection
All Influence Measures Simultaneously
\end_layout

\begin_layout Standard
We can display the result of diagnostic checking all at once in one table,
 with potentially influential points displayed.
 We do it with the command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

influence.measures(cars.lm)
\end_layout

\end_inset

:
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

influence.measures(cars.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The output is a huge matrix display, which we have omitted in the interest
 of brevity.
 A point is identified if it is classified to be influential with respect
 to any of the diagnostic measures.
 Here we see that observations 2, 11, 15, and 18 merit further investigation.
 
\end_layout

\begin_layout Standard
We can also look at all diagnostic plots at once with the commands
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

par(mfrow = c(2,2))
\begin_inset Newline newline
\end_inset

plot(cars.lm)
\begin_inset Newline newline
\end_inset

par(mfrow = c(1,1))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

par
\end_layout

\end_inset


\color inherit
 command is used so that 
\begin_inset Formula $2\times2=4$
\end_inset

 plots will be shown on the same display.
 The diagnostic plots for the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cars
\end_layout

\end_inset


\color inherit
 data are shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Diagnostic-plots-cars"

\end_inset

:
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true>>=
\begin_inset Newline newline
\end_inset

par(mfrow = c(2,2))
\begin_inset Newline newline
\end_inset

plot(cars.lm)
\begin_inset Newline newline
\end_inset

par(mfrow = c(1,1))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Diagnostic plots for the 
\family typewriter
cars
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:Diagnostic-plots-cars"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
We have discussed all of the plots except the last, which is possibly the
 most interesting.
 It shows Residuals vs.
 Leverage, which will identify outlying 
\begin_inset Formula $y$
\end_inset

 values versus outlying 
\begin_inset Formula $x$
\end_inset

 values.
 Here we see that observation 23 has a high residual, but low leverage,
 and it turns out that observations 1 and 2 have relatively high leverage
 but low/moderate leverage (they are on the right side of the plot, just
 above the horizontal line).
 Observation 49 has a large residual with a comparatively large leverage.
 
\end_layout

\begin_layout Standard
We can identify the observations with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

identify
\end_layout

\end_inset


\color inherit
 command; it allows us to display the observation number of dots on the
 plot.
 First, we plot the graph, then we call 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

identify
\end_layout

\end_inset


\color inherit
:
\end_layout

\begin_layout Scrap
<<eval = FALSE, keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

plot(cars.lm, which = 5)   # std'd resids vs lev plot
\begin_inset Newline newline
\end_inset

identify(leverage, sres, n = 4)   # identify 4 points
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The graph with the identified points is omitted (but the plain plot is shown
 in the bottom right corner of Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Diagnostic-plots-cars"

\end_inset

).
 Observations 1 and 2 fall on the far right side of the plot, near the horizonta
l axis.
\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Chapter Exercises
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{section}{Chapter Exercises}
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{thm}{0}
\end_layout

\end_inset


\end_layout

\begin_layout Exercise
Prove the ANOVA equality, Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:anovaeq"

\end_inset

.
 
\emph on
Hint
\emph default
: show that
\begin_inset Formula \[
\sum_{i=1}^{n}(Y_{i}-\hat{Y_{i}})(\hat{Y_{i}}-\Ybar)=0.\]

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Exercise
\begin_inset CommandInset label
LatexCommand label
name "xca:find-mles-SLR"

\end_inset

Solve the following system of equations for 
\begin_inset Formula $\beta_{1}$
\end_inset

 and 
\begin_inset Formula $\beta_{0}$
\end_inset

 to find the MLEs for slope and intercept in the simple linear regression
 model.
\begin_inset Formula \begin{eqnarray*}
n\beta_{0}+\beta_{1}\sum_{i=1}^{n}x_{i} & = & \sum_{i=1}^{n}y_{i}\\
\beta_{0}\sum_{i=1}^{n}x_{i}+\beta_{1}\sum_{i=1}^{n}x_{i}^{2} & = & \sum_{i=1}^{n}x_{i}y_{i}\end{eqnarray*}

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Exercise
\begin_inset CommandInset label
LatexCommand label
name "xca:show-alternate-slope-formula"

\end_inset

Show that the formula given in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:sample-correlation-formula"

\end_inset

 is equivalent to 
\begin_inset Formula \[
\hat{\beta}_{1}=\frac{\sum_{i=1}^{n}x_{i}y_{i}-\left.\left(\sum_{i=1}^{n}x_{i}\right)\left(\sum_{i=1}^{n}y_{i}\right)\right\slash n}{\sum_{i=1}^{n}x_{i}^{2}-\left.\left(\sum_{i=1}^{n}x_{i}\right)^{2}\right\slash n}.\]

\end_inset


\end_layout

\begin_layout Chapter
Multiple Linear Regression
\begin_inset CommandInset label
LatexCommand label
name "cha:multiple-linear-regression"

\end_inset


\end_layout

\begin_layout Standard
\noindent
We know a lot about simple linear regression models, and a next step is
 to study multiple regression models that have more than one independent
 (explanatory) variable.
 In the discussion that follows we will assume that we have 
\begin_inset Formula $p$
\end_inset

 explanatory variables, where 
\begin_inset Formula $p>1$
\end_inset

.
\end_layout

\begin_layout Standard
The language is phrased in matrix terms -- for two reasons.
 First, it is quicker to write and (arguably) more pleasant to read.
 Second, the matrix approach will be required for later study of the subject;
 the reader might as well be introduced to it now.
\end_layout

\begin_layout Standard
Most of the results are stated without proof or with only a cursory justificatio
n.
 Those yearning for more should consult an advanced text in linear regression
 for details, such as 
\emph on
Applied Linear Regression Models
\emph default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Neter1996"

\end_inset

or 
\emph on
Linear Models: Least Squares and Alternatives
\emph default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Rao1999"

\end_inset

.
\end_layout

\begin_layout Paragraph*
What do I want them to know?
\end_layout

\begin_layout Itemize
the basic MLR model, and how it relates to the SLR
\end_layout

\begin_layout Itemize
how to estimate the parameters and use those estimates to make predictions
\end_layout

\begin_layout Itemize
basic strategies to determine whether or not the model is doing a good job
\end_layout

\begin_layout Itemize
a few thoughts about selected applications of the MLR, such as polynomial,
 interaction, and dummy variable models
\end_layout

\begin_layout Itemize
some of the uses of residuals to diagnose problems
\end_layout

\begin_layout Itemize
hints about what will be coming later
\end_layout

\begin_layout Section
The Multiple Linear Regression Model
\begin_inset CommandInset label
LatexCommand label
name "sec:The-MLR-Model"

\end_inset


\end_layout

\begin_layout Standard
The first thing to do is get some better notation.
 We will write 
\begin_inset Formula \begin{equation}
\mathbf{Y}_{\mathrm{n}\times1}=\begin{bmatrix}y_{1}\\
y_{2}\\
\vdots\\
y_{n}\end{bmatrix},\quad\mbox{and}\quad\mathbf{X}_{\mathrm{n}\times(\mathrm{p}+1)}=\begin{bmatrix}1 & x_{11} & x_{21} & \cdots & x_{p1}\\
1 & x_{12} & x_{22} & \cdots & x_{p2}\\
\vdots & \vdots & \vdots & \ddots & \vdots\\
1 & x_{1n} & x_{2n} & \cdots & x_{pn}\end{bmatrix}.\end{equation}

\end_inset

The vector 
\begin_inset Formula $\mathbf{Y}$
\end_inset

 is called the 
\emph on
response vector
\begin_inset Index
status open

\begin_layout Plain Layout
response vector
\end_layout

\end_inset


\emph default
 and the matrix 
\begin_inset Formula $\mathbf{X}$
\end_inset

 is called the 
\emph on
model matrix
\emph default

\begin_inset Index
status open

\begin_layout Plain Layout
model matrix
\end_layout

\end_inset

.
 As in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:simple-linear-regression"

\end_inset

, the most general assumption that relates 
\begin_inset Formula $\mathbf{Y}$
\end_inset

 to 
\begin_inset Formula $\mathbf{X}$
\end_inset

 is
\begin_inset Formula \begin{equation}
\mathbf{Y}=\mu(\mathbf{X})+\upepsilon,\end{equation}

\end_inset

where 
\begin_inset Formula $\mu$
\end_inset

 is some function (the 
\emph on
signal
\emph default
) and 
\begin_inset Formula $\upepsilon$
\end_inset

 is the 
\emph on
noise
\emph default
 (everything else).
 We usually impose some structure on 
\begin_inset Formula $\mu$
\end_inset

 and 
\begin_inset Formula $\upepsilon$
\end_inset

.
 In particular, the standard multiple linear regression model
\begin_inset Index
status open

\begin_layout Plain Layout
model ! multiple linear regression
\end_layout

\end_inset

 assumes 
\begin_inset Formula \begin{equation}
\mathbf{Y}=\mathbf{X}\upbeta+\upepsilon,\end{equation}

\end_inset

where the parameter vector 
\begin_inset Formula $\upbeta$
\end_inset

 looks like 
\begin_inset Formula \begin{equation}
\upbeta_{(\mathrm{p}+1)\times1}=\begin{bmatrix}\beta_{0} & \beta_{1} & \cdots & \beta_{p}\end{bmatrix}^{\mathrm{T}},\end{equation}

\end_inset

and the random vector 
\begin_inset Formula $\upepsilon_{\mathrm{n}\times1}=\begin{bmatrix}\epsilon_{1} & \epsilon_{2} & \cdots & \epsilon_{n}\end{bmatrix}^{\mathrm{T}}$
\end_inset

 is assumed to be distributed
\begin_inset Formula \begin{equation}
\upepsilon\sim\mathsf{mvnorm}\left(\mathtt{mean}=\mathbf{0}_{\mathrm{n}\times1},\,\mathtt{sigma}=\sigma^{2}\mathbf{I}_{\mathrm{n}\times\mathrm{n}}\right).\end{equation}

\end_inset

The assumption on 
\begin_inset Formula $\upepsilon$
\end_inset

 is equivalent to the assumption that 
\begin_inset Formula $\epsilon_{1}$
\end_inset

, 
\begin_inset Formula $\epsilon_{2}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $\epsilon_{n}$
\end_inset

 are i.i.d.
\begin_inset space ~
\end_inset


\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=0,\,\mathtt{sd}=\sigma)$
\end_inset

.
 It is a linear model because the quantity 
\begin_inset Formula $\mu(\mathbf{X})=\mathbf{X}\upbeta$
\end_inset

 is linear in the parameters 
\begin_inset Formula $\beta_{0}$
\end_inset

, 
\begin_inset Formula $\beta_{1}$
\end_inset

,\SpecialChar \ldots{}
, 
\begin_inset Formula $\beta_{p}$
\end_inset

.
 It may be helpful to see the model in expanded form; the above matrix formulati
on is equivalent to the more lengthy
\begin_inset Formula \begin{equation}
Y_{i}=\beta_{0}+\beta_{1}x_{1i}+\beta_{2}x_{2i}+\cdots+\beta_{p}x_{pi}+\epsilon_{i},\quad i=1,2,\ldots,n.\end{equation}

\end_inset


\end_layout

\begin_layout Example

\series bold
Girth, Height, and Volume for Black Cherry trees.
\series default

\begin_inset Index
status open

\begin_layout Plain Layout
Data sets ! 
\family typewriter
trees
\end_layout

\end_inset

Measurements were made of the girth, height, and volume of timber in 31
 felled black cherry trees.
 Note that girth is the diameter of the tree (in inches) measured at 4
\begin_inset space \thinspace{}
\end_inset

ft 6
\begin_inset space \thinspace{}
\end_inset

in above the ground.
 The variables are
\end_layout

\begin_deeper
\begin_layout Enumerate

\color none
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
: tree diameter in inches (denoted 
\begin_inset Formula $x_{1}$
\end_inset

)
\end_layout

\begin_layout Enumerate

\color none
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset


\color inherit
: tree height in feet (
\begin_inset Formula $x_{2}$
\end_inset

).
\end_layout

\begin_layout Enumerate

\color none
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
: volume of the tree in cubic feet.
 (
\begin_inset Formula $y$
\end_inset

)
\end_layout

\begin_layout Standard
The data are in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

datasets
\end_layout

\end_inset


\color inherit
 package and are already on the search path; they can be viewed with
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

head(trees)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Let us take a look at a visual display of the data.
 For multiple variables, instead of a simple scatterplot we use a scatterplot
 matrix which is made with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

splom
\end_layout

\end_inset


\color inherit
 function in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lattice
\end_layout

\end_inset


\color inherit
 package 
\begin_inset CommandInset citation
LatexCommand cite
key "Sarkarlattice"

\end_inset

 as shown below.
 The plot is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:splom-trees"

\end_inset

.
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 6>>=
\begin_inset Newline newline
\end_inset

library(lattice)
\begin_inset Newline newline
\end_inset

print(splom(trees))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Scatterplot matrix of 
\family typewriter
trees
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:splom-trees"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

library(lattice)
\begin_inset Newline newline
\end_inset

splom(trees)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The dependent (response) variable 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 is listed in the first row of the scatterplot matrix.
 Moving from left to right, we see an approximately linear relationship
 between 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 and the independent (explanatory) variables
\color none
 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
.
 A first guess at a model for these data might be
\begin_inset Formula \begin{equation}
Y=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}+\epsilon,\end{equation}

\end_inset

in which case the quantity 
\begin_inset Formula $\mu(x_{1},x_{2})=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}$
\end_inset

 would represent the mean value of 
\begin_inset Formula $Y$
\end_inset

 at the point 
\begin_inset Formula $(x_{1},x_{2})$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Subsection*
What does it mean?
\end_layout

\begin_layout Standard
The interpretation is simple.
 The intercept 
\begin_inset Formula $\beta_{0}$
\end_inset

 represents the mean 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 when all other independent variables are zero.
 The parameter 
\begin_inset Formula $\beta_{i}$
\end_inset

 represents the change in mean 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 when there is a unit increase in 
\begin_inset Formula $x_{i}$
\end_inset

, while the other independent variable is held constant.
 For the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset


\color inherit
 data, 
\begin_inset Formula $\beta_{1}$
\end_inset

 represents the change in average 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 as 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
 increases by one unit when the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset


\color inherit
 is held constant, and 
\begin_inset Formula $\beta_{2}$
\end_inset

 represents the change in average 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 as 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset


\color inherit
 increases by one unit when the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
 is held constant.
\end_layout

\begin_layout Standard
In simple linear regression, we had one independent variable and our linear
 regression surface was 1D, simply a line.
 In multiple regression there are many independent variables and so our
 linear regression surface will be many-D\SpecialChar \ldots{}
 in general, a hyperplane.
 But when there are only two explanatory variables the hyperplane is just
 an ordinary plane and we can look at it with a 3D scatterplot.
 
\end_layout

\begin_layout Standard
One way to do this is with the 
\family sans
R
\family default
 Commander in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Rcmdr
\end_layout

\end_inset


\color inherit
 package 
\begin_inset CommandInset citation
LatexCommand cite
key "Foxrcmdr"

\end_inset

.
 It has a 3D scatterplot option under the 
\family sans
Graphs
\family default
 menu.
 It is especially great because the resulting graph is dynamic; it can be
 moved around with the mouse, zoomed, 
\emph on
etc
\emph default
.
 But that particular display does not translate well to a printed book.
\end_layout

\begin_layout Standard
Another way to do it is with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

scatterplot3d
\end_layout

\end_inset

 function in the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

scatterplot3d
\end_layout

\end_inset

 package.
 The code follows, and the result is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:3D-scatterplot-trees"

\end_inset

.
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

library(scatterplot3d)
\begin_inset Newline newline
\end_inset

s3d <- with(trees, scatterplot3d(Girth, Height, Volume, pch = 16, highlight.3d
 = TRUE, angle = 60))
\begin_inset Newline newline
\end_inset

fit <- lm(Volume ~ Girth + Height, data = trees)
\begin_inset Newline newline
\end_inset

s3d$plane3d(fit)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 6>>=
\begin_inset Newline newline
\end_inset

library(scatterplot3d)
\begin_inset Newline newline
\end_inset

s3d <- with(trees, scatterplot3d(Girth, Height, Volume, pch = 16, highlight.3d
 = TRUE, angle = 60))
\begin_inset Newline newline
\end_inset

fit <- lm(Volume ~ Girth + Height, data = trees)
\begin_inset Newline newline
\end_inset

s3d$plane3d(fit)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
3D scatterplot with regression plane for the 
\family typewriter
trees
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:3D-scatterplot-trees"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
Looking at the graph we see that the data points fall close to a plane in
 three dimensional space.
 (The plot looks remarkably good.
 In the author's experience it is rare to see points fit so well to the
 plane without some additional work.)
\end_layout

\begin_layout Section
Estimation and Prediction
\begin_inset CommandInset label
LatexCommand label
name "sec:Estimation-and-Prediction-MLR"

\end_inset


\end_layout

\begin_layout Subsection
Parameter estimates
\begin_inset CommandInset label
LatexCommand label
name "sub:mlr-parameter-estimates"

\end_inset


\end_layout

\begin_layout Standard
We will proceed exactly like we did in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:SLR-Estimation"

\end_inset

.
 We know 
\begin_inset Formula \begin{equation}
\upepsilon\sim\mathsf{mvnorm}\left(\mathtt{mean}=\mathbf{0}_{\mathrm{n}\times1},\,\mathtt{sigma}=\sigma^{2}\mathbf{I}_{\mathrm{n}\times\mathrm{n}}\right),\end{equation}

\end_inset

which means that 
\begin_inset Formula $\mathbf{Y}=\mathbf{X}\upbeta+\upepsilon$
\end_inset

 has an 
\begin_inset Formula $\mathsf{mvnorm}\left(\mathtt{mean}=\mathbf{X}\upbeta,\,\mathtt{sigma}=\sigma^{2}\mathbf{I}_{\mathrm{n}\times\mathrm{n}}\right)$
\end_inset

 distribution.
 Therefore, the likelihood function
\begin_inset Index
status open

\begin_layout Plain Layout
likelihood function
\end_layout

\end_inset

 is
\begin_inset Formula \begin{equation}
L(\upbeta,\sigma)=\frac{1}{2\pi^{n/2}\sigma}\exp\left\{ -\frac{1}{2\sigma^{2}}\left(\mathbf{Y}-\mathbf{X}\upbeta\right)^{\mathrm{T}}\left(\mathbf{Y}-\mathbf{X}\upbeta\right)\right\} .\end{equation}

\end_inset

To 
\emph on
maximize
\emph default
 the likelihood
\begin_inset Index
status open

\begin_layout Plain Layout
maximum likelihood
\end_layout

\end_inset

 in 
\begin_inset Formula $\upbeta$
\end_inset

, we need to 
\emph on
minimize
\emph default
 the quantity 
\begin_inset Formula $g(\upbeta)=\left(\mathbf{Y}-\mathbf{X}\upbeta\right)^{\mathrm{T}}\left(\mathbf{Y}-\mathbf{X}\upbeta\right)$
\end_inset

.
 We do this by differentiating 
\begin_inset Formula $g$
\end_inset

 with respect to 
\begin_inset Formula $\upbeta$
\end_inset

.
 (It may be a good idea to brush up on the material in Appendices 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Linear-Algebra"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Multivariable-Calculus"

\end_inset

.) First we will rewrite 
\begin_inset Formula $g$
\end_inset

:
\begin_inset Formula \begin{equation}
g(\upbeta)=\mathbf{Y}^{\mathrm{T}}\mathbf{Y}-\mathbf{Y}^{\mathrm{T}}\mathbf{X}\upbeta-\upbeta^{\mathrm{T}}\mathbf{X}^{\mathrm{T}}\mathbf{Y}+\upbeta^{\mathrm{T}}\mathbf{X}^{\mathrm{T}}\mathbf{X}\upbeta,\end{equation}

\end_inset

which can be further simplified to 
\begin_inset Formula $g(\upbeta)=\mathbf{Y}^{\mathrm{T}}\mathbf{Y}-2\upbeta^{\mathrm{T}}\mathbf{X}^{\mathrm{T}}\mathbf{Y}+\upbeta^{\mathrm{T}}\mathbf{X}^{\mathrm{T}}\mathbf{X}\upbeta$
\end_inset

 since 
\begin_inset Formula $\upbeta^{\mathrm{T}}\mathbf{X}^{\mathrm{T}}\mathbf{Y}$
\end_inset

 is 
\begin_inset Formula $1\times1$
\end_inset

 and thus equal to its transpose.
 Now we differentiate to get 
\begin_inset Formula \begin{equation}
\frac{\partial g}{\partial\upbeta}=\mathbf{0}-2\mathbf{X}^{\mathrm{T}}\mathbf{Y}+2\mathbf{X}^{\mathrm{T}}\mathbf{X}\upbeta,\end{equation}

\end_inset

since 
\begin_inset Formula $\mathbf{X}^{\mathrm{T}}\mathbf{X}$
\end_inset

 is symmetric.
 Setting the derivative equal to the zero vector yields the so called 
\begin_inset Quotes eld
\end_inset

normal equations
\begin_inset Quotes erd
\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout
normal equations
\end_layout

\end_inset


\begin_inset Formula \begin{equation}
\mathbf{X}^{\mathrm{T}}\mathbf{X}\upbeta=\mathbf{X}^{\mathrm{T}}\mathbf{Y}.\end{equation}

\end_inset

In the case that 
\begin_inset Formula $\mathbf{X}^{\mathrm{T}}\mathbf{X}$
\end_inset

 is invertible
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
We can find solutions of the normal equations even when 
\begin_inset Formula $\mathbf{X}^{\mathrm{T}}\mathbf{X}$
\end_inset

 is not of full rank, but the topic falls outside the scope of this book.
 The interested reader can consult an advanced text such as Rao 
\begin_inset CommandInset citation
LatexCommand cite
key "Rao1999"

\end_inset

.
\end_layout

\end_inset

, we may solve the equation for 
\begin_inset Formula $\upbeta$
\end_inset

 to get the maximum likelihood estimator of 
\begin_inset Formula $\upbeta$
\end_inset

 which we denote by 
\begin_inset Formula $\mathbf{b}$
\end_inset

:
\begin_inset Formula \begin{equation}
\mathbf{b}=\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}\mathbf{Y}.\label{eq:b-formula-matrix}\end{equation}

\end_inset


\end_layout

\begin_layout Remark
The formula in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:b-formula-matrix"

\end_inset

 is convenient for mathematical study but is inconvenient for numerical
 computation.
 Researchers have devised much more efficient algorithms for the actual
 calculation of the parameter estimates, and we do not explore them here.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Remark
We have only found a critical value, and have not actually shown that the
 critical value is a minimum.
 We omit the details and refer the interested reader to 
\begin_inset CommandInset citation
LatexCommand cite
key "Rao1999"

\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
We do all of the above just as we would in simple linear regression.
 The powerhouse is the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lm
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
lm
\end_layout

\end_inset

 function.
 Everything else is based on it.
 We separate explanatory variables in the model formula by a plus sign.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

trees.lm <- lm(Volume ~ Girth + Height, data = trees)
\begin_inset Newline newline
\end_inset

trees.lm
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We see from the output that for the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset


\color inherit
 data our parameter estimates are 
\begin_inset Formula $\mathbf{b}=\begin{bmatrix}-58.0 & 4.7 & 0.3\end{bmatrix}$
\end_inset

, and consequently our estimate of the mean response is 
\begin_inset Formula $\hat{\mu}$
\end_inset

 given by 
\begin_inset Formula \begin{alignat}{1}
\hat{\mu}(x_{1},x_{2})= & \ b_{0}+b_{1}x_{1}+b_{2}x_{2},\\
\approx & -58.0+4.7x_{1}+0.3x_{2}.\end{alignat}

\end_inset

We could see the entire model matrix 
\begin_inset Formula $\mathbf{X}$
\end_inset

 with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

model.matrix
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
model.matrix
\end_layout

\end_inset

 function, but in the interest of brevity we only show the first few rows.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

head(model.matrix(trees.lm))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Subsection
Point Estimates of the Regression Surface
\begin_inset CommandInset label
LatexCommand label
name "sub:mlr-point-est-regsurface"

\end_inset


\end_layout

\begin_layout Standard
The parameter estimates 
\begin_inset Formula $\mathbf{b}$
\end_inset

 make it easy to find the fitted values
\begin_inset Index
status open

\begin_layout Plain Layout
fitted values
\end_layout

\end_inset

, 
\begin_inset Formula $\hat{\mathbf{Y}}$
\end_inset

.
 We write them individually as 
\begin_inset Formula $\hat{Y}_{i}$
\end_inset

, 
\begin_inset Formula $i=1,2,\ldots,n$
\end_inset

, and recall that they are defined by
\begin_inset Formula \begin{eqnarray}
\hat{Y}_{i} & = & \hat{\mu}(x_{1i},x_{2i}),\\
 & = & b_{0}+b_{1}x_{1i}+b_{2}x_{2i},\quad i=1,2,\ldots,n.\end{eqnarray}

\end_inset

They are expressed more compactly by the matrix equation
\begin_inset Formula \begin{equation}
\hat{\mathbf{Y}}=\mathbf{X}\mathbf{b}.\end{equation}

\end_inset

From Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:b-formula-matrix"

\end_inset

 we know that 
\begin_inset Formula $\mathbf{b}=\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}\mathbf{Y}$
\end_inset

, so we can rewrite
\begin_inset Formula \begin{eqnarray}
\hat{\mathbf{Y}} & = & \mathbf{X}\left[\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}\mathbf{Y}\right],\\
 & = & \mathbf{H}\mathbf{Y},\end{eqnarray}

\end_inset

where 
\begin_inset Formula $\mathbf{H}=\mathbf{X}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}$
\end_inset

 is appropriately named 
\emph on
the hat matrix
\emph default

\begin_inset Index
status open

\begin_layout Plain Layout
hat matrix
\end_layout

\end_inset

 because it 
\begin_inset Quotes eld
\end_inset

puts the hat on 
\begin_inset Formula $\mathbf{Y}$
\end_inset


\begin_inset Quotes erd
\end_inset

.
 The hat matrix is very important in later courses.
 Some facts about 
\begin_inset Formula $\mathbf{H}$
\end_inset

 are
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{H}$
\end_inset

 is a symmetric square matrix, of dimension 
\begin_inset Formula $\mathrm{n}\times\mathrm{n}$
\end_inset

.
\end_layout

\begin_layout Itemize
The diagonal entries 
\begin_inset Formula $h_{ii}$
\end_inset

 satisfy 
\begin_inset Formula $0\leq h_{ii}\leq1$
\end_inset

 (compare to Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:slr-leverage-between"

\end_inset

).
\end_layout

\begin_layout Itemize
The trace is 
\begin_inset Formula $\mathrm{tr}(\mathbf{H})=p$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\mathbf{H}$
\end_inset

 is 
\emph on
idempotent
\emph default
 (also known as a 
\emph on
projection matrix
\emph default
) which means that 
\begin_inset Formula $\mathbf{H}^{2}=\mathbf{H}$
\end_inset

.
 The same is true of 
\begin_inset Formula $\mathbf{I}-\mathbf{H}$
\end_inset

.
\end_layout

\begin_layout Standard
Now let us write a column vector 
\begin_inset Formula $\mathbf{x}_{0}=(x_{10},x_{20})^{\mathrm{T}}$
\end_inset

 to denote given values of the explanatory variables 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth =
\end_layout

\end_inset


\color inherit
 
\begin_inset Formula $x_{10}$
\end_inset

 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height =
\end_layout

\end_inset


\color inherit
 
\begin_inset Formula $x_{20}$
\end_inset

.
 These values may match those of the collected data, or they may be completely
 new values not observed in the original data set.
 We may use the parameter estimates to find 
\begin_inset Formula $\hat{Y}(\mathbf{x}_{0})$
\end_inset

, which will give us
\end_layout

\begin_layout Enumerate
an estimate of 
\begin_inset Formula $\mu(\mathbf{x}_{0})$
\end_inset

, the mean value of a future observation at 
\begin_inset Formula $\mathbf{x}_{0}$
\end_inset

, and
\end_layout

\begin_layout Enumerate
a prediction for 
\begin_inset Formula $Y(\mathbf{x}_{0})$
\end_inset

, the actual value of a future observation at 
\begin_inset Formula $\mathbf{x}_{0}$
\end_inset

.
\end_layout

\begin_layout Standard
We can represent 
\begin_inset Formula $\hat{Y}(\mathbf{x}_{0})$
\end_inset

 by the matrix equation
\begin_inset Formula \begin{equation}
\hat{Y}(\mathbf{x}_{0})=\mathbf{x}_{0}^{\mathrm{T}}\mathbf{b},\label{eq:mlr-single-yhat-matrix}\end{equation}

\end_inset

which is just a fancy way to write
\begin_inset Formula \begin{equation}
\hat{Y}(x_{10},x_{20})=b_{0}+b_{1}x_{10}+b_{2}x_{20}.\end{equation}

\end_inset

 
\end_layout

\begin_layout Example
If we wanted to predict the average volume of black cherry trees 
\color none
that have 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth = 15
\end_layout

\end_inset


\begin_inset space \thinspace{}
\end_inset

in and are 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height = 77
\end_layout

\end_inset


\begin_inset space \thinspace{}
\end_inset

ft tall then 
\color inherit
we would use the estimate 
\begin_inset Formula \begin{alignat*}{1}
\hat{\mu}(15,\,77)= & -58+4.7(15)+0.3(77),\\
\approx & 35.6\mbox{\,\ ft}^{3}.\end{alignat*}

\end_inset

We would use the same estimate 
\begin_inset Formula $\hat{Y}=35.6$
\end_inset

 to predict the measured 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset

 of another black cherry tree -- yet to be observed -- that
\color inherit
 
\color none
has 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth = 15
\end_layout

\end_inset


\begin_inset space \thinspace{}
\end_inset

in and is 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height = 77
\end_layout

\end_inset


\begin_inset space \thinspace{}
\end_inset

ft tall
\color inherit
.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The fitted values are stored inside 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees.lm
\end_layout

\end_inset

 and may be
\color inherit
 accessed with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

fitted
\end_layout

\end_inset

 function.
 We only show the first five fitted values.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

fitted(trees.lm)[1:5]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The syntax for general prediction does not change much from simple linear
 regression.
 The computations are done with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

predict
\end_layout

\end_inset


\color inherit
 function as described below.
\end_layout

\begin_layout Standard
The only difference from SLR is in the way we tell 
\family sans
R
\family default
 the values of the explanatory variables for which we want predictions.
 In SLR we had only one independent variable but in MLR we have many (for
 the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset


\color inherit
 data we have two).
 We will store values for the independent variables in the data frame 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

new
\end_layout

\end_inset


\color inherit
, which has two columns (one for each independent variable) and three rows
 (we shall make predictions at three different locations).
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

new <- data.frame(Girth = c(9.1, 11.6, 12.5), Height = c(69, 74, 87))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We can view the locations at which we will predict:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

new
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We continue just like we would have done in SLR.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

predict(trees.lm, newdata = new)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<echo = FALSE>>=
\begin_inset Newline newline
\end_inset

treesFIT <- round(predict(trees.lm, newdata = new), 1)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Example
Using the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset

 data,
\end_layout

\begin_deeper
\begin_layout Enumerate
Report a point estimate of the mean 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 of a tree of 
\color none

\begin_inset listings
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
 9.1
\begin_inset space \thinspace{}
\end_inset

in and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset


\color inherit
 69
\begin_inset space \thinspace{}
\end_inset

ft.
\end_layout

\begin_deeper
\begin_layout Standard
The fitted value for 
\begin_inset Formula $x_{1}=9.1$
\end_inset

 and 
\begin_inset Formula $x_{2}=69$
\end_inset

 is 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesFIT[1]}
\end_layout

\end_inset

, so a point estimate would be 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesFIT[1]}
\end_layout

\end_inset

 cubic feet.
 
\end_layout

\end_deeper
\begin_layout Enumerate
Report a point prediction for and a 95% prediction interval for the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 of a hypothetical tree of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
 12.5
\begin_inset space \thinspace{}
\end_inset

in and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset


\color inherit
 87
\begin_inset space \thinspace{}
\end_inset

ft.
\end_layout

\begin_deeper
\begin_layout Standard
The fitted value for 
\begin_inset Formula $x_{1}=12.5$
\end_inset

 and 
\begin_inset Formula $x_{2}=87$
\end_inset

 is 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesFIT[3]}
\end_layout

\end_inset

, so a point prediction for the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 is 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesFIT[3]}
\end_layout

\end_inset

 cubic feet.
 
\end_layout

\end_deeper
\end_deeper
\begin_layout Subsection
Mean Square Error and Standard Error
\begin_inset CommandInset label
LatexCommand label
name "sub:mlr-mse-se"

\end_inset


\end_layout

\begin_layout Standard
The residuals are given by
\begin_inset Formula \begin{equation}
\mathbf{E}=\mathbf{Y}-\hat{\mathbf{Y}}=\mathbf{Y}-\mathbf{H}\mathbf{Y}=(\mathbf{I}-\mathbf{H})\mathbf{Y}.\end{equation}

\end_inset

Now we can use Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:mvnorm-dist-matrix-prod"

\end_inset

 to see that the residuals are distributed
\begin_inset Formula \begin{equation}
\mathbf{E}\sim\mathsf{mvnorm}(\mathtt{mean}=\mathbf{0},\,\mathtt{sigma}=\sigma^{2}(\mathbf{I}-\mathbf{H})),\end{equation}

\end_inset

since 
\begin_inset Formula $(\mathbf{I}-\mathbf{H})\mathbf{X}\upbeta=\mathbf{X}\upbeta-\mathbf{X}\upbeta=\mathbf{0}$
\end_inset

 and 
\begin_inset Formula $(\mathbf{I}-\mathbf{H})\,(\sigma^{2}\mathbf{I})\,(\mathbf{I}-\mathbf{H})^{\mathrm{T}}=\sigma^{2}(\mathbf{I}-\mathbf{H})^{2}=\sigma^{2}(\mathbf{I}-\mathbf{H})$
\end_inset

.
 The sum of squared errors 
\begin_inset Formula $SSE$
\end_inset

 is just
\begin_inset Formula \begin{equation}
SSE=\mathbf{E}^{\mathrm{T}}\mathbf{E}=\mathbf{Y}^{\mathrm{T}}(\mathbf{I}-\mathbf{H})(\mathbf{I}-\mathbf{H})\mathbf{Y}=\mathbf{Y}^{\mathrm{T}}(\mathbf{I}-\mathbf{H})\mathbf{Y}.\end{equation}

\end_inset

Recall that in SLR we had two parameters (
\begin_inset Formula $\beta_{0}$
\end_inset

 and 
\begin_inset Formula $\beta_{1}$
\end_inset

) in our regression model and we estimated 
\begin_inset Formula $\sigma^{2}$
\end_inset

 with 
\begin_inset Formula $s^{2}=SSE/(n-2)$
\end_inset

.
 In MLR, we have 
\begin_inset Formula $p+1$
\end_inset

 parameters in our regression model and we might guess that to estimate
 
\begin_inset Formula $\sigma^{2}$
\end_inset

 we would use the 
\emph on
mean square error
\emph default
 
\begin_inset Formula $S^{2}$
\end_inset

 defined by 
\begin_inset Formula \begin{equation}
S^{2}=\frac{SSE}{n-(p+1)}.\end{equation}

\end_inset

That would be a good guess.
 The 
\emph on
residual standard error
\emph default
 is 
\begin_inset Formula $S=\sqrt{S^{2}}$
\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The residuals are also stored with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees.lm
\end_layout

\end_inset

 a
\color inherit
nd may be accessed with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

residuals
\end_layout

\end_inset


\color inherit
 function.
 We only show the first five residuals.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

residuals(trees.lm)[1:5]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary
\end_layout

\end_inset


\color inherit
 function output (shown later) lists the 
\color none

\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Residual Standard Error
\end_layout

\end_inset


\color inherit
 which is just 
\begin_inset Formula $S=\sqrt{S^{2}}$
\end_inset

.
 It is stored in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

sigma
\end_layout

\end_inset

 component of the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary
\end_layout

\end_inset

 object.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

treesumry <- summary(trees.lm)
\begin_inset Newline newline
\end_inset

treesumry$sigma
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
For the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset


\color inherit
 data we find 
\begin_inset Formula $s\approx$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(treesumry$sigma, 3)}
\end_layout

\end_inset

.
\end_layout

\begin_layout Subsection
Interval Estimates of the Parameters
\begin_inset CommandInset label
LatexCommand label
name "sub:mlr-interval-est-params"

\end_inset


\end_layout

\begin_layout Standard
We showed in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:mlr-parameter-estimates"

\end_inset

 that 
\begin_inset Formula $\mathbf{b}=\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}\mathbf{Y}$
\end_inset

, which is really just a big matrix -- namely 
\begin_inset Formula $\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}$
\end_inset

 -- multiplied by 
\begin_inset Formula $\mathbf{Y}$
\end_inset

.
 It stands to reason that the sampling distribution of 
\begin_inset Formula $\mathbf{b}$
\end_inset

 would be intimately related to the distribution of 
\begin_inset Formula $\mathbf{Y}$
\end_inset

, which we assumed to be
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
\mathbf{Y}\sim\mathsf{mvnorm}\left(\mathtt{mean}=\mathbf{X}\upbeta,\,\mathtt{sigma}=\sigma^{2}\mathbf{I}\right).\end{equation}

\end_inset

Now recall Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:mvnorm-dist-matrix-prod"

\end_inset

 that we said we were going to need eventually (the time is now).
 That proposition guarantees that
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
\mathbf{b}\sim\mathsf{mvnorm}\left(\mathtt{mean}=\upbeta,\,\mathtt{sigma}=\sigma^{2}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\right),\label{eq:distn-b-mlr}\end{equation}

\end_inset

since
\begin_inset Formula \begin{equation}
\E\mathbf{b}=\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}(\mathbf{X}\upbeta)=\upbeta,\end{equation}

\end_inset

and
\begin_inset Formula \begin{equation}
\mbox{Var}(\mathbf{b})=\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{X}^{\mathrm{T}}(\sigma^{2}\mathbf{I})\mathbf{X}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}=\sigma^{2}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1},\end{equation}

\end_inset

the first equality following because the matrix 
\begin_inset Formula $\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}$
\end_inset

 is symmetric.
\end_layout

\begin_layout Standard
There is a lot that we can glean from Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:distn-b-mlr"

\end_inset

.
 First, it follows that the estimator 
\begin_inset Formula $\mathbf{b}$
\end_inset

 is unbiased (see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Point-Estimation-1"

\end_inset

).
 Second, the variances of 
\begin_inset Formula $b_{0}$
\end_inset

, 
\begin_inset Formula $b_{1}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $b_{n}$
\end_inset

 are exactly the diagonal elements of 
\begin_inset Formula $\sigma^{2}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}$
\end_inset

, which is completely known except for that pesky parameter 
\begin_inset Formula $\sigma^{2}$
\end_inset

.
 Third, we can estimate the standard error of 
\begin_inset Formula $b_{i}$
\end_inset

 (denoted 
\begin_inset Formula $S_{b_{i}}$
\end_inset

) with the mean square error 
\begin_inset Formula $S$
\end_inset

 (defined in the previous section) multiplied by the corresponding diagonal
 element of 
\begin_inset Formula $\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}$
\end_inset

.
 Finally, given estimates of the standard errors we may construct confidence
 intervals for 
\begin_inset Formula $\beta_{i}$
\end_inset

 with an interval that looks like
\begin_inset Formula \begin{equation}
b_{i}\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-p-1)S_{b_{i}}.\end{equation}

\end_inset

The degrees of freedom for the Student's 
\begin_inset Formula $t$
\end_inset

 distribution
\begin_inset Foot
status open

\begin_layout Plain Layout
We are taking great leaps over the mathematical details.
 In particular, we have yet to show that 
\begin_inset Formula $s^{2}$
\end_inset

 has a chi-square distribution and we have not even come close to showing
 that 
\begin_inset Formula $b_{i}$
\end_inset

 and 
\begin_inset Formula $s_{b_{i}}$
\end_inset

 are independent.
 But these are entirely outside the scope of the present book and the reader
 may rest assured that the proofs await in later classes.
 See C.R.
 Rao for more.
\end_layout

\end_inset

 are the same as the denominator of 
\begin_inset Formula $S^{2}$
\end_inset

.
 
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
To get confidence intervals for the parameters we need only use 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

confint
\end_layout

\end_inset


\color inherit

\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
confint
\end_layout

\end_inset

:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

confint(trees.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<echo = FALSE, results = hide>>=
\begin_inset Newline newline
\end_inset

treesPAR <- round(confint(trees.lm), 1)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
For example, using the calculations above we say that for the regression
 model 
\color none

\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume ~ Girth + Height
\end_layout

\end_inset


\color inherit
 we are 95% confident that the parameter 
\begin_inset Formula $\beta_{1}$
\end_inset

 lies somewhere in the interval [
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesPAR[2, 1]}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesPAR[2, 2]}
\end_layout

\end_inset

].
\end_layout

\begin_layout Subsection
Confidence and Prediction Intervals
\end_layout

\begin_layout Standard
We saw in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:mlr-point-est-regsurface"

\end_inset

 how to make point estimates of the mean value of additional observations
 and predict values of future observations, but how good are our estimates?
 We need confidence and prediction intervals to gauge their accuracy, and
 lucky for us the formulas look similar to the ones we saw in SLR.
\end_layout

\begin_layout Standard
In Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:mlr-single-yhat-matrix"

\end_inset

 we wrote 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset Formula $\hat{Y}(\mathbf{x}_{0})=\mathbf{x}_{0}^{\mathrm{T}}\mathbf{b},$
\end_inset


\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
 and in Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:distn-b-mlr"

\end_inset

 we saw that 
\begin_inset Formula \begin{equation}
\mathbf{b}\sim\mathsf{mvnorm}\left(\mathtt{mean}=\upbeta,\,\mathtt{sigma}=\sigma^{2}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\right),\end{equation}

\end_inset

The following is therefore immediate from Theorem 
\begin_inset CommandInset ref
LatexCommand ref
reference "thm:mvnorm-dist-matrix-prod"

\end_inset

:
\begin_inset Formula \begin{equation}
\hat{Y}(\mathbf{x}_{0})\sim\mathsf{mvnorm}\left(\mathtt{mean}=\mathbf{x}_{0}^{\mathrm{T}}\upbeta,\,\mathtt{sigma}=\sigma^{2}\mathbf{x}_{0}^{\mathrm{T}}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{x}_{0}\right).\end{equation}

\end_inset

It should be no surprise that confidence intervals for the mean value of
 a future observation at the location 
\begin_inset Formula $\mathbf{x}_{0}=\begin{bmatrix}x_{10} & x_{20} & \ldots & x_{p0}\end{bmatrix}^{\mathrm{T}}$
\end_inset

 are given by
\begin_inset Formula \begin{equation}
\hat{Y}(\mathbf{x}_{0})\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-p-1)\, S\sqrt{\mathbf{x}_{0}^{\mathrm{T}}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{x}_{0}}.\end{equation}

\end_inset

Intuitively, 
\begin_inset Formula $\mathbf{x}_{0}^{\mathrm{T}}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{x}_{0}$
\end_inset

 measures the distance of 
\begin_inset Formula $\mathbf{x}_{0}$
\end_inset

 from the center of the data.
 The degrees of freedom in the Student's 
\begin_inset Formula $t$
\end_inset

 critical value are 
\begin_inset Formula $n-(p+1)$
\end_inset

 because we need to estimate 
\begin_inset Formula $p+1$
\end_inset

 parameters.
\end_layout

\begin_layout Standard
Prediction intervals for a new observation at 
\begin_inset Formula $\mathbf{x}_{0}$
\end_inset

 are given by
\begin_inset Formula \begin{equation}
\hat{Y}(\mathbf{x}_{0})\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-p-1)\, S\sqrt{1+\mathbf{x}_{0}^{\mathrm{T}}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\mathbf{x}_{0}}.\end{equation}

\end_inset

The prediction intervals are wider than the confidence intervals, just as
 in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:slr-interval-est-regline"

\end_inset

.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The syntax is identical to that used in SLR, with the proviso that we need
 to specify values of the independent variables in the data frame 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

new
\end_layout

\end_inset


\color inherit
 as we did in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:slr-interval-est-regline"

\end_inset

 (which we repeat here for illustration).
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

new <- data.frame(Girth = c(9.1, 11.6, 12.5), Height = c(69, 74, 87))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Confidence intervals are given by
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

predict(trees.lm, newdata = new, interval = "confidence")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<echo = FALSE, results = hide>>=
\begin_inset Newline newline
\end_inset

treesCI <- round(predict(trees.lm, newdata = new, interval = "confidence"),
 1)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Prediction intervals are given by
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

predict(trees.lm, newdata = new, interval = "prediction")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<echo = FALSE, results = hide>>=
\begin_inset Newline newline
\end_inset

treesPI <- round(predict(trees.lm, newdata = new, interval = "prediction"),
 1)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
As before, the interval type is decided by the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

interval
\end_layout

\end_inset


\color inherit
 argument and the default confidence level is 95% (which can be changed
 with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

level
\end_layout

\end_inset


\color inherit
 argument).
 
\end_layout

\begin_layout Example
Using the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset

 data,
\end_layout

\begin_deeper
\begin_layout Enumerate
Report a 95% confidence interval for the mean 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 of a tree of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
 9.1
\begin_inset space \thinspace{}
\end_inset

in and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset


\color inherit
 69
\begin_inset space \thinspace{}
\end_inset

ft.
\end_layout

\begin_deeper
\begin_layout Standard
The 95% CI is given by [
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesCI[1, 2]}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesCI[1, 3]}
\end_layout

\end_inset

], so with 95% confidence the mean 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 lies somewhere between 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesCI[1, 2]}
\end_layout

\end_inset

 cubic feet and 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesCI[1, 3]}
\end_layout

\end_inset

 cubic feet.
\end_layout

\end_deeper
\begin_layout Enumerate
Report a 95% prediction interval for the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 of a hypothetical tree of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
 12.5
\begin_inset space \thinspace{}
\end_inset

in and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset


\color inherit
 87
\begin_inset space \thinspace{}
\end_inset

ft.
\end_layout

\begin_deeper
\begin_layout Standard
The 95% prediction interval is given by [
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesCI[3, 2]}
\end_layout

\end_inset

, 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesCI[3, 3]}
\end_layout

\end_inset

], so with 95% confidence we may assert that the hypothetical 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 of a tree of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
 12.5
\begin_inset space \thinspace{}
\end_inset

in and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset


\color inherit
 87
\begin_inset space \thinspace{}
\end_inset

ft would lie somewhere between 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesCI[3, 2]}
\end_layout

\end_inset

 cubic feet and 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesCI[3, 3]}
\end_layout

\end_inset

 feet.
\end_layout

\end_deeper
\end_deeper
\begin_layout Section
Model Utility and Inference
\begin_inset CommandInset label
LatexCommand label
name "sec:Model-Utility-and-MLR"

\end_inset


\end_layout

\begin_layout Subsection
Multiple Coefficient of Determination
\end_layout

\begin_layout Standard
We saw in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:mlr-mse-se"

\end_inset

 that the error sum of squares 
\begin_inset Formula $SSE$
\end_inset

 can be conveniently written in MLR as 
\begin_inset Formula \begin{equation}
SSE=\mathbf{Y}^{\mathrm{T}}(\mathbf{I}-\mathbf{H})\mathbf{Y}.\label{eq:mlr-sse-matrix}\end{equation}

\end_inset

It turns out that there are equally convenient formulas for the total sum
 of squares 
\begin_inset Formula $SSTO$
\end_inset

 and the regression sum of squares 
\begin_inset Formula $SSR$
\end_inset

.
 They are :
\begin_inset Formula \begin{alignat}{1}
SSTO= & \mathbf{Y}^{\mathrm{T}}\left(\mathbf{I}-\frac{1}{n}\mathbf{J}\right)\mathbf{Y}\label{eq:mlr-ssto-matrix}\end{alignat}

\end_inset

and
\begin_inset Formula \begin{alignat}{1}
SSR= & \mathbf{Y}^{\mathrm{T}}\left(\mathbf{H}-\frac{1}{n}\mathbf{J}\right)\mathbf{Y}.\label{eq:mlr-ssr-matrix}\end{alignat}

\end_inset

(The matrix 
\begin_inset Formula $\mathbf{J}$
\end_inset

 is defined in Appendix 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Linear-Algebra"

\end_inset

.) Immediately from Equations 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:mlr-sse-matrix"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:mlr-ssto-matrix"

\end_inset

, and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:mlr-ssr-matrix"

\end_inset

 we get the 
\emph on
Anova Equality
\emph default

\begin_inset Formula \begin{equation}
SSTO=SSE+SSR.\end{equation}

\end_inset

(See Exercise 
\begin_inset CommandInset ref
LatexCommand ref
reference "xca:anova-equality"

\end_inset

.) We define the 
\emph on
multiple coefficient of determination
\emph default
 by the formula
\begin_inset Formula \begin{equation}
R^{2}=1-\frac{SSE}{SSTO}.\end{equation}

\end_inset


\end_layout

\begin_layout Standard
We interpret 
\begin_inset Formula $R^{2}$
\end_inset

 as the proportion of total variation that is explained by the multiple
 regression model.
 In MLR we must be careful, however, because the value of 
\begin_inset Formula $R^{2}$
\end_inset

 can be artificially inflated by the addition of explanatory variables to
 the model, regardless of whether or not the added variables are useful
 with respect to prediction of the response variable.
 In fact, it can be proved that the addition of a single explanatory variable
 to a regression model will increase the value of 
\begin_inset Formula $R^{2}$
\end_inset

, 
\emph on
no matter how worthless
\emph default
 the explanatory variable is.
 We could model the height of the ocean tides, then add a variable for the
 length of cheetah tongues on the Serengeti plain, and our 
\begin_inset Formula $R^{2}$
\end_inset

 would inevitably increase.
\end_layout

\begin_layout Standard
This is a problem, because as the philosopher, Occam, once said: 
\begin_inset Quotes eld
\end_inset

causes should not be multiplied beyond necessity
\begin_inset Quotes erd
\end_inset

.
 We address the problem by penalizing 
\begin_inset Formula $R^{2}$
\end_inset

 when parameters are added to the model.
 The result is an 
\emph on
adjusted 
\begin_inset Formula $R^{2}$
\end_inset


\emph default
 which we denote by 
\begin_inset Formula $\overline{R}^{2}$
\end_inset

.
\begin_inset Formula \begin{equation}
\overline{R}^{2}=\left(R^{2}-\frac{p}{n-1}\right)\left(\frac{n-1}{n-p-1}\right).\end{equation}

\end_inset

It is good practice for the statistician to weigh both 
\begin_inset Formula $R^{2}$
\end_inset

 and 
\begin_inset Formula $\overline{R}^{2}$
\end_inset

 during assessment of model utility.
 In many cases their values will be very close to each other.
 If their values differ substantially, or if one changes dramatically when
 an explanatory variable is added, then (s)he should take a closer look
 at the explanatory variables in the model.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
For the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset


\color inherit
 data, we can get 
\begin_inset Formula $R^{2}$
\end_inset

 and 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset Formula $\overline{R}^{2}$
\end_inset

 
\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
from the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary
\end_layout

\end_inset


\color inherit
 output or access the values directly by name as shown (recall that we stored
 the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary
\end_layout

\end_inset


\color inherit
 object in 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

treesumry
\end_layout

\end_inset


\color inherit
).
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

treesumry$r.squared
\begin_inset Newline newline
\end_inset

treesumry$adj.r.squared
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
High values of 
\begin_inset Formula $R^{2}$
\end_inset

 and 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset Formula $\overline{R}^{2}$
\end_inset

 such as these indicate that the model fits very well, which agrees with
 what we saw in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:3D-scatterplot-trees"

\end_inset

.
\end_layout

\begin_layout Subsection
Overall 
\emph on
F
\emph default
-Test
\begin_inset CommandInset label
LatexCommand label
name "sub:mlr-Overall-F-Test"

\end_inset


\end_layout

\begin_layout Standard
Another way to assess the model's utility is to to test the hypothesis
\begin_inset Formula \[
H_{0}:\beta_{1}=\beta_{2}=\cdots=\beta_{p}=0\mbox{ versus }H_{1}:\mbox{ at least one \ensuremath{\beta_{i}\neq0}}.\]

\end_inset

The idea is that if all 
\begin_inset Formula $\beta_{i}$
\end_inset

's were zero, then the explanatory variables 
\begin_inset Formula $X_{1},\ldots,X_{p}$
\end_inset

 would be worthless predictors for the response variable 
\begin_inset Formula $Y$
\end_inset

.
 We can test the above hypothesis with the overall 
\begin_inset Formula $F$
\end_inset

 statistic, which in MLR is defined by
\begin_inset Formula \begin{equation}
F=\frac{SSR/p}{SSE/(n-p-1)}.\end{equation}

\end_inset

When the regression assumptions hold and under 
\begin_inset Formula $H_{0}$
\end_inset

, it can be shown that 
\begin_inset Formula $F\sim\mathsf{f}(\mathtt{df1}=p,\,\mathtt{df2}=n-p-1)$
\end_inset

.
 We reject 
\begin_inset Formula $H_{0}$
\end_inset

 when 
\begin_inset Formula $F$
\end_inset

 is large, that is, when the explained variation is large relative to the
 unexplained variation.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The overall 
\begin_inset Formula $F$
\end_inset

 statistic and its associated 
\emph on
p
\emph default
-value is listed at the bottom of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary
\end_layout

\end_inset


\color inherit
 output, or we can access it directly by name; it is stored in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

fstatistic
\end_layout

\end_inset

 component of the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary
\end_layout

\end_inset

 object.
 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

treesumry$fstatistic
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
For the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset


\color inherit
 data, we see that 
\begin_inset Formula $F=$
\end_inset

 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{treesumry$fstatistic[1]}
\end_layout

\end_inset

 with a 
\emph on
p
\emph default
-value 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

< 2.2e-16
\end_layout

\end_inset


\color inherit
.
 Consequently we reject 
\begin_inset Formula $H_{0}$
\end_inset

, that is, the data provide strong evidence that not all 
\begin_inset Formula $\beta_{i}$
\end_inset

's are zero.
\end_layout

\begin_layout Subsection
Student's 
\emph on
t
\emph default
 Tests
\begin_inset CommandInset label
LatexCommand label
name "sub:mlr-Student's-t-Tests"

\end_inset


\end_layout

\begin_layout Standard
We know that 
\begin_inset Formula \begin{equation}
\mathbf{b}\sim\mathsf{mvnorm}\left(\mathtt{mean}=\upbeta,\,\mathtt{sigma}=\sigma^{2}\left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{-1}\right)\end{equation}

\end_inset

and we have seen how to test the hypothesis 
\begin_inset Formula $H_{0}:\beta_{1}=\beta_{2}=\cdots=\beta_{p}=0$
\end_inset

, but let us now consider the test
\begin_inset Formula \begin{equation}
H_{0}:\beta_{i}=0\mbox{ versus }H_{1}:\beta_{i}\neq0,\end{equation}

\end_inset

where 
\begin_inset Formula $\beta_{i}$
\end_inset

 is the coefficient for the 
\begin_inset Formula $i$
\end_inset


\begin_inset Formula $^{\textrm{th}}$
\end_inset

 independent variable.
 We test the hypothesis by calculating a statistic, examining it's null
 distribution, and rejecting 
\begin_inset Formula $H_{0}$
\end_inset

 if the 
\emph on
p
\emph default
-value is small.
 If 
\begin_inset Formula $H_{0}$
\end_inset

 is rejected, then we conclude that there is a significant relationship
 between 
\begin_inset Formula $Y$
\end_inset

 and 
\begin_inset Formula $x_{i}$
\end_inset

 
\emph on
in the regression model
\emph default
 
\begin_inset Formula $Y\sim(x_{1},\ldots,x_{p})$
\end_inset

.
 This last part of the sentence is very important because the significance
 of the variable 
\begin_inset Formula $x_{i}$
\end_inset

 sometimes depends on the presence of other independent variables in the
 model
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
In other words, a variable might be highly significant one moment but then
 fail to be significant when another variable is added to the model.
 When this happens it often indicates a problem with the explanatory variables,
 such as 
\emph on
multicollinearity
\emph default
.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Multicollinearity"

\end_inset

.
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Standard
To test the hypothesis we go to find the sampling distribution of 
\begin_inset Formula $b_{i},$
\end_inset

 the estimator of the corresponding parameter 
\begin_inset Formula $\beta_{i}$
\end_inset

, when the null hypothesis is true.
 We saw in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:mlr-interval-est-params"

\end_inset

 that 
\begin_inset Formula \begin{equation}
T_{i}=\frac{b_{i}-\beta_{i}}{S_{b_{i}}}\end{equation}

\end_inset

has a Student's 
\begin_inset Formula $t$
\end_inset

 distribution with 
\begin_inset Formula $n-(p+1)$
\end_inset

 degrees of freedom.
 (Remember, we are estimating 
\begin_inset Formula $p+1$
\end_inset

 parameters.) Consequently, under the null hypothesis 
\begin_inset Formula $H_{0}:\beta_{i}=0$
\end_inset

 the statistic 
\begin_inset Formula $t_{i}=b_{i}/S_{b_{i}}$
\end_inset

 has a 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=n-p-1)$
\end_inset

 distribution.
\end_layout

\begin_layout Subsection
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The Student's 
\begin_inset Formula $t$
\end_inset

 tests for significance of the individual explanatory variables are shown
 in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary
\end_layout

\end_inset


\color inherit
 output.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

treesumry
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We see from the 
\emph on
p
\emph default
-values that there is a significant linear relationship between 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
 and between 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset


\color inherit
 in the 
\color none
regression model 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume ~ Girth + Height
\end_layout

\end_inset


\color inherit
.
 Further, it appears that the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Intercept
\end_layout

\end_inset


\color inherit
 is significant in the aforementioned model.
\end_layout

\begin_layout Section
Polynomial Regression
\begin_inset CommandInset label
LatexCommand label
name "sec:Polynomial-Regression"

\end_inset


\end_layout

\begin_layout Subsection
Quadratic Regression Model
\end_layout

\begin_layout Standard
In each of the previous sections we assumed that 
\begin_inset Formula $\mu$
\end_inset

 was a linear function of the explanatory variables.
 For example, in SLR we assumed that 
\begin_inset Formula $\mu(x)=\beta_{0}+\beta_{1}x$
\end_inset

, and in our previous MLR examples we assumed 
\begin_inset Formula $\mu(x_{1},x_{2})=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}$
\end_inset

.
 In every case the scatterplots indicated that our assumption was reasonable.
 Sometimes, however, plots of the data suggest that the linear model is
 incomplete and should be modified.
 
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 6>>=
\begin_inset Newline newline
\end_inset

plot(Volume ~ Girth, data = trees)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Scatterplot of 
\family typewriter
Volume
\family default
 versus 
\family typewriter
Girth
\family default
 for the 
\family typewriter
trees
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:Scatterplot-Volume-Girth-trees"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
For example, let us examine a scatterplot of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset

 versus 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
 a little more closely.
 See Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Scatterplot-Volume-Girth-trees"

\end_inset

.
 There might be a slight curvature to the data; the volume curves ever so
 slightly upward as the girth increases.
 After looking at the plot we might try to capture the curvature with a
 mean response such as 
\begin_inset Formula \begin{equation}
\mu(x_{1})=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{1}^{2}.\end{equation}

\end_inset

The model associated with this choice of 
\begin_inset Formula $\mu$
\end_inset

 is
\begin_inset Formula \begin{equation}
Y=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{1}^{2}+\epsilon.\end{equation}

\end_inset

The regression assumptions are the same.
 Almost everything indeed is the same.
 In fact, it is still called a 
\begin_inset Quotes eld
\end_inset

linear regression model
\begin_inset Quotes erd
\end_inset

, since the mean response 
\begin_inset Formula $\mu$
\end_inset

 is linear 
\emph on
in the parameters
\emph default
 
\begin_inset Formula $\beta_{0}$
\end_inset

, 
\begin_inset Formula $\beta_{1}$
\end_inset

, and 
\begin_inset Formula $\beta_{2}$
\end_inset

.
 
\end_layout

\begin_layout Standard

\series bold
\shape smallcaps
However, there is one important difference.

\series default
\shape default
 When we introduce the squared variable in the model we inadvertently also
 introduce strong dependence between the terms which can cause significant
 numerical problems when it comes time to calculate the parameter estimates.
 Therefore, we should usually rescale the independent variable to have mean
 zero (and even variance one if we wish) 
\series bold
\shape smallcaps
before
\series default
\shape default
 fitting the model.
 That is, we replace the 
\begin_inset Formula $x_{i}$
\end_inset

's with 
\begin_inset Formula $x_{i}-\xbar$
\end_inset

 (or 
\begin_inset Formula $(x_{i}-\xbar)/s$
\end_inset

) before fitting the model
\begin_inset Foot
status open

\begin_layout Plain Layout
Rescaling the data gets the job done but a better way to avoid the multicollinea
rity introduced by the higher order terms is with 
\emph on
orthogonal polynomials
\emph default
, whose coefficients are chosen just right so that the polynomials are not
 correlated with each other.
 This is beginning to linger outside the scope of this book, however, so
 we will content ourselves with a brief mention and then stick with the
 rescaling approach in the discussion that follows.
 A nice example of orthogonal polynomials in action can be run with 
\family typewriter
example(cars)
\family default
.
\end_layout

\end_inset

.
\end_layout

\begin_layout Subsection*
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
There are multiple ways to fit a quadratic model to the variables 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
 using 
\family sans
R
\family default
.
\end_layout

\begin_layout Enumerate
One way would be to square the values for 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
 and save them in a vector 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girthsq
\end_layout

\end_inset


\color inherit
.
 Next, fit the linear model 
\color none

\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume ~ Girth + Girthsq
\end_layout

\end_inset

.
\end_layout

\begin_layout Enumerate
A second way would be to use the 
\emph on
insulate
\emph default
 function in 
\family sans
R
\family default
, denoted by 
\color none

\begin_inset listings
lstparams "basicstyle={\ttfamily}"
inline true
status open

\begin_layout Plain Layout

I
\end_layout

\end_inset


\color inherit
:
\end_layout

\begin_deeper
\begin_layout Standard

\color none
\begin_inset listings
lstparams "showstringspaces=false"
inline false
status open

\begin_layout Plain Layout

Volume ~ Girth + I(Girth^2)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
The second method is shorter than the first but the end result is the same.
 And once we calculate and store the fitted model (in, say, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

treesquad.lm
\end_layout

\end_inset


\color inherit
) all of the previous comments regarding 
\family sans
R
\family default
 apply.
\end_layout

\end_deeper
\begin_layout Enumerate
A third and 
\begin_inset Quotes eld
\end_inset

right
\begin_inset Quotes erd
\end_inset

 way to do it is with orthogonal polynomials: 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline false
status open

\begin_layout Plain Layout

Volume ~ poly(Girth, degree = 2)
\end_layout

\end_inset


\color inherit
See 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?poly
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?cars
\end_layout

\end_inset

 for more information.
 Note that we can recover the approach in 2 with 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

poly(Girth, degree = 2, raw = TRUE)
\end_layout

\end_inset

.
 
\end_layout

\begin_layout Example
We will fit the quadratic model to the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset


\color inherit
 data and display the results with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

summary
\end_layout

\end_inset

, being careful to rescale the data before fitting the model.
 We may rescale the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset

 variable to have zero mean and unit variance on-the-fly with the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

scale
\end_layout

\end_inset

 function.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

treesquad.lm <- lm(Volume ~ scale(Girth) + I(scale(Girth)^2), data = trees)
\begin_inset Newline newline
\end_inset

summary(treesquad.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We see that the 
\begin_inset Formula $F$
\end_inset

 statistic indicates the overall model including 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth^2
\end_layout

\end_inset


\color inherit
 is significant.
 Further, there is strong evidence that 
\color none
both 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth^2
\end_layout

\end_inset

 
\color inherit
are significantly related to 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
.
 We may examine a scatterplot together with the fitted quadratic function
 using the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lines
\end_layout

\end_inset


\color inherit
 function, which adds a line to the plot tracing the estimated mean response.
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

plot(Volume ~ scale(Girth), data = trees)
\begin_inset Newline newline
\end_inset

lines(fitted(treesquad.lm) ~ scale(Girth), data = trees)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The plot is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "cap:Fitting-the-Quadratic"

\end_inset

.
 Pay attention to the scale on the 
\begin_inset Formula $x$
\end_inset

-axis: it is on the scale of the transformed 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset

 data and not on the original scale.
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 6>>=
\begin_inset Newline newline
\end_inset

plot(Volume ~ scale(Girth), data = trees)
\begin_inset Newline newline
\end_inset

lines(fitted(treesquad.lm) ~ scale(Girth), data = trees)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
A quadratic model for the 
\family typewriter
trees
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "cap:Fitting-the-Quadratic"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Remark
When a model includes a quadratic term for an independent variable, it is
 customary to also include the linear term in the model.
 The principle is called 
\emph on
parsimony
\emph default
.
 More generally, if the researcher decides to include 
\begin_inset Formula $x^{m}$
\end_inset

 as a term in the model, then (s)he should also include all lower order
 terms 
\begin_inset Formula $x$
\end_inset

, 
\begin_inset Formula $x^{2}$
\end_inset

, \SpecialChar \ldots{}
,
\begin_inset Formula $x^{m-1}$
\end_inset

 in the model.
 
\end_layout

\begin_layout Standard
We do estimation/prediction the same way that we did in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:mlr-point-est-regsurface"

\end_inset

, except we do not need a 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset

 
\color inherit
column in the dataframe 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

new
\end_layout

\end_inset


\color inherit
 since the variable is not included in the quadratic model.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

new <- data.frame(Girth = c(9.1, 11.6, 12.5))
\begin_inset Newline newline
\end_inset

predict(treesquad.lm, newdata = new, interval = "prediction")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The predictions and intervals are slightly different from what they were
 previously.
 Notice that it was not necessary to rescale the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset

 prediction data before input to the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

predict
\end_layout

\end_inset

 function; the model did the rescaling for us automatically.
\end_layout

\begin_layout Remark
We have mentioned on several occasions that it is important to rescale the
 explanatory variables for polynomial regression.
 Watch what happens if we ignore this advice:
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

summary(lm(Volume ~ Girth + I(Girth^2), data = trees))
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Remark
Now nothing is significant in the model except 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth^2
\end_layout

\end_inset


\color inherit
.
 We could delete the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Intercept
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset

 from the model, but the model would no longer be 
\emph on
\color inherit
parsimonious
\emph default
\color none
.

\color inherit
 A novice may see the output and be confused about how to proceed, while
 the seasoned statistician recognizes immediately that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth^2
\end_layout

\end_inset


\color inherit
 are highly correlated (see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Multicollinearity"

\end_inset

).
 The only remedy to this ailment is to rescale 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
, which we should have done in the first place.
\end_layout

\begin_layout Remark
In Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:mlr-trees-poly-no-rescale"

\end_inset

 of Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Partial-F-Statistic"

\end_inset

 we investigate this issue further.
\end_layout

\begin_layout Section
Interaction
\begin_inset CommandInset label
LatexCommand label
name "sec:Interaction"

\end_inset


\end_layout

\begin_layout Standard
In our model for tree volume there have been two independent variables:
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset

.

\color inherit
 We may suspect that the independent variables are related, that is, values
 of one variable may tend to influence values of the other.
 It may be desirable to include an additional term in our model to try and
 capture the dependence between the variables.
 Interaction terms are formed by multiplying one (or more) explanatory variable(
s) by another.
 
\end_layout

\begin_layout Example
Perhaps the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset


\color inherit
 of the tree interact to influence the its 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset

; w
\color inherit
e would like to investigate whether the model (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
 = 
\begin_inset Formula $x_{1}$
\end_inset

 and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset


\color inherit
 = 
\begin_inset Formula $x_{2}$
\end_inset

) 
\begin_inset Formula \begin{equation}
Y=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}+\epsilon\end{equation}

\end_inset

would be significantly improved by the model
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
Y=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{2}+\beta_{1:2}x_{1}x_{2}+\epsilon,\end{equation}

\end_inset

where the subscript 
\begin_inset Formula $1:2$
\end_inset

 denotes that 
\begin_inset Formula $\beta_{1:2}$
\end_inset

 is a coefficient of an interaction term between 
\begin_inset Formula $x{}_{1}$
\end_inset

 and 
\begin_inset Formula $x_{2}$
\end_inset

.
 
\end_layout

\begin_layout Paragraph*
What does it mean?
\end_layout

\begin_layout Standard
Consider the mean response 
\begin_inset Formula $\mu(x_{1},x_{2})$
\end_inset

 as a function of 
\begin_inset Formula $x_{2}$
\end_inset

:
\begin_inset Formula \begin{equation}
\mu(x_{2})=(\beta_{0}+\beta_{1}x_{1})+\beta_{2}x_{2}.\end{equation}

\end_inset

This is a linear function of 
\begin_inset Formula $x_{2}$
\end_inset

 with slope 
\begin_inset Formula $\beta_{2}$
\end_inset

.
 As 
\begin_inset Formula $x_{1}$
\end_inset

 changes, the 
\begin_inset Formula $y$
\end_inset

-intercept of the mean response in 
\begin_inset Formula $x_{2}$
\end_inset

 changes, but the slope remains the same.
 Therefore, the mean response in 
\begin_inset Formula $x_{2}$
\end_inset

 is represented by a collection of parallel lines all with common slope
 
\begin_inset Formula $\beta_{2}$
\end_inset

.
\end_layout

\begin_layout Standard
Now think about what happens when the interaction term 
\begin_inset Formula $\beta_{1:2}x_{1}x_{2}$
\end_inset

 is included.
 The mean response in 
\begin_inset Formula $x_{2}$
\end_inset

 now looks like
\begin_inset Formula \begin{equation}
\mu(x_{2})=(\beta_{0}+\beta_{1}x_{1})+(\beta_{2}+\beta_{1:2}x_{1})x_{2}.\end{equation}

\end_inset

In this case we see that not only the 
\begin_inset Formula $y$
\end_inset

-intercept changes when 
\begin_inset Formula $x_{1}$
\end_inset

 varies, but the slope also changes in 
\begin_inset Formula $x_{1}$
\end_inset

.
 Thus, the interaction term allows the slope of the mean response in 
\begin_inset Formula $x_{2}$
\end_inset

 to increase and decrease as 
\begin_inset Formula $x_{1}$
\end_inset

 varies.
\end_layout

\begin_layout Subsection*
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
There are several ways to introduce an interaction term into the model.
\end_layout

\begin_layout Enumerate
Make a new variable 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prod <- Girth * Height
\end_layout

\end_inset

, then
\color inherit
 include 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

prod
\end_layout

\end_inset


\color inherit
 in the model formula 
\color none

\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume ~ Girth + Height + prod
\end_layout

\end_inset


\color inherit
.
 This method is perhaps the most transparent, but it also reserves memory
 space unnecessarily.
\end_layout

\begin_layout Enumerate
Once can construct an interaction term directly in 
\family sans
R
\family default
 with a colon 
\begin_inset Quotes eld
\end_inset


\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

:
\end_layout

\end_inset


\color inherit

\begin_inset Quotes erd
\end_inset

.
 For this example, the model formula would look like 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume ~ Girth + Height + Girth:Height
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
For the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset


\color inherit
 data, we fit the model with the interaction using method two and see if
 it is significant:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

treesint.lm <- lm(Volume ~ Girth + Height + Girth:Height, data = trees)
\begin_inset Newline newline
\end_inset

summary(treesint.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We can see from the output that the interaction term is highly significant.
 Further, the estimate 
\begin_inset Formula $b_{1:2}$
\end_inset

 is positive.
 This means that the slope of 
\begin_inset Formula $\mu(x_{2})$
\end_inset

 is steeper for bigger values of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
.
 Keep in mind: the same interpretation holds for 
\begin_inset Formula $\mu(x_{1})$
\end_inset

; that is, the slope of 
\begin_inset Formula $\mu(x_{1})$
\end_inset

 is steeper for bigger values of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Standard
For the sake of completeness we calculate confidence intervals for the parameter
s and do prediction as before.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

confint(treesint.lm)
\begin_inset Newline newline
\end_inset

new <- data.frame(Girth = c(9.1, 11.6, 12.5), Height = c(69, 74, 87))
\begin_inset Newline newline
\end_inset

predict(treesint.lm, newdata = new, interval = "prediction")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Remark
There are two other ways to include interaction terms in model formulas.
 For example, we could have written 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth * Height
\end_layout

\end_inset

 or even 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

(Girth + Height)^2
\end_layout

\end_inset

 and both would be the same as 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth + Height + Girth:Height
\end_layout

\end_inset

.
\end_layout

\begin_layout Standard
These examples can be generalized to more than two independent variables,
 say three, four, or even more.
 We may be interested in seeing whether any pairwise interactions are significan
t.
 We do this with a model formula that looks something like
\family typewriter
 
\family default
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

y ~ (x1 + x2 + x3 + x4)^2
\end_layout

\end_inset

.

\color inherit
 
\end_layout

\begin_layout Section
Qualitative Explanatory Variables
\begin_inset CommandInset label
LatexCommand label
name "sec:Qualitative-Explanatory-Variables"

\end_inset


\end_layout

\begin_layout Standard
We have so far been concerned with numerical independent variables taking
 values in a subset of real numbers.
 In this section, we extend our treatment to include the case in which one
 of the explanatory variables is qualitative, that is, a 
\emph on
factor
\emph default
.
 Qualitative variables take values in a set of 
\emph on
levels
\emph default
, which may or may not be ordered.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Qualitative-Data"

\end_inset

.
\end_layout

\begin_layout Note*
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset


\color inherit
 data do not have any qualitative explanatory variables, so we will construct
 one for illustrative purposes
\begin_inset Foot
status open

\begin_layout Plain Layout
This procedure of replacing a continuous variable by a discrete/qualitative
 one is called 
\emph on
binning
\emph default
, and is almost 
\emph on
never
\emph default
 the right thing to do.
 We are in a bind at this point, however, because we have invested this
 chapter in the 
\family typewriter
trees
\family default
 data and I do not want to switch mid-discussion.
 I am currently searching for a data set with pre-existing qualitative variables
 that also conveys the same points present in the trees data, and when I
 find it I will update this chapter accordingly.
\end_layout

\end_inset

.
 We will leave the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
 variable alone, but we will replace the variable 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset

 by a new variable
\color inherit
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tall
\end_layout

\end_inset


\color inherit
 which indicates whether or not the cherry tree is taller than a certain
 threshold (which for the sake of argument will be the sample median height
 of 76
\begin_inset space \thinspace{}
\end_inset

ft).
 That is, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tall
\end_layout

\end_inset


\color inherit
 will be defined by
\begin_inset Formula \begin{equation}
\mathtt{Tall}=\begin{cases}
\mathtt{yes}, & \mbox{if }\mathtt{Height}>76,\\
\mathtt{no}, & \mbox{if }\mathtt{Height}\leq76.\end{cases}\end{equation}

\end_inset

We can construct 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tall
\end_layout

\end_inset


\color inherit
 very quickly in 
\family sans
R
\family default
 with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

cut
\end_layout

\end_inset

 function:
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

trees$Tall <- cut(trees$Height, breaks = c(-Inf, 76, Inf), labels = c("no","yes"
))
\begin_inset Newline newline
\end_inset

trees$Tall[1:5]
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Note that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tall
\end_layout

\end_inset


\color inherit
 is automatically generated to be a factor with the labels in the correct
 order.
 See 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?cut
\end_layout

\end_inset

 for more.
 
\end_layout

\end_deeper
\begin_layout Standard
Once we have 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tall
\end_layout

\end_inset

,
\color inherit
 we include it in the regression model just like we would any other variable.
 It is handled internally in a special way.
 Define a 
\begin_inset Quotes eld
\end_inset

dummy variable
\begin_inset Quotes erd
\end_inset

 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tallyes
\end_layout

\end_inset


\color inherit
 that takes values
\begin_inset Formula \begin{equation}
\mathtt{Tallyes}=\begin{cases}
1, & \mbox{if }\mathtt{Tall}=\mathtt{yes},\\
0, & \mbox{otherwise.}\end{cases}\end{equation}

\end_inset

That is, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tallyes
\end_layout

\end_inset


\color inherit
 is an 
\emph on
indicator
\emph default
 
\emph on
variable
\emph default
 which indicates when a respective tree is tall.
 The model may now be written as 
\begin_inset Formula \begin{equation}
\mathtt{Volume}=\beta_{0}+\beta_{1}\mathtt{Girth}+\beta_{2}\mathtt{Tallyes}+\epsilon.\end{equation}

\end_inset

Let us take a look at what this definition does to the mean response.
 Trees with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tall = yes
\end_layout

\end_inset

 will have the mean response
\begin_inset Formula \begin{equation}
\mu(\mathtt{Girth})=(\beta_{0}+\beta_{2})+\beta_{1}\mathtt{Girth},\end{equation}

\end_inset

while 
\color inherit
trees with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tall = no
\end_layout

\end_inset

 will have the mean response
\begin_inset Formula \begin{equation}
\mu(\mathtt{Girth})=\beta_{0}+\beta_{1}\mathtt{Girth}.\end{equation}

\end_inset

In essence, we are fitting two regression lines: one for tall trees, and
 one for short trees.
 The regression lines have the same slope but they have different 
\begin_inset Formula $y$
\end_inset

 intercepts (which are exactly 
\begin_inset Formula $|\beta_{2}|$
\end_inset

 far apart).
\end_layout

\begin_layout Subsection*
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The important thing is to double check that the qualitative variable in
 question is stored as a factor.
 The way to check is with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

class
\end_layout

\end_inset

 command.
 For example,
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

class(trees$Tall)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
If the qualitative variable is not yet stored as a factor then we may convert
 it to one with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

factor
\end_layout

\end_inset


\color inherit
 command.
 See Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:Qualitative-Data"

\end_inset

.
 Other than this we perform MLR as we normally would.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

treesdummy.lm <- lm(Volume ~ Girth + Tall, data = trees)
\begin_inset Newline newline
\end_inset

summary(treesdummy.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
From the output we see that all parameter estimates are statistically significan
t and we conclude that the mean response differs for trees with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tall = yes
\end_layout

\end_inset


\color inherit
 and trees with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tall = no
\end_layout

\end_inset


\color inherit
.
 
\end_layout

\begin_layout Remark
We were somewhat disingenuous when we defined the dummy variable 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tallyes
\end_layout

\end_inset

 because, in truth, 
\family sans
\color inherit
R
\family default
\color none
 defines 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tallyes
\end_layout

\end_inset

 automatically without input from the user
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
That is, 
\family sans
R
\family default
 by default handles contrasts according to its internal settings which may
 be customized by the user for fine control.
 Given that we will not investigate contrasts further in this book it does
 not serve the discussion to delve into those settings, either.
 The interested reader should check ?contrasts for details.
\end_layout

\end_inset

.
 Indeed, the author fit the model beforehand and wrote the discussion afterward
 with the knowledge of what 
\family sans
\color inherit
R
\family default
\color none
 would do so that the output the reader saw would match what (s)he had previousl
y read.
 The way that 
\family sans
\color inherit
R
\family default
\color none
 handles factors internally is part of a much larger topic concerning 
\emph on
\color inherit
contrasts
\emph default
\color none
, which falls outside the scope of this book.
 The interested reader should see 
\color inherit
Neter et al 
\begin_inset CommandInset citation
LatexCommand cite
key "Neter1996"

\end_inset


\color none
 or Fox 
\begin_inset CommandInset citation
LatexCommand cite
key "Fox1997"

\end_inset

 for more.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Remark
In general, if an explanatory variable 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

foo
\end_layout

\end_inset


\color inherit
 is qualitative with 
\begin_inset Formula $n$
\end_inset

 levels 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

bar1
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

bar2
\end_layout

\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

barn
\end_layout

\end_inset


\color inherit
 then 
\family sans
R
\family default
 will by default automatically define 
\begin_inset Formula $n-1$
\end_inset

 indicator variables in the following way:
\begin_inset Formula \begin{eqnarray*}
\mathtt{foobar2} & = & \begin{cases}
1, & \mbox{if }\mathtt{foo}=\mathtt{"bar2"},\\
0, & \mbox{otherwise.}\end{cases},\,\ldots,\,\mathtt{foobarn}=\begin{cases}
1, & \mbox{if }\mathtt{foo}=\mathtt{"barn"},\\
0, & \mbox{otherwise.}\end{cases}\end{eqnarray*}

\end_inset

The level 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

bar1
\end_layout

\end_inset


\color inherit
 is represented by 
\begin_inset Formula $\mathtt{foobar2}=\cdots=\mathtt{foobarn}=0$
\end_inset

.
 We just need to make sure that 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

foo
\end_layout

\end_inset


\color inherit
 is stored as a factor and 
\family sans
R
\family default
 will take care of the rest.
\end_layout

\begin_layout Subsection*
Graphing the Regression Lines
\end_layout

\begin_layout Standard
We can see a plot of the two regression lines with the following mouthful
 of code.
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

treesTall <- split(trees, trees$Tall)
\begin_inset Newline newline
\end_inset

treesTall[["yes"]]$Fit <- predict(treesdummy.lm, treesTall[["yes"]])
\begin_inset Newline newline
\end_inset

treesTall[["no"]]$Fit <- predict(treesdummy.lm, treesTall[["no"]])
\begin_inset Newline newline
\end_inset

plot(Volume ~ Girth, data = trees, type = "n")
\begin_inset Newline newline
\end_inset

points(Volume ~ Girth, data = treesTall[["yes"]], pch = 1)
\begin_inset Newline newline
\end_inset

points(Volume ~ Girth, data = treesTall[["no"]], pch = 2)
\begin_inset Newline newline
\end_inset

lines(Fit ~ Girth, data = treesTall[["yes"]])
\begin_inset Newline newline
\end_inset

lines(Fit ~ Girth, data = treesTall[["no"]])
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 6>>=
\begin_inset Newline newline
\end_inset

treesTall <- split(trees, trees$Tall)
\begin_inset Newline newline
\end_inset

treesTall[["yes"]]$Fit <- predict(treesdummy.lm, treesTall[["yes"]])
\begin_inset Newline newline
\end_inset

treesTall[["no"]]$Fit <- predict(treesdummy.lm, treesTall[["no"]])
\begin_inset Newline newline
\end_inset

plot(Volume ~ Girth, data = trees, type = "n")
\begin_inset Newline newline
\end_inset

points(Volume ~ Girth, data = treesTall[["yes"]], pch = 1)
\begin_inset Newline newline
\end_inset

points(Volume ~ Girth, data = treesTall[["no"]], pch = 2)
\begin_inset Newline newline
\end_inset

lines(Fit ~ Girth, data = treesTall[["yes"]])
\begin_inset Newline newline
\end_inset

lines(Fit ~ Girth, data = treesTall[["no"]])
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
A dummy variable model for the 
\family typewriter
trees
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:dummy-variable-trees"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
It may look intimidating but there is reason to the madness.
 First we 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

split
\end_layout

\end_inset

 the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset

 data into two pieces, with groups determined by the
\color inherit
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tall
\end_layout

\end_inset


\color inherit
 variable.
 Next we add the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Fit
\end_layout

\end_inset


\color inherit
ted values to each piece via 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

predict
\end_layout

\end_inset


\color inherit
.
 Then we set up a 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

plot
\end_layout

\end_inset


\color inherit
 for the variables 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume
\end_layout

\end_inset


\color inherit
 versus 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset


\color inherit
, but we do not plot anything yet (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

type = 
\begin_inset Quotes eld
\end_inset

n
\begin_inset Quotes erd
\end_inset


\end_layout

\end_inset


\color inherit
) because we want to use different symbols for the two groups.
 Next we add 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

points
\end_layout

\end_inset

 to the
\color inherit
 plot for the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tall = yes
\end_layout

\end_inset


\color inherit
 trees and use an open circle for a plot character (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

pch = 1
\end_layout

\end_inset


\color inherit
), followed by 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

points
\end_layout

\end_inset


\color inherit
 for the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Tall = no
\end_layout

\end_inset


\color inherit
 trees with a triangle character (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

pch = 2
\end_layout

\end_inset


\color inherit
).
 Finally, we add regression 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lines
\end_layout

\end_inset

 to the
\color inherit
 plot, one for each group.
\end_layout

\begin_layout Standard
There are other -- shorter -- ways to plot regression lines by groups, namely
 the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

scatterplot
\end_layout

\end_inset

 function in the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

car
\end_layout

\end_inset

 
\begin_inset CommandInset citation
LatexCommand cite
key "car"

\end_inset

 package and the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

xyplot
\end_layout

\end_inset

 function in the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lattice
\end_layout

\end_inset

 package.
 We elected to introduce the reader to the above approach since many advanced
 plots in 
\family sans
\color inherit
R
\family default
\color none
 are done in a similar, consecutive fashion.
\end_layout

\begin_layout Section
Partial 
\emph on
F
\emph default
 Statistic
\begin_inset CommandInset label
LatexCommand label
name "sec:Partial-F-Statistic"

\end_inset


\end_layout

\begin_layout Standard
We saw in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:mlr-Overall-F-Test"

\end_inset

 how to test 
\begin_inset Formula $H_{0}:\beta_{0}=\beta_{1}=\cdots=\beta_{p}=0$
\end_inset

 with the overall 
\begin_inset Formula $F$
\end_inset

 statistic and we saw in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:mlr-Student's-t-Tests"

\end_inset

 how to test 
\begin_inset Formula $H_{0}:\beta_{i}=0$
\end_inset

 that a particular coefficient 
\begin_inset Formula $\beta_{i}$
\end_inset

 is zero.
 Sometimes, however, we would like to test whether a certain part of the
 model is significant.
 Consider the regression model
\begin_inset Formula \begin{equation}
Y=\beta_{0}+\beta_{1}x_{1}+\cdots+\beta_{j}x_{j}+\beta_{j+1}x_{j+1}+\cdots+\beta_{p}x_{p}+\epsilon,\end{equation}

\end_inset

 where 
\begin_inset Formula $j\geq1$
\end_inset

 and 
\begin_inset Formula $p\geq2$
\end_inset

.
 Now we wish to test the hypothesis
\begin_inset Formula \begin{equation}
H_{0}:\beta_{j+1}=\beta_{j+2}=\cdots=\beta_{p}=0\end{equation}

\end_inset

versus the alternative 
\begin_inset Formula \begin{equation}
H_{1}:\mbox{at least one of \ensuremath{\beta_{j+1},\ \beta_{j+2},\ ,\ldots,\beta_{p}\neq0}}.\end{equation}

\end_inset

The interpretation of 
\begin_inset Formula $H_{0}$
\end_inset

 is that none of the variables 
\begin_inset Formula $x_{j+1}$
\end_inset

, \SpecialChar \ldots{}
,
\begin_inset Formula $x_{p}$
\end_inset

 is significantly related to 
\begin_inset Formula $Y$
\end_inset

 and the interpretation of 
\begin_inset Formula $H_{1}$
\end_inset

 is that at least one of 
\begin_inset Formula $x_{j+1}$
\end_inset

, \SpecialChar \ldots{}
,
\begin_inset Formula $x_{p}$
\end_inset

 is significantly related to 
\begin_inset Formula $Y$
\end_inset

.
 In essence, for this hypothesis test there are two competing models under
 consideration:
\begin_inset Formula \begin{align}
\mbox{the full model:} & \quad y=\beta_{0}+\beta_{1}x_{1}+\cdots+\beta_{p}x_{p}+\epsilon,\\
\mbox{the reduced model:} & \quad y=\beta_{0}+\beta_{1}x_{1}+\cdots+\beta_{j}x_{j}+\epsilon,\end{align}

\end_inset

Of course, the full model will always explain the data 
\emph on
better
\emph default
 than the reduced model, but does the full model explain the data 
\emph on
significantly better
\emph default
 than the reduced model? This question is exactly what the partial 
\begin_inset Formula $F$
\end_inset

 statistic is designed to answer.
\end_layout

\begin_layout Standard
We first calculate 
\begin_inset Formula $SSE_{f}$
\end_inset

, the unexplained variation in the full model, and 
\begin_inset Formula $SSE_{r}$
\end_inset

, the unexplained variation in the reduced model.
 We base our test on the difference 
\begin_inset Formula $SSE_{r}-SSE_{f}$
\end_inset

 which measures the reduction in unexplained variation attributable to the
 variables 
\begin_inset Formula $x_{j+1}$
\end_inset

, \SpecialChar \ldots{}
,
\begin_inset Formula $x_{p}$
\end_inset

.
 In the full model there are 
\begin_inset Formula $p+1$
\end_inset

 parameters and in the reduced model there are 
\begin_inset Formula $j+1$
\end_inset

 parameters, which gives a difference of 
\begin_inset Formula $p-j$
\end_inset

 parameters (hence degrees of freedom).
 The partial 
\emph on
F
\emph default
 statistic is 
\begin_inset Formula \begin{equation}
F=\frac{(SSE_{r}-SSE_{f})/(p-j)}{SSE_{f}/(n-p-1)}.\end{equation}

\end_inset

It can be shown when the regression assumptions hold under 
\begin_inset Formula $H_{0}$
\end_inset

 that the partial 
\begin_inset Formula $F$
\end_inset

 statistic has an 
\begin_inset Formula $\mathsf{f}(\mathtt{df1}=p-j,\,\mathtt{df2}=n-p-1)$
\end_inset

 distribution.
 We calculate the 
\begin_inset Formula $p$
\end_inset

-value of the observed partial 
\begin_inset Formula $F$
\end_inset

 statistic and reject 
\begin_inset Formula $H_{0}$
\end_inset

 if the 
\begin_inset Formula $p$
\end_inset

-value is small.
\end_layout

\begin_layout Subsection*
How to do it with 
\family sans
R
\end_layout

\begin_layout Standard
The key ingredient above is that the two competing models are 
\emph on
nested
\emph default
 in the sense that the reduced model is entirely contained within the complete
 model.
 The way to test whether the improvement is significant is to compute 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lm
\end_layout

\end_inset


\color inherit
 objects both for the complete model and the reduced model then compare
 the answers with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

anova
\end_layout

\end_inset


\color inherit
 function.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:mlr-trees-poly-no-rescale"

\end_inset

For the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset


\color inherit
 data, let us fit a polynomial regression model and for the sake of argument
 we will ignore our own good advice and fail to rescale the explanatory
 variables.
 
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

treesfull.lm <- lm(Volume ~ Girth + I(Girth^2) + Height + I(Height^2), data
 = trees)
\begin_inset Newline newline
\end_inset

summary(treesfull.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Example
In this ill-formed model nothing is significant except 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth^2
\end_layout

\end_inset

.
 Let us continue down this path and suppose that we would like to try a
 reduced model which contains nothing but
\color inherit
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth^2
\end_layout

\end_inset


\color inherit
 (not even an 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Intercept
\end_layout

\end_inset


\color inherit
).
 Our two models are now
\begin_inset Formula \begin{align*}
\mbox{the full model:} & \quad Y=\beta_{0}+\beta_{1}x_{1}+\beta_{2}x_{1}^{2}+\beta_{3}x_{2}+\beta_{4}x_{2}^{2}+\epsilon,\\
\mbox{the reduced model:} & \quad Y=\beta_{1}x_{1}+\beta_{2}x_{1}^{2}+\epsilon,\end{align*}

\end_inset

We fit the reduced model with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

lm
\end_layout

\end_inset


\color inherit
 and store the results:
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

treesreduced.lm <- lm(Volume ~ -1 + Girth + I(Girth^2), data = trees)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Example
To delete the intercept from the model we used 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

-1
\end_layout

\end_inset


\color inherit
 in the model formula.
 Next we compare the two models with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

anova
\end_layout

\end_inset


\color inherit
 function.
 The convention is to list the models from smallest to largest.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

anova(treesreduced.lm, treesfull.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Example
We see from the output that the complete model is highly significant compared
 to the model that does not incorporate 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset

 or
\color inherit
 the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Intercept
\end_layout

\end_inset


\color inherit
.
 We wonder (with our tongue in our cheek) if the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height^2
\end_layout

\end_inset

 term in the full model is causing all of the trouble.
 We will fit an alternative reduced model that only deletes 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height^2
\end_layout

\end_inset

.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

treesreduced2.lm <- lm(Volume ~ Girth + I(Girth^2) + Height, data = trees)
\begin_inset Newline newline
\end_inset

anova(treesreduced2.lm, treesfull.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Example
In this case, the improvement to the reduced model that is attributable
 to 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height^2
\end_layout

\end_inset


\color inherit
 is not significant, so we can delete 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height^2
\end_layout

\end_inset


\color inherit
 from the model with a clear conscience.
 We notice that the 
\emph on
p
\emph default
-value for this latest partial 
\begin_inset Formula $F$
\end_inset

 test is 0.8865, which seems to be remarkably close to the 
\emph on
p
\emph default
-value we saw for the univariate 
\emph on
t
\emph default
 test 
\color none
of 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height^2
\end_layout

\end_inset


\color inherit
 at the beginning of this example.
 In fact, the 
\emph on
p
\emph default
-values are 
\emph on
exactly
\emph default
 the same.
 Perhaps now we gain some insight into the true meaning of the univariate
 tests.
\end_layout

\begin_layout Section
Residual Analysis and Diagnostic Tools
\begin_inset CommandInset label
LatexCommand label
name "sec:Residual-Analysis-MLR"

\end_inset


\end_layout

\begin_layout Standard
We encountered many, many diagnostic measures for simple linear regression
 in Sections 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Residual-Analysis-SLR"

\end_inset

 and 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Other-Diagnostic-Tools-SLR"

\end_inset

.
 All of these are valid in multiple linear regression, too, but there are
 some slight changes that we need to make for the multivariate case.
 We list these below, and apply them to the trees example.
 
\end_layout

\begin_layout Description
Shapiro-Wilk,
\begin_inset space ~
\end_inset

Breusch-Pagan,
\begin_inset space ~
\end_inset

Durbin-Watson: unchanged from SLR, but we are now equipped to talk about
 the Shapiro-Wilk test statistic for the residuals.
 It is defined by the formula 
\begin_inset Formula \begin{equation}
W=\frac{\mathbf{a}^{\mathrm{T}}\mathbf{E}^{\ast}}{\mathbf{E}^{\mathrm{T}}\mathbf{E}},\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{E}^{\ast}$
\end_inset

 is the sorted residuals and 
\begin_inset Formula $\mathbf{a}_{1\times\mathrm{n}}$
\end_inset

 is defined by 
\begin_inset Formula \begin{equation}
\mathbf{a}=\frac{\mathbf{m}^{\mathrm{T}}\mathbf{V}^{-1}}{\sqrt{\mathbf{m}^{\mathrm{T}}\mathbf{V}^{-1}\mathbf{V}^{-1}\mathbf{m}}},\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{m}_{\mathrm{n}\times1}$
\end_inset

 and 
\begin_inset Formula $\mathbf{V}_{\mathrm{n}\times\mathrm{n}}$
\end_inset

 are the mean and covariance matrix, respectively, of the order statistics
 from an 
\begin_inset Formula $\mathsf{mvnorm}\left(\mathtt{mean}=\mathbf{0},\,\mathtt{sigma}=\mathbf{I}\right)$
\end_inset

 distribution.
 
\end_layout

\begin_layout Description
Leverages: are defined to be the diagonal entries of the hat matrix 
\begin_inset Formula $\mathbf{H}$
\end_inset

 (which is why we called them 
\begin_inset Formula $h_{ii}$
\end_inset

 in Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:mlr-point-est-regsurface"

\end_inset

).
 The sum of the leverages is 
\begin_inset Formula $\mbox{tr}(\mathbf{H})=p+1$
\end_inset

.
 One rule of thumb considers a leverage extreme if it is larger than double
 the mean leverage value, which is 
\begin_inset Formula $2(p+1)/n$
\end_inset

, and another rule of thumb considers leverages bigger than 0.5 to indicate
 high leverage, while values between 0.3 and 0.5 indicate moderate leverage.
\end_layout

\begin_layout Description
Standardized
\begin_inset space ~
\end_inset

residuals: unchanged.
 Considered extreme if 
\begin_inset Formula $|R_{i}|>2$
\end_inset

.
\end_layout

\begin_layout Description
Studentized
\begin_inset space ~
\end_inset

residuals: compared to a 
\begin_inset Formula $\mathsf{t}(\mathtt{df}=n-p-2)$
\end_inset

 distribution.
 
\end_layout

\begin_layout Description
\begin_inset Formula $DFBETAS$
\end_inset

: The formula is generalized to
\begin_inset Formula \begin{equation}
(DFBETAS)_{j(i)}=\frac{b_{j}-b_{j(i)}}{S_{(i)}\sqrt{c_{jj}}},\quad j=0,\ldots p,\ i=1,\ldots,n,\end{equation}

\end_inset

where 
\begin_inset Formula $c_{jj}$
\end_inset

 is the 
\begin_inset Formula $j^{\mathrm{th}}$
\end_inset

 diagonal entry of 
\begin_inset Formula $(\mathbf{X}^{\mathrm{T}}\mathbf{X})^{-1}$
\end_inset

.
 Values larger than one for small data sets or 
\begin_inset Formula $2/\sqrt{n}$
\end_inset

 for large data sets should be investigated.
\end_layout

\begin_layout Description
\begin_inset Formula $DFFITS$
\end_inset

: unchanged.
 Larger than one in absolute value is considered extreme.
\end_layout

\begin_layout Description
Cook's
\begin_inset space ~
\end_inset


\begin_inset Formula $D$
\end_inset

: compared to an 
\begin_inset Formula $\mathsf{f}(\mathtt{df1}=p+1,\,\mathtt{df2}=n-p-1)$
\end_inset

 distribution.
 Observations falling higher than the 50
\begin_inset Formula $^{\textrm{th}}$
\end_inset

 percentile are extreme.
 
\end_layout

\begin_layout Standard
Note that plugging the value 
\begin_inset Formula $p=1$
\end_inset

 into the formulas will recover all of the ones we saw in Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:simple-linear-regression"

\end_inset

.
\end_layout

\begin_layout Section
Additional Topics
\begin_inset CommandInset label
LatexCommand label
name "sec:Additional-Topics-MLR"

\end_inset


\end_layout

\begin_layout Subsection
Nonlinear Regression
\end_layout

\begin_layout Standard
We spent the entire chapter talking about the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset

 data, and all of our models looked like 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Volume ~ Girth + Height
\end_layout

\end_inset

 or a variant of this model.
 But let us think again: we know from elementary school that the volume
 of a rectangle is 
\begin_inset Formula $V=lwh$
\end_inset

 and the volume of a cylinder (which is closer to what a black cherry tree
 looks like) is
\begin_inset Formula \begin{equation}
V=\pi r^{2}h\quad\mbox{or}\quad V=4\pi dh,\end{equation}

\end_inset

where 
\begin_inset Formula $r$
\end_inset

 and 
\begin_inset Formula $d$
\end_inset

 represent the radius and diameter of the tree, respectively.
 With this in mind, it would seem that a more appropriate model for 
\begin_inset Formula $\mu$
\end_inset

 might be
\begin_inset Formula \begin{equation}
\mu(x_{1},x_{2})=\beta_{0}x_{1}^{\beta_{1}}x_{2}^{\beta_{2}},\label{eq:trees-nonlin-reg}\end{equation}

\end_inset

where 
\begin_inset Formula $\beta_{1}$
\end_inset

 and 
\begin_inset Formula $\beta_{2}$
\end_inset

 are parameters to adjust for the fact that a black cherry tree is not a
 perfect cylinder.
\end_layout

\begin_layout Standard
How can we fit this model? The model is not linear in the parameters any
 more, so our linear regression methods will not work\SpecialChar \ldots{}
or will they? In the
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset

 
\color inherit
example we may take the logarithm of both sides of Equation 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:trees-nonlin-reg"

\end_inset

 to get
\color none

\begin_inset Formula \begin{equation}
\mu^{\ast}(x_{1},x_{2})=\ln\left[\mu(x_{1},x_{2})\right]=\ln\beta_{0}+\beta_{1}\ln x_{1}+\beta_{2}\ln x_{2},\end{equation}

\end_inset

and this new model 
\begin_inset Formula $\mu^{\ast}$
\end_inset

 is linear in the parameters 
\begin_inset Formula $\beta_{0}^{\ast}=\ln\beta_{0}$
\end_inset

, 
\begin_inset Formula $\beta_{1}^{\ast}=\beta_{1}$
\end_inset

 and 
\begin_inset Formula $\beta_{2}^{\ast}=\beta_{2}$
\end_inset

.
 We can use what we have learned to fit a linear model 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

log(Volume) ~ log(Girth) + log(Height)
\end_layout

\end_inset

, and everything will proceed as before, with one exception: we will need
 to be mindful when it comes time to make predictions because the model
 will have been fit on the log scale, and we will need to transform our
 predictions back to the original scale (by exponentiating with 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

exp
\end_layout

\end_inset

) to make sense.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

treesNonlin.lm <- lm(log(Volume) ~ log(Girth) + log(Height), data = trees)
\begin_inset Newline newline
\end_inset

summary(treesNonlin.lm)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
This is our best model yet (judging by 
\begin_inset Formula $R^{2}$
\end_inset

 and 
\begin_inset Formula $\overline{R}^{2}$
\end_inset

), all of the parameters are significant, it is simpler than the quadratic
 or interaction models, and it even makes theoretical sense.
 It rarely gets any better than that.
\end_layout

\begin_layout Standard
We may get confidence intervals for the parameters, but remember that it
 is usually better to transform back to the original scale for interpretation
 purposes :
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

exp(confint(treesNonlin.lm))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
(Note that we did not update the row labels of the matrix to show that we
 exponentiated and so they are misleading as written.) We do predictions
 just as before.
 Remember to transform the response variable back to the original scale
 after prediction.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

new <- data.frame(Girth = c(9.1, 11.6, 12.5), Height = c(69, 74, 87))
\begin_inset Newline newline
\end_inset

exp(predict(treesNonlin.lm, newdata = new, interval = "confidence"))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The predictions and intervals are slightly different from those calculated
 earlier, but they are close.
 Note that we did not need to transform the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Girth
\end_layout

\end_inset

 and 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Height
\end_layout

\end_inset

 arguments in the dataframe 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

new
\end_layout

\end_inset

.
 All transformations are done for us automatically.
\end_layout

\begin_layout Subsection
Real Nonlinear Regression
\end_layout

\begin_layout Standard
We saw with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

trees
\end_layout

\end_inset

 data that a nonlinear model might be more appropriate for the data based
 on theoretical considerations, and we were lucky because the functional
 form of 
\begin_inset Formula $\mu$
\end_inset

 allowed us to take logarithms to transform the nonlinear model to a linear
 one.
 The same trick will not work in other circumstances, however.
 We need techniques to fit general models of the form
\begin_inset Formula \begin{equation}
\mathbf{Y}=\mu(\mathbf{X})+\epsilon,\end{equation}

\end_inset

where 
\begin_inset Formula $\mu$
\end_inset

 is some crazy function that does not lend itself to linear transformations.
\end_layout

\begin_layout Standard
There are a host of methods to address problems like these which are studied
 in advanced regression classes.
 The interested reader should see Neter 
\emph on
et al
\emph default
 
\begin_inset CommandInset citation
LatexCommand cite
key "Neter1996"

\end_inset

 or Tabachnick and Fidell 
\begin_inset CommandInset citation
LatexCommand cite
key "Tabachnick2006"

\end_inset

.
 
\end_layout

\begin_layout Standard
It turns out that John Fox has posted an Appendix to his book 
\begin_inset CommandInset citation
LatexCommand cite
key "Fox2002"

\end_inset

 which discusses some of the methods and issues associated with nonlinear
 regression; see 
\end_layout

\begin_layout Standard
\align center
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://cran.r-project.org/doc/contrib/Fox-Companion/appendix.html
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Here is an example of how it works, based on a question from R-help.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

# fake data 
\begin_inset Newline newline
\end_inset

set.seed(1) 
\begin_inset Newline newline
\end_inset

x <- seq(from = 0, to = 1000, length.out = 200) 
\begin_inset Newline newline
\end_inset

y <- 1 + 2*(sin((2*pi*x/360) - 3))^2 + rnorm(200, sd = 2)
\begin_inset Newline newline
\end_inset

plot(x, y)
\begin_inset Newline newline
\end_inset

acc.nls <- nls(y ~ a + b*(sin((2*pi*x/360) - c))^2, start = list(a = 0.9,
 b = 2.3, c = 2.9))
\begin_inset Newline newline
\end_inset

summary(acc.nls)
\begin_inset Newline newline
\end_inset

#plot(x, fitted(acc.nls))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Subsection
Multicollinearity
\begin_inset CommandInset label
LatexCommand label
name "sub:Multicollinearity"

\end_inset


\end_layout

\begin_layout Standard
A multiple regression model exhibits 
\emph on
multicollinearity
\emph default
 when two or more of the explanatory variables are substantially correlated
 with each other.
 We can measure multicollinearity by having one of the explanatory play
 the role of 
\begin_inset Quotes eld
\end_inset

dependent variable
\begin_inset Quotes erd
\end_inset

 and regress it on the remaining explanatory variables.
 The the 
\begin_inset Formula $R^{2}$
\end_inset

 of the resulting model is near one, then we say that the model is multicollinea
r or shows multicollinearity.
\end_layout

\begin_layout Standard
Multicollinearity is a problem because it causes instability in the regression
 model.
 The instability is a consequence of redundancy in the explanatory variables:
 a high 
\begin_inset Formula $R^{2}$
\end_inset

 indicates a strong dependence between the selected independent variable
 and the others.
 The redundant information inflates the variance of the parameter estimates
 which can cause them to be statistically insignificant when they would
 have been significant otherwise.
 To wit, multicollinearity is usually measured by what are called 
\emph on
variance inflation factors
\emph default
.
\end_layout

\begin_layout Standard
Once multicollinearity has been diagnosed there are several approaches to
 remediate it.
 Here are a couple of important ones.
\end_layout

\begin_layout Description
Principal
\begin_inset space ~
\end_inset

Components
\begin_inset space ~
\end_inset

Analysis.
 This approach casts out two or more of the original explanatory variables
 and replaces them with new variables, derived from the original ones, that
 are by design uncorrelated with one another.
 The redundancy is thus eliminated and we may proceed as usual with the
 new variables in hand.
 Principal Components Analysis is important for other reasons, too, not
 just for fixing multicollinearity problems.
\end_layout

\begin_layout Description
Ridge
\begin_inset space ~
\end_inset

Regression.
 The idea of this approach is to replace the original parameter estimates
 with a different type of parameter estimate which is more stable under
 multicollinearity.
 The estimators are not found by ordinary least squares but rather a different
 optimization procedure which incorporates the variance inflation factor
 information.
\end_layout

\begin_layout Standard
We decided to omit a thorough discussion of multicollinearity because we
 are not equipped to handle the mathematical details.
 Perhaps the topic will receive more attention in a later edition.
\end_layout

\begin_layout Itemize
What to do when data are not normal
\end_layout

\begin_deeper
\begin_layout Itemize
Bootstrap (see Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:resampling-methods"

\end_inset

).
\end_layout

\end_deeper
\begin_layout Subsection
Akaike's Information Criterion
\end_layout

\begin_layout Standard
\begin_inset Formula \[
AIC=-2\ln L+2(p+1)\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Chapter Exercises
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{section}{Chapter Exercises}
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{thm}{0}
\end_layout

\end_inset


\end_layout

\begin_layout Exercise
\begin_inset CommandInset label
LatexCommand label
name "xca:anova-equality"

\end_inset

Use Equations 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:mlr-sse-matrix"

\end_inset

, 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:mlr-ssto-matrix"

\end_inset

, and 
\begin_inset CommandInset ref
LatexCommand ref
reference "eq:mlr-ssr-matrix"

\end_inset

 to prove the Anova Equality:
\begin_inset Formula \[
SSTO=SSE+SSR.\]

\end_inset


\end_layout

\begin_layout Chapter
Resampling Methods
\begin_inset CommandInset label
LatexCommand label
name "cha:resampling-methods"

\end_inset


\end_layout

\begin_layout Standard
\noindent
Computers have changed the face of statistics.
 Their quick computational speed and flawless accuracy, coupled with large
 data sets acquired by the researcher, make them indispensable for many
 modern analyses.
 In particular, resampling methods (due in large part to Bradley Efron)
 have gained prominence in the modern statistician's repertoire.
 We first look at a classical problem to get some insight why.
 
\end_layout

\begin_layout Standard
I have seen 
\emph on
Statistical Computing with 
\family sans
R
\family default
\emph default
 by Rizzo 
\begin_inset CommandInset citation
LatexCommand cite
key "Rizzo2008"

\end_inset

 and I recommend it to those looking for a more advanced treatment with
 additional topics.
 I believe that 
\emph on
Monte Carlo Statistical Methods
\emph default
 by Robert and Casella 
\begin_inset CommandInset citation
LatexCommand cite
key "Robert2004"

\end_inset

 has a new edition that integrates 
\family sans
R
\family default
 into the narrative.
\end_layout

\begin_layout Paragraph*
What do I want them to know?
\end_layout

\begin_layout Itemize
basic philosophy of resampling and why it is important
\end_layout

\begin_layout Itemize
resampling for standard errors and confidence intervals
\end_layout

\begin_layout Itemize
resampling for hypothesis tests (permutation tests)
\end_layout

\begin_layout Section
Introduction
\begin_inset CommandInset label
LatexCommand label
name "sec:Introduction-Resampling"

\end_inset


\end_layout

\begin_layout Description

\series bold
Classical
\begin_inset space ~
\end_inset

question
\series default
 Given a population of interest, how may we effectively learn some of its
 salient features, 
\emph on
e.g.
\emph default
, the population's mean? One way is through representative random sampling.
 Given a random sample, we summarize the information contained therein by
 calculating a reasonable statistic, 
\emph on
e.g.
\emph default
, the sample mean.
 Given a value of a statistic, how do we know whether that value is significantl
y different from that which was expected? We don't; we look at the 
\emph on
sampling distribution
\emph default
 of the statistic, and we try to make probabilistic assertions based on
 a confidence level or other consideration.
 For example, we may find ourselves saying things like, "With 95% confidence,
 the true population mean is greater than zero."
\end_layout

\begin_layout Description

\series bold
Problem
\series default
 Unfortunately, in most cases the sampling distribution is 
\emph on
unknown
\emph default
.
 Thus, in the past, in efforts to say something useful, statisticians have
 been obligated to place some restrictive assumptions on the underlying
 population.
 For example, if we suppose that the population has a normal distribution,
 then we can say that the distribution of 
\begin_inset Formula $\Xbar$
\end_inset

 is normal, too, with the same mean (and a smaller standard deviation).
 It is then easy to draw conclusions, make inferences, and go on about our
 business.
\end_layout

\begin_layout Description

\series bold
Alternative
\series default
 We don't know what the underlying population distributions is, so let us
 
\emph on
estimate
\emph default
 it, just like we would with any other parameter.
 The statistic we use is the 
\emph on
empirical CDF
\emph default
, that is, the function that places mass 
\begin_inset Formula $1/n$
\end_inset

 at each of the observed data points 
\begin_inset Formula $x_{1},\ldots,x_{n}$
\end_inset

 (see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:empirical-distribution"

\end_inset

).
 As the sample size increases, we would expect the approximation to get
 better and better (with i.i.d.
\begin_inset space ~
\end_inset

observations, it does, and there is a wonderful theorem by Glivenko and
 Cantelli that proves it).
 And now that we have an (estimated) population distribution, it is easy
 to find the sampling distribution of any statistic we like: just 
\series bold
sample
\series default
 from the empirical CDF many, many times, calculate the statistic each time,
 and make a histogram.
 Done! Of course, the number of samples needed to get a representative histogram
 is prohibitively large\SpecialChar \ldots{}
human beings are simply too slow (and clumsy) to
 do this tedious procedure.
\begin_inset Newline newline
\end_inset

Fortunately, computers are very skilled at doing simple, repetitive tasks
 very quickly and accurately.
 So we employ them to give us a reasonable idea about the sampling distribution
 of our statistic, and we use the generated sampling distribution to guide
 our inferences and draw our conclusions.
 If we would like to have a better approximation for the sampling distribution
 (within the confines of the information contained in the original sample),
 we merely tell the computer to sample more.
 In this (restricted) sense, we are limited only by our current computational
 speed and pocket book.
\end_layout

\begin_layout Standard
In short, here are some of the benefits that the advent of resampling methods
 has given us:
\end_layout

\begin_layout Description
Fewer
\begin_inset space ~
\end_inset

assumptions.
 We are no longer required to assume the population is normal or the sample
 size is large (though, as before, the larger the sample the better).
\end_layout

\begin_layout Description
Greater
\begin_inset space ~
\end_inset

accuracy.
 Many classical methods are based on rough upper bounds or Taylor expansions.
 The bootstrap procedures can be iterated long enough to give results accurate
 to several decimal places, often beating classical approximations.
 
\end_layout

\begin_layout Description
Generality.
 Resampling methods are easy to understand and apply to a large class of
 seemingly unrelated procedures.
 One no longer needs to memorize long complicated formulas and algorithms.
\end_layout

\begin_layout Remark
Due to the special structure of the empirical CDF, to get an i.i.d.
\begin_inset space ~
\end_inset

sample we just need to take a random sample of size 
\begin_inset Formula $n$
\end_inset

, with replacement, from the observed data 
\begin_inset Formula $x_{1},\ldots,x_{n}$
\end_inset

.
 Repeats are expected and acceptable.
 Since we already sampled to get the original data, the term 
\emph on
resampling
\emph default
 is used to describe the procedure.
\end_layout

\begin_layout Paragraph*
General bootstrap procedure.
\end_layout

\begin_layout Standard
The above discussion leads us to the following general procedure to approximate
 the sampling distribution of a statistic 
\begin_inset Formula $S=S(x_{1},x_{2},\ldots,x_{n})$
\end_inset

 based on an observed simple random sample 
\begin_inset Formula $\mathbf{x}=(x_{1},x_{2},\ldots,x_{n})$
\end_inset

 of size 
\begin_inset Formula $n$
\end_inset

:
\end_layout

\begin_layout Enumerate
Create many many samples 
\begin_inset Formula $\mathbf{x}_{1}^{\ast},\ldots,\mathbf{x}_{M}^{\ast}$
\end_inset

, called 
\emph on
resamples
\emph default
, by sampling with replacement from the data.
 
\end_layout

\begin_layout Enumerate
Calculate the statistic of interest 
\begin_inset Formula $S(\mathbf{x}_{1}^{\ast}),\ldots,S(\mathbf{x}_{M}^{\ast})$
\end_inset

 for each resample.
 The distribution of the resample statistics is called a 
\emph on
bootstrap distribution
\emph default
.
 
\end_layout

\begin_layout Enumerate
The bootstrap distribution gives information about the sampling distribution
 of the original statistic 
\begin_inset Formula $S$
\end_inset

.
 In particular, the bootstrap distribution gives us some idea about the
 center, spread, and shape of the sampling distribution of 
\begin_inset Formula $S$
\end_inset

.
\end_layout

\begin_layout Section
Bootstrap Standard Errors
\begin_inset CommandInset label
LatexCommand label
name "sec:Bootstrap-Standard-Errors"

\end_inset


\end_layout

\begin_layout Standard
Since the bootstrap distribution gives us information about a statistic's
 sampling distribution, we can use the bootstrap distribution to estimate
 properties of the statistic.
 We will illustrate the bootstrap procedure in the special case that the
 statistic 
\begin_inset Formula $S$
\end_inset

 is a standard error.
\end_layout

\begin_layout Example

\series bold
Standard error of the mean.
\begin_inset CommandInset label
LatexCommand label
name "exa:Bootstrap-se-mean"

\end_inset


\series default
 In this example we illustrate the bootstrap by estimating the standard
 error of the sample meanand we will do it in the special case that the
 underlying population is 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=3,\,\mathtt{sd}=1)$
\end_inset

.
 
\end_layout

\begin_layout Example
Of course, we do not really need a bootstrap distribution here because from
 Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:sampling-from-normal-dist"

\end_inset

 we know that 
\begin_inset Formula $\Xbar\sim\mathsf{norm}(\mathtt{mean}=3,\,\mathtt{sd}=1/\sqrt{n})$
\end_inset

, but we proceed anyway to investigate how the bootstrap performs when we
 know what the answer should be ahead of time.
\end_layout

\begin_layout Example
We will take a random sample of size 
\begin_inset Formula $n=25$
\end_inset

 from the population.
 Then we will 
\emph on
resample
\emph default
 the data 1000 times to get 1000 resamples of size 25.
 We will calculate the sample mean of each of the resamples, and will study
 the data distribution of the 1000 values of 
\begin_inset Formula $\xbar$
\end_inset

.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

srs <- rnorm(25, mean = 3)
\begin_inset Newline newline
\end_inset

resamps <- replicate(1000, sample(srs, 25, TRUE), simplify = FALSE)
\begin_inset Newline newline
\end_inset

xbarstar <- sapply(resamps, mean, simplify = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 6>>=
\begin_inset Newline newline
\end_inset

hist(xbarstar, breaks = 40, prob = TRUE)
\begin_inset Newline newline
\end_inset

curve(dnorm(x, 3, 0.2), add = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Bootstrapping the standard error of the mean, simulated data
\begin_inset CommandInset label
LatexCommand label
name "fig:Bootstrap-se-mean"

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout

\size small
\begin_inset space ~
\end_inset


\end_layout

\begin_layout Plain Layout

\size small
The original data were 25 observations generated from a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=3,\,\mathtt{sd}=1)$
\end_inset

 distribution.
 We next resampled to get 1000 resamples, each of size 25, and calculated
 the sample mean for each resample.
 A histogram of the 1000 values of 
\begin_inset Formula $\xbar$
\end_inset

 is shown above.
 Also shown (with a solid line) is the true sampling distribution of 
\begin_inset Formula $\Xbar$
\end_inset

, which is a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=3,\,\mathtt{sd}=0.2)$
\end_inset

 distribution.
 Note that the histogram is centered at the sample mean of the original
 data, while the true sampling distribution is centered at the true value
 of 
\begin_inset Formula $\mu=3$
\end_inset

.
 The shape and spread of the histogram is similar to the shape and spread
 of the true sampling distribution.
\end_layout

\end_inset

A histogram of the 1000 values of 
\begin_inset Formula $\xbar$
\end_inset

 is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Bootstrap-se-mean"

\end_inset

, and was produced by the following code.
\end_layout

\begin_layout Scrap
<<eval = FALSE, keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

hist(xbarstar, breaks = 40, prob = TRUE)
\begin_inset Newline newline
\end_inset

curve(dnorm(x, 3, 0.2), add = TRUE)  # overlay true normal density
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Example
We have overlain what we know to be the true sampling distribution of 
\begin_inset Formula $\Xbar$
\end_inset

, namely, a 
\begin_inset Formula $\mathsf{norm}(\mathtt{mean}=3,\,\mathtt{sd}=1/\sqrt{25})$
\end_inset

 distribution.
 The histogram matches the true sampling distribution pretty well with respect
 to shape and spread\SpecialChar \ldots{}
but notice how the histogram is off-center a little
 bit.
 This is not a coincidence -- in fact, it can be shown that the mean of
 the bootstrap distribution is exactly the mean of the original sample,
 that is, the value of the statistic that we originally observed.
 Let us calculate the mean of the bootstrap distribution and compare it
 to the mean of the original sample:
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

mean(xbarstar)
\begin_inset Newline newline
\end_inset

mean(srs)
\begin_inset Newline newline
\end_inset

mean(xbarstar) - mean(srs)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Standard
Notice how close the two values are.
 The difference between them is an estimate of how biased the original statistic
 is, the so-called 
\emph on
bootstrap estimate of bias
\emph default
.
 Since the estimate is so small we would expect our original statistic (
\begin_inset Formula $\Xbar$
\end_inset

) to have small bias, but this is no surprise to us because we already knew
 from Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sub:simple-random-samples"

\end_inset

 that 
\begin_inset Formula $\Xbar$
\end_inset

 is an unbiased estimator of the population mean.
\end_layout

\begin_layout Standard
Now back to our original problem, we would like to estimate the standard
 error of 
\begin_inset Formula $\Xbar$
\end_inset

.
 Looking at the histogram, we see that the spread of the bootstrap distribution
 is similar to the spread of the sampling distribution.
 Therefore, it stands to reason that we could estimate the standard error
 of 
\begin_inset Formula $\Xbar$
\end_inset

 with the sample standard deviation of the resample statistics.
 Let us try and see.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

sd(xbarstar)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We know from theory that the true standard error is 
\begin_inset Formula $1/\sqrt{25}=0.20$
\end_inset

.
 Our bootstrap estimate is not very far from the theoretical value.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Remark
What would happen if we take more resamples? Instead of 1000 resamples,
 we could increase to, say, 2000, 3000, or even 4000\SpecialChar \ldots{}
would it help? The answer
 is both yes and no.
 Keep in mind that with resampling methods there are two sources of randomness:
 that from the original sample, and that from the subsequent resampling
 procedure.
 An increased number of resamples would reduce the variation due to the
 second part, but would do nothing to reduce the variation due to the first
 part.
 We only took an original sample of size 
\begin_inset Formula $n=25$
\end_inset

, and resampling more and more would never generate more information about
 the population than was already there.
 In this sense, the statistician is limited by the information contained
 in the original sample.
 
\end_layout

\begin_layout Example

\series bold
Standard error of the median.
\begin_inset CommandInset label
LatexCommand label
name "exa:Bootstrap-se-median"

\end_inset


\series default
 We look at one where we do not know the answer ahead of time.
 This example uses the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rivers
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\color none
Data sets ! 
\family typewriter
\color inherit
rivers
\end_layout

\end_inset


\color inherit
 data set.
 Recall the stemplot on page 
\begin_inset CommandInset ref
LatexCommand vpageref
reference "ite:stemplot-rivers"

\end_inset

 that we made for these data which shows them to be markedly right-skewed,
 so a natural estimate of center would be the sample median.
 Unfortunately, its sampling distribution falls out of our reach.
 We use the bootstrap to help us with this problem, and the modifications
 to the last example are trivial.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

resamps <- replicate(1000, sample(rivers, 141, TRUE), simplify = FALSE)
\begin_inset Newline newline
\end_inset

medstar <- sapply(resamps, median, simplify = TRUE)
\begin_inset Newline newline
\end_inset

sd(medstar)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset Float figure
wide false
sideways false
status open

\begin_layout Scrap
\align center
<<echo = FALSE, fig=true, height = 4, width = 6>>=
\begin_inset Newline newline
\end_inset

hist(medstar, breaks = 40, prob = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Bootstrapping the standard error of the median for the 
\family typewriter
rivers
\family default
 data
\begin_inset CommandInset label
LatexCommand label
name "fig:Bootstrapping-se-median"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Standard
The graph is shown in Figure 
\begin_inset CommandInset ref
LatexCommand ref
reference "fig:Bootstrapping-se-median"

\end_inset

, and was produced by the following code.
\end_layout

\begin_layout Scrap
<<eval = FALSE, keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

hist(medstar, breaks = 40, prob = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

median(rivers)
\begin_inset Newline newline
\end_inset

mean(medstar)
\begin_inset Newline newline
\end_inset

mean(medstar) - median(rivers)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Example

\series bold
The boot package in 
\family typewriter
R
\family default
\series default
.
 It turns out that there are many bootstrap procedures and commands already
 built into base 
\family typewriter
R
\family default
, in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

boot
\end_layout

\end_inset


\color inherit
 package.
 Further, inside the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

boot
\end_layout

\end_inset


\color inherit
 package there is even a function called 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

boot
\end_layout

\end_inset


\color inherit

\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
boot
\end_layout

\end_inset

.
 The basic syntax is of the form:
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline false
status open

\begin_layout Plain Layout

boot(data, statistic, R)
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Here, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

data
\end_layout

\end_inset


\color inherit
 is a vector (or matrix) containing the data to be resampled, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

statistic
\end_layout

\end_inset


\color inherit
 is a defined function, 
\emph on
of two arguments
\emph default
, that tells which statistic should be computed, and the parameter 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

R
\end_layout

\end_inset


\color inherit
 specifies how many resamples should be taken.
\end_layout

\begin_layout Standard
For the standard error of the mean (Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Bootstrap-se-mean"

\end_inset

):
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(boot)
\begin_inset Newline newline
\end_inset

mean_fun <- function(x, indices) mean(x[indices])
\begin_inset Newline newline
\end_inset

boot(data = srs, statistic = mean_fun, R = 1000)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
For the standard error of the median (Example 
\begin_inset CommandInset ref
LatexCommand ref
reference "exa:Bootstrap-se-median"

\end_inset

):
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

median_fun <- function(x, indices) median(x[indices])
\begin_inset Newline newline
\end_inset

boot(data = rivers, statistic = median_fun, R = 1000)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We notice that the output from both methods of estimating the standard errors
 produced similar results.
 In fact, the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

boot
\end_layout

\end_inset


\color inherit
 procedure is to be preferred since it invisibly returns much more information
 (which we will use later) than our naive script and it is much quicker
 in its computations.
\end_layout

\begin_layout Remark
Some things to keep in mind about the bootstrap:
\end_layout

\begin_deeper
\begin_layout Itemize
For many statistics, the bootstrap distribution closely resembles the sampling
 distribution with respect to spread and shape.
 However, the bootstrap will not have the same center as the true sampling
 distribution.
 While the sampling distribution is centered at the population mean (plus
 any bias), the bootstrap distribution is centered at the original value
 of the statistic (plus any bias).
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

boot
\end_layout

\end_inset

 
\color inherit
function gives an empirical estimate of the bias of the statistic as part
 of its output.
 
\end_layout

\begin_layout Itemize
We tried to estimate the standard error, but we could have (in principle)
 tried to estimate something else.
 Note from the previous remark, however, that it would be useless to estimate
 the population mean 
\begin_inset Formula $\mu$
\end_inset

 using the bootstrap since the mean of the bootstrap distribution is the
 observed 
\begin_inset Formula $\xbar$
\end_inset

.
 
\end_layout

\begin_layout Itemize
You don't get something from nothing.
 We have seen that we can take a random sample from a population and use
 bootstrap methods to get a very good idea about standard errors, bias,
 and the like.
 However, one must not get lured into believing that by doing some random
 resampling somehow one gets more information about the parameters than
 that which was contained in the original sample.
 Indeed, there is some uncertainty about the parameter due to the randomness
 of the original sample, and there is even more uncertainty introduced by
 resampling.
 One should think of the bootstrap as just another estimation method, nothing
 more, nothing less.
\end_layout

\end_deeper
\begin_layout Section
Bootstrap Confidence Intervals
\begin_inset CommandInset label
LatexCommand label
name "sec:Bootstrap-Confidence-Intervals"

\end_inset


\end_layout

\begin_layout Subsection
Percentile Confidence Intervals
\end_layout

\begin_layout Standard
As a first try, we want to obtain a 95% confidence interval for a parameter.
 Typically the statistic we use to estimate the parameter is centered at
 (or at least close by) the parameter; in such cases a 95% confidence interval
 for the parameter is nothing more than a 95% confidence interval for the
 statistic.
 And to find a 95% confidence interval for the statistic we need only go
 to its sampling distribution to find an interval that contains 95% of the
 area.
 (The most popular choice is the equal-tailed interval with 2.5% in each
 tail.)
\end_layout

\begin_layout Standard
This is incredibly easy to accomplish with the bootstrap.
 We need only to take a bunch of bootstrap resamples, order them, and choose
 the 
\begin_inset Formula $\alpha/2$
\end_inset

th and 
\begin_inset Formula $(1-\alpha)$
\end_inset

th percentiles.
 There is a function 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

boot.ci
\end_layout

\end_inset


\begin_inset Index
status open

\begin_layout Plain Layout

\family typewriter
boot.ci
\end_layout

\end_inset


\color inherit
 in 
\family sans
R
\family default
 already created to do just this.
 Note that in order to use the function 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

boot.ci
\end_layout

\end_inset

 
\color inherit
we must first run the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

boot
\end_layout

\end_inset


\color inherit
 function and save the output in a variable, for example, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

data.boot
\end_layout

\end_inset

.

\color inherit
 We then plug 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

data.boot
\end_layout

\end_inset


\color inherit
 into the function 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

boot.ci
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Example
\begin_inset CommandInset label
LatexCommand label
name "exa:percentile-interval-median-first"

\end_inset


\series bold
Percentile interval for the expected value of the median.

\series default
 Wee will try the naive approach where we generate the resamples and calculate
 the percentile interval by hand.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

btsamps <- replicate(2000, sample(stack.loss, 21, TRUE), simplify = FALSE)
\begin_inset Newline newline
\end_inset

thetast <- sapply(btsamps, median, simplify = TRUE)
\begin_inset Newline newline
\end_inset

mean(thetast)
\begin_inset Newline newline
\end_inset

median(stack.loss)
\begin_inset Newline newline
\end_inset

quantile(thetast, c(0.025, 0.975))
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout --Separator--

\end_layout

\begin_layout Example

\series bold
Confidence interval for expected value of the median, 
\begin_inset Formula $2^{\mathrm{nd}}$
\end_inset

 try.

\series default
 Now we will do it the right way with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

boot
\end_layout

\end_inset


\color inherit
 function.
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(boot)
\begin_inset Newline newline
\end_inset

med_fun <- function(x, ind) median(x[ind])
\begin_inset Newline newline
\end_inset

med_boot <- boot(stack.loss, med_fun, R = 2000)
\begin_inset Newline newline
\end_inset

boot.ci(med_boot, type = c("perc", "norm", "bca"))
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_deeper
\begin_layout Subsection
Student's 
\begin_inset Formula $t$
\end_inset

 intervals (
\begin_inset Quotes eld
\end_inset

normal intervals
\begin_inset Quotes erd
\end_inset

)
\end_layout

\begin_layout Standard
The idea is to use confidence intervals that we already know and let the
 bootstrap help us when we get into trouble.
 We know that a 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence interval for the mean of a 
\begin_inset Formula $SRS(n)$
\end_inset

 from a normal distribution is 
\begin_inset Formula \begin{equation}
\Xbar\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-1)\frac{S}{\sqrt{n}},\end{equation}

\end_inset

where 
\begin_inset Formula $\mathsf{t}_{\alpha/2}(\mathtt{df}=n-1)$
\end_inset

 is the appropriate critical value from Student's 
\begin_inset Formula $t$
\end_inset

 distribution, and we remember that an estimate for the standard error of
 
\begin_inset Formula $\Xbar$
\end_inset

 is 
\begin_inset Formula $S/\sqrt{n}$
\end_inset

.
 Of course, the estimate for the standard error will change when the underlying
 population distribution is not normal, or when we use a statistic more
 complicated than 
\begin_inset Formula $\Xbar$
\end_inset

.
 In those situations the bootstrap will give us quite reasonable estimates
 for the standard error.
 And as long as the sampling distribution of our statistic is approximately
 bell-shaped with small bias, the interval 
\begin_inset Formula \begin{equation}
\mbox{statistic}\pm\mathsf{t}_{\alpha/2}(\mathtt{df}=n-1)*\mathrm{SE}(\mbox{statistic})\end{equation}

\end_inset

 will have approximately 
\begin_inset Formula $100(1-\alpha)\%$
\end_inset

 confidence of containing 
\begin_inset Formula $\E(\mathrm{statistic})$
\end_inset

.
\end_layout

\begin_layout Example
We will use the t-interval method to find the bootstrap CI for the median.
 We have looked at the bootstrap distribution; it appears to be symmetric
 and approximately mound shaped.
 Further, we may check that the bias is approximately 40, which on the scale
 of these data is practically negligible.
 Thus, we may consider looking at the 
\begin_inset Formula $t$
\end_inset

-intervals.
 Note that, since our sample is so large, instead of 
\begin_inset Formula $t$
\end_inset

-intervals we will essentially be using 
\begin_inset Formula $z$
\end_inset

-intervals.
\end_layout

\begin_layout Standard
Please see the handout, 
\begin_inset Quotes eld
\end_inset

Bootstrapping Confidence Intervals for the Median, 
\begin_inset Formula $3^{\mathrm{rd}}$
\end_inset

 try.
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Standard
We see that, considering the scale of the data, the confidence intervals
 compare with each other quite well.
\end_layout

\begin_layout Remark
We have seen two methods for bootstrapping confidence intervals for a statistic.
 Which method should we use? If the bias of the bootstrap distribution is
 small and if the distribution is close to normal, then the percentile and
 
\begin_inset Formula $t$
\end_inset

-intervals will closely agree.
 If the intervals are noticeably different, then it should be considered
 evidence that the normality and bias conditions are not met.
 In this case, 
\emph on
neither
\emph default
 interval should be used.
\end_layout

\begin_layout Itemize
\begin_inset Formula $BC_{a}$
\end_inset

: bias-corrected and accelerated
\end_layout

\begin_deeper
\begin_layout Itemize
transformation invariant
\end_layout

\begin_layout Itemize
more correct and accurate
\end_layout

\begin_layout Itemize
not monotone in coverage level?
\end_layout

\end_deeper
\begin_layout Itemize
t - intervals
\end_layout

\begin_deeper
\begin_layout Itemize
more natural
\end_layout

\begin_layout Itemize
numerically unstable
\end_layout

\end_deeper
\begin_layout Itemize
Can do things like transform scales, compute confidence intervals, and then
 transform back.
\end_layout

\begin_layout Itemize
Studentized bootstrap confidence intervals where is the Studentized version
 of is the  order statistic of the simulation
\end_layout

\begin_layout Section
Resampling in Hypothesis Tests
\begin_inset CommandInset label
LatexCommand label
name "sec:Resampling-in-Hypothesis"

\end_inset


\end_layout

\begin_layout Standard
The classical two-sample problem can be stated as follows: given two groups
 of interest, we would like to know whether these two groups are significantly
 different from one another or whether the groups are reasonably similar.
 The standard way to decide is to
\end_layout

\begin_layout Enumerate
Go collect some information from the two groups and calculate an associated
 statistic, for example, 
\begin_inset Formula $\Xbar_{1}-\Xbar_{2}$
\end_inset

.
 
\end_layout

\begin_layout Enumerate
Suppose that there is no difference in the groups, and find the distribution
 of the statistic in 1.
 
\end_layout

\begin_layout Enumerate
Locate the observed value of the statistic with respect to the distribution
 found in 2.
 A value in the main body of the distribution is not spectacular, it could
 reasonably have occurred by chance.
 A value in the tail of the distribution is unlikely, and hence provides
 evidence 
\emph on
against
\emph default
 the null hypothesis that the population distributions are the same.
 
\end_layout

\begin_layout Standard
Of course, we usually compute a 
\begin_inset Formula $p$
\end_inset

-value, defined to be the probability of the observed value of the statistic
 or more extreme when the null hypothesis is true.
 Small 
\begin_inset Formula $p$
\end_inset

-values are evidence against the null hypothesis.
 It is not immediately obvious how to use resampling methods here, so we
 discuss an example.
\end_layout

\begin_layout Example
A study concerned differing dosages of the antiretroviral drug AZT.
 The common dosage is 300mg daily.
 Higher doses cause more side affects, but are they significantly higher?
 We examine for a 600mg dose.
 The data are as follows: We compare the scores from the two groups by computing
 the difference in their sample means.
 The 300mg data were entered in x1 and the 600mg data were entered into
 x2.
 The observed difference was
\end_layout

\begin_deeper
\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="2" columns="11">
<features>
<column alignment="left" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
300 mg 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
284 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
279 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
289 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
292 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
287 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
295 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
285 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
279 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
306 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
298 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
600 mg 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
298 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
307 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
297 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
279 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
291 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
335 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
299 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
300 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
306 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
291 
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
The average amounts can be found:
\end_layout

\begin_layout Standard

\family typewriter
> mean(x1)
\end_layout

\begin_layout Standard

\family typewriter
[1] 289.4
\end_layout

\begin_layout Standard

\family typewriter
> mean(x2)
\end_layout

\begin_layout Standard

\family typewriter
[1] 300.3
\end_layout

\begin_layout Standard
with an observed difference of 
\family typewriter
mean(x2) - mean(x1) = 10.9.

\family default
 As expected, the 600 mg measurements seem to have a higher average, and
 we might be interested in trying to decide if the average amounts are 
\emph on
significantly
\emph default
 different.
 The null hypothesis should be that there is no difference in the amounts,
 that is, the groups are more or less the same.
 If the null hypothesis were true, then the two groups would indeed be the
 same, or just one big group.
 In that case, the observed difference in the sample means just reflects
 the random assignment into the arbitrary 
\family typewriter
x1
\family default
 and 
\family typewriter
x2
\family default
 categories.
 It is now clear how we may resample, consistent with the null hypothesis.
\end_layout

\begin_layout Paragraph*

\series bold
Procedure:
\end_layout

\begin_layout Enumerate
Randomly resample 10 scores from the combined scores of 
\family typewriter
x1
\family default
 and 
\family typewriter
x2
\family default
, and assign then to the 
\begin_inset Quotes eld
\end_inset


\family typewriter
x1
\family default

\begin_inset Quotes erd
\end_inset

 group.
 The rest will then be in the 
\begin_inset Quotes eld
\end_inset


\family typewriter
x2
\family default

\begin_inset Quotes erd
\end_inset

 group.
 Calculate the difference in (re)sampled means, and store that value.
 
\end_layout

\begin_layout Enumerate
Repeat this procedure many, many times and draw a histogram of the resampled
 statistics, called the 
\emph on
permutation distribution
\emph default
.
 Locate the observed difference 10.9 on the histogram to get the 
\begin_inset Formula $p$
\end_inset

-value.
 If the 
\begin_inset Formula $p$
\end_inset

-value is small, then we consider that evidence against the hypothesis that
 the groups are the same.
 
\end_layout

\end_deeper
\begin_layout Remark
In calculating the permutation test 
\begin_inset Formula $p$
\end_inset

-value, the formula is essentially the proportion of resample statistics
 that are greater than or equal to the observed value.
 Of course, this is merely an 
\emph on
estimate
\emph default
 of the true 
\begin_inset Formula $p$
\end_inset

-value.
 As it turns out, an adjustment of 
\begin_inset Formula $+1$
\end_inset

 to both the numerator and denominator of the proportion improves the performanc
e of the estimated 
\begin_inset Formula $p$
\end_inset

-value, and this adjustment is implemented in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

ts.perm
\end_layout

\end_inset


\color inherit
 function.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(coin)
\begin_inset Newline newline
\end_inset

oneway_test(len ~ supp, data = ToothGrowth)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Subsection
Comparison with the Two Sample 
\emph on
t
\emph default
 test
\end_layout

\begin_layout Standard
We know from Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Hypothesis-Testing"

\end_inset

 to use the two-sample 
\begin_inset Formula $t$
\end_inset

-test to tell whether there is an improvement as a result of taking the
 intervention class.
 Note that the 
\begin_inset Formula $t$
\end_inset

-test assumes normal underlying populations, with unknown variance, and
 small sample 
\begin_inset Formula $n=10$
\end_inset

.
 What does the 
\begin_inset Formula $t$
\end_inset

-test say? Below is the output.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

t.test(len ~ supp, data = ToothGrowth, alt = "greater", var.equal = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Scrap
<<echo = FALSE, results = hide>>=
\begin_inset Newline newline
\end_inset

A <- show(oneway_test(len ~ supp, data = ToothGrowth))
\begin_inset Newline newline
\end_inset

B <- t.test(len ~ supp, data = ToothGrowth, alt = "greater", var.equal = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
The 
\begin_inset Formula $p$
\end_inset

-value for the 
\begin_inset Formula $t$
\end_inset

-test was 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(B$p.value, 3)}
\end_layout

\end_inset

, while the permutation test 
\begin_inset Formula $p$
\end_inset

-value was 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(A$p.value, 3)}
\end_layout

\end_inset

.
 Note that there is an underlying normality assumption for the 
\begin_inset Formula $t$
\end_inset

-test, which isn't present in the permutation test.
 If the normality assumption may be questionable, then the permutation test
 would be more reasonable.
 We see what can happen when using a test in a situation where the assumptions
 are not met: smaller 
\begin_inset Formula $p$
\end_inset

-values.
 In situations where the normality assumptions are not met, for example,
 small sample scenarios, the permutation test is to be preferred.
 In particular, if accuracy is very important then we should use the permutation
 test.
\end_layout

\begin_layout Remark
Here are some things about permutation tests to keep in mind.
\end_layout

\begin_deeper
\begin_layout Itemize
While the permutation test does not require normality of the populations
 (as contrasted with the 
\begin_inset Formula $t$
\end_inset

-test), nevertheless it still requires that the two groups are exchangeable;
 see Section 
\begin_inset CommandInset ref
LatexCommand ref
reference "sec:Exchangeable-Random-Variables"

\end_inset

.
 In particular, this means that they must be identically distributed under
 the null hypothesis.
 They must have not only the same means, but they must also have the same
 spread, shape, and everything else.
 This assumption may or may not be true in a given example, but it will
 rarely cause the 
\begin_inset Formula $t$
\end_inset

-test to outperform the permutation test, because even if the sample standard
 deviations are markedly different it does not mean that the population
 standard deviations are different.
 In many situations the permutation test will also carry over to the 
\begin_inset Formula $t$
\end_inset

-test.
 
\end_layout

\begin_layout Itemize
If the distribution of the groups is close to normal, then the 
\begin_inset Formula $t$
\end_inset

-test 
\begin_inset Formula $p$
\end_inset

-value and the bootstrap 
\begin_inset Formula $p$
\end_inset

-value will be approximately equal.
 If they differ markedly, then this should be considered evidence that the
 normality assumptions do not hold.
 
\end_layout

\begin_layout Itemize
The generality of the permutation test is such that one can use all kinds
 of statistics to compare the two groups.
 One could compare the difference in variances or the difference in (just
 about anything).
 Alternatively, one could compare the ratio of sample means, 
\begin_inset Formula $\Xbar_{1}/\Xbar_{2}$
\end_inset

.
 Of course, under the null hypothesis this last quantity should be near
 1.
 
\end_layout

\begin_layout Itemize
Just as with the bootstrap, the answer we get is subject to variability
 due to the inherent randomness of resampling from the data.
 We can make the variability as small as we like by taking sufficiently
 many resamples.
 How many? If the conclusion is very important (that is, if lots of money
 is at stake), then take thousands.
 For point estimation problems typically, 
\begin_inset Formula $R=1000$
\end_inset

 resamples, or so, is enough.
 In general, if the true 
\begin_inset Formula $p$
\end_inset

-value is 
\begin_inset Formula $p$
\end_inset

 then the standard error of the estimated 
\begin_inset Formula $p$
\end_inset

-value is 
\begin_inset Formula $\sqrt{p(1-p)/R}$
\end_inset

.
 You can choose 
\begin_inset Formula $R$
\end_inset

 to get whatever accuracy desired.
 
\end_layout

\end_deeper
\begin_layout Itemize
Other possible testing designs:
\end_layout

\begin_deeper
\begin_layout Itemize
Matched Pairs Designs.
 
\end_layout

\begin_layout Itemize
Relationship between two variables.
 
\end_layout

\end_deeper
\begin_layout Standard
\begin_inset Newpage newpage
\end_inset


\end_layout

\begin_layout Section*
Chapter Exercises
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{section}{Chapter Exercises}
\end_layout

\begin_layout Plain Layout


\backslash
setcounter{thm}{0}
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Categorical Data Analysis
\begin_inset CommandInset label
LatexCommand label
name "cha:Categorical-Data-Analysis"

\end_inset


\end_layout

\begin_layout Standard
This chapter is still under substantial revision.
 At any time you can preview any released drafts with the development version
 of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR
\end_layout

\end_inset

 package which is available from 
\family sans
\color inherit
R
\family default
\color none
-Forge:
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

install.packages("IPSUR", repos="http://R-Forge.R-project.org")
\begin_inset Newline newline
\end_inset

library(IPSUR)
\begin_inset Newline newline
\end_inset

read(IPSUR)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Chapter
Nonparametric Statistics
\begin_inset CommandInset label
LatexCommand label
name "cha:Nonparametric-Statistics"

\end_inset


\end_layout

\begin_layout Standard
This chapter is still under substantial revision.
 At any time you can preview any released drafts with the development version
 of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR
\end_layout

\end_inset

 package which is available from 
\family sans
\color inherit
R
\family default
\color none
-Forge:
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

install.packages("IPSUR", repos="http://R-Forge.R-project.org")
\begin_inset Newline newline
\end_inset

library(IPSUR)
\begin_inset Newline newline
\end_inset

read(IPSUR)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Chapter
Time Series
\begin_inset CommandInset label
LatexCommand label
name "cha:Time-Series"

\end_inset


\end_layout

\begin_layout Standard
This chapter is still under substantial revision.
 At any time you can preview any released drafts with the development version
 of the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR
\end_layout

\end_inset

 package which is available from 
\family sans
\color inherit
R
\family default
\color none
-Forge:
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

install.packages("IPSUR", repos="http://R-Forge.R-project.org")
\begin_inset Newline newline
\end_inset

library(IPSUR)
\begin_inset Newline newline
\end_inset

read(IPSUR)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Chapter
\start_of_appendix

\family sans
R
\family default
 Session Information
\begin_inset CommandInset label
LatexCommand label
name "cha:R-Session-Information"

\end_inset


\end_layout

\begin_layout Standard
If you ever write the 
\family sans
R
\family default
 help mailing list with a question, then you should include your session
 information in the email; it makes the reader's job easier and is requested
 by the Posting Guide.
 Here is how to do that, and below is what the output looks like.
 
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

sessionInfo()
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
\begin_inset VSpace vfill
\end_inset


\end_layout

\begin_layout Chapter
GNU Free Documentation License
\begin_inset CommandInset label
LatexCommand label
name "cha:GNU-Free-Documentation"

\end_inset


\end_layout

\begin_layout Standard
\align center

\series bold
\size large
Version 1.3, 3 November 2008
\series default
\size default

\begin_inset VSpace bigskip
\end_inset


\end_layout

\begin_layout Standard
\noindent
Copyright (C) 2000, 2001, 2002, 2007, 2008 Free Software Foundation, Inc.
\end_layout

\begin_layout Standard
\align center
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://fsf.org/
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
Everyone is permitted to copy and distribute verbatim copies of this license
 document, but changing it is not allowed.
\end_layout

\begin_layout Section*
0.
 PREAMBLE
\end_layout

\begin_layout Standard
The purpose of this License is to make a manual, textbook, or other functional
 and useful document "free" in the sense of freedom: to assure everyone
 the effective freedom to copy and redistribute it, with or without modifying
 it, either commercially or noncommercially.
 Secondarily, this License preserves for the author and publisher a way
 to get credit for their work, while not being considered responsible for
 modifications made by others.
\end_layout

\begin_layout Standard
This License is a kind of "copyleft", which means that derivative works
 of the document must themselves be free in the same sense.
 It complements the GNU General Public License, which is a copyleft license
 designed for free software.
\end_layout

\begin_layout Standard
We have designed this License in order to use it for manuals for free software,
 because free software needs free documentation: a free program should come
 with manuals providing the same freedoms that the software does.
 But this License is not limited to software manuals; it can be used for
 any textual work, regardless of subject matter or whether it is published
 as a printed book.
 We recommend this License principally for works whose purpose is instruction
 or reference.
\end_layout

\begin_layout Section*
1.
 APPLICABILITY AND DEFINITIONS
\end_layout

\begin_layout Standard
This License applies to any manual or other work, in any medium, that contains
 a notice placed by the copyright holder saying it can be distributed under
 the terms of this License.
 Such a notice grants a world-wide, royalty-free license, unlimited in duration,
 to use that work under the conditions stated herein.
 The "Document", below, refers to any such manual or work.
 Any member of the public is a licensee, and is addressed as "you".
 You accept the license if you copy, modify or distribute the work in a
 way requiring permission under copyright law.
\end_layout

\begin_layout Standard
A "Modified Version" of the Document means any work containing the Document
 or a portion of it, either copied verbatim, or with modifications and/or
 translated into another language.
\end_layout

\begin_layout Standard
A "Secondary Section" is a named appendix or a front-matter section of the
 Document that deals exclusively with the relationship of the publishers
 or authors of the Document to the Document's overall subject (or to related
 matters) and contains nothing that could fall directly within that overall
 subject.
 (Thus, if the Document is in part a textbook of mathematics, a Secondary
 Section may not explain any mathematics.) The relationship could be a matter
 of historical connection with the subject or with related matters, or of
 legal, commercial, philosophical, ethical or political position regarding
 them.
\end_layout

\begin_layout Standard
The "Invariant Sections" are certain Secondary Sections whose titles are
 designated, as being those of Invariant Sections, in the notice that says
 that the Document is released under this License.
 If a section does not fit the above definition of Secondary then it is
 not allowed to be designated as Invariant.
 The Document may contain zero Invariant Sections.
 If the Document does not identify any Invariant Sections then there are
 none.
\end_layout

\begin_layout Standard
The "Cover Texts" are certain short passages of text that are listed, as
 Front-Cover Texts or Back-Cover Texts, in the notice that says that the
 Document is released under this License.
 A Front-Cover Text may be at most 5 words, and a Back-Cover Text may be
 at most 25 words.
\end_layout

\begin_layout Standard
A "Transparent" copy of the Document means a machine-readable copy, represented
 in a format whose specification is available to the general public, that
 is suitable for revising the document straightforwardly with generic text
 editors or (for images composed of pixels) generic paint programs or (for
 drawings) some widely available drawing editor, and that is suitable for
 input to text formatters or for automatic translation to a variety of formats
 suitable for input to text formatters.
 A copy made in an otherwise Transparent file format whose markup, or absence
 of markup, has been arranged to thwart or discourage subsequent modification
 by readers is not Transparent.
 An image format is not Transparent if used for any substantial amount of
 text.
 A copy that is not "Transparent" is called "Opaque".
\end_layout

\begin_layout Standard
Examples of suitable formats for Transparent copies include plain ASCII
 without markup, Texinfo input format, LaTeX input format, SGML or XML using
 a publicly available DTD, and standard-conforming simple HTML, PostScript
 or PDF designed for human modification.
 Examples of transparent image formats include PNG, XCF and JPG.
 Opaque formats include proprietary formats that can be read and edited
 only by proprietary word processors, SGML or XML for which the DTD and/or
 processing tools are not generally available, and the machine-generated
 HTML, PostScript or PDF produced by some word processors for output purposes
 only.
\end_layout

\begin_layout Standard
The "Title Page" means, for a printed book, the title page itself, plus
 such following pages as are needed to hold, legibly, the material this
 License requires to appear in the title page.
 For works in formats which do not have any title page as such, "Title Page"
 means the text near the most prominent appearance of the work's title,
 preceding the beginning of the body of the text.
\end_layout

\begin_layout Standard
The "publisher" means any person or entity that distributes copies of the
 Document to the public.
\end_layout

\begin_layout Standard
A section "Entitled XYZ" means a named subunit of the Document whose title
 either is precisely XYZ or contains XYZ in parentheses following text that
 translates XYZ in another language.
 (Here XYZ stands for a specific section name mentioned below, such as "Acknowle
dgements", "Dedications", "Endorsements", or "History".) To "Preserve the
 Title" of such a section when you modify the Document means that it remains
 a section "Entitled XYZ" according to this definition.
\end_layout

\begin_layout Standard
The Document may include Warranty Disclaimers next to the notice which states
 that this License applies to the Document.
 These Warranty Disclaimers are considered to be included by reference in
 this License, but only as regards disclaiming warranties: any other implication
 that these Warranty Disclaimers may have is void and has no effect on the
 meaning of this License.
\end_layout

\begin_layout Section*
2.
 VERBATIM COPYING
\end_layout

\begin_layout Standard
You may copy and distribute the Document in any medium, either commercially
 or noncommercially, provided that this License, the copyright notices,
 and the license notice saying this License applies to the Document are
 reproduced in all copies, and that you add no other conditions whatsoever
 to those of this License.
 You may not use technical measures to obstruct or control the reading or
 further copying of the copies you make or distribute.
 However, you may accept compensation in exchange for copies.
 If you distribute a large enough number of copies you must also follow
 the conditions in section 3.
\end_layout

\begin_layout Standard
You may also lend copies, under the same conditions stated above, and you
 may publicly display copies.
\end_layout

\begin_layout Section*
3.
 COPYING IN QUANTITY
\end_layout

\begin_layout Standard
If you publish printed copies (or copies in media that commonly have printed
 covers) of the Document, numbering more than 100, and the Document's license
 notice requires Cover Texts, you must enclose the copies in covers that
 carry, clearly and legibly, all these Cover Texts: Front-Cover Texts on
 the front cover, and Back-Cover Texts on the back cover.
 Both covers must also clearly and legibly identify you as the publisher
 of these copies.
 The front cover must present the full title with all words of the title
 equally prominent and visible.
 You may add other material on the covers in addition.
 Copying with changes limited to the covers, as long as they preserve the
 title of the Document and satisfy these conditions, can be treated as verbatim
 copying in other respects.
\end_layout

\begin_layout Standard
If the required texts for either cover are too voluminous to fit legibly,
 you should put the first ones listed (as many as fit reasonably) on the
 actual cover, and continue the rest onto adjacent pages.
\end_layout

\begin_layout Standard
If you publish or distribute Opaque copies of the Document numbering more
 than 100, you must either include a machine-readable Transparent copy along
 with each Opaque copy, or state in or with each Opaque copy a computer-network
 location from which the general network-using public has access to download
 using public-standard network protocols a complete Transparent copy of
 the Document, free of added material.
 If you use the latter option, you must take reasonably prudent steps, when
 you begin distribution of Opaque copies in quantity, to ensure that this
 Transparent copy will remain thus accessible at the stated location until
 at least one year after the last time you distribute an Opaque copy (directly
 or through your agents or retailers) of that edition to the public.
\end_layout

\begin_layout Standard
It is requested, but not required, that you contact the authors of the Document
 well before redistributing any large number of copies, to give them a chance
 to provide you with an updated version of the Document.
\end_layout

\begin_layout Section*
4.
 MODIFICATIONS
\end_layout

\begin_layout Standard
You may copy and distribute a Modified Version of the Document under the
 conditions of sections 2 and 3 above, provided that you release the Modified
 Version under precisely this License, with the Modified Version filling
 the role of the Document, thus licensing distribution and modification
 of the Modified Version to whoever possesses a copy of it.
 In addition, you must do these things in the Modified Version:
\end_layout

\begin_layout Standard
A.
 Use in the Title Page (and on the covers, if any) a title distinct from
 that of the Document, and from those of previous versions (which should,
 if there were any, be listed in the History section of the Document).
 You may use the same title as a previous version if the original publisher
 of that version gives permission.
 
\end_layout

\begin_layout Standard
B.
 List on the Title Page, as authors, one or more persons or entities responsible
 for authorship of the modifications in the Modified Version, together with
 at least five of the principal authors of the Document (all of its principal
 authors, if it has fewer than five), unless they release you from this
 requirement.
 
\end_layout

\begin_layout Standard
C.
 State on the Title page the name of the publisher of the Modified Version,
 as the publisher.
 
\end_layout

\begin_layout Standard
D.
 Preserve all the copyright notices of the Document.
 
\end_layout

\begin_layout Standard
E.
 Add an appropriate copyright notice for your modifications adjacent to
 the other copyright notices.
 
\end_layout

\begin_layout Standard
F.
 Include, immediately after the copyright notices, a license notice giving
 the public permission to use the Modified Version under the terms of this
 License, in the form shown in the Addendum below.
 
\end_layout

\begin_layout Standard
G.
 Preserve in that license notice the full lists of Invariant Sections and
 required Cover Texts given in the Document's license notice.
 
\end_layout

\begin_layout Standard
H.
 Include an unaltered copy of this License.
 
\end_layout

\begin_layout Standard
I.
 Preserve the section Entitled "History", Preserve its Title, and add to
 it an item stating at least the title, year, new authors, and publisher
 of the Modified Version as given on the Title Page.
 If there is no section Entitled "History" in the Document, create one stating
 the title, year, authors, and publisher of the Document as given on its
 Title Page, then add an item describing the Modified Version as stated
 in the previous sentence.
 
\end_layout

\begin_layout Standard
J.
 Preserve the network location, if any, given in the Document for public
 access to a Transparent copy of the Document, and likewise the network
 locations given in the Document for previous versions it was based on.
 These may be placed in the "History" section.
 You may omit a network location for a work that was published at least
 four years before the Document itself, or if the original publisher of
 the version it refers to gives permission.
 
\end_layout

\begin_layout Standard
K.
 For any section Entitled "Acknowledgements" or "Dedications", Preserve
 the Title of the section, and preserve in the section all the substance
 and tone of each of the contributor acknowledgements and/or dedications
 given therein.
 
\end_layout

\begin_layout Standard
L.
 Preserve all the Invariant Sections of the Document, unaltered in their
 text and in their titles.
 Section numbers or the equivalent are not considered part of the section
 titles.
 
\end_layout

\begin_layout Standard
M.
 Delete any section Entitled "Endorsements".
 Such a section may not be included in the Modified Version.
 
\end_layout

\begin_layout Standard
N.
 Do not retitle any existing section to be Entitled "Endorsements" or to
 conflict in title with any Invariant Section.
 
\end_layout

\begin_layout Standard
O.
 Preserve any Warranty Disclaimers.
\end_layout

\begin_layout Standard
If the Modified Version includes new front-matter sections or appendices
 that qualify as Secondary Sections and contain no material copied from
 the Document, you may at your option designate some or all of these sections
 as invariant.
 To do this, add their titles to the list of Invariant Sections in the Modified
 Version's license notice.
 These titles must be distinct from any other section titles.
\end_layout

\begin_layout Standard
You may add a section Entitled "Endorsements", provided it contains nothing
 but endorsements of your Modified Version by various parties--for example,
 statements of peer review or that the text has been approved by an organization
 as the authoritative definition of a standard.
\end_layout

\begin_layout Standard
You may add a passage of up to five words as a Front-Cover Text, and a passage
 of up to 25 words as a Back-Cover Text, to the end of the list of Cover
 Texts in the Modified Version.
 Only one passage of Front-Cover Text and one of Back-Cover Text may be
 added by (or through arrangements made by) any one entity.
 If the Document already includes a cover text for the same cover, previously
 added by you or by arrangement made by the same entity you are acting on
 behalf of, you may not add another; but you may replace the old one, on
 explicit permission from the previous publisher that added the old one.
\end_layout

\begin_layout Standard
The author(s) and publisher(s) of the Document do not by this License give
 permission to use their names for publicity for or to assert or imply endorseme
nt of any Modified Version.
\end_layout

\begin_layout Section*
5.
 COMBINING DOCUMENTS
\end_layout

\begin_layout Standard
You may combine the Document with other documents released under this License,
 under the terms defined in section 4 above for modified versions, provided
 that you include in the combination all of the Invariant Sections of all
 of the original documents, unmodified, and list them all as Invariant Sections
 of your combined work in its license notice, and that you preserve all
 their Warranty Disclaimers.
\end_layout

\begin_layout Standard
The combined work need only contain one copy of this License, and multiple
 identical Invariant Sections may be replaced with a single copy.
 If there are multiple Invariant Sections with the same name but different
 contents, make the title of each such section unique by adding at the end
 of it, in parentheses, the name of the original author or publisher of
 that section if known, or else a unique number.
 Make the same adjustment to the section titles in the list of Invariant
 Sections in the license notice of the combined work.
\end_layout

\begin_layout Standard
In the combination, you must combine any sections Entitled "History" in
 the various original documents, forming one section Entitled "History";
 likewise combine any sections Entitled "Acknowledgements", and any sections
 Entitled "Dedications".
 You must delete all sections Entitled "Endorsements".
\end_layout

\begin_layout Section*
6.
 COLLECTIONS OF DOCUMENTS
\end_layout

\begin_layout Standard
You may make a collection consisting of the Document and other documents
 released under this License, and replace the individual copies of this
 License in the various documents with a single copy that is included in
 the collection, provided that you follow the rules of this License for
 verbatim copying of each of the documents in all other respects.
\end_layout

\begin_layout Standard
You may extract a single document from such a collection, and distribute
 it individually under this License, provided you insert a copy of this
 License into the extracted document, and follow this License in all other
 respects regarding verbatim copying of that document.
\end_layout

\begin_layout Section*
7.
 AGGREGATION WITH INDEPENDENT WORKS
\end_layout

\begin_layout Standard
A compilation of the Document or its derivatives with other separate and
 independent documents or works, in or on a volume of a storage or distribution
 medium, is called an "aggregate" if the copyright resulting from the compilatio
n is not used to limit the legal rights of the compilation's users beyond
 what the individual works permit.
 When the Document is included in an aggregate, this License does not apply
 to the other works in the aggregate which are not themselves derivative
 works of the Document.
\end_layout

\begin_layout Standard
If the Cover Text requirement of section 3 is applicable to these copies
 of the Document, then if the Document is less than one half of the entire
 aggregate, the Document's Cover Texts may be placed on covers that bracket
 the Document within the aggregate, or the electronic equivalent of covers
 if the Document is in electronic form.
 Otherwise they must appear on printed covers that bracket the whole aggregate.
\end_layout

\begin_layout Section*
8.
 TRANSLATION
\end_layout

\begin_layout Standard
Translation is considered a kind of modification, so you may distribute
 translations of the Document under the terms of section 4.
 Replacing Invariant Sections with translations requires special permission
 from their copyright holders, but you may include translations of some
 or all Invariant Sections in addition to the original versions of these
 Invariant Sections.
 You may include a translation of this License, and all the license notices
 in the Document, and any Warranty Disclaimers, provided that you also include
 the original English version of this License and the original versions
 of those notices and disclaimers.
 In case of a disagreement between the translation and the original version
 of this License or a notice or disclaimer, the original version will prevail.
\end_layout

\begin_layout Standard
If a section in the Document is Entitled "Acknowledgements", "Dedications",
 or "History", the requirement (section 4) to Preserve its Title (section
 1) will typically require changing the actual title.
\end_layout

\begin_layout Section*
9.
 TERMINATION
\end_layout

\begin_layout Standard
You may not copy, modify, sublicense, or distribute the Document except
 as expressly provided under this License.
 Any attempt otherwise to copy, modify, sublicense, or distribute it is
 void, and will automatically terminate your rights under this License.
\end_layout

\begin_layout Standard
However, if you cease all violation of this License, then your license from
 a particular copyright holder is reinstated (a) provisionally, unless and
 until the copyright holder explicitly and finally terminates your license,
 and (b) permanently, if the copyright holder fails to notify you of the
 violation by some reasonable means prior to 60 days after the cessation.
\end_layout

\begin_layout Standard
Moreover, your license from a particular copyright holder is reinstated
 permanently if the copyright holder notifies you of the violation by some
 reasonable means, this is the first time you have received notice of violation
 of this License (for any work) from that copyright holder, and you cure
 the violation prior to 30 days after your receipt of the notice.
\end_layout

\begin_layout Standard
Termination of your rights under this section does not terminate the licenses
 of parties who have received copies or rights from you under this License.
 If your rights have been terminated and not permanently reinstated, receipt
 of a copy of some or all of the same material does not give you any rights
 to use it.
\end_layout

\begin_layout Section*
10.
 FUTURE REVISIONS OF THIS LICENSE
\end_layout

\begin_layout Standard
The Free Software Foundation may publish new, revised versions of the GNU
 Free Documentation License from time to time.
 Such new versions will be similar in spirit to the present version, but
 may differ in detail to address new problems or concerns.
 See http://www.gnu.org/copyleft/.
\end_layout

\begin_layout Standard
Each version of the License is given a distinguishing version number.
 If the Document specifies that a particular numbered version of this License
 "or any later version" applies to it, you have the option of following
 the terms and conditions either of that specified version or of any later
 version that has been published (not as a draft) by the Free Software Foundatio
n.
 If the Document does not specify a version number of this License, you
 may choose any version ever published (not as a draft) by the Free Software
 Foundation.
 If the Document specifies that a proxy can decide which future versions
 of this License can be used, that proxy's public statement of acceptance
 of a version permanently authorizes you to choose that version for the
 Document.
\end_layout

\begin_layout Section*
11.
 RELICENSING
\end_layout

\begin_layout Standard
"Massive Multiauthor Collaboration Site" (or "MMC Site") means any World
 Wide Web server that publishes copyrightable works and also provides prominent
 facilities for anybody to edit those works.
 A public wiki that anybody can edit is an example of such a server.
 A "Massive Multiauthor Collaboration" (or "MMC") contained in the site
 means any set of copyrightable works thus published on the MMC site.
\end_layout

\begin_layout Standard
"CC-BY-SA" means the Creative Commons Attribution-Share Alike 3.0 license
 published by Creative Commons Corporation, a not-for-profit corporation
 with a principal place of business in San Francisco, California, as well
 as future copyleft versions of that license published by that same organization.
\end_layout

\begin_layout Standard
"Incorporate" means to publish or republish a Document, in whole or in part,
 as part of another Document.
\end_layout

\begin_layout Standard
An MMC is "eligible for relicensing" if it is licensed under this License,
 and if all works that were first published under this License somewhere
 other than this MMC, and subsequently incorporated in whole or in part
 into the MMC, (1) had no cover texts or invariant sections, and (2) were
 thus incorporated prior to November 1, 2008.
\end_layout

\begin_layout Standard
The operator of an MMC Site may republish an MMC contained in the site under
 CC-BY-SA on the same site at any time before August 1, 2009, provided the
 MMC is eligible for relicensing.
\end_layout

\begin_layout Section*
ADDENDUM: How to use this License for your documents
\end_layout

\begin_layout Standard
To use this License in a document you have written, include a copy of the
 License in the document and put the following copyright and license notices
 just after the title page:
\end_layout

\begin_layout Quotation
\noindent
Copyright (c) YEAR YOUR NAME.
 Permission is granted to copy, distribute and/or modify this document under
 the terms of the GNU Free Documentation License, Version 1.3 or any later
 version published by the Free Software Foundation; with no Invariant Sections,
 no Front-Cover Texts, and no Back-Cover Texts.
 A copy of the license is included in the section entitled "GNU Free Documentati
on License".
\end_layout

\begin_layout Standard
If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts,
 replace the "with...Texts." line with this:
\end_layout

\begin_layout Quotation
\noindent
with the Invariant Sections being LIST THEIR TITLES, with the Front-Cover
 Texts being LIST, and with the Back-Cover Texts being LIST.
\end_layout

\begin_layout Standard
If you have Invariant Sections without Cover Texts, or some other combination
 of the three, merge those two alternatives to suit the situation.
\end_layout

\begin_layout Standard
If your document contains nontrivial examples of program code, we recommend
 releasing these examples in parallel under your choice of free software
 license, such as the GNU General Public License, to permit their use in
 free software.
 
\end_layout

\begin_layout Chapter
History
\begin_inset CommandInset label
LatexCommand label
name "cha:History"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="2">
<features>
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Title:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Introduction to Probability and Statistics Using 
\family sans
R
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Year:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2010
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Authors:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
G.
\begin_inset space ~
\end_inset

Jay Kerns
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\series bold
Publisher:
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
G.
\begin_inset space ~
\end_inset

Jay Kerns
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace vfill
\end_inset


\end_layout

\begin_layout Chapter
Data
\begin_inset CommandInset label
LatexCommand label
name "cha:data"

\end_inset


\end_layout

\begin_layout Standard
This appendix is a reference of sorts regarding some of the data structures
 a statistician is likely to encounter.
 We discuss their salient features and idiosyncrasies.
\end_layout

\begin_layout Section
Data Structures
\begin_inset CommandInset label
LatexCommand label
name "sec:Data-Structures"

\end_inset


\end_layout

\begin_layout Subsection
Vectors
\end_layout

\begin_layout Standard
See the 
\begin_inset Quotes eld
\end_inset

Vectors and Assignment
\begin_inset Quotes erd
\end_inset

 section of 
\emph on
An Introduction to 
\family sans
R
\family default
\emph default
.
 A vector is an ordered sequence of elements, such as numbers, characters,
 or logical values, and there may be 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

NA
\end_layout

\end_inset

's present.
 We usually make vectors with the assignment operator 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

<-
\end_layout

\end_inset

.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x <- c(3, 5, 9)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Vectors are atomic in the sense that if you try to mix and match elements
 of different modes then all elements will be coerced to the most convenient
 common mode.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

y <- c(3, "5", TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
In the example all elements were coerced to 
\emph on
character
\emph default
 mode.
 We can test whether a given object is a vector with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

is.vector
\end_layout

\end_inset


\color inherit
 and can coerce an object (if possible) to a vector with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

as.vector
\end_layout

\end_inset

.
\end_layout

\begin_layout Subsection
Matrices and Arrays
\end_layout

\begin_layout Standard
See the 
\begin_inset Quotes eld
\end_inset

Arrays and Matrices
\begin_inset Quotes erd
\end_inset

 section of 
\emph on
An Introduction to 
\family sans
R
\family default
\emph default
.
 Loosely speaking, a matrix is a vector that has been reshaped into rectangular
 form, and an array is a multidimensional matrix.
 Strictly speaking, it is the other way around: an array is a data vector
 with a dimension attribute (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

dim
\end_layout

\end_inset


\color inherit
), and a matrix is the special case of an array with only two dimensions.
 We can construct a matrix with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

matrix
\end_layout

\end_inset


\color inherit
 function.
 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

matrix(letters[1:6], nrow = 2, ncol = 3)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Notice the order of the matrix entries, which shows how the matrix is populated
 by default.
 We can change this with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

byrow
\end_layout

\end_inset

 argument:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

matrix(letters[1:6], nrow = 2, ncol = 3, byrow = TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We can test whether a given object is a matrix with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

is.matrix
\end_layout

\end_inset


\color inherit
 and can coerce an object (if possible) to a matrix with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

as.matrix
\end_layout

\end_inset


\color inherit
.
 As a final example watch what happens when we mix and match types in the
 first argument:
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

matrix(c(1,"2",NA, FALSE), nrow = 2, ncol = 3)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Notice how all of the entries were coerced to character for the final result
 (except 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

NA
\end_layout

\end_inset


\color inherit
).
 Also notice how the four values were 
\emph on
recycled
\emph default
 to fill up the six entries of the matrix.
\end_layout

\begin_layout Standard
The standard arithmetic operations work element-wise with matrices.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

A <- matrix(1:6, 2, 3)
\begin_inset Newline newline
\end_inset

B <- matrix(2:7, 2, 3)
\begin_inset Newline newline
\end_inset

A + B
\begin_inset Newline newline
\end_inset

A * B
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
If you want the standard definition of matrix multiplication then use the
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

%*%
\end_layout

\end_inset


\color inherit
 function.
 If we were to try 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

A %*% B
\end_layout

\end_inset


\color inherit
 we would get an error because the dimensions do not match correctly, but
 for fun, we could transpose 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

B
\end_layout

\end_inset

 to get conformable matrices.

\color inherit
 The transpose function 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

t
\end_layout

\end_inset

 only works for matrices (and data frames).
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

try(A * B)     # an error
\begin_inset Newline newline
\end_inset

A %*% t(B)     # this is alright
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
To get the ordinary matrix inverse use the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

solve
\end_layout

\end_inset

 function:
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

solve(A %*% t(B))     # input matrix must be square
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Arrays more general than matrices, and some functions (like transpose) do
 not work for the more general array.
 Here is what an array looks like: 
\end_layout

\begin_layout Scrap
<<keep.source = TRUE>>=
\begin_inset Newline newline
\end_inset

array(LETTERS[1:24], dim = c(3,4,2))
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We can test with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

is.array
\end_layout

\end_inset


\color inherit
 and may coerce with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

as.array
\end_layout

\end_inset

.
\end_layout

\begin_layout Subsection
Data Frames
\end_layout

\begin_layout Standard
A data frame is a rectangular array of information with a special status
 in 
\family sans
R
\family default
.
 It is used as the fundamental data structure by many of the modeling functions.
 It is like a matrix in that all of the columns must be the same length,
 but it is more general than a matrix in that columns are allowed to have
 different modes.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

x <- c(1.3, 5.2, 6)
\begin_inset Newline newline
\end_inset

y <- letters[1:3]
\begin_inset Newline newline
\end_inset

z <- c(TRUE, FALSE, TRUE)
\begin_inset Newline newline
\end_inset

A <- data.frame(x, y, z)
\begin_inset Newline newline
\end_inset

A
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Notice the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

names
\end_layout

\end_inset


\color inherit
 on the columns of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

A
\end_layout

\end_inset


\color inherit
.
 We can change those with the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

names
\end_layout

\end_inset


\color inherit
 function.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

names(A) <- c("Fred","Mary","Sue")
\begin_inset Newline newline
\end_inset

A
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Basic command is 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

data.frame
\end_layout

\end_inset


\color inherit
.
 You can test with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

is.data.frame
\end_layout

\end_inset


\color inherit
 and you can coerce with 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

as.data.frame
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Subsection
Lists
\end_layout

\begin_layout Standard
A list is more general than a data frame.
\end_layout

\begin_layout Subsection
Tables
\end_layout

\begin_layout Standard
The word 
\begin_inset Quotes eld
\end_inset

table
\begin_inset Quotes erd
\end_inset

 has a special meaning in 
\family sans
R
\family default
.
 More precisely, a contingency table is an object of class 
\begin_inset Quotes eld
\end_inset


\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

table
\end_layout

\end_inset


\color inherit

\begin_inset Quotes erd
\end_inset

 which is an array
\end_layout

\begin_layout Standard
Suppose you have a contingency table and would like to do descriptive or
 inferential statistics on it.
 The default form of the table is usually inconvenient to use unless we
 are working with a function specially tailored for tables.
 Here is how to transform your data to a more manageable form, namely, the
 raw data used to make the table.
\end_layout

\begin_layout Standard
First, we coerce the table to a data frame with : 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

A <- as.data.frame(Titanic)
\begin_inset Newline newline
\end_inset

head(A)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Note that there are as many preliminary columns of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

A
\end_layout

\end_inset

 as there are dimensions to the table.
 The rows of 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

A
\end_layout

\end_inset

 contain every possible combination of levels from each of the dimensions.
 There is also a 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Freq
\end_layout

\end_inset

 column, which shows how many observations there were at that particular
 combination of levels.
\end_layout

\begin_layout Standard
The form of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

A
\end_layout

\end_inset

 is often sufficient for our purposes, but more often we need to do more
 work: we would usually like to repeat each row of 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

A
\end_layout

\end_inset

 exactly the number of times shown in the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Freq
\end_layout

\end_inset

 column.
 The 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

reshape
\end_layout

\end_inset

 package 
\begin_inset CommandInset citation
LatexCommand cite
key "Wickhamreshape"

\end_inset

 has the function 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

untable
\end_layout

\end_inset

 designed for that very purpose: 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(reshape)
\begin_inset Newline newline
\end_inset

B <- with(A, untable(A, Freq))
\begin_inset Newline newline
\end_inset

head(B)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Now, this is more like it.
 Note that we slipped in a call to the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

with
\end_layout

\end_inset


\color inherit
 function
\color none
, which was done to make the call to 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

untable
\end_layout

\end_inset

 more pretty; we could just as easily have done
\end_layout

\begin_layout Standard

\color none
\begin_inset listings
lstparams "showstringspaces=false"
inline false
status open

\begin_layout Plain Layout

untable(TitanicDF, A$Freq)
\end_layout

\end_inset


\end_layout

\begin_layout Standard

\color none
The only fly in the ointment is the lingering 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Freq
\end_layout

\end_inset

 column which has repeated values that do not have any meaning any more.
 We could just ignore it, but it would be better to get rid of the meaningless
 column so that it does not cause trouble later.
 While we are at it, we could clean up the 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

rownames
\end_layout

\end_inset

, too.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

C <- B[, -5]
\begin_inset Newline newline
\end_inset

rownames(C) <- 1:dim(C)[1]
\begin_inset Newline newline
\end_inset

head(C)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Subsection
More about Tables
\end_layout

\begin_layout Standard
Suppose you want to make a table that looks like this:
\end_layout

\begin_layout Standard
There are at least two ways to do it.
\end_layout

\begin_layout Itemize
Using a matrix:
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

tab <- matrix(1:6, nrow = 2, ncol = 3)
\begin_inset Newline newline
\end_inset

rownames(tab) <- c('first', 'second')
\begin_inset Newline newline
\end_inset

colnames(tab) <- c('A', 'B', 'C')
\begin_inset Newline newline
\end_inset

tab  # Counts
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Itemize
note that the columns are filled in consecutively by default.
 If you want to fill the data in by rows then do byrow = TRUE in the matrix
 command.
\end_layout

\begin_layout Itemize
the object is a matrix
\end_layout

\end_deeper
\begin_layout Itemize
Using a dataframe
\end_layout

\begin_deeper
\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

p <- c("milk","tea")
\begin_inset Newline newline
\end_inset

g <- c("milk","tea")
\begin_inset Newline newline
\end_inset

catgs <- expand.grid(poured = p, guessed = g)
\begin_inset Newline newline
\end_inset

cnts <- c(3, 1, 1, 3)
\begin_inset Newline newline
\end_inset

D <- cbind(catgs, count = cnts)
\begin_inset Newline newline
\end_inset

xtabs(count ~ poured + guessed, data = D)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Itemize
again, the data are filled in column-wise.
\end_layout

\begin_layout Itemize
the object is a dataframe
\end_layout

\begin_layout Itemize
if you want to store it as a table then do A <- xtabs(count ~ poured + guessed,
 data = D)
\end_layout

\end_deeper
\begin_layout Section
Importing Data
\begin_inset CommandInset label
LatexCommand label
name "sec:Importing-A-Data"

\end_inset


\end_layout

\begin_layout Standard
Statistics is the study of data, so the statistician's first step is usually
 to obtain data from somewhere or another and read them into 
\family sans
R
\family default
.
 In this section we describe some of the most common sources of data and
 how to get data from those sources into a running 
\family sans
R
\family default
 session.
\end_layout

\begin_layout Standard
For more information please refer to the 
\family sans
R
\family default
 
\emph on
Data Import/Export Manual
\emph default
, 
\begin_inset CommandInset citation
LatexCommand cite
key "rstatenv"

\end_inset

 and 
\emph on
An Introduction to 
\family sans
R
\family default
\emph default
, 
\begin_inset CommandInset citation
LatexCommand cite
key "Venables2010"

\end_inset

.
\end_layout

\begin_layout Subsection
Data in Packages
\end_layout

\begin_layout Standard
There are many data sets stored in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

datasets
\end_layout

\end_inset

 package of
\color inherit
 base 
\family sans
R
\family default
.
 To see a list of them all 
\color none
issue the command 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

data(package = "datasets")
\end_layout

\end_inset

.
 The output is omitted here because the list is so long.
 The names of the data sets are listed in the left column.
 Any data set in that list is already on the search path by default, which
 means that a user can use it immediately without any additional work.
\end_layout

\begin_layout Standard
There are many other data sets available in the thousands of contributed
 packages.
 To see the data sets available in those packages that are currently loaded
 into memory issue the single command 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

data()
\end_layout

\end_inset


\color inherit
.
 If you would like to see all of the data sets that are available in all
 packages that are installed on your computer (but not necessarily loaded),
 issue the command 
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=2"
inline false
status open

\begin_layout Plain Layout

data(package = .packages(all.available = TRUE))
\end_layout

\end_inset


\end_layout

\begin_layout Standard
To load the data set 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

foo
\end_layout

\end_inset

 in the contributed package 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

bar
\end_layout

\end_inset

 issue the commands 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

library(bar)
\end_layout

\end_inset

 followed by 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

data(foo)
\end_layout

\end_inset

, or just the single command
\color inherit
 
\begin_inset listings
lstparams "breaklines=true,showstringspaces=false,tabsize=2"
inline false
status open

\begin_layout Plain Layout

data(foo, package = "bar")
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Text Files
\end_layout

\begin_layout Standard
Many sources of data are simple text files.
 The entries in the file are separated by delimeters such as TABS (tab-delimeted
), commas (comma separated values, or 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.csv
\end_layout

\end_inset


\color inherit
, for short) or even just white space (no special name).
 A lot of data on the Internet are stored with text files, and even if they
 are not, a person can copy-paste information from a web page to a text
 file, save it on the computer, and read it into 
\family sans
R
\family default
.
 
\end_layout

\begin_layout Subsection
Other Software Files
\end_layout

\begin_layout Standard
Often the data set of interest is stored in some other, proprietary, format
 by third-party software such as Minitab, SAS, or SPSS.
 The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

foreign
\end_layout

\end_inset


\color inherit
 package supports import/conversion from many of these formats.
 Please note, however, that data sets from other software sometimes have
 properties with no direct analogue in 
\family sans
R
\family default
.
 In those cases the conversion process may lose some information which will
 need to be reentered manually from within 
\family sans
R
\family default
.
 See the 
\emph on
Data Import/Export Manual
\emph default
.
\end_layout

\begin_layout Standard
As an example, suppose the data are stored in the SPSS file 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

foo.sav
\end_layout

\end_inset

 which the user has copied to the working directory; it can be imported
 with the commands
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

library(foreign)
\begin_inset Newline newline
\end_inset

read.spss("foo.sav")
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
See 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?read.spss
\end_layout

\end_inset

 for the available options to customize the file import.
 Note that the 
\family sans
\color inherit
R
\family default
\color none
 Commander will import many of the common file types with a menu driven
 interface.
\end_layout

\begin_layout Subsection
Importing a Data Frame
\end_layout

\begin_layout Standard
The basic command is 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

read.table
\end_layout

\end_inset

.
\end_layout

\begin_layout Section
Creating New Data Sets
\begin_inset CommandInset label
LatexCommand label
name "sec:Creating-New-Data"

\end_inset


\end_layout

\begin_layout Standard
Using 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

c
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Using 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

scan
\end_layout

\end_inset


\end_layout

\begin_layout Standard
Using the 
\family sans
R
\family default
 Commander.
\end_layout

\begin_layout Section
Editing Data
\begin_inset CommandInset label
LatexCommand label
name "sec:Editing-Data-Sets"

\end_inset


\end_layout

\begin_layout Subsection
Editing Data Values
\end_layout

\begin_layout Subsection
Inserting Rows and Columns
\end_layout

\begin_layout Subsection
Deleting Rows and Columns
\end_layout

\begin_layout Subsection
Sorting Data
\end_layout

\begin_layout Standard
We can sort a vector with the 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

sort
\end_layout

\end_inset

 function.
 Normally we have a data frame of several columns (variables) and many,
 many rows (observations).
 The goal is to shuffle the rows so that they are ordered by the values
 of one or more columns.
 This is done with the 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

order
\end_layout

\end_inset

 function.
 
\end_layout

\begin_layout Standard
For example, we may sort all of the rows of the 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

Puromycin
\end_layout

\end_inset

 data (in ascending order) by the variable 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

conc
\end_layout

\end_inset

 with the following: 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

Tmp <- Puromycin[order(Puromycin$conc), ]
\begin_inset Newline newline
\end_inset

head(Tmp)
\begin_inset Newline newline
\end_inset

@ 
\end_layout

\begin_layout Standard
We can accomplish the same thing with the command 
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

with(Puromycin, Puromycin[order(conc), ])
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
We can sort by more than one variable.
 To sort first by 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

state
\end_layout

\end_inset

 and next by 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

conc
\end_layout

\end_inset

 do 
\end_layout

\begin_layout Scrap
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

with(Puromycin, Puromycin[order(state, conc), ])
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
If we would like to sort a numeric variable in descending order then we
 put a minus sign in front of it.
 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

Tmp <- with(Puromycin, Puromycin[order(-conc), ])
\begin_inset Newline newline
\end_inset

head(Tmp)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
If we would like to sort by a character (or factor) in decreasing order
 then we can use the 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

xtfrm
\end_layout

\end_inset

 function which produces a numeric vector in the same order as the character
 vector.
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

Tmp <- with(Puromycin, Puromycin[order(-xtfrm(state)), ])
\begin_inset Newline newline
\end_inset

head(Tmp)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Section
Exporting Data
\begin_inset CommandInset label
LatexCommand label
name "sec:Exporting-a-Data"

\end_inset


\end_layout

\begin_layout Standard
The basic function is 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

write.table
\end_layout

\end_inset

.
 The 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

MASS
\end_layout

\end_inset

 package also has a 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

write.matrix
\end_layout

\end_inset

 function.
\end_layout

\begin_layout Section
Reshaping Data
\begin_inset CommandInset label
LatexCommand label
name "sec:Reshaping-a-Data"

\end_inset


\end_layout

\begin_layout Itemize
Aggregation
\end_layout

\begin_layout Itemize
Convert Tables to data frames and back
\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

rbind
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

cbind
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

ab[order(ab[,1]),]
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

complete.cases
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

aggregate
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

stack
\end_layout

\end_inset


\end_layout

\begin_layout Chapter
Mathematical Machinery
\begin_inset CommandInset label
LatexCommand label
name "cha:Mathematical-Machinery"

\end_inset


\end_layout

\begin_layout Standard
This appendix houses many of the standard definitions and theorems that
 are used at some point during the narrative.
 It is targeted for someone reading the book who forgets the precise definition
 of something and would like a quick reminder of an exact statement.
 No proofs are given, and the interested reader should consult a good text
 on Calculus (say, Stewart 
\begin_inset CommandInset citation
LatexCommand citet
key "Stewart2008"

\end_inset

 or Apostol 
\begin_inset CommandInset citation
LatexCommand cite
key "Apostol1967,ApostolI1967"

\end_inset

), Linear Algebra (say, Strang 
\begin_inset CommandInset citation
LatexCommand cite
key "Strang1988"

\end_inset

 and Magnus 
\begin_inset CommandInset citation
LatexCommand cite
key "Magnus1999"

\end_inset

), Real Analysis (say, Folland 
\begin_inset CommandInset citation
LatexCommand citet
key "Folland1999"

\end_inset

, or Carothers 
\begin_inset CommandInset citation
LatexCommand cite
key "Carothers2000"

\end_inset

), or Measure Theory (Billingsley 
\begin_inset CommandInset citation
LatexCommand cite
key "Billingsley1995"

\end_inset

, Ash 
\begin_inset CommandInset citation
LatexCommand cite
key "Ash2000"

\end_inset

, Resnick 
\begin_inset CommandInset citation
LatexCommand cite
key "Resnick1999"

\end_inset

) for details.
 
\end_layout

\begin_layout Section
Set Algebra
\begin_inset CommandInset label
LatexCommand label
name "sec:The-Algebra-of"

\end_inset


\end_layout

\begin_layout Standard
We denote sets by capital letters, 
\begin_inset Formula $A$
\end_inset

, 
\begin_inset Formula $B$
\end_inset

, 
\begin_inset Formula $C$
\end_inset

, 
\emph on
etc
\emph default
.
 The letter 
\begin_inset Formula $S$
\end_inset

 is reserved for the sample space, also known as the universe or universal
 set, the set which contains all possible elements.
 The symbol 
\begin_inset Formula $\emptyset$
\end_inset

 represents the empty set, the set with no elements.
 
\end_layout

\begin_layout Subsection*
Set Union, Intersection, and Difference
\end_layout

\begin_layout Standard
Given subsets 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

, we may manipulate them in an algebraic fashion.
 To this end, we have three set operations at our disposal: union, intersection,
 and difference.
 Below is a table summarizing the pertinent information about these operations.
\begin_inset Float table
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="4">
<features>
<column alignment="left" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<column alignment="left" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Name 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Denoted 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Defined by elements 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\family sans
R
\family default
 syntax
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Union 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $A\cup B$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in 
\begin_inset Formula $A$
\end_inset

 or 
\begin_inset Formula $B$
\end_inset

 or both 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

union(A, B)
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Intersection 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $A\cap B$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in both 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

intersect(A, B)
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Difference
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $A\textbackslash B$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in 
\begin_inset Formula $A$
\end_inset

 but not in 
\begin_inset Formula $B$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

setdiff(A, B)
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
Complement
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $A^{c}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
in 
\begin_inset Formula $S$
\end_inset

 but not in 
\begin_inset Formula $A$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="left" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset listings
lstparams "showstringspaces=false,tabsize=2"
inline true
status open

\begin_layout Plain Layout

setdiff(S, A)
\end_layout

\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Set operations
\begin_inset CommandInset label
LatexCommand label
name "tab:Set-Operations"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Identities and Properties
\end_layout

\begin_layout Enumerate
\begin_inset Formula $A\cup\emptyset=A,\quad A\cap\emptyset=\emptyset$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $A\cup S=S,\quad A\cap S=A$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $A\cup A^{c}=S$
\end_inset

, 
\begin_inset Formula $A\cap A^{c}=\emptyset$
\end_inset


\end_layout

\begin_layout Enumerate
\begin_inset Formula $(A{}^{c})^{c}=A$
\end_inset


\end_layout

\begin_layout Enumerate
The Commutative Property: 
\begin_inset Formula \begin{equation}
A\cup B=B\cup A,\quad A\cap B=B\cap A\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
The Associative Property: 
\begin_inset Formula \begin{equation}
(A\cup B)\cup C=A\cup(B\cup C),\quad(A\cap B)\cap C=A\cap(B\cap C)\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
The Distributive Property: 
\begin_inset Formula \begin{equation}
A\cup(B\cap C)=(A\cup B)\cap(A\cup B),\quad A\cap(B\cup C)=(A\cap B)\cup(A\cap B)\end{equation}

\end_inset


\end_layout

\begin_layout Enumerate
DeMorgan's Laws
\begin_inset Formula \begin{equation}
(A\cup B)^{c}=A^{c}\cap B^{c}\quad\mbox{and}\quad(A\cap B)^{c}=A^{c}\cup B^{c},\end{equation}

\end_inset

or more generally,
\begin_inset Formula \begin{equation}
\left(\bigcup_{\alpha}A_{\alpha}\right)^{c}=\bigcap_{\alpha}A_{\alpha}^{c},\quad\mbox{and}\quad\left(\bigcap_{\alpha}A_{\alpha}\right)^{c}=\bigcup_{\alpha}A_{\alpha}^{c}\end{equation}

\end_inset


\end_layout

\begin_layout Section
Differential and Integral Calculus
\begin_inset CommandInset label
LatexCommand label
name "sec:Differential-and-Integral"

\end_inset


\end_layout

\begin_layout Standard
A function 
\begin_inset Formula $f$
\end_inset

 of one variable is said to be one-to-one if no two distinct 
\begin_inset Formula $x$
\end_inset

 values are mapped to the same 
\begin_inset Formula $y=f(x)$
\end_inset

 value.
 To show that a function is one-to-one we can either use the horizontal
 line test or we may start with the equation 
\begin_inset Formula $f(x_{1})=f(x_{2})$
\end_inset

 and use algebra to show that it implies 
\begin_inset Formula $x_{1}=x_{2}$
\end_inset

.
\end_layout

\begin_layout Subsection*
Limits and Continuity
\end_layout

\begin_layout Definition
Let 
\begin_inset Formula $f$
\end_inset

 be a function defined on some open interval that contains the number 
\begin_inset Formula $a$
\end_inset

, except possibly at 
\begin_inset Formula $a$
\end_inset

 itself.
 Then we say the 
\emph on
limit of
\emph default
 
\begin_inset Formula $f(x)$
\end_inset

 
\emph on
as
\emph default
 
\begin_inset Formula $x$
\end_inset

 
\emph on
approaches
\emph default
 
\begin_inset Formula $a$
\end_inset

 
\emph on
is
\emph default
 
\begin_inset Formula $L$
\end_inset

, and we write 
\begin_inset Formula \begin{equation}
\lim_{x\to a}f(x)=L,\end{equation}

\end_inset

if for every 
\begin_inset Formula $\epsilon>0$
\end_inset

 there exists a number 
\begin_inset Formula $\delta>0$
\end_inset

 such that 
\begin_inset Formula $0<|x-a|<\delta$
\end_inset

 implies 
\begin_inset Formula $|f(x)-L|<\epsilon$
\end_inset

.
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Definition
A function 
\begin_inset Formula $f$
\end_inset

 is 
\emph on
continuous at a number
\emph default
 
\begin_inset Formula $a$
\end_inset

 if 
\begin_inset Formula \begin{equation}
\lim_{x\to a}f(x)=f(a).\end{equation}

\end_inset

The function 
\begin_inset Formula $f$
\end_inset

 is 
\emph on
right-continuous at the number
\emph default
 
\begin_inset Formula $a$
\end_inset

 if 
\begin_inset Formula $\lim_{x\to a^{+}}f(x)=f(a)$
\end_inset

, and 
\emph on
left-continuous
\emph default
 at 
\begin_inset Formula $a$
\end_inset

 if 
\begin_inset Formula $\lim_{x\to a^{-}}f(x)=f(a)$
\end_inset

.
 Finally, the function 
\begin_inset Formula $f$
\end_inset

 is 
\emph on
continuous on an interval
\emph default
 
\begin_inset Formula $I$
\end_inset

 if it is continuous at every number in the interval.
 
\end_layout

\begin_layout Subsection*
Differentiation
\end_layout

\begin_layout Definition
The 
\emph on
derivative of a function
\emph default
 
\begin_inset Formula $f$
\end_inset

 
\emph on
at a number
\emph default
 
\begin_inset Formula $a$
\end_inset

, denoted by 
\begin_inset Formula $f'(a)$
\end_inset

, is
\begin_inset Formula \begin{equation}
f'(a)=\lim_{h\to0}\frac{f(a+h)-f(a)}{h},\end{equation}

\end_inset

provided this limit exists.
\end_layout

\begin_layout Definition
A function is 
\emph on
differentiable at
\emph default
 
\begin_inset Formula $a$
\end_inset

 if 
\begin_inset Formula $f'(a)$
\end_inset

 exists.
 It is 
\emph on
differentiable on an open interval
\emph default
 
\begin_inset Formula $(a,b)$
\end_inset

 if it is differentiable at every number in the interval.
\end_layout

\begin_layout Subsubsection*
Differentiation Rules
\end_layout

\begin_layout Standard
In the table that follows, 
\begin_inset Formula $f$
\end_inset

 and 
\begin_inset Formula $g$
\end_inset

 are differentiable functions and 
\begin_inset Formula $c$
\end_inset

 is a constant.
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{\diff}{\diff x}c=0$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{\diff}{\diff x}x^{n}=nx^{n-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(cf)'=cf'$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(f\pm g)'=f'\pm g'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $(fg)'=f'g+fg'$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\left(\frac{f}{g}\right)'=\frac{f'g-fg'}{g^{2}}$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Differentiation rules
\series bold

\begin_inset CommandInset label
LatexCommand label
name "tab:Differentiation-Rules"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Theorem
Chain Rule: If 
\begin_inset Formula $f$
\end_inset

 and 
\begin_inset Formula $g$
\end_inset

 are both differentiable and 
\begin_inset Formula $F=f\circ g$
\end_inset

 is the composite function defined by 
\begin_inset Formula $F(x)=f[g(x)]$
\end_inset

, then 
\begin_inset Formula $F$
\end_inset

 is differentiable and 
\begin_inset Formula $F'(x)=f'[g(x)]\cdot g'(x)$
\end_inset

.
 
\end_layout

\begin_layout Subsubsection*
Useful Derivatives
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{\diff}{\diff x}\me^{x}=\me^{x}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{\diff}{\diff x}\ln x=x^{-1}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{\diff}{\diff x}\sin x=\cos x$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{\diff}{\diff x}\cos x=-\sin x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{\diff}{\diff x}\tan x=\sec^{2}x$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\frac{\diff}{\diff x}\tan^{-1}x=(1+x^{2})^{-1}$
\end_inset


\begin_inset Formula $ $
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Some derivatives
\series bold

\begin_inset CommandInset label
LatexCommand label
name "tab:Useful-Derivatives"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection*
Optimization
\end_layout

\begin_layout Definition
A 
\emph on
critical number
\emph default
 of the function 
\begin_inset Formula $f$
\end_inset

 is a value 
\begin_inset Formula $x^{\ast}$
\end_inset

 for which 
\begin_inset Formula $f'(x^{\ast})=0$
\end_inset

 or for which 
\begin_inset Formula $f'(x^{\ast})$
\end_inset

 does not exist.
\end_layout

\begin_layout Theorem
\begin_inset CommandInset label
LatexCommand label
name "thm:First-Derivative-Test"

\end_inset

First Derivative Test.
 If 
\begin_inset Formula $f$
\end_inset

 is differentiable and if 
\begin_inset Formula $x^{\ast}$
\end_inset

 is a critical number of 
\begin_inset Formula $f$
\end_inset

 and if 
\begin_inset Formula $f'(x)\geq0$
\end_inset

 for 
\begin_inset Formula $x\leq x^{\ast}$
\end_inset

 and 
\begin_inset Formula $f'(x)\leq0$
\end_inset

 for 
\begin_inset Formula $x\geq x^{\ast}$
\end_inset

 , then 
\begin_inset Formula $x^{\ast}$
\end_inset

 is a local maximum of 
\begin_inset Formula $f$
\end_inset

.
 If 
\begin_inset Formula $f'(x)\leq0$
\end_inset

 for 
\begin_inset Formula $x\leq x^{\ast}$
\end_inset

 and 
\begin_inset Formula $f'(x)\geq0$
\end_inset

 for 
\begin_inset Formula $x\geq x^{\ast}$
\end_inset

 , then 
\begin_inset Formula $x^{\ast}$
\end_inset

 is a local minimum of 
\begin_inset Formula $f$
\end_inset

.
 
\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Theorem
Second Derivative Test.
 If 
\begin_inset Formula $f$
\end_inset

 is twice differentiable and if 
\begin_inset Formula $x^{\ast}$
\end_inset

 is a critical number of 
\begin_inset Formula $f$
\end_inset

, then 
\begin_inset Formula $x^{\ast}$
\end_inset

 is a local maximum of 
\begin_inset Formula $f$
\end_inset

 if 
\begin_inset Formula $f''(x^{\ast})<0$
\end_inset

 and 
\begin_inset Formula $x^{\ast}$
\end_inset

 is a local minimum of 
\begin_inset Formula $f$
\end_inset

 if 
\begin_inset Formula $f''(x^{\ast})>0$
\end_inset

.
\end_layout

\begin_layout Subsection*
Integration
\end_layout

\begin_layout Standard
As it turns out, there are all sorts of things called 
\begin_inset Quotes eld
\end_inset

integrals
\begin_inset Quotes erd
\end_inset

, each defined in its own idiosyncratic way.
 There are 
\emph on
Riemann
\emph default
 integrals, 
\emph on
Lebesgue
\emph default
 integrals, variants of these called 
\emph on
Stieltjes
\emph default
 integrals, 
\emph on
Daniell
\emph default
 integrals, 
\emph on
Ito
\emph default
 integrals, and the list continues.
 Given that this is an introductory book, we will use the Riemannian integral
 with the caveat that the Riemann integral is 
\emph on
not
\emph default
 the integral that will be used in more advanced study.
\end_layout

\begin_layout Definition
Let 
\begin_inset Formula $f$
\end_inset

 be defined on 
\begin_inset Formula $[a,b]$
\end_inset

, a closed interval of the real line.
 For each 
\begin_inset Formula $n$
\end_inset

, divide 
\begin_inset Formula $[a,b]$
\end_inset

 into subintervals 
\begin_inset Formula $[x_{i},x_{i+1}]$
\end_inset

, 
\begin_inset Formula $i=0,1,\ldots,n-1$
\end_inset

, of length 
\begin_inset Formula $\Delta x_{i}=(b-a)/n$
\end_inset

 where 
\begin_inset Formula $x_{0}=a$
\end_inset

 and 
\begin_inset Formula $x_{n}=b$
\end_inset

, and let 
\begin_inset Formula $x_{i}^{\ast}$
\end_inset

 be any points chosen from the respective subintervals.
 Then the 
\emph on
definite integral
\emph default
 of 
\begin_inset Formula $f$
\end_inset

 from 
\begin_inset Formula $a$
\end_inset

 to 
\begin_inset Formula $b$
\end_inset

 is defined by
\begin_inset Formula \begin{equation}
\int_{a}^{b}f(x)\,\diff x=\lim_{n\to\infty}\sum_{i=0}^{n-1}f(x_{i}^{\ast})\,\Delta x_{i},\end{equation}

\end_inset

provided the limit exists, and in that case, we say that 
\begin_inset Formula $f$
\end_inset

 is 
\emph on
integrable
\emph default
 from 
\begin_inset Formula $a$
\end_inset

 to 
\begin_inset Formula $b$
\end_inset

.
 
\end_layout

\begin_layout Theorem
The Fundamental Theorem of Calculus.
 Suppose 
\begin_inset Formula $f$
\end_inset

 is continuous on 
\begin_inset Formula $[a,b]$
\end_inset

.
 Then
\end_layout

\begin_deeper
\begin_layout Enumerate
the function 
\begin_inset Formula $g$
\end_inset

 defined by 
\begin_inset Formula $g(x)=\int_{a}^{x}f(t)\:\diff t$
\end_inset

, 
\begin_inset Formula $a\leq x\leq b$
\end_inset

, is continuous on 
\begin_inset Formula $[a,b]$
\end_inset

 and differentiable on 
\begin_inset Formula $(a,b)$
\end_inset

 with 
\begin_inset Formula $g'(x)=f(x)$
\end_inset

.
\end_layout

\begin_layout Enumerate
\begin_inset Formula $\int_{a}^{b}f(x)\,\diff x=F(b)-F(a)$
\end_inset

, where 
\begin_inset Formula $F$
\end_inset

 is any 
\emph on
antiderivative
\emph default
 of 
\begin_inset Formula $f$
\end_inset

, that is, any function 
\begin_inset Formula $F$
\end_inset

 satisfying 
\begin_inset Formula $F'=f$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Subsubsection*
Change of Variables
\end_layout

\begin_layout Theorem
If 
\begin_inset Formula $g$
\end_inset

 is a differentiable function whose range is the interval 
\begin_inset Formula $[a,b]$
\end_inset

 and if both 
\begin_inset Formula $f$
\end_inset

 and 
\begin_inset Formula $g'$
\end_inset

 are continuous on the range of 
\begin_inset Formula $u=g(x)$
\end_inset

, then
\begin_inset Formula \begin{equation}
\int_{g(a)}^{g(b)}f(u)\:\diff u=\int_{a}^{b}f[g(x)]\: g'(x)\:\diff x.\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection*
Useful Integrals
\end_layout

\begin_layout Standard
\begin_inset Float table
placement H
wide false
sideways false
status open

\begin_layout Plain Layout
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="5" columns="3">
<features>
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<column alignment="center" valignment="top" width="0">
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\int x^{n}\,\diff x=x^{n+1}/(n+1),\ n\neq-1$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\int\me^{x}\,\diff x=\me^{x}$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\int x^{-1}\,\diff x=\ln|x|$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\int\tan x\:\diff x=\ln|\sec x|$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\int a^{x}\,\diff x=a^{x}/\ln a$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $\int(x^{2}+1)^{-1}\,\diff x=\tan^{-1}x$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption

\begin_layout Plain Layout
Some integrals (constants of integration omitted)
\series bold

\begin_inset CommandInset label
LatexCommand label
name "tab:Useful-Integrals"

\end_inset


\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsubsection*
Integration by Parts
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
\int u\:\diff v=uv-\int v\:\diff u\end{equation}

\end_inset


\end_layout

\begin_layout Theorem
L'H
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
^ o
\end_layout

\end_inset

pital's Rule.
 Suppose 
\begin_inset Formula $f$
\end_inset

 and 
\begin_inset Formula $g$
\end_inset

 are differentiable and 
\begin_inset Formula $g'(x)\neq0$
\end_inset

 near 
\begin_inset Formula $a$
\end_inset

, except possibly at 
\begin_inset Formula $a$
\end_inset

.
 Suppose that the limit
\begin_inset Formula \begin{equation}
\lim_{x\to a}\frac{f(x)}{g(x)}\end{equation}

\end_inset

is an indeterminate form of type 
\begin_inset Formula $\frac{0}{0}$
\end_inset

 or 
\begin_inset Formula $\infty/\infty$
\end_inset

.
 Then
\begin_inset Formula \begin{equation}
\lim_{x\to a}\frac{f(x)}{g(x)}=\lim_{x\to a}\frac{f'(x)}{g'(x)},\end{equation}

\end_inset

provided the limit on the right-hand side exists or is infinite.
\end_layout

\begin_layout Subsubsection*
Improper Integrals
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $\int_{a}^{t}f(x)\diff x$
\end_inset

 exists for every number 
\begin_inset Formula $t\geq a$
\end_inset

, then we define 
\begin_inset Formula \begin{equation}
\int_{a}^{\infty}f(x)\,\diff x=\lim_{t\to\infty}\int_{a}^{t}f(x)\,\diff x,\end{equation}

\end_inset

provided this limit exists as a finite number, and in that case we say that
 
\begin_inset Formula $\int_{a}^{\infty}f(x)\,\diff x$
\end_inset

 is 
\emph on
convergent
\emph default
.
 Otherwise, we say that the improper integral is 
\emph on
divergent
\emph default
.
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $\int_{t}^{b}f(x)\,\diff x$
\end_inset

 exists for every number 
\begin_inset Formula $t\leq b$
\end_inset

, then we define 
\begin_inset Formula \begin{equation}
\int_{-\infty}^{b}f(x)\,\diff x=\lim_{t\to-\infty}\int_{t}^{b}f(x)\,\diff x,\end{equation}

\end_inset

provided this limit exists as a finite number, and in that case we say that
 
\begin_inset Formula $\int_{-\infty}^{b}f(x)\,\diff x$
\end_inset

 is 
\emph on
convergent
\emph default
.
 Otherwise, we say that the improper integral is 
\emph on
divergent
\emph default
.
\end_layout

\begin_layout Standard
If both 
\begin_inset Formula $\int_{a}^{\infty}f(x)\,\diff x$
\end_inset

 and 
\begin_inset Formula $\int_{-\infty}^{a}f(x)\,\diff x$
\end_inset

 are convergent, then we define
\begin_inset Formula \begin{equation}
\int_{-\infty}^{\infty}f(x)\,\diff x=\int_{-\infty}^{a}f(x)\,\diff x+\int_{a}^{\infty}f(x)\diff x,\end{equation}

\end_inset

and we say that 
\begin_inset Formula $\int_{-\infty}^{\infty}f(x)\,\diff x$
\end_inset

 is 
\emph on
convergent
\emph default
.
 Otherwise, we say that the improper integral is 
\emph on
divergent
\emph default
.
\end_layout

\begin_layout Section
Sequences and Series
\begin_inset CommandInset label
LatexCommand label
name "sec:Sequences-and-Series"

\end_inset


\end_layout

\begin_layout Standard
A 
\emph on
sequence
\emph default
 is an ordered list of numbers, 
\begin_inset Formula $a_{1}$
\end_inset

, 
\begin_inset Formula $a_{2}$
\end_inset

, 
\begin_inset Formula $a_{3}$
\end_inset

, \SpecialChar \ldots{}
, 
\begin_inset Formula $a_{n}$
\end_inset

 
\begin_inset Formula $=\left(a_{k}\right)_{k=1}^{n}$
\end_inset

.
 A sequence may be finite or infinite.
 In the latter case we write 
\begin_inset Formula $a_{1}$
\end_inset

, 
\begin_inset Formula $a_{2}$
\end_inset

, 
\begin_inset Formula $a_{3}$
\end_inset

, \SpecialChar \ldots{}

\begin_inset Formula $=\left(a_{k}\right)_{k=1}^{\infty}$
\end_inset

.
 We say that 
\emph on
the infinite sequence
\emph default
 
\begin_inset Formula $\left(a_{k}\right)_{k=1}^{\infty}$
\end_inset

 
\emph on
converges to the finite limit
\emph default
 
\begin_inset Formula $L$
\end_inset

, and we write 
\begin_inset Formula \begin{equation}
\lim_{k\to\infty}a_{k}=L,\end{equation}

\end_inset

if for every 
\begin_inset Formula $\epsilon>0$
\end_inset

 there exists an integer 
\begin_inset Formula $N\geq1$
\end_inset

 such that 
\begin_inset Formula $|a_{k}-L|<\epsilon$
\end_inset

 for all 
\begin_inset Formula $k\geq N$
\end_inset

.
 We say that 
\emph on
the infinite sequence
\emph default
 
\begin_inset Formula $\left(a_{k}\right)_{k=1}^{\infty}$
\end_inset

 
\emph on
diverges to
\emph default
 
\begin_inset Formula $+\infty$
\end_inset

 (or -
\begin_inset Formula $\infty$
\end_inset

) if for every 
\begin_inset Formula $M\geq0$
\end_inset

 there exists an integer 
\begin_inset Formula $N\geq1$
\end_inset

 such that 
\begin_inset Formula $a_{k}\geq M$
\end_inset

 for all 
\begin_inset Formula $k\geq N$
\end_inset

 (or 
\begin_inset Formula $a_{k}\leq-M$
\end_inset

 for all 
\begin_inset Formula $k\geq N$
\end_inset

).
\end_layout

\begin_layout Subsection*
Finite Series
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
\sum_{k=1}^{n}k=1+2+\cdots+n=\frac{n(n+1)}{2}\label{eq:gauss-series}\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
\sum_{k=1}^{n}k^{2}=1^{2}+2^{2}+\cdots+n^{2}=\frac{n(n+1)(2n+3)}{6}\label{eq:gauss-series-sq}\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection*
The Binomial Series
\end_layout

\begin_layout Paragraph*
\begin_inset Formula \begin{equation}
\sum_{k=0}^{n}{n \choose k}\, a^{n-k}b^{k}=(a+b)^{n}\label{eq:binom-series}\end{equation}

\end_inset


\end_layout

\begin_layout Subsection*
Infinite Series
\end_layout

\begin_layout Standard
Given an infinite sequence of numbers 
\begin_inset Formula $a_{1}$
\end_inset

, 
\begin_inset Formula $a_{2}$
\end_inset

, 
\begin_inset Formula $a_{3}$
\end_inset

, \SpecialChar \ldots{}

\begin_inset Formula $=\left(a_{k}\right)_{k=1}^{\infty}$
\end_inset

, let 
\begin_inset Formula $s_{n}$
\end_inset

 denote the 
\emph on
partial sum
\emph default
 of the first 
\begin_inset Formula $n$
\end_inset

 terms:
\begin_inset Formula \begin{equation}
s_{n}=\sum_{k=1}^{n}a_{k}=a_{1}+a_{2}+\cdots+a_{n}.\end{equation}

\end_inset

If the sequence 
\begin_inset Formula $\left(s_{n}\right)_{n=1}^{\infty}$
\end_inset

 converges to a finite number 
\begin_inset Formula $S$
\end_inset

 then we say that the infinite series 
\begin_inset Formula $\sum_{k}a_{k}$
\end_inset

 is 
\emph on
convergent
\emph default
 and write
\begin_inset Formula \begin{equation}
\sum_{k=1}^{\infty}a_{k}=S.\end{equation}

\end_inset

Otherwise we say the infinite series is 
\emph on
divergent
\emph default
.
\end_layout

\begin_layout Subsection*
Rules for Series
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $\left(a_{k}\right)_{k=1}^{\infty}$
\end_inset

 and 
\begin_inset Formula $\left(b_{k}\right)_{k=1}^{\infty}$
\end_inset

 be infinite sequences and let 
\begin_inset Formula $c$
\end_inset

 be a constant.
\end_layout

\begin_layout Paragraph*
\begin_inset Formula \begin{equation}
\sum_{k=1}^{\infty}ca_{k}=c\sum_{k=1}^{\infty}a_{k}\end{equation}

\end_inset


\begin_inset Formula \begin{equation}
\sum_{k=1}^{\infty}(a_{k}\pm b_{k})=\sum_{k=1}^{\infty}a_{k}\pm\sum_{k=1}^{\infty}b_{k}\end{equation}

\end_inset


\end_layout

\begin_layout Standard
In both of the above the series on the left is convergent if the series
 on the right is (are) convergent.
\end_layout

\begin_layout Subsubsection*
The Geometric Series
\begin_inset Formula \begin{equation}
\sum_{k=0}^{\infty}x^{k}=\frac{1}{1-x},\quad|x|<1.\label{eq:geom-series}\end{equation}

\end_inset


\end_layout

\begin_layout Subsubsection*
The Exponential Series
\begin_inset Formula \begin{equation}
\sum_{k=0}^{\infty}\frac{x^{k}}{k!}=\me^{x},\quad-\infty<x<\infty.\label{eq:exp-series}\end{equation}

\end_inset


\end_layout

\begin_layout Paragraph*
Other Series
\begin_inset Formula \begin{equation}
\sum_{k=0}^{\infty}{m+k-1 \choose m-1}x^{k}=\frac{1}{(1-x)^{m}},\quad|x|<1.\label{eq:negbin-series}\end{equation}

\end_inset


\end_layout

\begin_layout Paragraph*
\begin_inset Formula \begin{equation}
-\sum_{k=1}^{\infty}\frac{x^{n}}{n}=\ln(1-x),\quad|x|<1.\label{eq:log-series}\end{equation}

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
\sum_{k=0}^{\infty}{n \choose k}x^{k}=(1+x)^{n},\quad|x|<1.\label{eq:binom-series-infinite}\end{equation}

\end_inset


\end_layout

\begin_layout Subsection*
Taylor Series
\end_layout

\begin_layout Standard
If the function 
\begin_inset Formula $f$
\end_inset

 has a 
\emph on
power series
\emph default
 representation at the point 
\begin_inset Formula $a$
\end_inset

 with radius of convergence 
\begin_inset Formula $R>0$
\end_inset

, that is, if
\begin_inset Formula \begin{equation}
f(x)=\sum_{k=0}^{\infty}c_{k}(x-a)^{k},\quad|x-a|<R,\end{equation}

\end_inset

for some constants 
\begin_inset Formula $\left(c_{k}\right)_{k=0}^{\infty}$
\end_inset

, then 
\begin_inset Formula $c_{k}$
\end_inset

 must be 
\begin_inset Formula \begin{equation}
c_{k}=\frac{f^{(k)}(a)}{k!},\quad k=0,1,2,\ldots\end{equation}

\end_inset

Furthermore, the function 
\begin_inset Formula $f$
\end_inset

 is differentiable on the open interval 
\begin_inset Formula $(a-R,\, a+R)$
\end_inset

 with
\begin_inset Formula \begin{equation}
f'(x)=\sum_{k=1}^{\infty}kc_{k}(x-a)^{k-1},\quad|x-a|<R,\end{equation}

\end_inset


\begin_inset Formula \begin{equation}
\int f(x)\,\diff x=C+\sum_{k=0}^{\infty}c_{k}\frac{(x-a)^{k+1}}{k+1},\quad|x-a|<R,\end{equation}

\end_inset

in which case both of the above series have radius of convergence 
\begin_inset Formula $R$
\end_inset

.
\end_layout

\begin_layout Section
The Gamma Function
\begin_inset CommandInset label
LatexCommand label
name "sec:The-Gamma-Function"

\end_inset


\end_layout

\begin_layout Standard
The 
\emph on
Gamma function
\emph default
 
\begin_inset Formula $\Gamma$
\end_inset

 will be defined in this book according to the formula
\end_layout

\begin_layout Standard
\begin_inset Formula \begin{equation}
\Gamma(\alpha)=\int_{0}^{\infty}x^{\alpha-1}\me^{-x}\:\diff x,\quad\mbox{for }\alpha>0.\end{equation}

\end_inset


\end_layout

\begin_layout Fact
Properties of the Gamma Function:
\end_layout

\begin_deeper
\begin_layout Itemize
\begin_inset Formula $\Gamma(\alpha)=(\alpha-1)\Gamma(\alpha-1)$
\end_inset

 for any 
\begin_inset Formula $\alpha>1$
\end_inset

, and so 
\begin_inset Formula $\Gamma(n)=(n-1)!$
\end_inset

 for any positive integer 
\begin_inset Formula $n$
\end_inset

.
\end_layout

\begin_layout Itemize
\begin_inset Formula $\Gamma(1/2)=\sqrt{\pi}$
\end_inset

.
\end_layout

\end_deeper
\begin_layout Section
Linear Algebra
\begin_inset CommandInset label
LatexCommand label
name "sec:Linear-Algebra"

\end_inset


\end_layout

\begin_layout Subsection*
Matrices
\end_layout

\begin_layout Standard
A 
\emph on
matrix
\emph default
 is an ordered array of numbers or expressions; typically we write 
\begin_inset Formula $\mathbf{A}=\begin{pmatrix}a_{ij}\end{pmatrix}$
\end_inset

 or 
\begin_inset Formula $\mathbf{A}=\begin{bmatrix}a_{ij}\end{bmatrix}$
\end_inset

.
 If 
\begin_inset Formula $\mathbf{A}$
\end_inset

 has 
\begin_inset Formula $m$
\end_inset

 rows and 
\begin_inset Formula $n$
\end_inset

 columns then we write
\begin_inset Formula \begin{equation}
\mathbf{A}_{\mathrm{m}\times\mathrm{n}}=\begin{bmatrix}a_{11} & a_{12} & \cdots & a_{1n}\\
a_{21} & a_{22} & \cdots & a_{2n}\\
\vdots & \vdots & \ddots & \vdots\\
a_{m1} & a_{m2} & \cdots & a_{mn}\end{bmatrix}.\end{equation}

\end_inset

The 
\emph on
identity matrix
\emph default
 
\begin_inset Formula $\mathbf{I}_{\mathrm{n}\times\mathrm{n}}$
\end_inset

 is an 
\begin_inset Formula $\mathrm{n}\times\mathrm{n}$
\end_inset

 matrix with zeros everywhere except for 1's along the main diagonal: 
\begin_inset Formula \begin{equation}
\mathbf{I}_{\mathrm{n}\times\mathrm{n}}=\begin{bmatrix}1 & 0 & \cdots & 0\\
0 & 1 & \cdots & 0\\
\vdots & \vdots & \ddots & \vdots\\
0 & 0 & \cdots & 1\end{bmatrix}.\end{equation}

\end_inset

and the matrix with ones everywhere is denoted 
\begin_inset Formula $\mathbf{J}_{\mathrm{n}\times\mathrm{n}}$
\end_inset

:
\begin_inset Formula \begin{equation}
\mathbf{J}_{\mathrm{n}\times\mathrm{n}}=\begin{bmatrix}1 & 1 & \cdots & 1\\
1 & 1 & \cdots & 1\\
\vdots & \vdots & \ddots & \vdots\\
1 & 1 & \cdots & 1\end{bmatrix}.\end{equation}

\end_inset


\end_layout

\begin_layout Standard
A 
\emph on
vector
\emph default
 is a matrix with one of the dimensions equal to one, such as 
\family roman
\series medium
\shape up
\size normal
\emph off
\bar no
\noun off
\color none

\begin_inset Formula $\mathbf{A}_{\mathrm{m}\times1}$
\end_inset

 (a column vector) or 
\begin_inset Formula $\mathbf{A}_{\mathrm{1}\times\mathrm{n}}$
\end_inset

 (a row vector).

\family default
\series default
\shape default
\size default
\emph default
\bar default
\noun default
\color inherit
 The 
\emph on
zero vector
\emph default
 
\begin_inset Formula $\mathbf{0}_{\mathrm{n}\times1}$
\end_inset

 is an 
\begin_inset Formula $\mathrm{n}\times1$
\end_inset

 matrix of zeros:
\begin_inset Formula \begin{equation}
\mathbf{0}_{\mathrm{n}\times1}=\begin{bmatrix}0 & 0 & \cdots & 0\end{bmatrix}^{\mathrm{T}}.\end{equation}

\end_inset


\end_layout

\begin_layout Standard
The 
\emph on
transpose
\emph default
 of a matrix 
\begin_inset Formula $\mathbf{A}=\begin{pmatrix}a_{ij}\end{pmatrix}$
\end_inset

 is the matrix 
\begin_inset Formula $\mathbf{A}^{\mathrm{T}}=\begin{pmatrix}a_{ji}\end{pmatrix}$
\end_inset

, which is just like 
\begin_inset Formula $\mathbf{A}$
\end_inset

 except the rows are columns and the columns are rows.
 The matrix 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is said to be 
\emph on
symmetric
\emph default
 if 
\begin_inset Formula $\mathbf{A}^{\mathrm{T}}=\mathbf{A}$
\end_inset

.
 Note that 
\begin_inset Formula $\left(\mathbf{A}\mathbf{B}\right)^{\mathrm{T}}=\mathbf{B}^{\mathrm{T}}\mathbf{A}^{\mathrm{T}}$
\end_inset

.
\end_layout

\begin_layout Standard
The 
\emph on
trace
\emph default
 of a square matrix 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is the sum of its diagonal elements: 
\begin_inset Formula $\mathrm{tr}(\mathbf{A})=\sum_{i}a_{ii}$
\end_inset

.
\end_layout

\begin_layout Standard
The 
\emph on
inverse
\emph default
 of a square matrix 
\begin_inset Formula $\mathbf{A}_{\mathrm{n}\times\mathrm{n}}$
\end_inset

 (when it exists) is the unique matrix denoted 
\begin_inset Formula $\mathbf{A}^{-1}$
\end_inset

 which satisfies 
\begin_inset Formula $\mathbf{A}\mathbf{A}^{-1}=\mathbf{A}^{-1}\mathbf{A}=\mathbf{I}_{\mathrm{n}\times\mathrm{n}}$
\end_inset

.
 If 
\begin_inset Formula $\mathbf{A}^{-1}$
\end_inset

 exists then we say 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is 
\emph on
invertible
\emph default
, or alternatively 
\emph on
nonsingular
\emph default
.
 Note that 
\begin_inset Formula $\left(\mathbf{A}^{\mathrm{T}}\right)^{-1}=\left(\mathbf{A}^{\mathrm{-1}}\right)^{\mathrm{T}}$
\end_inset

.
\end_layout

\begin_layout Fact
The inverse of the 
\begin_inset Formula $2\times2$
\end_inset

 matrix
\begin_inset Formula \begin{equation}
\mathbf{A}=\begin{bmatrix}a & b\\
c & d\end{bmatrix}\quad\mbox{is}\quad\mathbf{A}^{-1}=\frac{1}{ad-bc}\begin{bmatrix}d & -b\\
-c & a\end{bmatrix},\end{equation}

\end_inset

provided 
\begin_inset Formula $ad-bc\neq0$
\end_inset

.
\end_layout

\begin_layout Subsection*
Determinants
\end_layout

\begin_layout Definition
The 
\emph on
determinant
\emph default
 of a square matrix 
\begin_inset Formula $\mathbf{A}_{\mathrm{n}\times n}$
\end_inset

 is denoted 
\begin_inset Formula $\mathrm{det}(\mathbf{A})$
\end_inset

 or 
\begin_inset Formula $|\mathbf{A}|$
\end_inset

 and is defined recursively by
\begin_inset Formula \begin{equation}
\mathrm{det}(\mathbf{A})=\sum_{i=1}^{n}(-1)^{i+j}a_{ij}\,\mathrm{det}(\mathbf{M}_{ij}),\end{equation}

\end_inset

where 
\begin_inset Formula $\mathbf{M}_{ij}$
\end_inset

 is the submatrix formed by deleting the 
\begin_inset Formula $i^{\mathrm{th}}$
\end_inset

 row and 
\begin_inset Formula $j^{\mathrm{th}}$
\end_inset

 column of 
\begin_inset Formula $\mathbf{A}$
\end_inset

.
 We may choose any fixed 
\begin_inset Formula $1\leq j\leq n$
\end_inset

 we wish to compute the determinant; the final result is independent of
 the 
\begin_inset Formula $j$
\end_inset

 chosen.
\end_layout

\begin_layout Fact
The determinant of the 
\begin_inset Formula $2\times2$
\end_inset

 matrix
\begin_inset Formula \begin{equation}
\mathbf{A}=\begin{bmatrix}a & b\\
c & d\end{bmatrix}\quad\mbox{is}\quad|\mathbf{A}|=ad-bc.\end{equation}

\end_inset


\end_layout

\begin_layout --Separator--

\end_layout

\begin_layout Fact
A square matrix 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is nonsingular if and only if 
\begin_inset Formula $\mathrm{det}(\mathbf{A})\neq0$
\end_inset

.
\end_layout

\begin_layout Subsection*
Positive (Semi)Definite
\end_layout

\begin_layout Standard
If the matrix 
\begin_inset Formula $\mathbf{A}$
\end_inset

 satisfies 
\begin_inset Formula $\mathbf{x^{\mathrm{T}}}\mathbf{A}\mathbf{x}\geq0$
\end_inset

 for all vectors 
\begin_inset Formula $\mathbf{x}\neq\mathbf{0}$
\end_inset

, then we say that 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is 
\emph on
positive semidefinite
\emph default
.
 If strict inequality holds for all 
\begin_inset Formula $\mathbf{x}\neq\mathbf{0}$
\end_inset

, then 
\begin_inset Formula $\mathbf{A}$
\end_inset

 is 
\emph on
positive definite
\emph default
.
 The connection to statistics is that covariance matrices (see Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:Multivariable-Distributions"

\end_inset

) are always positive semidefinite, and many of them are even positive definite.
\end_layout

\begin_layout Section
Multivariable Calculus
\begin_inset CommandInset label
LatexCommand label
name "sec:Multivariable-Calculus"

\end_inset


\end_layout

\begin_layout Subsection*
Partial Derivatives
\end_layout

\begin_layout Standard
If 
\begin_inset Formula $f$
\end_inset

 is a function of two variables, its 
\emph on
first-order partial derivatives
\emph default
 are defined by
\begin_inset Formula \begin{equation}
\frac{\partial f}{\partial x}=\frac{\partial}{\partial x}f(x,y)=\lim_{h\to0}\frac{f(x+h,\, y)-f(x,y)}{h}\end{equation}

\end_inset

and
\begin_inset Formula \begin{equation}
\frac{\partial f}{\partial y}=\frac{\partial}{\partial y}f(x,y)=\lim_{h\to0}\frac{f(x,\, y+h)-f(x,y)}{h},\end{equation}

\end_inset

provided these limits exist.
 The 
\emph on
second-order partial derivatives
\emph default
 of 
\begin_inset Formula $f$
\end_inset

 are defined by
\begin_inset Formula \begin{equation}
\frac{\partial^{2}f}{\partial x^{2}}=\frac{\partial}{\partial x}\left(\frac{\partial f}{\partial x}\right),\quad\frac{\partial^{2}f}{\partial y^{2}}=\frac{\partial}{\partial y}\left(\frac{\partial f}{\partial y}\right),\quad\frac{\partial^{2}f}{\partial x\partial y}=\frac{\partial}{\partial x}\left(\frac{\partial f}{\partial y}\right),\quad\frac{\partial^{2}f}{\partial y\partial x}=\frac{\partial}{\partial y}\left(\frac{\partial f}{\partial x}\right).\end{equation}

\end_inset

In many cases (and for all cases in this book) it is true that
\begin_inset Formula \begin{equation}
\frac{\partial^{2}f}{\partial x\partial y}=\frac{\partial^{2}f}{\partial y\partial x}.\end{equation}

\end_inset


\end_layout

\begin_layout Subsection*
Optimization
\end_layout

\begin_layout Standard
An function 
\begin_inset Formula $f$
\end_inset

 of two variables has a 
\emph on
local maximum
\emph default
 at 
\begin_inset Formula $(a,b)$
\end_inset

 if 
\begin_inset Formula $f(x,y)\geq f(a,b)$
\end_inset

 for all points 
\begin_inset Formula $(x,y)$
\end_inset

 near 
\begin_inset Formula $(a,b)$
\end_inset

, that is, for all points in an open disk centered at 
\begin_inset Formula $(a,b)$
\end_inset

.
 The number 
\begin_inset Formula $f(a,b)$
\end_inset

 is then called a 
\emph on
local maximum value
\emph default
 of 
\begin_inset Formula $f$
\end_inset

.
 The function 
\begin_inset Formula $f$
\end_inset

 has a 
\emph on
local minimum
\emph default
 if the same thing happens with the inequality reversed.
\end_layout

\begin_layout Standard
Suppose the point 
\begin_inset Formula $(a,b)$
\end_inset

 is a 
\emph on
critical point
\emph default
 of 
\begin_inset Formula $f$
\end_inset

, that is, suppose 
\begin_inset Formula $(a,b)$
\end_inset

 satisfies 
\begin_inset Formula \begin{equation}
\frac{\partial f}{\partial x}(a,b)=\frac{\partial f}{\partial y}(a,b)=0.\end{equation}

\end_inset

Further suppose 
\begin_inset Formula $\frac{\partial^{2}f}{\partial x^{2}}$
\end_inset

 and 
\begin_inset Formula $\frac{\partial^{2}f}{\partial y^{2}}$
\end_inset

 are continuous near 
\begin_inset Formula $(a,b)$
\end_inset

.
 Let the 
\emph on
Hessian matrix
\emph default
 
\begin_inset Formula $H$
\end_inset

 (not to be confused with the 
\emph on
hat matrix
\emph default
 
\begin_inset Formula $\mathbf{H}$
\end_inset

 of Chapter 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:multiple-linear-regression"

\end_inset

) be defined by
\begin_inset Formula \begin{equation}
H=\begin{bmatrix}\frac{\partial^{2}f}{\partial x^{2}} & \frac{\partial^{2}f}{\partial x\partial y}\\
\frac{\partial^{2}f}{\partial y\partial x} & \frac{\partial^{2}f}{\partial y^{2}}\end{bmatrix}.\end{equation}

\end_inset

We use the following rules to decide whether 
\begin_inset Formula $(a,b)$
\end_inset

 is an 
\emph on
extremum
\emph default
 (that is, a local minimum or local maximum) of 
\begin_inset Formula $f$
\end_inset

.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $\mbox{det}(H)>0$
\end_inset

 and 
\begin_inset Formula $\frac{\partial^{2}f}{\partial x^{2}}(a,b)>0$
\end_inset

, then 
\begin_inset Formula $(a,b)$
\end_inset

 is a local minimum of 
\begin_inset Formula $f$
\end_inset

.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $\mbox{det}(H)>0$
\end_inset

 and 
\begin_inset Formula $\frac{\partial^{2}f}{\partial x^{2}}(a,b)<0$
\end_inset

, then 
\begin_inset Formula $(a,b)$
\end_inset

 is a local maximum of 
\begin_inset Formula $f$
\end_inset

.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $\mbox{det}(H)<0$
\end_inset

, then 
\begin_inset Formula $(a,b)$
\end_inset

 is a 
\emph on
saddle point
\emph default
 of 
\begin_inset Formula $f$
\end_inset

 and so is not an extremum of 
\begin_inset Formula $f$
\end_inset

.
\end_layout

\begin_layout Itemize
If 
\begin_inset Formula $\mbox{det}(H)=0$
\end_inset

, then we do not know the status of 
\begin_inset Formula $(a,b)$
\end_inset

; it might be an extremum or it might not be.
\end_layout

\begin_layout Subsection*
Double and Multiple Integrals
\end_layout

\begin_layout Standard
Let 
\begin_inset Formula $f$
\end_inset

 be defined on a rectangle 
\begin_inset Formula $R=[a,b]\times[c,d]$
\end_inset

, and for each 
\begin_inset Formula $m$
\end_inset

 and 
\begin_inset Formula $n$
\end_inset

 divide 
\begin_inset Formula $[a,b]$
\end_inset

 (respectively 
\begin_inset Formula $[c,d]$
\end_inset

) into subintervals 
\begin_inset Formula $[x_{j},x_{j+1}]$
\end_inset

, 
\begin_inset Formula $i=0,1,\ldots,m-1$
\end_inset

 (respectively 
\begin_inset Formula $[y_{i},y_{i+1}]$
\end_inset

) of length 
\begin_inset Formula $\Delta x_{j}=(b-a)/m$
\end_inset

 (respectively 
\begin_inset Formula $\Delta y_{i}=(d-c)/n$
\end_inset

) where 
\begin_inset Formula $x_{0}=a$
\end_inset

 and 
\begin_inset Formula $x_{m}=b$
\end_inset

 (and 
\begin_inset Formula $y_{0}=c$
\end_inset

 and 
\begin_inset Formula $y_{n}=d$
\end_inset

 ), and let 
\begin_inset Formula $x_{j}^{\ast}$
\end_inset

 (
\begin_inset Formula $y_{i}^{\ast}$
\end_inset

) be any points chosen from their respective subintervals.
 Then the 
\emph on
double integral
\emph default
 of 
\begin_inset Formula $f$
\end_inset

 over the rectangle 
\begin_inset Formula $R$
\end_inset

 is
\begin_inset Formula \begin{equation}
\iintop_{R}f(x,y)\,\diff A=\intop_{c}^{d}\!\!\!\intop_{a}^{b}f(x,y)\,\diff x\diff y=\lim_{m,n\to\infty}\sum_{i=1}^{n}\sum_{j=1}^{m}f(x_{j}^{\ast},y_{i}^{\ast})\Delta x_{j}\Delta y_{i},\end{equation}

\end_inset

provided this limit exists.
 Multiple integrals are defined in the same way just with more letters and
 sums.
\end_layout

\begin_layout Subsection*
Bivariate and Multivariate Change of Variables
\end_layout

\begin_layout Standard
Suppose we have a transformation
\begin_inset Foot
status open

\begin_layout Plain Layout
For our purposes 
\begin_inset Formula $T$
\end_inset

 is in fact the 
\emph on
inverse
\emph default
 of a one-to-one transformation that we are initially given.
 We usually start with functions that map 
\begin_inset Formula $(x,y)\longmapsto(u,v)$
\end_inset

, and one of our first tasks is to solve for the inverse transformation
 that maps 
\begin_inset Formula $(u,v)\longmapsto(x,y)$
\end_inset

.
 It is this inverse transformation which we are calling 
\begin_inset Formula $T$
\end_inset

.
\end_layout

\end_inset

 
\begin_inset Formula $T$
\end_inset

 that maps points 
\begin_inset Formula $(u,v)$
\end_inset

 in a set 
\begin_inset Formula $A$
\end_inset

 to points 
\begin_inset Formula $(x,y)$
\end_inset

 in a set 
\begin_inset Formula $B$
\end_inset

.
 We typically write 
\begin_inset Formula $x=x(u,v)$
\end_inset

 and 
\begin_inset Formula $y=y(u,v)$
\end_inset

, and we assume that 
\begin_inset Formula $x$
\end_inset

 and 
\begin_inset Formula $y$
\end_inset

 have continuous first-order partial derivatives.
 We say that 
\begin_inset Formula $T$
\end_inset

 is 
\emph on
one-to-one
\emph default
 if no two distinct 
\begin_inset Formula $(u,v)$
\end_inset

 pairs get mapped to the same 
\begin_inset Formula $(x,y)$
\end_inset

 pair; in this book, all of our multivariate transformations 
\begin_inset Formula $T$
\end_inset

 are one-to-one.
\end_layout

\begin_layout Standard
The 
\emph on
Jacobian
\emph default
 (pronounced 
\begin_inset Quotes eld
\end_inset

yah-KOH-bee-uhn
\begin_inset Quotes erd
\end_inset

) of 
\begin_inset Formula $T$
\end_inset

 is denoted by 
\begin_inset Formula $\partial(x,y)/\partial(u,v)$
\end_inset

 and is defined by the determinant of the following matrix of partial derivative
s:
\begin_inset Formula \begin{equation}
\frac{\partial(x,y)}{\partial(u,v)}=\left|\begin{array}{cc}
\frac{\partial x}{\partial u} & \frac{\partial x}{\partial v}\\
\frac{\partial y}{\partial u} & \frac{\partial y}{\partial v}\end{array}\right|=\frac{\partial x}{\partial u}\frac{\partial y}{\partial v}-\frac{\partial x}{\partial v}\frac{\partial y}{\partial u}.\end{equation}

\end_inset

If the function 
\begin_inset Formula $f$
\end_inset

 is continuous on 
\begin_inset Formula $A$
\end_inset

 and if the Jacobian of 
\begin_inset Formula $T$
\end_inset

 is nonzero except perhaps on the boundary of 
\begin_inset Formula $A$
\end_inset

, then 
\begin_inset Formula \begin{equation}
\iint_{B}f(x,y)\,\diff x\,\diff y=\iint_{A}f\left[x(u,v),\, y(u,v)\right]\ \left|\frac{\partial(x,y)}{\partial(u,v)}\right|\diff u\,\diff v.\end{equation}

\end_inset

A multivariate change of variables is defined in an analogous way: the one-to-on
e transformation 
\begin_inset Formula $T$
\end_inset

 maps points 
\begin_inset Formula $(u_{1},u_{2},\ldots,u_{n})$
\end_inset

 to points 
\begin_inset Formula $(x_{1},x_{2},\ldots,x_{n})$
\end_inset

, the Jacobian is the determinant of the 
\begin_inset Formula $\mathrm{n}\times\mathrm{n}$
\end_inset

 matrix of first-order partial derivatives of 
\begin_inset Formula $T$
\end_inset

 (lined up in the natural manner), and instead of a double integral we have
 a multiple integral over multidimensional sets 
\begin_inset Formula $A$
\end_inset

 and 
\begin_inset Formula $B$
\end_inset

.
\end_layout

\begin_layout Chapter
Writing Reports with 
\family sans
R
\begin_inset CommandInset label
LatexCommand label
name "cha:Writing-Reports-with"

\end_inset


\end_layout

\begin_layout Standard
Perhaps the most important part of a statistician's job once the analysis
 is complete is to communicate the results to others.
 This is usually done with some type of report that is delivered to the
 client, manager, or administrator.
 Other situations that call for reports include term papers, final projects,
 thesis work, 
\emph on
etc
\emph default
.
 This chapter is designed to pass along some tips about writing reports
 once the work is completed with 
\family sans
R
\family default
.
\end_layout

\begin_layout Section
What to Write
\begin_inset CommandInset label
LatexCommand label
name "sec:What-to-Write"

\end_inset


\end_layout

\begin_layout Standard
It is possible to summarize this entire appendix with only one sentence:
 
\emph on
the statistician's goal is to communicate with others
\emph default
.
 To this end, there are some general guidelines that I give to students
 which are based on an outline originally written and shared with me by
 Dr.
\begin_inset space ~
\end_inset

G.
\begin_inset space ~
\end_inset

Andy Chang.
\end_layout

\begin_layout Subsection*
Basic Outline for a Statistical Report
\end_layout

\begin_layout Enumerate
Executive Summary (a one page description of the study and conclusion) 
\end_layout

\begin_layout Enumerate
Introduction 
\end_layout

\begin_deeper
\begin_layout Enumerate
What is the question, and why is it important?
\end_layout

\begin_layout Enumerate
Is the study observational or experimental?
\end_layout

\begin_layout Enumerate
What are the hypotheses of interest to the researcher?
\end_layout

\begin_layout Enumerate
What are the types of analyses employed? (one sample 
\begin_inset Formula $t$
\end_inset

-test, paired-sample 
\begin_inset Formula $t$
\end_inset

-test, ANOVA, chi-square test, regression, \SpecialChar \ldots{}
) 
\end_layout

\end_deeper
\begin_layout Enumerate
Data Collection 
\end_layout

\begin_deeper
\begin_layout Enumerate
Describe how the data were collected in detail.
\end_layout

\begin_layout Enumerate
Identify all variable types: quantitative, qualitative, ordered or nominal
 (with levels), discrete, continuous.
\end_layout

\begin_layout Enumerate
Discuss any limitations of the data collection procedure.
 Look carefully for any sources of bias.
\end_layout

\end_deeper
\begin_layout Enumerate
Summary Information 
\end_layout

\begin_deeper
\begin_layout Enumerate
Give numeric summaries of all variables of interest.
\end_layout

\begin_deeper
\begin_layout Enumerate
Discrete: (relative) frequencies, contingency tables, odds ratios, 
\emph on
etc
\emph default
.
 
\end_layout

\begin_layout Enumerate
Continuous: measures of center, spread, shape.
\end_layout

\end_deeper
\begin_layout Enumerate
Give visual summaries of all variables of interest.
\end_layout

\begin_deeper
\begin_layout Enumerate
Side-by-side boxplots, scatterplots, histograms, 
\emph on
etc
\emph default
.
\end_layout

\end_deeper
\begin_layout Enumerate
Discuss any unusual features of the data (outliers, clusters, granularity,
 
\emph on
etc
\emph default
.)
\end_layout

\begin_layout Enumerate
Report any missing data and identify any potential problems or bias.
\end_layout

\end_deeper
\begin_layout Enumerate
Analysis 
\end_layout

\begin_deeper
\begin_layout Enumerate
State any hypotheses employed, and check the assumptions.
 
\end_layout

\begin_layout Enumerate
Report test statistics, 
\emph on
p
\emph default
-values, and confidence intervals.
 
\end_layout

\begin_layout Enumerate
Interpret the results in the context of the study.
\end_layout

\begin_layout Enumerate
Attach (labeled) tables and/or graphs and make reference to them in the
 report as needed.
 
\end_layout

\end_deeper
\begin_layout Enumerate
Conclusion
\end_layout

\begin_deeper
\begin_layout Enumerate
Summarize the results of the study.
 What did you learn? 
\end_layout

\begin_layout Enumerate
Discuss any limitations of the study or inferences.
\end_layout

\begin_layout Enumerate
Discuss avenues of future research suggested by the study.
 
\end_layout

\end_deeper
\begin_layout Section
How to Write It with 
\family sans
R
\begin_inset CommandInset label
LatexCommand label
name "sec:How-to-Write"

\end_inset


\end_layout

\begin_layout Standard
Once the decision has been made what to write, the next task is to typeset
 the information to be shared.
 To do this the author will need to select software to use to write the
 documents.
 There are many options available, and choosing one over another is sometimes
 a matter of taste.
 But not all software were created equal, and 
\family sans
R
\family default
 plays better with some applications than it does with others.
\end_layout

\begin_layout Standard
In short, 
\family sans
R
\family default
 does great with LaTeX and there are many resources available to make writing
 a document with 
\family sans
R
\family default
 and LaTeX easier.
 But LaTeX is not for the beginner, and there are other word processors
 which may be acceptable depending on the circumstances.
\end_layout

\begin_layout Subsection
Microsoft
\begin_inset Formula $\circledR$
\end_inset

 Word
\end_layout

\begin_layout Standard
It is a fact of life that Microsoft
\begin_inset Formula $\circledR$
\end_inset

 Windows is currently the most prevalent desktop operating system on the
 planet.
 Those who own Windows also typically own some version of Microsoft Office,
 thus Microsoft Word is the default word processor for many, many people.
 
\end_layout

\begin_layout Standard
The standard way to write an 
\family sans
R
\family default
 report with Microsoft
\begin_inset Formula $\circledR$
\end_inset

 Word is to generate material with 
\family sans
R
\family default
 and then copy-paste the material at selected places in a Word document.
 An advantage to this approach is that Word is nicely designed to make it
 easy to copy-and-paste from 
\family sans
RGui
\family default
 to the Word document.
\end_layout

\begin_layout Standard
A disadvantage to this approach is that the R input/output needs to be edited
 manually by the author to make it readable for others.
 Another disadvantage is that the approach does not work on all operating
 systems (not on Linux, in particular).
 Yet another disadvantage is that Microsoft
\begin_inset Formula $\circledR$
\end_inset

 Word is proprietary, and as a result, 
\family sans
R
\family default
 does not communicate with Microsoft
\begin_inset Formula $\circledR$
\end_inset

 Word as well as it does with other software as we shall soon see.
\end_layout

\begin_layout Standard
Nevertheless, if you are going to write a report with Word there are some
 steps that you can take to make the report more amenable to the reader.
\end_layout

\begin_layout Enumerate
Copy and paste graphs into the document.
 You can do this by right clicking on the graph and selecting 
\family sans
Copy as bitmap,
\family default
 or 
\family sans
Copy as metafile
\family default
, or one of the other options.
 Then move the cursor to the document where you want the picture, right-click,
 and select 
\family sans
Paste
\family default
.
\end_layout

\begin_layout Enumerate
Resize (most) pictures so that they take up no more than 1/2 page.
 You may want to put graphs side by side; do this by inserting a table and
 placing the graphs inside the cells.
\end_layout

\begin_layout Enumerate
Copy selected 
\family sans
R
\family default
 input and output to the Word document.
 All code should be separated from the rest of the writing, except when
 specifically mentioning a function or object in a sentence.
\end_layout

\begin_layout Enumerate
The font of 
\family sans
R
\family default
 input/output should be Courier New, or some other monowidth font (not Times
 New Roman or Calibri); the default font size of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

12
\end_layout

\end_inset


\color inherit
 is usually too big for 
\family sans
R
\family default
 code and should be reduced to, for example, 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

10pt
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Standard
It is also possible to communicate with 
\family sans
R
\family default
 through OpenOffice.org, which can export to the proprietary (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.doc
\end_layout

\end_inset


\color inherit
) format.
\end_layout

\begin_layout Subsection
OpenOffice.org and 
\family typewriter
odfWeave
\end_layout

\begin_layout Standard
OpenOffice.org (OO.o) is an open source desktop productivity suite which mirrors
 Microsoft
\begin_inset Formula $\circledR$
\end_inset

 Office.
 It is especially nice because it works on all operating systems.
 OO.o can read most document formats, and in particular, it will read 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.doc
\end_layout

\end_inset


\color inherit
 files.
 The standard OO.o file extension for documents is 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.odt
\end_layout

\end_inset


\color inherit
, which stands for 
\begin_inset Quotes eld
\end_inset

open document text
\begin_inset Quotes erd
\end_inset

.
\end_layout

\begin_layout Standard
The 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

odfWeave
\end_layout

\end_inset


\color inherit
 package 
\begin_inset CommandInset citation
LatexCommand cite
key "odfweave"

\end_inset

 provides a way to generate an 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.odt
\end_layout

\end_inset


\color inherit
 file with 
\family sans
R
\family default
 input and output code formatted correctly and inserted in the correct places,
 without any additional work.
 In this way, one does not need to worry about all of the trouble of typesetting
 
\family sans
R
\family default
 output.
 Another advantage of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

odfWeave
\end_layout

\end_inset


\color inherit
 is that it allows you to generate the report dynamically; if the data underlyin
g the report change or are updated, then a few clicks (or commands) will
 generate a brand new report.
\end_layout

\begin_layout Standard
One disadvantage is that the source 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.odt
\end_layout

\end_inset


\color inherit
 file is not easy to read, because it is difficult to visually distinguish
 the noweb parts (where the 
\family sans
R
\family default
 code is) from the non-noweb parts.
 This can be fixed by manually changing the font of the noweb sections to,
 for instance, Courier font, size 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

10pt
\end_layout

\end_inset


\color inherit
.
 But it is extra work.
 It would be nice if a program would discriminate between the two different
 sections and automatically typeset the respective parts in their correct
 fonts.
 This is one of the advantages to LyX.
\end_layout

\begin_layout Standard
Another advantage of OO.o is that even after you have generated the outfile,
 it is fully editable just like any other 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.odt
\end_layout

\end_inset


\color inherit
 document.
 If there are errors or formatting problems, they can be fixed at any time.
\end_layout

\begin_layout Standard
Here are the basic steps to typeset a statistical report with OO.o.
\end_layout

\begin_layout Enumerate
Write your report as an 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.odt
\end_layout

\end_inset


\color inherit
 document in OO.o just as you would any other document.
 Call this document 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

infile.odt
\end_layout

\end_inset


\color inherit
, and make sure that it is saved in your working directory.
\end_layout

\begin_layout Enumerate
At the places you would like to insert 
\family sans
R
\family default
 code in the document, write the code chunks in the following format:
\end_layout

\begin_deeper
\begin_layout Standard

\family typewriter
<<>>=
\begin_inset Newline newline
\end_inset

x <- rnorm(10)
\begin_inset Newline newline
\end_inset

mean(x)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
or write whatever code you want between the symbols 
\family typewriter
<<>>=
\family default
 and 
\family typewriter
@
\family default
.
\end_layout

\end_deeper
\begin_layout Enumerate
Open 
\family sans
R
\family default
 and type the following:
\end_layout

\begin_deeper
\begin_layout Scrap

\family typewriter
<<eval = FALSE>>=
\begin_inset Newline newline
\end_inset

library(odfWeave)
\begin_inset Newline newline
\end_inset

odfWeave(file = "infile.odt", dest = "outfile.odt")
\begin_inset Newline newline
\end_inset

@
\family default
 
\end_layout

\end_deeper
\begin_layout Enumerate
The compiled (
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

.odt
\end_layout

\end_inset


\color inherit
) file, complete with all of the 
\family sans
R
\family default
 output automatically inserted in the correct places, will now be the file
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

outfile.odt
\end_layout

\end_inset


\color inherit
 located in the working directory.
 Open 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

outfile.odt
\end_layout

\end_inset


\color inherit
, examine it, modify it, and repeat if desired.
\end_layout

\begin_layout Standard
There are all sorts of extra things that can be done.
 For example, the 
\family sans
R
\family default
 commands can be suppressed with the tag 
\family typewriter
<<echo = FALSE>>=
\family default
, and the 
\family sans
R
\family default
 output may be hidden with 
\family typewriter
<<results = hide>>=
\family default
.
 See the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

odfWeave
\end_layout

\end_inset

 package documentation for details.
\end_layout

\begin_layout Subsection
Sweave and LaTeX
\end_layout

\begin_layout Standard
This approach is nice because it works for all operating systems.
 One can quite literally typeset 
\emph on
anything
\emph default
 with LaTeX.
 All of this power comes at a price, however.
 The writer must learn the LaTeX language which is a nontrivial enterprise.
 Even given the language, if there is a single syntax error, or a single
 delimeter missing in the entire document, then the whole thing breaks.
\end_layout

\begin_layout Standard
LaTeX can do anything, but it is relatively difficult to learn and very
 grumpy about syntax errors and delimiter matching.
 there are however programs useful for formatting LaTeX.
\end_layout

\begin_layout Standard
A disadvantage is that you cannot see the mathematical formulas until you
 run the whole file with LaTeX.
\end_layout

\begin_layout Standard
A disadvantage is that figures and tables are relatively difficult.
\end_layout

\begin_layout Standard
There are programs to make the process easier AUCTeX
\end_layout

\begin_layout Standard
dev.copy2eps, also dev.copy2pdf
\end_layout

\begin_layout Standard
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://www.stat.uni-muenchen.de/~leisch/Sweave/
\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Sweave and LyX
\end_layout

\begin_layout Standard
This approach is nice because it works for all operating systems.
 It gives you everything from the last section and makes it easier to use
 LaTeX.
 That being said, it is better to know LaTeX already when migrating to LyX,
 because you understand all of the machinery going on under the hood.
\end_layout

\begin_layout Standard
Program Listings and the 
\family sans
R
\family default
 language
\end_layout

\begin_layout Standard
This book was written with LyX.
\end_layout

\begin_layout Standard
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://gregor.gorjanc.googlepages.com/lyx-sweave
\end_layout

\end_inset


\end_layout

\begin_layout Section
Formatting Tables
\begin_inset CommandInset label
LatexCommand label
name "sec:Formatting-Tables"

\end_inset


\end_layout

\begin_layout Standard
The prettyR package 
\end_layout

\begin_layout Standard
the Hmisc package
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

library(Hmisc)
\begin_inset Newline newline
\end_inset

summary(cbind(Sepal.Length, Sepal.Width) ~ Species, data = iris)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
There is a method argument to summary, which is set to 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

method = "response"
\end_layout

\end_inset


\color inherit
 by default.
 There are two other methods for summarizing data: reverse and cross.
 See 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

?summary.formula
\end_layout

\end_inset


\color inherit
 or the following document from Frank Harrell for more details 
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://biostat.mc.vanderbilt.edu/twiki/bin/view/Main/StatReport
\end_layout

\end_inset

.
\end_layout

\begin_layout Section
Other Formats
\begin_inset CommandInset label
LatexCommand label
name "sec:Other-Formats"

\end_inset


\end_layout

\begin_layout Standard
HTML and prettyR
\end_layout

\begin_layout Standard
R2HTML
\end_layout

\begin_layout Chapter
Instructions for Instructors
\family sans

\begin_inset CommandInset label
LatexCommand label
name "cha:Instructions-for-Instructors"

\end_inset


\end_layout

\begin_layout Standard

\noun on
WARNING: this appendix is not applicable until the exercises have been written.

\noun default
 
\end_layout

\begin_layout Scrap
<<echo = FALSE>>=
\begin_inset Newline newline
\end_inset

set.seed(095259)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Probably this 
\emph on
book
\emph default
 could more accurately be described as 
\emph on
software
\emph default
.
 The reason is that the document is one big random variable, one observation
 realized out of millions.
 It is electronically distributed under the GNU FDL, and 
\begin_inset Quotes eld
\end_inset

free
\begin_inset Quotes erd
\end_inset

 in both senses: speech and beer.
 
\end_layout

\begin_layout Standard
There are four components to 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
IPSUR
\end_layout

\end_inset

: the Document, the Program used to generate it, the 
\family sans
R
\family default
 package that holds the Program, and the Ancillaries that accompany it.
\end_layout

\begin_layout Standard
The majority of the data and exercises have been designed to be randomly
 generated.
 Different realizations of this book will have different graphs and exercises
 throughout.
 The advantage of this approach is that a teacher, say, can generate a unique
 version to be used in his/her class.
 Students can do the exercises and the teacher will have the answers to
 all of the problems in their own, unique solutions manual.
 Students may download a different solutions manual online somewhere else,
 but none of the answers will match the teacher's copy.
 
\end_layout

\begin_layout Standard
Then next semester, the teacher can generate a 
\emph on
new
\emph default
 book and the problems will be more or less identical, except the numbers
 will be changed.
 This means that students from different sections of the same class will
 not be able to copy from one another quite so easily.
 The same will be true for similar classes at different institutions.
 Indeed, as long as the instructor protects his/her 
\emph on
key
\emph default
 used to generate the book, it will be difficult for students to crack the
 code.
 And if they are industrious enough at this level to find a way to (a) download
 and decipher my version's source code, (b) hack the teacher's password
 somehow, and (c) generate the teacher's book with all of the answers, then
 they probably should be testing out of an 
\begin_inset Quotes eld
\end_inset

Introduction to Probability and Statistics
\begin_inset Quotes erd
\end_inset

 course, anyway.
 
\end_layout

\begin_layout Standard
The book that you are reading was created with a random seed which was set
 at the beginning.
 The original seed is 42.
 You can choose your own seed, and generate a new book with brand new data
 for the text and exercises, complete with updated manuals.
 A method I recommend for finding a seed is to look down at your watch at
 this very moment and record the 6 digit hour, minute, and second (say,
 9:52:59am): choose that for a seed
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
In fact, this is essentially the method used by 
\family sans
R
\family default
 to select an initial random seed (see ?set.seed).
 However, the instructor should set the seed manually so that the book can
 be regenerated at a later time, if necessary.
\end_layout

\end_inset

.
 This method already provides for over 43,000 books, without taking military
 time into account.
 An alternative would be to go to 
\family sans
R
\family default
 and type 
\end_layout

\begin_layout Scrap
<<>>=
\begin_inset Newline newline
\end_inset

options(digits = 16)
\begin_inset Newline newline
\end_inset

runif(1)
\begin_inset Newline newline
\end_inset

@
\end_layout

\begin_layout Standard
Now choose 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{set.seed(095259); options(digits = 16); runif(1)*10^16}
\end_layout

\end_inset

 as your secret seed\SpecialChar \ldots{}
 write it down in a safe place and do not share it with
 anyone.
 Next generate the book with your seed using LyX-Sweave or Sweave-LaTeX.
 You may wish to also generate Student and Instructor Solution Manuals.
 Guidance regarding this is given below in the How to Use This Document
 section.
\end_layout

\begin_layout Section
Generating This Document
\begin_inset CommandInset label
LatexCommand label
name "sec:Generating-This-Document"

\end_inset


\end_layout

\begin_layout Standard
You will need three (3) things to generate this document for yourself, in
 addition to a current 
\family sans
R
\family default
 distribution which at the time of this writing is 
\family typewriter

\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{version$version.string}
\end_layout

\end_inset

:
\end_layout

\begin_layout Enumerate
a LaTeX distribution,
\end_layout

\begin_layout Enumerate
Sweave (which comes with 
\family sans
R
\family default
 automatically), and 
\end_layout

\begin_layout Enumerate
LyX (optional, but recommended).
\end_layout

\begin_layout Standard
We will discuss each of these in turn.
\end_layout

\begin_layout Description
LaTeX: The distribution used by the present author was TeX Live (
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://www.tug.org/texlive/
\end_layout

\end_inset

).
 There are plenty of other perfectly suitable LaTeX distributions depending
 on your operating system, one such alternative being MikTeX (
\begin_inset Flex URL
status open

\begin_layout Plain Layout

http://miktex.org/
\end_layout

\end_inset

) for Microsoft Windows.
\end_layout

\begin_layout Description
Sweave: If you have 
\family sans
R
\family default
 installed, then the required Sweave files are already on your system\SpecialChar \ldots{}
 somewhere.
 The only problems that you may have are likely associated with making sure
 that your LaTeX distribution knows where to find the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Sweave.sty
\end_layout

\end_inset


\color inherit
 file.
 See the Sweave Homepage (
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://www.statistik.lmu.de/~leisch/Sweave/
\end_layout

\end_inset

) for guidance on how to get it working on your particular operating system.
\end_layout

\begin_layout Description
LyX: Strictly speaking, LyX is not needed to generate this document.
 But this document was written stem to stern with LyX, taking full advantage
 of all of the bells and whistles that LyX has to offer over plain LaTeX
 editors.
 And it's free.
 See the LyX homepage (
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://www.lyx.org/
\end_layout

\end_inset

) for additional information.
\begin_inset Newline newline
\end_inset

If you decide to give LyX a try, then you will need to complete some extra
 steps to coordinate Sweave and LyX with each other.
 Luckily, Gregor Gorjanc has a website and an 
\family sans
R
\family default
 News article 
\begin_inset CommandInset citation
LatexCommand cite
key "Gorjanc2008"

\end_inset

 to help you do exactly that.
 See the LyX-Sweave homepage (
\begin_inset Flex URL
status collapsed

\begin_layout Plain Layout

http://gregor.gorjanc.googlepages.com/lyx-sweave
\end_layout

\end_inset

) for details.
\end_layout

\begin_layout Standard
An attempt was made to not be extravagant with fonts or packages so that
 a person would not need the entire 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

CTAN
\end_layout

\end_inset


\color inherit
 (or 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

CRAN
\end_layout

\end_inset


\color inherit
) installed on their personal computer to generate the book.
 Nevertheless, there are a few extra packages required.
 These packages are listed in the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

preamble
\end_layout

\end_inset


\color inherit
 of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.Rnw
\end_layout

\end_inset

, 
\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.tex
\end_layout

\end_inset


\color inherit
, and 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR.lyx
\end_layout

\end_inset


\color inherit
.
\end_layout

\begin_layout Section
How to Use This Document
\begin_inset CommandInset label
LatexCommand label
name "sec:How-to-Use-Document"

\end_inset


\end_layout

\begin_layout Standard
The easiest way to use this document is to install the 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

IPSUR
\end_layout

\end_inset


\color inherit
 package from 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

CRAN
\end_layout

\end_inset


\color inherit
 and be all done.
 This way would be acceptable if there is another, primary, text being used
 for the course and 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
IPSUR
\backslash

\end_layout

\end_inset

 is only meant to play a supplementary role.
\end_layout

\begin_layout Standard
If you plan for 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
IPSUR
\backslash

\end_layout

\end_inset

 to serve as the primary text for your course, then it would be wise to
 generate your own version of the document.
 You will need the source code for the Program which can be downloaded from
 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

CRAN
\end_layout

\end_inset

 or the
\color inherit
 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
IPSUR
\backslash

\end_layout

\end_inset

 website.
 Once the source is obtained there are four (4) basic steps to generating
 your own copy.
\end_layout

\begin_layout Enumerate
Randomly select a secret 
\begin_inset Quotes eld
\end_inset

seed
\begin_inset Quotes erd
\end_inset

 of integers and replace my seed of 42 with your own seed.
\end_layout

\begin_layout Enumerate
Make sure that the 
\family sans
\series bold
maintext
\family default
\series default
 branch is turned 
\family sans
ON
\family default
 and also make sure that both the 
\family sans
\series bold
solutions
\family default
\series default
 branch and the 
\family sans
\series bold
answers
\family default
\series default
 branch are turned 
\family sans
OFF
\family default
.
 Use LyX or your LaTeX editor with Sweave to generate your unique PDF copy
 of the book and distribute this copy to your students.
 (See the LyX User's Guide to learn more about branches; the ones referenced
 above can be found under 
\family sans
Document 
\begin_inset Formula $\triangleright$
\end_inset

 Settings 
\begin_inset Formula $\triangleright$
\end_inset

 Branches
\family default
.)
\end_layout

\begin_layout Enumerate
Turn the 
\family sans
\series bold
maintext
\family default
\series default
 branch
\family sans

\begin_inset Foot
status collapsed

\begin_layout Plain Layout
You can leave the 
\family sans
\series bold
maintext
\family default
\series default
 branch 
\family sans
ON
\family default
 when generating the solutions manuals, but (1) all of the page numbers
 will be different, and (2) the typeset solutions will generate and take
 up a lot of space between exercises.
\end_layout

\end_inset


\family default
 
\family sans
OFF
\family default
 and the 
\family sans
\series bold
solutions
\family default
\series default
 branch 
\family sans
ON
\family default
.
 Generate a 
\begin_inset Quotes eld
\end_inset

Student Solutions Manual
\begin_inset Quotes erd
\end_inset

 which has complete solutions to selected exercises and distribute the PDF
 to the students.
\end_layout

\begin_layout Enumerate
Leave the 
\family sans
\series bold
solutions
\family default
\series default
 branch 
\family sans
ON
\family default
 and also turn the 
\family sans
\series bold
answers
\family default
\series default
 branch 
\family sans
ON
\family default
 and generate an 
\begin_inset Quotes eld
\end_inset

Instructor Solutions and Answers Manual
\begin_inset Quotes erd
\end_inset

 with full solutions to some of the exercises and just answers to the remaining
 exercises.
 Do NOT distribute this to the students -- unless of course you want them
 to have the answers to all of the problems.
 
\end_layout

\begin_layout Standard
To make it easier for those people who do not want to use LyX (or for whatever
 reason cannot get it working), I have included three (3) Sweave files correspon
ding to the main text, student solutions, and instructor answers, that are
 included in the 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
IPSUR
\backslash

\end_layout

\end_inset

 source package in the 
\family typewriter
/tex
\family default
 subdirectory.
 In principle it is possible to change the seed and generate the three parts
 separately with only Sweave and LaTeX.
 This method is not recommended by me, but is perhaps desirable for some
 people.
\end_layout

\begin_layout Paragraph*
Generating Quizzes and Exams
\end_layout

\begin_layout Itemize
you can copy paste selected exercises from the text, put them together,
 and you have a quiz.
 Since the numbers are randomly generated you do not need to worry about
 different semesters.
 And you will have answer keys already for all of your QUIZZES and EXAMS,
 too.
\end_layout

\begin_layout Section
Ancillary Materials
\begin_inset CommandInset label
LatexCommand label
name "sec:Ancillary-Materials"

\end_inset


\end_layout

\begin_layout Standard
In addition to the main text, student manual, and instructor manual, there
 are two other ancillaries.
 IPSUR.R, and IPSUR.RData.
\end_layout

\begin_layout Section
Modifying This Document
\begin_inset CommandInset label
LatexCommand label
name "sec:Modifying-This-Document"

\end_inset


\end_layout

\begin_layout Standard
Since this document is released under the GNU-FDL, you are free to modify
 this document however you wish (in accordance with the license -- see Appendix
 
\begin_inset CommandInset ref
LatexCommand ref
reference "cha:GNU-Free-Documentation"

\end_inset

).
 The immediate benefit of this is that you can generate the book, with brand
 new problem sets, and distribute it to your students simply as a PDF (in
 an email, for instance).
 As long as you distribute less than 100 such 
\emph on
Opaque
\emph default
 copies, you are not even required by the GNU-FDL to share your 
\emph on
Transparent
\emph default
 copy (the source code with the secret key) that you used to generate them.
 Next semester, choose a new key and generate a new copy to be distributed
 to the new class.
\end_layout

\begin_layout Quotation
But more generally, if you are not keen on the way I explained (or failed
 to explain) something, then you are 
\bar under
free
\bar default
 to rewrite it.
 If you would like to cover more (or less) material, then you are 
\bar under
free
\bar default
 to add (or delete) whatever Chapters/Sections/Paragraphs that you wish.
 And since you have the source code, you do not need to retype the wheel.
\end_layout

\begin_layout Standard
Some individuals will argue that the nature of a statistics textbook like
 this one, many of the exercises being randomly generated 
\emph on
by design
\emph default
, does a disservice to the students because the exercises do not use real-world
 data.
 That is a valid criticism\SpecialChar \ldots{}
 but in my case the benefits outweighed the detriments
 and I moved forward to incorporate static data sets whenever it was feasible
 and effective.
 Frankly, and most humbly, the only response I have for those individuals
 is: 
\begin_inset Quotes eld
\end_inset

Please refer to the preceding paragraph.
\begin_inset Quotes erd
\end_inset


\end_layout

\begin_layout Chapter

\family typewriter
RcmdrTestDrive
\family default
 Story
\family sans

\begin_inset CommandInset label
LatexCommand label
name "cha:RcmdrTestDrive-Story"

\end_inset


\end_layout

\begin_layout Standard
The goal of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

RcmdrTestDrive
\end_layout

\end_inset


\color inherit
 was to have a data set sufficiently rich in the types of data represented
 such that a person could load it into the 
\family sans
R
\family default
 Commander and be able to explore all of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Rcmdr
\end_layout

\end_inset


\color inherit
's menu options at once.
 I decided early-on that an efficient way to do this would be to generate
 the data set randomly, and later add to the list of variables as more 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

Rcmdr
\end_layout

\end_inset


\color inherit
 menu options became available.
 Generating the data was easy, but generating a 
\emph on
story
\emph default
 that related all of the respective variables proved to be less so.
\end_layout

\begin_layout Standard
In the Summer of 2006 I gave a version of the raw data and variable names
 to my STAT 3743 Probability and Statistics class and invited each of them
 to write a short story linking all of the variables together in a coherent
 narrative.
 No further direction was given.
\end_layout

\begin_layout Standard
The most colorful of those I received was written by Jeffery Cornfield,
 submitted July 12, 2006, and is included below with his permission.
 It was edited slightly by the present author and updated to respond dynamically
 to the random generation of 
\color none

\begin_inset listings
lstparams "showstringspaces=false"
inline true
status open

\begin_layout Plain Layout

RcmdrTestDrive
\end_layout

\end_inset


\color inherit
; otherwise, the story has been unchanged.
 
\end_layout

\begin_layout Section*
Case File: ALU-179 
\begin_inset Quotes eld
\end_inset

Murder Madness in Toon Town”
\end_layout

\begin_layout Quotation
\noindent
\align center
***WARNING*** 
\end_layout

\begin_layout Quotation
\noindent
***This file is not for the faint of heart, dear reader, because it is filled
 with horrible images that will haunt your nightmares.
 If you are weak of stomach, have irritable bowel syndrome, or are simply
 paranoid, DO NOT READ FURTHER! Otherwise, read at your own risk.***
\end_layout

\begin_layout Standard
One fine sunny day, Police Chief R.
\begin_inset space ~
\end_inset

Runner called up the forensics department at Acme-Looney University.
 There had been 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{dim(RcmdrTestDrive)[1]-2}
\end_layout

\end_inset

 murders in the past 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round((dim(RcmdrTestDrive)[1]-2)/24)}
\end_layout

\end_inset

 days, approximately one murder every hour, of many of the local Human workers,
 shop keepers, and residents of Toon Town.
 These alarming rates threatened to destroy the fragile balance of Toon
 and Human camaraderie that had developed in Toon Town.
 
\end_layout

\begin_layout Standard
Professor Twee T.
\begin_inset space ~
\end_inset

Bird, a world-renowned forensics specialist and a Czechoslovakian native,
 received the call.
 “Professor, we need your expertise in this field to identify the pattern
 of the killer or killers,” Chief Runner exclaimed.
 “We need to establish a link between these people to stop this massacre.”
\end_layout

\begin_layout Standard
“Yes, Chief Runner, please give me the details of the case,” Professor Bird
 declared with a heavy native accent, (though, for the sake of the case
 file, reader, I have decided to leave out the accent due to the fact that
 it would obviously drive you -- if you will forgive the pun -- looney!)
\end_layout

\begin_layout Standard
“All prints are wiped clean and there are no identifiable marks on the bodies
 of the victims.
 All we are able to come up with is the possibility that perhaps there is
 some kind of alternative method of which we are unaware.
 We have sent a secure e-mail with a listing of all of the victims’ 
\series bold
races
\series default
, 
\series bold
genders
\series default
, locations of the bodies, and the sequential 
\series bold
order
\series default
 in which they were killed.
 We have also included other information that might be helpful,” said Chief
 Runner.
\end_layout

\begin_layout Standard
“Thank you very much.
 Perhaps I will contact my colleague in the Statistics Department here,
 Dr.
\begin_inset space ~
\end_inset

Elmer Fudd-Einstein,” exclaimed Professor Bird.
 “He might be able to identify a pattern of attack with mathematics and
 statistics.” 
\end_layout

\begin_layout Standard
“Good luck trying to find him, Professor.
 Last I heard, he had a bottle of scotch and was in the Hundred Acre Woods
 hunting rabbits,” Chief Runner declared in a manner that questioned the
 beloved doctor’s credibility.
\end_layout

\begin_layout Standard
“Perhaps I will take a drive to find him.
 The fresh air will do me good.”
\end_layout

\begin_layout Quotation
\noindent
***I will skip ahead, dear reader, for much occurred during this time.
 Needless to say, after a fierce battle with a mountain cat that the Toon-ology
 Department tagged earlier in the year as “Sylvester,” Professor Bird found
 Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein and brought him back, with much bribery of alcohol and the
 promise of the future slaying of those “wascally wabbits” (it would help
 to explain that Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein had a speech impediment which was only worsened during the
 consumption of alcohol.)***
\end_layout

\begin_layout Standard
Once our two heroes returned to the beautiful Acme-Looney University, and
 once Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein became sober and coherent, they set off to examine the case
 and begin solving these mysterious murders.
 
\end_layout

\begin_layout Standard
“First off,” Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein explained, “these people all worked at the University at some
 point or another.
 Also, there also seems to be a trend in the fact that they all had a 
\series bold
salary
\series default
 between $
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(min(RcmdrTestDrive$salary))}
\end_layout

\end_inset

 and $
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round(max(RcmdrTestDrive$salary))}
\end_layout

\end_inset

 when they retired.” 
\end_layout

\begin_layout Standard
“That’s not really a lot to live off of,” explained Professor Bird.
 
\end_layout

\begin_layout Standard
“Yes, but you forget that the Looney Currency System works differently than
 the rest of the American Currency System.
 One Looney is equivalent to Ten American Dollars.
 Also, these faculty members are the ones who faced a cut in their salary,
 as denoted by ‘
\series bold
reduction
\series default
’.
 Some of them dropped quite substantially when the University had to fix
 that little 
\emph on
faux pas
\emph default
 in the Chemistry Department.
 You remember: when Dr.
\begin_inset space ~
\end_inset

D.
\begin_inset space ~
\end_inset

Duck tried to create that ‘Everlasting Elixir?’ As a result, these faculty
 left the university.
 Speaking of which, when is his memorial service?” inquired Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein.
 
\end_layout

\begin_layout Standard
“This coming Monday.
 But if there were all of these killings, how in the world could one person
 do it? It just doesn’t seem to be possible; stay up 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{round((dim(RcmdrTestDrive)[1]-2)/24)}
\end_layout

\end_inset

 days straight and be able to kill all of these people and have the energy
 to continue on,” Professor Bird exclaimed, doubting the guilt of only one
 person.
\end_layout

\begin_layout Standard
“Perhaps then, it was a group of people, perhaps there was more than one
 killer placed throughout Toon Town to commit these crimes.
 If I feed in these variables, along with any others that might have a pattern,
 the Acme Computer will give us an accurate reading of suspects, with a
 scant probability of error.
 As you know, the Acme Computer was developed entirely in house here at
 Acme-Looney University,” Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein said as he began feeding the numbers into the massive server.
 
\end_layout

\begin_layout Standard
“Hey, look at this,” Professor Bird exclaimed, “What’s with this 
\series bold
before
\series default
/
\series bold
after
\series default
 information?” 
\end_layout

\begin_layout Standard
“Scroll down; it shows it as a note from the coroner’s office.
 Apparently Toon Town Coroner Marvin -- that strange fellow from Mars, Pennsylva
nia -- feels, in his opinion, that given the fact that the cadavers were
 either 
\series bold
smoke
\series default
rs or non-smokers, and given their personal health, and family medical history,
 that this was their life expectancy before contact with cigarettes or second-ha
nd smoke and after,” Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein declared matter-of-factly.
 
\end_layout

\begin_layout Standard
“Well, would race or gender have something to do with it, Elmer?” inquired
 Professor Bird.
\end_layout

\begin_layout Standard
“Maybe, but I would bet my money on somebody was trying to quiet these faculty
 before they made a big ruckus about the secret money-laundering of Old
 Man Acme.
 You know, most people think that is how the University receives most of
 its funds, through the mob families out of Chicago.
 And I would be willing to bet that these faculty figured out the connection
 and were ready to tell the Looney Police.” Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein spoke lower, fearing that somebody would overhear their conversati
on.
\end_layout

\begin_layout Standard
Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein then pressed 
\family sans
Enter
\family default
 on the keyboard and waited for the results.
 The massive computer roared to life\SpecialChar \ldots{}
 and when I say roared, I mean it literally
 
\emph on
roared
\emph default
.
 All the hidden bells, whistles, and alarm clocks in its secret compartments
 came out and created such a loud racket that classes across the university
 had to come to a stand-still until it finished computing.
 
\end_layout

\begin_layout Standard
Once it was completed, the computer listed 4 names:
\end_layout

\begin_layout Quotation
***********************SUSPECTS******************************** 
\end_layout

\begin_deeper
\begin_layout Description
Yosemite Sam (“Looney” Insane Asylum) 
\end_layout

\begin_layout Description
Wile
\begin_inset space ~
\end_inset

E.
\begin_inset space ~
\end_inset

Coyote (deceased) 
\end_layout

\begin_layout Description
Foghorn
\begin_inset space ~
\end_inset

Leghorn (whereabouts unknown) 
\end_layout

\begin_layout Description
Granny (1313 Mockingbird Lane, Toon Town USA)
\end_layout

\end_deeper
\begin_layout Standard
Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein and Professor Bird looked on in silence.
 They could not believe their eyes.
 The greatest computer on the Gulf of Mexico seaboard just released the
 most obscure results imaginable.
\end_layout

\begin_layout Standard
“There seems to be a mistake.
 Perhaps something is off,” Professor Bird asked, still unable to believe
 the results.
\end_layout

\begin_layout Standard
“Not possible; the Acme Computer takes into account every kind of connection
 available.
 It considers affiliations to groups, and affiliations those groups have
 to other groups.
 It checks the FBI, CIA, British intelligence, NAACP, AARP, NSA, JAG, TWA,
 EPA, FDA, USWA, 
\family sans
R
\family default
, MAPLE, SPSS, SAS, and Ben & Jerry’s files to identify possible links,
 creating the most powerful computer in the world\SpecialChar \ldots{}
 with a tweak of Toon fanaticis
m,” Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein proclaimed, being a proud co-founder of the Acme Computer
 Technology.
\end_layout

\begin_layout Standard
“Wait a minute, Ben & Jerry? What would eating ice cream have to do with
 anything?” Professor Bird inquired.
\end_layout

\begin_layout Standard
“It is in the works now, but a few of my fellow statistician colleagues
 are trying to find a mathematical model to link the type of ice cream consumed
 to the type of person they might become.
 Assassins always ate vanilla with chocolate sprinkles, a little known fact
 they would tell you about Oswald and Booth,” Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein declared.
\end_layout

\begin_layout Standard
“I’ve heard about this.
 My forensics graduate students are trying to identify car thieves with
 either rocky road or mint chocolate chip… so far, the pattern is showing
 a clear trend with chocolate chip,” Professor Bird declared.
 
\end_layout

\begin_layout Standard
“Well, what do we know about these suspects, Twee?” Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein asked.
\end_layout

\begin_layout Standard
“Yosemite Sam was locked up after trying to rob that bank in the West Borough.
 Apparently his guns were switched and he was sent the Acme Kids Joke Gun
 and they blew up in his face.
 The containers of peroxide they contained turned all of his facial hair
 red.
 Some little child is running around Toon Town with a pair of .38’s to this
 day.
\end_layout

\begin_layout Standard
“Wile E.
\begin_inset space ~
\end_inset

Coyote was that psychopath working for the Yahtzee - the fanatics who believed
 that Toons were superior to Humans.
 He strapped sticks of Acme Dynamite to his chest to be a martyr for the
 cause, but before he got to the middle of Toon Town, this defective TNT
 blew him up.
 Not a single other person -- Toon or Human -- was even close.
\end_layout

\begin_layout Standard
“Foghorn Leghorn is the most infamous Dog Kidnapper of all times.
 He goes to the homes of prominent Dog citizens and holds one of their relatives
 for ransom.
 If they refuse to pay, he sends them to the pound.
 Either way, they’re sure stuck in the dog house,” Professor Bird laughed.
 Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein didn’t seem amused, so Professor Bird continued.
 
\end_layout

\begin_layout Standard
“Granny is the most beloved alumnus of Acme-Looney University.
 She was in the first graduating class and gives graciously each year to
 the university.
 Without her continued financial support, we wouldn’t have the jobs we do.
 She worked as a parking attendant at the University lots\SpecialChar \ldots{}
 wait a minute,
 take a look at this,” Professor Bird said as he scrolled down in the police
 information.
 “Granny’s signature is on each of these faculty members’ 
\series bold
parking
\series default
 tickets.
 Kind of odd, considering the Chief-of-Parking signed each personally.
 The deceased had from as few as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{min(RcmdrTestDrive$parking)}
\end_layout

\end_inset

 ticket to as many as 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{max(RcmdrTestDrive$parking)}
\end_layout

\end_inset

.
 All tickets were unpaid.
\end_layout

\begin_layout Standard
“And look at this, Granny married Old Man Acme after graduation.
 He was a resident of Chicago and rumored to be a consigliere to one of
 the most prominent crime families in Chicago, the Chuck Jones/Warner Crime
 Family,” Professor Bird read from the screen as a cold feeling of terror
 rose from the pit of his stomach.
\end_layout

\begin_layout Standard
“Say, don’t you live at her house? Wow, you’re living under the same roof
 as one of the greatest criminals/murderers of all time!” Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein said in awe and sarcasm.
\end_layout

\begin_layout Standard
“I would never have suspected her, but I guess it makes sense.
 She is older, so she doesn’t need near the amount of sleep as a younger
 person.
 She has access to all of the vehicles so she can copy license plate numbers
 and follow them to their houses.
 She has the finances to pay for this kind of massive campaign on behalf
 of the Mob, and she hates anyone that even remotely smells like smoke,”
 Professor Bird explained, wishing to have his hit of nicotine at this time.
\end_layout

\begin_layout Standard
“Well, I guess there is nothing left to do but to call Police Chief Runner
 and have him arrest her,” Dr.
\begin_inset space ~
\end_inset

Fudd-Einstein explained as he began dialing.
 “What I can’t understand is how in the world the Police Chief sent me all
 of this information and somehow seemed to screw it up.”
\end_layout

\begin_layout Standard
“What do you mean?” inquired Professor Bird.
\end_layout

\begin_layout Standard
“Well, look here.
 The data file from the Chief's email shows 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{dim(RcmdrTestDrive)[1]}
\end_layout

\end_inset

 murders, but there have only been 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{dim(RcmdrTestDrive)[1]-2}
\end_layout

\end_inset

.
 This doesn’t make any sense.
 I’ll have to straighten it out.
 Hey, wait a minute.
 Look at this, Person #
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{dim(RcmdrTestDrive)[1]-1}
\end_layout

\end_inset

 and Person #
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{dim(RcmdrTestDrive)[1]}
\end_layout

\end_inset

 seem to match our stats.
 But how can that be?”
\end_layout

\begin_layout Standard
It was at this moment that our two heroes were shot from behind and fell
 over the computer, dead.
 The killer hit 
\family sans
Delete
\family default
 on the computer and walked out slowly (considering they had arthritis)
 and cackling loudly in the now quiet computer lab.
 
\end_layout

\begin_layout Standard
And so, I guess my question to you the reader is, did Granny murder 
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Sexpr{dim(RcmdrTestDrive)[1]}
\end_layout

\end_inset

 people, or did the murderer slip through the cracks of justice? You be
 the statistician and come to your own conclusion.
 
\end_layout

\begin_layout Standard
Detective Pyork E.
\begin_inset space ~
\end_inset

Pig 
\end_layout

\begin_layout Standard
***End File***
\end_layout

\begin_layout Standard
\begin_inset VSpace vfill
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

%
\backslash
bibliographystyle{plainurl}
\end_layout

\begin_layout Plain Layout


\backslash
cleardoublepage
\end_layout

\begin_layout Plain Layout


\backslash
phantomsection
\end_layout

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{chapter}{
\backslash
bibname}
\end_layout

\begin_layout Plain Layout

%
\backslash
nocite{*} 
\end_layout

\begin_layout Plain Layout

%
\backslash
bibliography{IPSUR}
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
btprint "btPrintAll"
bibfiles "IPSUR"
options "plainurl"

\end_inset


\end_layout

\begin_layout Standard
\begin_inset VSpace vfill
\end_inset


\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
cleardoublepage
\end_layout

\begin_layout Plain Layout


\backslash
phantomsection
\end_layout

\begin_layout Plain Layout


\backslash
addcontentsline{toc}{chapter}{
\backslash
indexname} 
\end_layout

\begin_layout Plain Layout

%
\backslash
printindex
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\begin_inset CommandInset index_print
LatexCommand printindex

\end_inset


\end_layout

\begin_layout Scrap
<<echo=FALSE, results=hide, split=FALSE>>= 
\begin_inset Newline newline
\end_inset

rm(.Random.seed)
\begin_inset Newline newline
\end_inset

try(dir.create("../../data"), silent = TRUE)
\begin_inset Newline newline
\end_inset

save.image(file = "../../data/IPSUR.RData")
\begin_inset Newline newline
\end_inset

Stangle(file="IPSUR.Rnw", output="../IPSUR.R", annotate=TRUE)
\begin_inset Newline newline
\end_inset

@
\end_layout

\end_body
\end_document
